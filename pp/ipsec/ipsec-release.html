<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html><head><title>Functional Package for IPsec 'n Friends</title><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><script type="text/x-mathjax-config">
            MathJax.Hub.Config({
            extensions: ["tex2jax.js"],
            jax: ["input/TeX", "output/HTML-CSS"],
            showMathMenu: false,
            tex2jax: {
              inlineMath: [ ['$','$'], ["\\(","\\)"] ],
              displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
              processEscapes: true
            },
            styles: {

                ".MathJax_Display": {
                "text-align": "left !important",
                margin:       "0em 0em !important"
            }}
            });
        </script><script type="text/javascript">// 

// Called on page load to parse URL parameters and perform actions on them.
function init(){
    if(getQueryVariable("expand") == "on"){
      expand();
    }
    fixAbbrs();
}


function fixAbbrs(){
    var aa;
    var brk_els = document.getElementsByClassName("dyn-abbr");
    //
    for(aa=0; aa!=brk_els.length; aa++){
        var abbr = brk_els[aa].firstElementChild.getAttribute("href").substring(1);
        var el = document.getElementById("long_"+abbr)
        if (el==null) {
             console.log("Could not find 'long_abbr_'"+abbr);
             continue;
        }
        var abbr_def = el.textContent;
        brk_els[aa].setAttribute("title", abbr_def);
    }
}
// // 
const AMPERSAND=String.fromCharCode(38);

// Pass a URL variable to this function and it will return its value
function getQueryVariable(variable)
{
    var query = window.location.search.substring(1);
    var vars = query.split(AMPERSAND);
    for (var i=0;i!=vars.length;i++) {
        var pair = vars[i].split("=");
        if(pair[0] == variable){return pair[1];}
    }
    return(false);
}


//    Expands all evaluation activities
function expand(){
    var ap = document.getElementsByClassName('activity_pane');
    for (var ii = 0; ii!=ap.length; ii++) {
        ap[ii].classList.remove('hide');
    }
}

// Function to expand and contract a given div
function toggle(descendent) {
    var cl = descendent.parentNode.parentNode.classList;
    if (cl.contains('hide')){
      cl.remove('hide');
    }
    else{
      cl.add('hide');
    }
}

// Expands targets if they are hidden
function showTarget(id){
    var element = document.getElementById(id);
    while (element != document.body.rootNode ){
	element.classList.remove("hide");
	element = element.parentElement;
    }
}


// </script><style type="text/css">
    #toc a{
        display: block;
    }

    svg{
      width: 100%;
    }

    a[id^="ajq_"]{
        color:black;
    }

    
    body{
       max-width: 900px;
       margin: auto;
    }
    #toc span{
       margin-left: 20px;
    }
    .assignable-content{
      font-style: italic;
    }
    .selection-content{
      font-style: italic;
    }
    .refinement{
      font-weight: bold;
    }
    div.eacategory{
      font-style: italic;
      font-weight: bold;
    }
    .activity_pane .toggler::after, .activity_pane .toggler{
       display: inline-block;
       height: auto;
       content: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8A\
       AAAPCAYAAAA71pVKAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAQOFAAEDhQGl\
       VDz+AAAAB3RJTUUH4gIXFDM7fhmr1wAAAfRJREFUKM+dkk9I02EYxz/P+25uurWR\
       tTkzI4NGl4jQgkq71K1DhnTQIDolRAQFQYSHTtGhU4e6eujQofBSFLOg0C4RUSjh\
       FnmqTTdKpj/mfv/eX4cUpmRYn9vz8v3w8D7PA/AWGADCbI4QcAb4AnAF8IBJEdX+\
       N0tEda40C4AHADviW1LFvpOX6+FwtAacVzqkGiWtwxo4F21OuPu7+yvxRNoDEhpY\
       cpzavkQyc7D76FCk+vN7j7VU6RdR4xAsikjGGP9FKrN3sPfEpajv2i2zhckR4JUG\
       UCr0erFavLkn2ytd2WPxcFOsZb74+SIQA0YPHBqIdB8Z6tChJv1m/N4P33OGAUsD\
       BIFxPNcOkq07jyeSbbo1tTu2q6vHEqU7D/ddSKcz2ZQJjBSmx925b9NjwEMAafha\
       eyQa/3Dq7O0243sCIEoRGAOA59nm5dM7OHVruzH+AkDjYEp23RrLT+U8Ub+fV0UR\
       oVyaMfVa9fqquF5GKX3ja2FCuc6yWbMipYNP755UgEdr8o2FMf5ivVYdKRfzRkRW\
       RfJTOc+2rWdAcUN5hdGP7x8viGgAXLvGbGFCKxW6tj74J3nOqVvP89M5V6kQ86UZ\
       f7lWvWWMt7Sp41VKb21uSfqnB++6kWi8BLTzL4ioq7H4tgC4z3/QAZSBxEaBXygN\
       v+jeFnAPAAAAAElFTkSuQmCC');
       max-width: 15px;
    }


    a {
      text-decoration: none;
      word-wrap: break-word;
    }
    a.abbr:link{
      color:black;
      text-decoration:none;
    }
    a.abbr:visited{
      color:black;
      text-decoration:none;
    }
    a.abbr:hover{
      color:blue;
      text-decoration:none;
    }
    a.abbr:hover:visited{
      color:purple;
      text-decoration:none;
    }
    a.abbr:active{
      color:red;
      text-decoration:none;
    }
    .note-header{
      font-weight: bold;
    }
    .note p:first-child{
      display: inline;
    }

    .indent{ margin-left:2em; }

    /* Tooltip container */
    .tooltipped {
       position: relative;
       display: inline-block;
       border-bottom: 1px dotted black; /* If you want dots under the hoverable text */
    }

    /* Tooltip text */
    .tooltiptext {
       visibility: hidden;
       width: 120px;
       background-color: black;
       color: #fff;
       text-align: center;
       padding: 5px 0;
       border-radius: 6px;

       /* Position the tooltip text - see examples below! */
       position: absolute;
       z-index: 1;
   }

   /* Show the tooltip text when you mouse over the tooltip container */
   .tooltipped:hover .tooltiptext {
       visibility: visible;
   }
   tr.major-row{
       border-top-style: double;
   }
   tr.major-row td:first-child{
       border-right-style: ridge;
       background-color: white;
   } 
   table.mfs td{
       text-align: center;
   }
   table.mfs td:first-child{
       text-align: left;
   }
  .table-caption, caption{
       text-align: center;
       font-weight: bold;
   }
   table{
       margin:auto;
       margin-top:1em;
       border-collapse:collapse; /*border: 1px solid black;*/
   }
   td{
       text-align:left;
       padding:8px 8px;
   }
   th{
       padding:8px 8px;
   }
   thead tr td{
       text-align: center;
       font-style: oblique;
       font-weight: bold;
   }
   tr.header{
       border-bottom:3px solid gray;
       padding:8px 8px;
       text-align:left;
       font-weight:bold; /*font-size: 90%; font-family: verdana, arial, helvetica, sans-serif; */
   }
   table tr:nth-child(2n+2){
       background-color:#F4F4F4;
   }

   .dependent{
       border: 1px solid gray;
       border-radius: 1px
   }
   .dependent-content{
       margin-left: 25px;
       font-style: italic;
   }

   .uc_table_or td, .uc_table_or tr {
       vertical-align: middle;
       border: 1px solid black;
       background-color: white;
   }

   .uc_not, .uc_mf, .uc_sel, .uc_guide{
       text-indent: 10px;
   }
   .uc_sel &gt; a{ 
       font-style: italic;
   }

   .uc_not_sel, .uc_sel.uc_mf, uc_assign.uc_mf{
       text-indent: 20px;
   }


   .uc_table_or tr td.or_cell{
      white-space: nowrap;
      border-radius: 0.6em 0 0 0.6em;
      background-color: black;
      color: white;
   }

   .uc_table_and, .uc_table_or {
       width: 100%;
       background-color: white;
   }
   .uc_guidance{
       display: table;
       background-color: gray;
   }  
   div.uc_inc_fcomp{
       display: list-item;
       list-style-type: disc;
       list-style-position: inside;
   }
   .evidence, .test-obj { font-style: normal; font-size: 90%;}
   
   
	table.classic {
    	width: 100%;
    	background-color: white;
    	border-collapse: collapse;
    	border-width: 2px;
  		border-color: gray;
  		border-style: solid;
  		color: black;
		font-size: small;
	}
    table.classic th {
  		background-color: lightgray;   
	}
    table.classic th:empty{
	    background-color: white;
		border-top: none;
		border-left: none;
	}
	table.classic td, table.classic th {
  		border-width: 2px;
  		border-color: gray;
  		border-style: solid;
  		padding: 5px;
	}

   
   
   
          .figure{
              font-weight:bold;
          }
          h1{
              page-break-before:always;
              text-align:left;
              font-size:200%;
              margin-top:2em;
              margin-bottom:2em;
              font-family:verdana, arial, helvetica, sans-serif;
              margin-bottom:1.0em;
          }
          h1.title{
              text-align:center;
          }
          h2{
              font-size:125%;
              border-bottom:solid 1px gray;
              margin-bottom:1.0em;
              margin-top:2em;
              margin-bottom:0.75em;
              font-family:verdana, arial, helvetica, sans-serif;
          }
          h3{
              font-size:110%;
              margin-bottom:0.25em;
              font-family:verdana, arial, helvetica, sans-serif;
          }
          h4{
              margin-left:0%;
              font-size:100%;
              margin-bottom:0.75em;
              font-family:verdana, arial, helvetica, sans-serif;
          }
          h5,
          h6{
              margin-left:6%;
              font-size:90%;
              margin-bottom:0.5em;
              font-family:verdana, arial, helvetica, sans-serif;
          }
          p{
              margin-bottom:0.6em;
              margin-top:0.2em;
          }
          pre{
              margin-bottom:0.5em;
              margin-top:0.25em;
              margin-left:3%;
              font-family:monospace;
              font-size:90%;
          }
          ul{
              margin-bottom:0.5em;
              margin-top:0.25em;
          }
          td{
              vertical-align:top;
          }
          dl{
              margin-bottom:0.5em;
              margin-top:0.25em;
          }
          dt{
              margin-top:0.7em;
              font-weight:bold;
              font-family:verdana, arial, helvetica, sans-serif;
          }

          a.linkref{
              font-family:verdana, arial, helvetica, sans-serif;
              font-size:90%;
          }

          *.simpleText{
              margin-left:10%;
          }
          *.propertyText{
              margin-left:10%;
              margin-top:0.2em;
              margin-bottom:0.2em
          }
          *.toc{
              background:#FFFFFF;
          }
          *.toc2{
              background:#FFFFFF;
          }
	  .choicelabel{
	    font-weight: bold;
	  }
          div.comp{
              margin-left:8%;
              margin-top:1em;
              margin-bottom:1em;
          }
          div.element{
              margin-bottom:1em;
          }
          div.appnote{
              margin-left:0%;
              margin-top:1em;
          }
          .comment-aa{
              background-color:beige;
              color:green;
          }

          div.subaact{
              margin-left:0%;
              margin-top:1em;
          }
          .subaact-header{
              font-weight: bold;
          }

          div.activity_pane_body{
              font-style:italic;
              margin-left:0%;
              margin-top:1em;
              margin-bottom:1em;
              padding:1em;
              border:2px solid #888888;
              border-radius:3px;
              display:block;
              margin-left:0%;
              margin-top:1em;
              margin-bottom:1em;
              box-shadow:0 2px 2px 0 rgba(0,0,0,.14),0 3px 1px -2px rgba(0,0,0,.2),0 1px 5px 0 rgba(0,0,0,.12);
          }
          div.optional-appendicies{
              display:none;
          }

          div.statustag{
              margin-left:0%;
              margin-top:1em;
              margin-bottom:1em;
              padding: 0.6em;
              border:2px solid #888888;
              border-radius:3px;
          }

          div.toc{
              margin-left:8%;
              margin-bottom:4em;
              padding-bottom:0.75em;
              padding-top:1em;
              padding-left:2em;
              padding-right:2em;
          }
          span.SOlist{
              font-size:90%;
              font-family:verdana, arial, helvetica, sans-serif;
          }
          h2.toc{
              border-bottom:none;
              margin-left:0%;
              margin-top:0em;
          }
          p.toc{
              margin-left:2em;
              margin-bottom:0.2em;
              margin-top:0.5em;
          }
          p.toc2{
              margin-left:5em;
              margin-bottom:0.1em;
              margin-top:0.1em;
          }
          div.center{
              display:block;
              margin-left:auto;
              margin-right:auto;
              text-align:center;
          }
          div.figure{
              display:block;
              margin-left:auto;
              margin-right:auto;
              text-align:center;
              margin-top:1em;
          }
          div.activity_pane_header{
              display:table-cell;
              vertical-align:middle;
              padding-top:10px
          }
          span.activity_pane_label{
              vertical-align:middle;
              color:black;
              text-decoration:none;
              font-size:100%;
              font-weight:bold; /*font-family: verdana, arial, helvetica, sans-serif; */
          }
          .dyn-abbr a, .dyn-abbr a:active, .dyn-abbr a:visited{
              background-color: inherit;
              color: inherit;
              text-decoration: inherit;;
          }

          @media screen{
              *.reqid{
                  float:left;
                  font-size:90%;
                  font-family:verdana, arial, helvetica, sans-serif;
                  margin-right:1em;
              }
              *.req{
                  margin-left:0%;
                  margin-top:1em;
                  margin-bottom:1em;
              }
              *.reqdesc{
                  margin-left:20%;
              }

              .activity_pane.hide .toggler::after, .activity_pane.hide .toggler{
	          content: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8A\
		  AAAPCAYAAAA71pVKAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAQOFAAEDhQGl\
		  VDz+AAAAB3RJTUUH4gIXFC4BR3keeQAAAfZJREFUKM+d0k1PE1EUBuB37h2nQ+30\
		  w5YObR0FhIppqBgWuDCaSBQjiQZNTIxLfoAkBHXh2vg7xID+ABPXBl3UdAMaN1CR\
		  j5ZijZ22DKW9d44LP1KMROvZnMU5z+KcvBzAAgADwCdV1RzXlYQ26tYhrYM6u/qX\
		  ATwCcKodrAOYv3z9IV28OuP6/NHPAGYZ45G/QQ5AAFjNbyzdTA2NewcGx7xeI5wu\
		  FZenQOQQuasHncN/9IJo1sn+unkpbqVFIJhgydQo13VjDKCJSnnLBJAHUPoTBoA3\
		  uzvlfiNgDhn+KMiVCB6xYCZSoaPHz5wrba/cbuztpBWFvQLI+R2DSGZqleKNuJX2\
		  cVVjAIExDo/uV7pPjGhSNntrleI9+n7Ox33Y549Wq/ZWTyh8rNcfjPlaZ4xzZvUM\
		  ezrNvnJ+fXFCiL2k2rpQq2wnAqH4tYjZFyZq/Y8CKZoim51z1nIZQ4jGNIC5fZhz\
		  7fHA4JVuj26AyIWiMDSbdTi1L/T29RO7ahdfKgqbInJLANCKZ6Kx5J24dVowztW6\
		  Y+8WNt91FNYXc4WN988BzAL4QOT+Aj/x8GFf+MHI+UlI2cBS9kVlLZfxSFdMS9GY\
		  V1WtKETDPShhz85emLRHx++TETBLAJ4qCov8c7ajsZMr/5PtBQB3AXSpqsbagd8A\
		  O+HMRUtPNsQAAAAASUVORK5CYII=');
              }

              .activity_pane.hide .activity_pane_body{
                  display:none;
              }
              div.statustag{
                  box-shadow:4px 4px 3px #888888;
              }
          }


          @media print{
              *.reqid{
                  font-size:90%;
                  font-family:verdana, arial, helvetica, sans-serif;
              }
              *.req{
                  margin-left:0%;
                  margin-top:1em;
                  margin-bottom:1em;
              }
              *.reqdesc{
                  margin-left:20%;
              }
              div.activity_pane_body{
                  padding:1em;
                  border:2px solid #888888;
                  border-radius:3px;
                  display:block;
              }

	            img[src="images/collapsed.png"] { display:none;}

          }
    </style></head><body onLoad="init()"><h1 class="title" style="page-break-before:auto;">Functional Package for IPsec 'n Friends</h1><noscript><h1 style="text-align:center; border-style: dashed; border-width: medium; border-color: red;">This page is best viewed with JavaScript enabled!</h1></noscript><div class="center"><img src="images/niaplogo.png" alt="NIAP Logo"></img><br/>
      Version: 1.0<br/>2022-01-06<br/><b>National Information Assurance Partnership</b><br/></div><h2 style="page-break-before:always;">Revision History</h2><table><tr class="header"><th>Version</th><th>Date</th><th>Comment</th></tr><tr><td>1.0</td><td>2022-01-06</td><td>Start of first draft.</td></tr>
</table><h2>Contents</h2><div class="toc" id="toc"><a href="#Introduction" style="text-indent:0px">1<span>Introduction</span></a><a href="#Overview" style="text-indent:10px">1.1<span>Overview</span></a><a href="#glossary" style="text-indent:10px">1.2<span>Terms</span></a><a href="#cc-terms" style="text-indent:20px">1.2.1<span>Common Criteria Terms</span></a><a href="#tech-terms" style="text-indent:20px">1.2.2<span>Technical Terms</span></a><a href="#toes" style="text-indent:10px">1.3<span>Compliant Targets of Evaluation</span></a><a href="#s-usecases" style="text-indent:10px">1.4<span>Use Cases</span></a><a href="#Conformance_Claims" style="text-indent:0px">2<span>Conformance Claims</span></a><a href="#Security_Functional_Requirements" style="text-indent:0px">3<span>Security Functional Requirements</span></a><a href="#ss-audit-table" style="text-indent:10px">3.1<span>Auditable Events for Mandatory SFRs</span></a><a href="#cryptsup" style="text-indent:10px">3.2<span>Cryptographic Support (FCS)</span></a><a href="#s-fia" style="text-indent:10px">3.3<span>Identification and Authentication (FIA)</span></a><a href="#opt-app" style="text-indent:0px">Appendix A - <span>Optional Requirements</span></a><a href="#optional-reqs" style="text-indent:10px">A.1<span>Strictly Optional  Requirements
    </span></a><a href="#objective-reqs" style="text-indent:10px">A.2<span>Objective  Requirements
    </span></a><a href="#feat-based-reqs" style="text-indent:10px">A.3<span>Implementation-Based  Requirements
    </span></a><a href="#sel-based-reqs" style="text-indent:0px">Appendix B - <span>Selection-Based  Requirements
    </span></a><a href="#sel-based-reqs-audit" style="text-indent:10px">B.1<span>
              Auditable Events for Selection-Based  Requirements
           </span></a><a href="#-sel-based" style="text-indent:10px">B.2<span>Cryptographic Support (FCS)</span></a><a href="#s-fia-sel-based" style="text-indent:10px">B.3<span>Identification and Authentication (FIA)</span></a><a href="#use-case-appendix" style="text-indent:0px">Appendix C - <span>Use Case Templates</span></a><a href="#appendix-uc-ipsec-endpoint" style="text-indent:10px">C.1<span>IPsec Endpoint</span></a><a href="#appendix-uc-EAP" style="text-indent:10px">C.2<span>EAP</span></a><a href="#appendix-uc-pre-shared-keys" style="text-indent:10px">C.3<span>Pre-Shared Keys</span></a><a href="#acronyms" style="text-indent:0px">Appendix D - <span>Acronyms</span></a><a href="#appendix-bibliography" style="text-indent:0px">Appendix E - <span>Bibliography</span></a></div><h1 class="indexable" data-level="1" id="Introduction">1 Introduction</h1>
	



  <h2 class="indexable" data-level="2" id="Overview">1.1 Overview</h2>
	Internet Protocol Security (<abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr>) is a suite of open standards for ensuring private
	communications over public networks. It is typically used to encrypt Internet Protocol (IP) traffic 
	between hosts in a network and to create a virtual private network (<abbr class="dyn-abbr"><a href="#abbr_VPN">VPN</a></abbr>). 
	A <abbr class="dyn-abbr"><a href="#abbr_VPN">VPN</a></abbr> is a virtual network built on top of existing physical networks that provides a secure 
	communications mechanism for data and control information transmitted between computers or networks. 
	<abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> can also be used as a component that provides security for other
	internet protocols, such as the User Datagram Protocol (<abbr class="dyn-abbr"><a href="#abbr_UDP">UDP</a></abbr>). <p></p> 
	The main components of <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> are Encapsulating Security Protocol (<abbr class="dyn-abbr"><a href="#abbr_ESP">ESP</a></abbr>) and Internet Key Exchange (<abbr class="dyn-abbr"><a href="#abbr_IKE">IKE</a></abbr>).
	<abbr class="dyn-abbr"><a href="#abbr_ESP">ESP</a></abbr> is the protocol used to to transport encrypted and integrity-protected 
	communications across the network.  <abbr class="dyn-abbr"><a href="#abbr_IKE">IKE</a></abbr> is the protocol used to set up and manage <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> connections.
	<p></p>
	This <i>Functional Package for <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr></i> provides a collection of requirements and evaluation activities for
	IPSec implementations. The intent of this package is to provide <abbr class="dyn-abbr"><a href="#abbr_PP">PP</a></abbr>, <abbr class="dyn-abbr"><a href="#abbr_cPP">cPP</a></abbr>, and <abbr class="dyn-abbr"><a href="#abbr_PP-Module">PP-Module</a></abbr> authors with a readily
	consumable collection of SFRs and EAs to be integrated into their documents. This Package can be used to 
	to evaluate the <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> functionality of TOEs that are not themselves <abbr class="dyn-abbr"><a href="#abbr_VPN">VPN</a></abbr> clients. For example,
	it could be used to evaluate the trusted channel functionality of an operating system that chooses to 
	use <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> rather than SSH or TLS to implement secure remote management. And of course, this Package 
	could be used to encapsulate the <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr>-specific requirements in a <abbr class="dyn-abbr"><a href="#abbr_VPN">VPN</a></abbr> technology evaluation as well.<p></p>
	As such, this Package attempts to specify only requirements and evaluation activities for <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> implementations
	as distinct from those for <abbr class="dyn-abbr"><a href="#abbr_VPN">VPN</a></abbr> implementations, such as <abbr class="dyn-abbr"><a href="#abbr_VPN">VPN</a></abbr> gateways and clients. 
   






	<h2 id="glossary" class="indexable" data-level="2">1.2 Terms</h2>
The following sections list Common Criteria and technology terms used in this document.
    <h3 id="cc-terms" class="indexable" data-level="3">1.2.1 Common Criteria Terms</h3><table><tr><td><div id="Assurance">Assurance</div></td><td>Grounds for confidence that a <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> meets the SFRs <a href="#bibCC">[CC]</a>.</td></tr>
<tr><td><div id="Base_Protection_Profile">Base Protection Profile (<abbr class="dyn-abbr"><a href="#abbr_Base-PP">Base-PP</a></abbr>)</div></td><td>Protection Profile used as a basis to build a <abbr class="dyn-abbr"><a href="#abbr_PP-Configuration">PP-Configuration</a></abbr>.</td></tr>
<tr><td><div id="Collaborative_Protection_Profile">Collaborative Protection Profile (<abbr class="dyn-abbr"><a href="#abbr_cPP">cPP</a></abbr>)</div></td><td>A Protection Profile developed by
    international technical communities and approved by multiple schemes</td></tr>
<tr><td><div id="Common_Criteria">Common Criteria (<abbr class="dyn-abbr"><a href="#abbr_CC">CC</a></abbr>)</div></td><td>Common Criteria for Information Technology Security Evaluation (International Standard ISO/IEC 15408).</td></tr>
<tr><td><div id="Common_Criteria_Testing_Laboratory">Common Criteria Testing Laboratory</div></td><td>
      Within the context of the Common Criteria Evaluation and Validation Scheme (CCEVS), an IT security evaluation facility, accredited by the National Voluntary Laboratory Accreditation Program (NVLAP) and approved by the NIAP Validation Body to conduct Common Criteria-based evaluations.
    </td></tr>
<tr><td><div id="Common_Evaluation_Methodology">Common Evaluation Methodology (<abbr class="dyn-abbr"><a href="#abbr_CEM">CEM</a></abbr>)</div></td><td>Common Evaluation Methodology for Information Technology Security Evaluation.</td></tr>
<tr><td><div id="Distributed_TOE">Distributed <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr></div></td><td>A <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> composed of multiple components operating as a logical whole.</td></tr>
<tr><td><div id="Extended_Package">Extended Package (<abbr class="dyn-abbr"><a href="#abbr_EP">EP</a></abbr>)</div></td><td>A deprecated document form for collecting SFRs that implement a particular protocol, technology,
	    or functionality. See Functional Packages.</td></tr>
<tr><td><div id="Functional_Package">Functional Package (<abbr class="dyn-abbr"><a href="#abbr_FP">FP</a></abbr>)</div></td><td>A document that collects SFRs for a particular protocol, technology,
	    or functionality.</td></tr>
<tr><td><div id="Operational_Environment">Operational Environment (<abbr class="dyn-abbr"><a href="#abbr_OE">OE</a></abbr>)</div></td><td>Hardware and software that are outside the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> boundary that support the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> functionality and security policy.</td></tr>
<tr><td><div id="Protection_Profile">Protection Profile (<abbr class="dyn-abbr"><a href="#abbr_PP">PP</a></abbr>)</div></td><td>An implementation-independent set of security requirements for a category of products.</td></tr>
<tr><td><div id="Protection_Profile_Configuration">Protection Profile Configuration (<abbr class="dyn-abbr"><a href="#abbr_PP-Configuration">PP-Configuration</a></abbr>)</div></td><td>A comprehensive set of security requirements for a product type that consists of at least one <abbr class="dyn-abbr"><a href="#abbr_Base-PP">Base-PP</a></abbr> and at least one <abbr class="dyn-abbr"><a href="#abbr_PP-Module">PP-Module</a></abbr>.</td></tr>
<tr><td><div id="Protection_Profile_Module">Protection Profile Module (<abbr class="dyn-abbr"><a href="#abbr_PP-Module">PP-Module</a></abbr>)</div></td><td>An implementation-independent statement of security needs for a <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> type complementary to one or more Base Protection Profiles.</td></tr>
<tr><td><div id="Security_Assurance_Requirement">Security Assurance Requirement (<abbr class="dyn-abbr"><a href="#abbr_SAR">SAR</a></abbr>)</div></td><td>A requirement to assure the security of the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr>.</td></tr>
<tr><td><div id="Security_Functional_Requirement">Security Functional Requirement (<abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr>)</div></td><td>A requirement for security enforcement by the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr>.</td></tr>
<tr><td><div id="Security_Target">Security Target (<abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr>)</div></td><td>A set of implementation-dependent security requirements for a specific product.</td></tr>
<tr><td><div id="Target_of_Evaluation">Target of Evaluation (<abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr>)</div></td><td>The product under evaluation. </td></tr>
<tr><td><div id="TOE_Security_Functionality"><abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> Security Functionality (<abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>)</div></td><td>The security functionality of the product under evaluation.</td></tr>
<tr><td><div id="TOE_Summary_Specification"><abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> Summary Specification (<abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr>)</div></td><td>A description of how a <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> satisfies the SFRs in an <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr>.</td></tr>
</table><h3 id="tech-terms" class="indexable" data-level="3">1.2.2 Technical Terms</h3><table style="width: 100%"><tr><td><div id="Certificate_Authority">Certificate Authority (<abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr>)</div></td><td>
			An entity that issues digital certificates.
		</td></tr>
<tr><td><div id="Certificate_Signing_Request">Certificate Signing Request (<abbr class="dyn-abbr"><a href="#abbr_CSR">CSR</a></abbr>)</div></td><td>
			A message sent from an applicant to a registration authority of the public key infrastructure 
			in order to apply for a digital identity certificate.
		</td></tr>
<tr><td><div id="Distinguished_Name">Distinguished Name (<abbr class="dyn-abbr"><a href="#abbr_DN">DN</a></abbr>)</div></td><td>
			A field in an X.509 certificate that uniquely identifies a person, organization, or business.
		</td></tr>
<tr><td><div id="Eliptic_Curve_group_modulo_a_Prime">Eliptic Curve group modulo a Prime (<abbr class="dyn-abbr"><a href="#abbr_ECP">ECP</a></abbr>)</div></td><td>
			Eliptic Curve Group Modulo a Prime.
		</td></tr>
<tr><td><div id="Encapsulating_Security_Payload">Encapsulating Security Payload (<abbr class="dyn-abbr"><a href="#abbr_ESP">ESP</a></abbr>)</div></td><td>
			The protocol used by <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> to transport encrypted and integrity-protected 
			communications across the network.
		</td></tr>
<tr><td><div id="Extended_Authentication">Extended Authentication (<abbr class="dyn-abbr"><a href="#abbr_XAUTH">XAUTH</a></abbr>)</div></td><td>
			An authentication scheme that supports an additional level of authentication by allowing the IPSec 
			gateway to request extended authentication from remote users.
		</td></tr>
<tr><td><div id="Extended_Sequence_Number">Extended Sequence Number (<abbr class="dyn-abbr"><a href="#abbr_ESN">ESN</a></abbr>)</div></td><td>
			An extension to the standard that allows <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> to use 64-bit sequence numbers.
		</td></tr>
<tr><td><div id="Extensible_Authentication_Protocol">Extensible Authentication Protocol (<abbr class="dyn-abbr"><a href="#abbr_EAP">EAP</a></abbr>)</div></td><td>
			A framework for adding arbitrary authentication methods in a standardized way to any
			protocol. The most common <abbr class="dyn-abbr"><a href="#abbr_EAP">EAP</a></abbr> method used with IKEv2 is <abbr class="dyn-abbr"><a href="#abbr_EAP">EAP</a></abbr>-TLS.
		</td></tr>
<tr><td><div id="Fully_Qualified_Domain_Name">Fully Qualified Domain Name (<abbr class="dyn-abbr"><a href="#abbr_FQDN">FQDN</a></abbr>)</div></td><td>
			A domain name that specifies its exact location in the hierarchy of the Domain Name System (DNS).
		</td></tr>
<tr><td><div id="Internet_Control_Message_Protocol">Internet Control Message Protocol (<abbr class="dyn-abbr"><a href="#abbr_ICMP">ICMP</a></abbr>)</div></td><td>
			A supporting protocol in the Internet Protocol suite. It is used by network devices 
			to send error messages and operational information indicating success or failure when 
			communicating with another IP address. 
		</td></tr>
<tr><td><div id="Internet_Key_Exchange">Internet Key Exchange (<abbr class="dyn-abbr"><a href="#abbr_IKE">IKE</a></abbr>)</div></td><td>
			The protocol used by <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> to set up and manage <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> connections. This includes negotiating
			<abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> connection settings, authenticating endpoints to each other, defining 
			the security parameters of <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr>-protected connections, and negotiating session keys.  
			IKEv2 is the current version.
		</td></tr>
<tr><td><div id="Internet_Protocol_Security">Internet Protocol Security (<abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr>)</div></td><td>
			A suite of open standards for ensuring private communications over public networks.
		</td></tr>
<tr><td><div id="Internet_Security_Association_and_Key_Management_Protocol">Internet Security Association and Key Management Protocol (<abbr class="dyn-abbr"><a href="#abbr_ISAKMP">ISAKMP</a></abbr>)</div></td><td>
			A protocol defined by RFC 2408 for establishing Security association (<abbr class="dyn-abbr"><a href="#abbr_SA">SA</a></abbr>) and cryptographic keys in an
			Internet environment.	  
		</td></tr>
<tr><td><div id="Online_Certificate_Status_Protocol">Online Certificate Status Protocol (<abbr class="dyn-abbr"><a href="#abbr_OCSP">OCSP</a></abbr>)</div></td><td>
			An Internet protocol used for obtaining the revocation status of an X.509 digital certificate.
		</td></tr>
<tr><td><div id="Pre-Shared_Key">Pre-Shared Key (<abbr class="dyn-abbr"><a href="#abbr_PSK">PSK</a></abbr>)</div></td><td>
			A secret that was previously shared between two parties before it needs to be used.
		</td></tr>
<tr><td><div id="Security_Association">Security Association (<abbr class="dyn-abbr"><a href="#abbr_SA">SA</a></abbr>)</div></td><td>
			The establishment of shared security attributes between two network entities to support secure 
			communication.
		</td></tr>
<tr><td><div id="Security_Policy_Database">Security Policy Database (<abbr class="dyn-abbr"><a href="#abbr_SPD">SPD</a></abbr>)</div></td><td>
			A set of rules that determines whether a packet is subject to <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> processing.  
			Each entry in the <abbr class="dyn-abbr"><a href="#abbr_SPD">SPD</a></abbr> represents a policy that defines how the set of traffic covered under
			the policy will be processed.
		</td></tr>
<tr><td><div id="User_Datagram_Protocol">User Datagram Protocol (<abbr class="dyn-abbr"><a href="#abbr_UDP">UDP</a></abbr>)</div></td><td>
			A communications protocol that is primarily used to establish low-latency and loss-tolerating
			connections between applications on the internet. 
		</td></tr>
<tr><td><div id="Virtual_Private_Network">Virtual Private Network (<abbr class="dyn-abbr"><a href="#abbr_VPN">VPN</a></abbr>)</div></td><td>
			An extension of a private network across a public or shared network that allows users to 
			exchange data as though they were connected directly to the private network.
		</td></tr>
</table>
     



    <h2 class="indexable" data-level="2" id="toes">1.3 Compliant Targets of Evaluation</h2>
		The Target of Evaluation (<abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr>) in this Functional Package (<abbr class="dyn-abbr"><a href="#abbr_FP">FP</a></abbr>) is an IT product that includes 
		an implementation of <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr>.  Typically this is a <abbr class="dyn-abbr"><a href="#abbr_VPN">VPN</a></abbr> client or <abbr class="dyn-abbr"><a href="#abbr_VPN">VPN</a></abbr> gateway - for which <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> 
		functionality is fundamental. But the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> could also be an operating system or other
		IT product for which <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> functionality is ancillary. This <abbr class="dyn-abbr"><a href="#abbr_FP">FP</a></abbr> describes the security 
		functionality of <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> in terms of <a href="#bibCC">[CC]</a>. 
		<p></p>
		The contents of this <abbr class="dyn-abbr"><a href="#abbr_FP">FP</a></abbr> must be appropriately incorporated into a <abbr class="dyn-abbr"><a href="#abbr_PP">PP</a></abbr>, <abbr class="dyn-abbr"><a href="#abbr_cPP">cPP</a></abbr>, or <abbr class="dyn-abbr"><a href="#abbr_PP-Module">PP-Module</a></abbr>. When this Package 
		is so incorporated, the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> must include selection-based requirements in accordance with the selections or 
		assignments indicated in the incorporating document.
		<p></p>
		The <abbr class="dyn-abbr"><a href="#abbr_PP">PP</a></abbr>, <abbr class="dyn-abbr"><a href="#abbr_cPP">cPP</a></abbr>, or <abbr class="dyn-abbr"><a href="#abbr_PP-Module">PP-Module</a></abbr> that instantiates this Package must typically include the following components in order
		to satisfy dependencies of this Package. It is the responsibility of the <abbr class="dyn-abbr"><a href="#abbr_PP">PP</a></abbr>, <abbr class="dyn-abbr"><a href="#abbr_cPP">cPP</a></abbr>, or <abbr class="dyn-abbr"><a href="#abbr_PP-Module">PP-Module</a></abbr> author who 
		incorporates this <abbr class="dyn-abbr"><a href="#abbr_FP">FP</a></abbr> to ensure that dependence on these components is satisfied, either by the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> or by 
		assumptions about its Operational Environment.
		<p>An <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> must identify the applicable version of the <abbr class="dyn-abbr"><a href="#abbr_PP">PP</a></abbr>, <abbr class="dyn-abbr"><a href="#abbr_cPP">cPP</a></abbr>, or <abbr class="dyn-abbr"><a href="#abbr_PP-Module">PP-Module</a></abbr> and this
		Functional Package in its conformance claims.</p>
		
		<table><tr class="header"><th>Component</th><th>Explanation</th></tr><tr><td class="componentneeded" id="FCS_CKM.1"><a href="#FCS_CKM.1">FCS_CKM.1</a></td><td>To support key generation for <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr>, the incorporating document must
					include <a href="#FCS_CKM.1">FCS_CKM.1</a> and specify the corresponding algorithms. </td></tr><tr><td class="componentneeded" id="FCS_CKM.2"><a href="#FCS_CKM.2">FCS_CKM.2</a></td><td>To support key establishment for <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr>, the incorporating document must
						include <a href="#FCS_CKM.2">FCS_CKM.2</a> and specify the corresponding algorithms.</td></tr><tr><td class="componentneeded" id="FCS_CKM_EXT.5"><a href="#FCS_CKM_EXT.5">FCS_CKM_EXT.5</a></td><td>To support key derivation for <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr>, the incorporating document may need to include
						<a href="#FCS_CKM_EXT.5">FCS_CKM_EXT.5</a> and specify the corresponding key derivation algorithms.</td></tr><tr><td class="componentneeded" id="FCS_COP.1"><a href="#FCS_COP.1">FCS_COP.1</a></td><td>
					To support the cryptography needed for <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> communications, the incorporating document must include 
					<a href="#FCS_COP.1">FCS_COP.1</a> (iterating as needed) to specify AES with corresponding key sizes and modes, digital
					signature generation and verification function (at least one of RSA or ECDSA), a cryptographic hash
					function, and a keyed-hash message authentication function. In particular, this Package requires that the
					<abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> support AES-GCM-128 and AES-GCM-256 for <abbr class="dyn-abbr"><a href="#abbr_ESP">ESP</a></abbr>, and AES-CBC-128 and AES-CBC-256 for <abbr class="dyn-abbr"><a href="#abbr_IKE">IKE</a></abbr>.					
				</td></tr><tr><td class="componentneeded" id="FCS_RBG_EXT.1"><a href="#FCS_RBG_EXT.1">FCS_RBG_EXT.1</a></td><td>To support random bit generation needed for <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> key generation, the incorporating document must
					include a requirement that specifies the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr>'s ability to invoke or provide 
					random bit generation services, commonly identified as <a href="#FCS_RBG_EXT.1">FCS_RBG_EXT.1</a>.</td></tr><tr><td class="componentneeded" id="FIA_X509_EXT.2"><a href="#FIA_X509_EXT.2">FIA_X509_EXT.2</a></td><td>To support establishment of <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> communications using a public key algorithm that includes X.509, 
					the incorporating document must include <a href="#FIA_X509_EXT.2">FIA_X509_EXT.2</a> to specify the reasons for using X.509 certificates. 
					But is this really a dependency for this package? I don't think so.</td></tr><tr><td class="componentneeded" id="FPT_STM.1"><a href="#FPT_STM.1">FPT_STM.1</a></td><td>To support establishment of IPSec communications using a public key algorithm that includes X.509, 
					the incorporating document must include <a href="#FPT_STM.1">FPT_STM.1</a> or some other requirement that ensures reliable system time.  
					Note however that support for time-based rekey thresholds is selectable and not mandatory.</td></tr></table>
	
	
	
    <h2 class="indexable" data-level="2" id="s-usecases">1.4 Use Cases</h2>
	    Although focused on <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr>, this Package contains requirements for several protocols. If the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> does not implement <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr>, but
	    it does implement one of the other protocols, then this Package can be used to integrate requirements for the other protocols
	    into the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr>.
		<dl><dt id="uc-ipsec-endpoint"> [USE CASE 1] IPsec Endpoint</dt><dd>
					This is the default use case for this package. The mandatory requirement is <a href="#FCS_IPSEC_EXT.1">FCS_IPSEC_EXT.1</a> and all
					other SFRs are claimed depending on selections made within this requirement.
				<p>
            For changes to included SFRs, selections, and assignments required for this use case, see <a href="#appendix-uc-ipsec-endpoint" class="dynref">C.1 IPsec Endpoint</a>.
          </p></dd><dt id="uc-EAP"> [USE CASE 2] EAP</dt><dd>
					This use case adds physical protections to the base requirements for server-class hardware.
					Additional physical protections are required because the platform us assumed to be minimally 
					protected by the by the operational environment. This use case can also be invoked for servers in 
					data centers where there are enhanced security requirements.<p></p>
					This use case adds requirements for audit, physical protections, and Administrator 
					authentication to the base mandatory SFRs. 
					It removes the assumption that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> is physically protected by the <abbr class="dyn-abbr"><a href="#abbr_OE">OE</a></abbr>.
				<p>
            For changes to included SFRs, selections, and assignments required for this use case, see <a href="#appendix-uc-EAP" class="dynref">C.2 EAP</a>.
          </p></dd><dt id="uc-pre-shared-keys"> [USE CASE 3] Pre-Shared Keys</dt><dd>
					This use case defines the base requirements for portable clients. <p></p>
					This use case adds no requirements to the base mandatory SFRs.
				<p>
            For changes to included SFRs, selections, and assignments required for this use case, see <a href="#appendix-uc-pre-shared-keys" class="dynref">C.3 Pre-Shared Keys</a>.
          </p></dd></dl>

    
	
	
	
<h1 class="indexable" data-level="1" id="Conformance_Claims">2 Conformance Claims</h1><dl><dt>Conformance Statement</dt><dd>
          An <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> must claim exact conformance to this Package, 
              as defined in the <abbr class="dyn-abbr"><a href="#abbr_CC">CC</a></abbr> and <abbr class="dyn-abbr"><a href="#abbr_CEM">CEM</a></abbr> addenda for Exact Conformance, Selection-Based SFRs, and 
              Optional SFRs (dated May 2017).
        </dd><dt>CC Conformance Claims</dt><dd>This Package is conformant to Parts 2 (extended) and 3 (conformant) of Common Criteria Version 3.1, Revision 5.</dd><dt>PP Claim </dt><dd>This Package does not claim conformance to any Protection Profile. </dd><dt>Package Claim</dt><dd>This Package  does not claim conformance to any packages.</dd></dl>
      

	  
<h1 class="indexable" data-level="1" id="Security_Functional_Requirements">3 Security Functional Requirements</h1>
      This chapter describes the security requirements which have to be fulfilled by the product under evaluation.
      Those requirements comprise functional components from Part 2 of <a href="#bibCC">[CC]</a>.
 
       
    The following conventions are used for the completion of operations:
     <ul>
       <li>
         <b>Refinement</b> operation (denoted by <b>bold text</b> or <strike>strikethrough
         text</strike>): is used to add details to a requirement (including replacing an assignment
         with a more restrictive selection) or to remove part of the requirement that is made irrelevant
         through the completion of another operation, and thus further restricts a requirement.
         </li>
       <li>
         <b>Selection</b> (denoted by <i>italicized text</i>): is used to select one or more options
         provided by the [<abbr class="dyn-abbr"><a href="#abbr_CC">CC</a></abbr>] in stating a requirement.</li>
       <li>
         <b>Assignment</b> operation (denoted by <span class="assignable-content">italicized text</span>): is used to assign a
         specific value to an unspecified parameter, such as the length of a password. Showing the
         value in square brackets indicates assignment.</li>
       <li>
         <b>Iteration</b> operation: is indicated by appending the <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> name with a slash and unique identifier
            suggesting the purpose of the operation, e.g. "/EXAMPLE1."
       </li>
     </ul>
   

	
	<h2 class="indexable" data-level="2" id="ss-audit-table">3.1 Auditable Events for Mandatory SFRs</h2>
		<p>
			The auditable events specified in this Package are included in a Security Target 
			if the incorporating <abbr class="dyn-abbr"><a href="#abbr_PP">PP</a></abbr>, <abbr class="dyn-abbr"><a href="#abbr_cPP">cPP</a></abbr>, or <abbr class="dyn-abbr"><a href="#abbr_PP-Module">PP-Module</a></abbr> supports audit event reporting through FAU_GEN.1
			and all other criteria in the incorporating document are met.
		</p>
		<table class="" border="1"><caption><span class="ctr" data-myid="t-audit-mandatory" data-counter-type="ct-Table" id="t-audit-mandatory">Table <span class="counter">1</span></span>: Auditable Events for Mandatory Requirements</caption><tr><th>Requirement</th><th>Auditable Events</th><th>Additional Audit Record Contents</th></tr><tr><td><a href="#FCS_IPSEC_EXT.1">FCS_IPSEC_EXT.1</a></td><td>Decisions to DISCARD or BYPASS network packets processed by the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr>.</td><td>Presumed identity of source subject.<br/>The entry in the <abbr class="dyn-abbr"><a href="#abbr_SPD">SPD</a></abbr> that applied to the decision.<br/></td></tr><tr><td><a href="#FCS_IPSEC_EXT.1">FCS_IPSEC_EXT.1</a></td><td>Failure to establish an <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> <abbr class="dyn-abbr"><a href="#abbr_SA">SA</a></abbr>.</td><td>Identity of destination subject.<br/>Reason for failure.<br/></td></tr><tr><td><a href="#FCS_IPSEC_EXT.1">FCS_IPSEC_EXT.1</a></td><td>Establishment/Termination of an <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> <abbr class="dyn-abbr"><a href="#abbr_SA">SA</a></abbr>.</td><td>Identity of destination subject.<br/>Transport layer protocol, if applicable.<br/>Source subject service identifier, if applicable.<br/>Non-TOE endpoint of connection (IP address) for both successes and failures.<br/></td></tr></table>
	
	  
	
	
	
	<h2 id="cryptsup" class="indexable" data-level="2">3.2 Cryptographic Support (FCS)</h2>
	
	    
        	
	
	    	
        <div class="comp" id="FCS_IPSEC_EXT.1"><h4>FCS_IPSEC_EXT.1 IPsec</h4>

			
			<div class="element"><div class="reqid" id="FCS_IPSEC_EXT.1.1"><a href="#FCS_IPSEC_EXT.1.1" class="abbr">FCS_IPSEC_EXT.1.1</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall implement <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> as specified in <a href="#bibRFC4301">[RFC 4301]</a>.<div class="appnote"><span class="note-header">Application Note: </span><span class="note">




					<a href="#bibRFC4301">[RFC 4301]</a> calls for an <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> implementation to protect IP traffic through the use
					of a Security Policy Database (<abbr class="dyn-abbr"><a href="#abbr_SPD">SPD</a></abbr>). The <abbr class="dyn-abbr"><a href="#abbr_SPD">SPD</a></abbr> is used to define how IP packets are
					to be handled: PROTECT the packet (e.g., encrypt the packet), BYPASS the <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr>
					services (e.g., no encryption), or DISCARD the packet (e.g., drop the packet). The
					<abbr class="dyn-abbr"><a href="#abbr_SPD">SPD</a></abbr> can be implemented in various ways, including router access control lists,
					firewall rulesets, a "traditional" <abbr class="dyn-abbr"><a href="#abbr_SPD">SPD</a></abbr>, etc. Regardless of the implementation
					details, there is a notion of a "rule" that a packet is "matched" against and a
					resulting action that takes place.<p></p>

					While there must be a means to order the rules, a general approach to ordering
					is not mandated, as long as the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> can distinguish the IP packets and apply the
					rules accordingly. There may be multiple SPDs (one for each network interface)
					but this is not required.<p></p>

					It is permissible for the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to receive configuration of the <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> behavior from an environmental
					source. For example, The <abbr class="dyn-abbr"><a href="#abbr_SPD">SPD</a></abbr> is established and populated through an administrative interface or
					application implemented by the entity that establishes the <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> connection, such as a <abbr class="dyn-abbr"><a href="#abbr_VPN">VPN</a></abbr> gateway 
					or client application. This interface or application is outside the scope of this <abbr class="dyn-abbr"><a href="#abbr_FP">FP</a></abbr>.<p></p>


					
				</span></div></div></div>
			
			
			<div class="element"><div class="reqid" id="FCS_IPSEC_EXT.1.2"><a href="#FCS_IPSEC_EXT.1.2" class="abbr">FCS_IPSEC_EXT.1.2</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall implement <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> in
					[<b>selection</b>: <i id="_s_12">tunnel mode</i>, <i id="_s_13">transport mode</i>].
				<div class="appnote"><span class="note-header">Application Note: </span><span class="note">
					If the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> is used to connect to a <abbr class="dyn-abbr"><a href="#abbr_VPN">VPN</a></abbr> gateway for the purposes of establishing a
					secure connection to a private network, the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author is expected to select
					tunnel mode. If the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> uses <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> to establish an end-to-end connection to
					another <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> endpoint, the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author is expected to select transport mode. If
					the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> uses <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> to establish a connection to a specific endpoint device for the
					purpose of secure remote administration, the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author is expected to select
					transport mode.
				</span></div></div></div>
			
			
			<div class="element"><div class="reqid" id="FCS_IPSEC_EXT.1.3"><a href="#FCS_IPSEC_EXT.1.3" class="abbr">FCS_IPSEC_EXT.1.3</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall have a nominal, final entry in the <abbr class="dyn-abbr"><a href="#abbr_SPD">SPD</a></abbr> that matches anything that
					is otherwise unmatched, and discards it.
				</div></div>
			
			
			<div class="element"><div class="reqid" id="FCS_IPSEC_EXT.1.4"><a href="#FCS_IPSEC_EXT.1.4" class="abbr">FCS_IPSEC_EXT.1.4</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall implement the <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> protocol <abbr class="dyn-abbr"><a href="#abbr_ESP">ESP</a></abbr> as defined by <a href="#bibRFC4303">[RFC 4303]</a> using the cryptographic 
					algorithms [<i>AES-GCM-128 as specified in <a href="#bibRFC4106">[RFC 4106]</a>,
									AES-GCM-256 as specified in <a href="#bibRFC4106">[RFC 4106]</a>,</i>
					[<b>selection</b>: <ul><li style=""><i id="sel-ipsec-esp-cbc-128">AES-CBC-128 with 
							[<b>selection</b>: <i id="_s_15">HMAC-SHA-1</i>, <i id="_s_16">HMAC-SHA-256</i>, <i id="_s_17">HMAC-SHA-384</i>, <i id="_s_18">HMAC-SHA-512</i>] as specified in <a href="#bibRFC3602">[RFC 3602]</a></i>, </li><li style=""><i id="sel-ipsec-esp-cbc-256">AES-CBC-256 with
							[<b>selection</b>: <i id="_s_20">HMAC-SHA-1</i>, <i id="_s_21">HMAC-SHA-256</i>, <i id="_s_22">HMAC-SHA-384</i>, <i id="_s_23">HMAC-SHA-512</i>] as specified in <a href="#bibRFC3602">[RFC 3602]</a></i>, </li><li style=""><i id="_s_24">no other algorithms</i></li></ul>]].
				<div class="appnote"><span class="note-header">Application Note: </span><span class="note">
					If this functionality is configurable, the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> may be configured by a <abbr class="dyn-abbr"><a href="#abbr_VPN">VPN</a></abbr> gateway
					or by an Administrator of the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> itself.
				</span></div></div></div>
			
			
			<div class="element"><div class="reqid" id="FCS_IPSEC_EXT.1.5"><a href="#FCS_IPSEC_EXT.1.5" class="abbr">FCS_IPSEC_EXT.1.5</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall implement the protocol:
					[<b>selection</b>: <ul><li style=""><i id="sel-ipsec-5-ikev1">IKEv1, using Main Mode for Phase I exchanges, as defined in <a href="#bibRFC2407">[RFC 2407]</a>, 
							<a href="#bibRFC2408">[RFC 2408]</a>, <a href="#bibRFC2409">[RFC 2409]</a>, <a href="#bibRFC4109">[RFC 4109]</a>, 
							[<b>selection</b>: <i id="_s_26"><a href="#bibRFC4304">[RFC 4304]</a> for extended sequence numbers</i>, <i id="_s_27">no other RFCs for extended sequence numbers</i>], 
							[<b>selection</b>: <i id="_s_28"><a href="#bibRFC4868">[RFC 4868]</a> for hash functions</i>, <i id="_s_29">no other RFCs for hash functions</i>], and 
							[<b>selection</b><b>, choose one of</b>: <i id="_s_30">support for <abbr class="dyn-abbr"><a href="#abbr_XAUTH">XAUTH</a></abbr></i>, <i id="_s_31">no support for <abbr class="dyn-abbr"><a href="#abbr_XAUTH">XAUTH</a></abbr></i>]</i>, </li><li style=""><i id="sel-ipsec-5-ikev2">IKEv2 as defined in <a href="#bibRFC7296">[RFC 7296]</a> (with mandatory support for NAT traversal 
							as specified in section 2.23), <a href="#bibRFC8784">[RFC 8784]</a>, <a href="#bibRFC8247">[RFC 8247]</a>, and 
							[<b>selection</b>: <i id="_s_33"><a href="#bibRFC4868">[RFC 4868]</a> for hash functions</i>, <i id="_s_34">no other RFCs for hash functions</i>]
						</i></li></ul>].
				</div></div>
			
			
			<div class="element"><div class="reqid" id="FCS_IPSEC_EXT.1.6"><a href="#FCS_IPSEC_EXT.1.6" class="abbr">FCS_IPSEC_EXT.1.6</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall ensure the encrypted payload in the 
					[<b>selection</b>: <i id="sel-ipsec-6-ikev1">IKEv1</i>, <i id="sel-ipsec-6-ikev2">IKEv2</i>] 
					protocol uses the cryptographic algorithms [<i>AES-CBC-128, AES-CBC-256 as specified in 
					<a href="#bibRFC6379">[RFC 6379]</a> and </i>
					[<b>selection</b>: <i id="sel-ipsec-ike-gcm-128">AES-GCM-128 as specified in <a href="#bibRFC5282">[RFC 5282]</a></i>, <i id="sel-ipsec-ike-gcm-256">AES-GCM-256 as specified in <a href="#bibRFC5282">[RFC 5282]</a></i>, <i id="_s_39">no other algorithm</i>].
				<div class="appnote"><span class="note-header">Application Note: </span><span class="note">
					If this functionality is configurable, the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> may be configured by a <abbr class="dyn-abbr"><a href="#abbr_VPN">VPN</a></abbr> gateway
					or by an Administrator of the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> itself.
				</span></div></div></div>
			
			
			<div class="element"><div class="reqid" id="FCS_IPSEC_EXT.1.7"><a href="#FCS_IPSEC_EXT.1.7" class="abbr">FCS_IPSEC_EXT.1.7</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall ensure that 
					[<b>selection</b>: <ul><li style=""><i id="sel-ipsec-ikev2-sa-config">IKEv2 <abbr class="dyn-abbr"><a href="#abbr_SA">SA</a></abbr> lifetimes can be configured by 
							[<b>selection</b>: <i id="_s_41">an Administrator</i>, <i id="_s_42">a <abbr class="dyn-abbr"><a href="#abbr_VPN">VPN</a></abbr> gateway</i>] 
							based on 
							[<b>selection</b>: <i id="_s_43">number of packets/number of bytes</i>, <i id="_s_44">length of time</i>]
						</i>, </li><li style=""><i id="sel-ipsec-ikev1-sa-config">IKEv1 <abbr class="dyn-abbr"><a href="#abbr_SA">SA</a></abbr> lifetimes can be configured by 
							[<b>selection</b>: <i id="_s_46">an Administrator</i>, <i id="_s_47">a <abbr class="dyn-abbr"><a href="#abbr_VPN">VPN</a></abbr> gateway</i>] 
							based on 
							[<b>selection</b>: <i id="_s_48">number of packets/number of bytes</i>, <i id="_s_49">length of time</i>]
						</i>, </li><li style=""><i id="sel-ipsec-ikev1-sa-fixed">IKEv1 <abbr class="dyn-abbr"><a href="#abbr_SA">SA</a></abbr> lifetimes are fixed based on 
							[<b>selection</b>: <i id="_s_51">number of packets/number of bytes</i>, <i id="_s_52">length of time</i>]
						</i></li></ul>], and that if length of time is used, it shall include at least one option that
					is 24 hours or less for Phase 1 SAs and 8 hours or less for Phase 2 SAs.
				<div class="appnote"><span class="note-header">Application Note: </span><span class="note">
					The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author is afforded a selection based on the version of <abbr class="dyn-abbr"><a href="#abbr_IKE">IKE</a></abbr> in their
					implementation. There is a further selection within this selection that allows the
					<abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author to specify which entity is responsible for configuring the life of the
					<abbr class="dyn-abbr"><a href="#abbr_SA">SA</a></abbr>. An implementation that allows an administrator to configure the <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> endpoint or a
					<abbr class="dyn-abbr"><a href="#abbr_VPN">VPN</a></abbr> gateway that pushes the <abbr class="dyn-abbr"><a href="#abbr_SA">SA</a></abbr> lifetime down to the <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> endpoint are both acceptable.<p></p>
					As far as <abbr class="dyn-abbr"><a href="#abbr_SA">SA</a></abbr> lifetimes are concerned, the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> can limit the lifetime based on the
					number of bytes transmitted, or the number of packets transmitted. Either
					packet-based or volume-based <abbr class="dyn-abbr"><a href="#abbr_SA">SA</a></abbr> lifetimes are acceptable; the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author makes
					the appropriate selection to indicate which type of lifetime limits are supported.<p></p>
					The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author chooses either the IKEv1 requirements or IKEv2 requirements (or
					both, depending on the selection in <a href="#FCS_IPSEC_EXT.1.5">FCS_IPSEC_EXT.1.5</a>. The IKEv1 requirement
					can be accomplished either by providing Authorized Administrator-configurable
					lifetimes (with appropriate instructions in documents mandated by AGD_OPE),
					or by hard coding the limits in the implementation. For IKEv2, there are no
					hard-coded limits, but in this case it is required that an administrator be able to
					configure the values. In general, instructions for setting the parameters of the
					implementation, including lifetime of the SAs, should be included in the 
					operational guidance generated for AGD_OPE. It is appropriate to refine the
					requirement in terms of number of MB/KB instead of number of packets, as long
					as the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> is capable of setting a limit on the amount of traffic that is protected
					by the same key (the total volume of all <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> traffic protected by that key).
				</span></div></div></div>
			
			
			<div class="element"><div class="reqid" id="FCS_IPSEC_EXT.1.8"><a href="#FCS_IPSEC_EXT.1.8" class="abbr">FCS_IPSEC_EXT.1.8</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall ensure that all <abbr class="dyn-abbr"><a href="#abbr_IKE">IKE</a></abbr> protocols implement DH Groups [
					<i>19 (256-bit Random <abbr class="dyn-abbr"><a href="#abbr_ECP">ECP</a></abbr>), 20 (384-bit Random <abbr class="dyn-abbr"><a href="#abbr_ECP">ECP</a></abbr>), and </i>
					[<b>selection</b>: <i id="_s_53">24 (2048-bit MODP with 256-bit POS)</i>, <i id="_s_54">15 (3072-bit MODP)</i>, <i id="_s_55">14 (2048-bit MODP)</i>, <i id="_s_56">no other DH groups</i>]].
				<div class="appnote"><span class="note-header">Application Note: </span><span class="note">
					The selection is used to specify additional DH groups supported. This applies to
					IKEv1 and IKEv2 exchanges. It should be noted that if any additional DH groups
					are specified, they must comply with the requirements (in terms of the
					ephemeral keys that are established) listed in <span class="no-link">FCS_CKM.1</span>.<p></p>
					Since the implementation may allow different Diffie-Hellman groups to be
					negotiated for use in forming the SAs, the assignments in <a href="#FCS_IPSEC_EXT.1.9">FCS_IPSEC_EXT.1.9</a>
					and <a href="#FCS_IPSEC_EXT.1.10">FCS_IPSEC_EXT.1.10</a> may contain multiple values. For each DH group
					supported, the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author consults Table 2 in 800-57 to determine the bits of
					security associated with the DH group. Each unique value is then used to fill in
					the assignment (for 1.9 they are doubled; for 1.10 they are inserted directly into
					the assignment). For example, suppose the implementation supports DH group
					14 (2048-bit MODP) and group 20 (ECDH using NIST curve P-384). From Table 2,
					the bits of security value for group 14 is 112, and for group 20 it is 192. For
					<a href="#FCS_IPSEC_EXT.1.9">FCS_IPSEC_EXT.1.9</a>, then, the assignment would read [224, 384] and for
					<a href="#FCS_IPSEC_EXT.1.10">FCS_IPSEC_EXT.1.10</a> it would read [112, 192] (although in this case the
					requirement should probably be refined so that it makes sense mathematically).
				</span></div></div></div>
			
			
			<div class="element"><div class="reqid" id="FCS_IPSEC_EXT.1.9"><a href="#FCS_IPSEC_EXT.1.9" class="abbr">FCS_IPSEC_EXT.1.9</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall generate the secret value x used in the
					<abbr class="dyn-abbr"><a href="#abbr_IKE">IKE</a></abbr> Diffie-Hellman key exchange (x in g^x mod p) using the random bit
					generator specified in <a href="#FCS_RBG_EXT.1">FCS_RBG_EXT.1</a>, and having a length of at least
					[<b>assignment</b>: 
     <span class="assignable-content">(one or more) number(s) of bits that is at least twice the bits of
					security value associated with the negotiated Diffie-Hellman group as listed in
					Table 2 of NIST SP 800-57, Recommendation for Key Management: Part 1 - General</span>] bits.

				</div></div>
			
			
			<div class="element"><div class="reqid" id="FCS_IPSEC_EXT.1.10"><a href="#FCS_IPSEC_EXT.1.10" class="abbr">FCS_IPSEC_EXT.1.10</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall generate nonces used in <abbr class="dyn-abbr"><a href="#abbr_IKE">IKE</a></abbr> exchanges in a manner such that the
					probability that a specific nonce value will be repeated during the life a specific
					<abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> <abbr class="dyn-abbr"><a href="#abbr_SA">SA</a></abbr> is less than 1 in 2^[<b>assignment</b>: 
     <span class="assignable-content">(one or more) bits of security value(s)
					associated with the negotiated Diffie-Hellman group as listed in Table 2 of 
					NIST SP 800-57, Recommendation for Key Management: Part 1 - General</span>].

				</div></div>
          
			
			<div class="element"><div class="reqid" id="FCS_IPSEC_EXT.1.11"><a href="#FCS_IPSEC_EXT.1.11" class="abbr">FCS_IPSEC_EXT.1.11</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall ensure that all <abbr class="dyn-abbr"><a href="#abbr_IKE">IKE</a></abbr> protocols perform peer authentication using  
					[<b>selection</b>: <i id="_s_57">RSA</i>, <i id="_s_58">ECDSA</i>] 
					that use X.509v3 certificates that conform to <a href="#bibRFC4945">[RFC 4945]</a> and 
					[<b>selection</b>: <i id="sel-ipsec-psk-eap-tls">Pre-shared Keys transmitted via <abbr class="dyn-abbr"><a href="#abbr_EAP">EAP</a></abbr>-TLS</i>, <i id="sel-ipsec-psk-eap-ttls">Pre-shared Keys transmitted via <abbr class="dyn-abbr"><a href="#abbr_EAP">EAP</a></abbr>-TTLS with mutual authentication</i>, <i id="sel-ipsec-psk">Pre-shared Keys not transmitted via <abbr class="dyn-abbr"><a href="#abbr_EAP">EAP</a></abbr></i>, <i id="_s_62">no other method</i>].
				<div class="appnote"><span class="note-header">Application Note: </span><span class="note">
					At least one public-key-based Peer Authentication method is required in order to
					conform to this <abbr class="dyn-abbr"><a href="#abbr_PP-Module">PP-Module</a></abbr>; one or more of the public key schemes is chosen by
					the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author to reflect what is implemented. The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author also ensures that
					appropriate FCS requirements reflecting the algorithms used (and key
					generation capabilities, if provided) are listed to support those methods. Note
					that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> will elaborate on the way in which these algorithms are to be used 
					(for example, RFC 2409 specifies three authentication methods using public keys;
					each one supported will be described in the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr>).<p></p>

					If any selection with pre-shared keys is selected, the selection-based requirement <a href="#FIA_PSK_EXT.1">FIA_PSK_EXT.1</a>
					must be claimed. <a href="#FIA_PSK_EXT.1">FIA_PSK_EXT.1</a> includes the options for MFA solutions, it may be brought in via this selection or via the 
					optional FPF_MFA_EXT.1 requirement.<p></p> 
					When pre-shared keys are supported for <abbr class="dyn-abbr"><a href="#abbr_IKE">IKE</a></abbr> v2, Pre-shared Keys transmitted via <abbr class="dyn-abbr"><a href="#abbr_EAP">EAP</a></abbr>-TLS and/or 
					Pre-shared Keys transmitted via <abbr class="dyn-abbr"><a href="#abbr_EAP">EAP</a></abbr>-TTLS is selected to indicate client verification using certificates 
					in a mutually authenticated TLS handshake, and verification of provided <abbr class="dyn-abbr"><a href="#abbr_PSK">PSK</a></abbr> protected under the TLS channel. 
					When Pre-shared Keys are supported for <abbr class="dyn-abbr"><a href="#abbr_IKE">IKE</a></abbr> v1, the first selection is claimed to indicate one of the mechanisms 
					for using <abbr class="dyn-abbr"><a href="#abbr_PSK">PSK</a></abbr> described in the RFC. <p></p>
					It is acceptable for different use cases to leverage different selections, if this is the case it shall be identified.
				</span></div></div></div>
			
			
			<div class="element"><div class="reqid" id="FCS_IPSEC_EXT.1.12"><a href="#FCS_IPSEC_EXT.1.12" class="abbr">FCS_IPSEC_EXT.1.12</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall not establish an <abbr class="dyn-abbr"><a href="#abbr_SA">SA</a></abbr> if the [
					[<b>selection</b>: <i id="_s_63">IP address</i>, <i id="_s_64">Fully Qualified Domain Name (<abbr class="dyn-abbr"><a href="#abbr_FQDN">FQDN</a></abbr>)</i>, <i id="_s_65">user <abbr class="dyn-abbr"><a href="#abbr_FQDN">FQDN</a></abbr></i>, <i id="_s_66">Distinguished Name (<abbr class="dyn-abbr"><a href="#abbr_DN">DN</a></abbr>)</i>] 
					and 
					[<b>selection</b>: <i id="_s_67">no other reference identifier type</i>, <i id="_s_68">[<b>assignment</b>: 
     <span class="assignable-content">other supported reference identifier types</span>]</i>]] contained in a certificate does not match the expected value(s) for the
					entity attempting to establish a connection.
				<div class="appnote"><span class="note-header">Application Note: </span><span class="note">
					The <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> must support at least one of the following identifier types: IP address,
					Fully Qualified Domain Name (<abbr class="dyn-abbr"><a href="#abbr_FQDN">FQDN</a></abbr>), user <abbr class="dyn-abbr"><a href="#abbr_FQDN">FQDN</a></abbr>, or Distinguished Name (<abbr class="dyn-abbr"><a href="#abbr_DN">DN</a></abbr>).
					In the future, the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> will be required to support all of these identifier types. The
					<abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> is expected to support as many IP address formats (IPv4 and IPv6) as IP
					versions supported by the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> in general. The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author may assign additional
					supported identifier types in the second selection.
				</span></div></div></div>
			
			
			<div class="element"><div class="reqid" id="FCS_IPSEC_EXT.1.13"><a href="#FCS_IPSEC_EXT.1.13" class="abbr">FCS_IPSEC_EXT.1.13</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall not establish an <abbr class="dyn-abbr"><a href="#abbr_SA">SA</a></abbr> if the presented identifier does not match the
					configured reference identifier of the peer.
				<div class="appnote"><span class="note-header">Application Note: </span><span class="note">
					At this time, only the comparison between the presented identifier in the peers
					certificate and the peers reference identifier is mandated by the testing below.
					However, in the future, this requirement will address two aspects of the peer
					certificate validation: 1) comparison of the peers ID payload to the peers
					certificate which are both presented identifiers, as required by RFC 4945 and 2)
					verification that the peer identified by the ID payload and the certificate is the
					peer expected by the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> (per the reference identifier). At that time, the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> will
					be required to demonstrate both aspects (i.e. that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> enforces that the
					peers ID payload matches the peers certificate which both match configured
					peer reference identifiers).<p></p>
					Excluding the <abbr class="dyn-abbr"><a href="#abbr_DN">DN</a></abbr> identifier type (which is necessarily the Subject <abbr class="dyn-abbr"><a href="#abbr_DN">DN</a></abbr> in the peer
					certificate), the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> may support the identifier in either the Common Name or
					Subject Alternative Name (SAN) or both. If both are supported, the preferred
					logic is to compare the reference identifier to a presented SAN, and only if the
					peers certificate does not contain a SAN, to fall back to a comparison against
					the Common Name. In the future, the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> will be required to compare the
					reference identifier to the presented identifier in the SAN only, ignoring the
					Common Name.<p></p>

					The configuration of the peer reference identifier is addressed by
					FMT_SMF.1.1/<abbr class="dyn-abbr"><a href="#abbr_VPN">VPN</a></abbr>.
				</span></div></div></div>
			
			
			<div class="element"><div class="reqid" id="FCS_IPSEC_EXT.1.14"><a href="#FCS_IPSEC_EXT.1.14" class="abbr">FCS_IPSEC_EXT.1.14</a></div><div class="reqdesc">The 
					[<b>selection</b>: <i id="_s_69"><abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr></i>, <i id="_s_70"><abbr class="dyn-abbr"><a href="#abbr_VPN">VPN</a></abbr> gateway</i>] shall be able to ensure by default that the strength of the symmetric algorithm 
					(in terms of the number of bits in the key) negotiated to protect the 
					[<b>selection</b>: <i id="_s_71">IKEv1 Phase 1</i>, <i id="_s_72">IKEv2 IKE_SA</i>] 
					connection is greater than or equal to the strength of the symmetric algorithm
					(in terms of the number of bits in the key) negotiated to protect the 
					[<b>selection</b>: <i id="_s_73">IKEv1 Phase 2</i>, <i id="_s_74">IKEv2 CHILD_SA</i>] connection.
				<div class="appnote"><span class="note-header">Application Note: </span><span class="note">
					If this functionality is configurable, the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> may be configured by a <abbr class="dyn-abbr"><a href="#abbr_VPN">VPN</a></abbr> gateway
					or by an Administrator of the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> itself<p></p>
					The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author chooses either or both of the <abbr class="dyn-abbr"><a href="#abbr_IKE">IKE</a></abbr> selections based on what is
					implemented by the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr>. Obviously, the <abbr class="dyn-abbr"><a href="#abbr_IKE">IKE</a></abbr> versions chosen should be
					consistent not only in this element, but with other choices for other elements in
					this component. While it is acceptable for this capability to be configurable, the
					default configuration in the evaluated configuration (either "out of the box" or
					by configuration guidance in the AGD documentation) must enable this
					functionality.<p></p>
				</span></div></div></div>
			
			
			
			
        <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"><a href="#FCS_IPSEC_EXT.1">FCS_IPSEC_EXT.1</a></div>
					
					
					
				<div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div>

						If the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> boundary includes a general-purpose operating system or mobile device, the evaluator
						shall examine the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> to ensure that it describes whether the <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> functionality is 
						architecturally integrated with the platform itself or whether it is a separate executable that 
						is bundled with the platform.<p></p>
					<div class="eacategory">Guidance</div>

						The evaluator shall ensure that the operational guidance contains any appropriate information for ensuring
						that the <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> implementation can be properly configured.<p></p>
						
						Note in this case that the implementation of the <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> protocol must be enforced entirely within the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr>
						boundary; i.e. it is not permissible for a software application <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> to be a graphical front-end for <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr>
						functionality implemented totally or in part by the underlying OS platform. The behavior referenced here
						is for the possibility that the configuration of the <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> connection is initiated from outside the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr>, which
						is permissible so long as the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> is solely responsible for enforcing the configured behavior. However, it is
						allowable for the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to rely on low-level platform-provided networking functions to implement the <abbr class="dyn-abbr"><a href="#abbr_SPD">SPD</a></abbr>
						from the client (e.g., enforcement of packet routing decisions).<p></p>
					<div class="eacategory">Tests</div>
						As a prerequisite for performing the Test EAs for the individual <a href="#FCS_IPSEC_EXT.1">FCS_IPSEC_EXT.1</a> elements below, the
						evaluator must do the following:<p></p>
						The evaluator must create a test environment consisting of at least the components illustrated
						below. It is expected that the traffic generator will be used to construct network packets and will provide the
						evaluator with the ability manipulate fields in the <abbr class="dyn-abbr"><a href="#abbr_ICMP">ICMP</a></abbr>, IPv4, IPv6, <abbr class="dyn-abbr"><a href="#abbr_UDP">UDP</a></abbr>, and TCP packet headers. The
						evaluator shall provide justification for any differences in the test environment.<p></p>
						<div class="figure" id="figure-fig-testenv"><img id="fig-testenv" src="images/network.png" width="" height=""></img><br/><span class="ctr" data-myid="fig-testenv" data-counter-type="ct-figure">Figure <span class="counter">1</span></span>:
      Test Environment</div>
						Note that the evaluator shall perform all tests using the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> and a representative sample of
						platforms listed in the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> (for TOEs that claim to support multiple platforms).<p></p>
					<div class="element-activity-header"><a href="#FCS_IPSEC_EXT.1.1">FCS_IPSEC_EXT.1.1</a></div> 
					<div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div>
						The evaluator shall examine the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> and determine that it describes how the <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> functionality is
						implemented.<p></p>
						 The evaluator shall ensure that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> identifies any
						platform functionality the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> relies upon to support its <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> implementation, if any (e.g. does it invoke
						cryptographic primitive functions from the platforms cryptographic library, enforcement of packet
						routing decisions by low-level network drivers).<p></p>
		    
						In all cases, the evaluator shall also ensure that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes how the <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> implementation  interacts with the network
						stack of the platform(s) on which it can run (e.g., does the client insert itself within the stack via kernel
						mods, does the <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> implementation simply invoke APIs to gain access to network services).<p></p>		   
						The evaluator shall ensure that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes how the <abbr class="dyn-abbr"><a href="#abbr_SPD">SPD</a></abbr> is implemented and the rules for processing
						both inbound and outbound packets in terms of the <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> policy. The <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes the rules that are
						available and the resulting actions available after matching a rule. The <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes how the available
						rules and actions form the <abbr class="dyn-abbr"><a href="#abbr_SPD">SPD</a></abbr> using terms defined in RFC 4301 such as BYPASS (e.g., no encryption),
						DISCARD (e.g., drop the packet), and PROTECT (e.g., encrypt the packet) actions defined in RFC 4301.			  
						As noted in section 4.4.1 of RFC 4301, the processing of entries in the <abbr class="dyn-abbr"><a href="#abbr_SPD">SPD</a></abbr> is non-trivial and the evaluator
						shall determine that the description in the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> is sufficient to determine which rules will be applied given
						the rule structure implemented by the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr>. For example, if the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> allows specification of ranges,
						conditional rules, etc., the evaluator shall determine that the description of rule processing (for both
						inbound and outbound packets) is sufficient to determine the action that will be applied, especially in the
						case where two different rules may apply. This description shall cover both the initial packets (that is, no
						<abbr class="dyn-abbr"><a href="#abbr_SA">SA</a></abbr> is established on the interface or for that particular packet) as well as packets that are part of an
						established <abbr class="dyn-abbr"><a href="#abbr_SA">SA</a></abbr>. <br/>
					<br/>    
					<div class="eacategory">Guidance</div>
						The evaluator shall examine the operational guidance to verify that it describes how the <abbr class="dyn-abbr"><a href="#abbr_SPD">SPD</a></abbr> is created and
						configured. If there is an administrative interface to the <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> implementation , then the guidance describes how the
						administrator specifies rules for processing a packet. The description includes all three cases - a rule that
						ensures packets are encrypted/decrypted, dropped, and allowing a packet to flow in plaintext. The
						evaluator shall determine that the description in the operational guidance is consistent with the
						description in the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr>, and that the level of detail in the operational guidance is sufficient to allow the
						administrator to set up the <abbr class="dyn-abbr"><a href="#abbr_SPD">SPD</a></abbr> in an unambiguous fashion. This includes a discussion of how ordering of
						rules impacts the processing of an IP packet.<p></p>
						If the <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> implementation is configured by an external application, such as the <abbr class="dyn-abbr"><a href="#abbr_VPN">VPN</a></abbr> gateway, then the operational
						guidance should indicate this and provide a description of how <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr>  is configured by the external
						application. The description should contain information as to how the <abbr class="dyn-abbr"><a href="#abbr_SPD">SPD</a></abbr> is established and set up in an
						unambiguous fashion. The description should also include what is configurable via the external
						application, how ordering of entries may be expressed, as well as the impacts that ordering of entries may
						have on the packet processing.<p></p>
						In either case, the evaluator ensures the description provided In the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> is consistent with the capabilities
						and description provided in the operational guidance.<br/>
					<br/>
					<div class="eacategory">Tests</div>
						Depending on the implementation, the evaluator may be required to use a <abbr class="dyn-abbr"><a href="#abbr_VPN">VPN</a></abbr> gateway or some form of
						application to configure the client. For Test 2, the evaluator is required to choose an application that
						allows for the configuration of the full set of capabilities of the <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> implementation . For example, if the <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> implementation  supports specification of wildcards,
						subnets, etc., it is unacceptable for the evaluator to  specify only
						a single fully qualified IP addresses in the rule.<p></p>
						The evaluator shall perform the following tests:
						<ul>
							<li><b>Test 1: </b>The evaluator shall configure an <abbr class="dyn-abbr"><a href="#abbr_SPD">SPD</a></abbr> that is capable of the following: dropping a
								packet, encrypting a packet, and allowing a packet to flow in plaintext. The selectors used in the
								construction of the rule shall be different such that the evaluator can generate a packet and send packets
								to the <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> endpoint with the appropriate fields (fields that are used by the rule - e.g., the IP addresses, TCP/<abbr class="dyn-abbr"><a href="#abbr_UDP">UDP</a></abbr>
								ports) in the packet header. The evaluator performs both positive and negative test cases for each type
								of rule. The evaluator observes via the audit trail, and packet captures that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> exhibited the expected
								behavior: appropriate packets were dropped, allowed through without modification, were encrypted by
								the <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> implementation.</li>
							<li><b>Test 2: </b>The evaluator shall devise several tests that cover a variety of scenarios for packet processing.
								These scenarios must exercise the range of possibilities for <abbr class="dyn-abbr"><a href="#abbr_SPD">SPD</a></abbr> entries and processing modes as outlined
								in the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> and operational guidance. Potential areas to cover include rules with overlapping ranges and
								conflicting entries, inbound and outbound packets, and packets that establish SAs as well as packets that
								belong to established SAs. The evaluator shall verify, via the audit trail and packet captures, for each
								scenario that the expected behavior is exhibited, and is consistent with both the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> and the operational
								guidance.
							</li>
						</ul>
					<br/>
				<div class="element-activity-header"><a href="#FCS_IPSEC_EXT.1.2">FCS_IPSEC_EXT.1.2</a></div>
					<div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div>
						The evaluator shall check the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> to ensure it states that <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> can be established to operate 
						in tunnel mode or transport mode or both (as selected). <br/>
					<br/>
					<div class="eacategory">Guidance</div>
						The evaluator shall confirm that the operational guidance contains instructions on how to
						configure the connection for each mode selected.<p></p>
						If both transport mode and tunnel mode are implemented, the evaluator shall review the operational
						guidance to determine how the use of a given mode is specified.<br/>
					<br/>
					<div class="eacategory">Tests</div>
						The evaluator shall perform the following tests based on the selections chosen:
						<ul>
							<li><b>Test 1: </b>[conditional] If tunnel mode is selected, the evaluator uses the operational guidance to
								configure the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> to operate in tunnel mode and also configures a <abbr class="dyn-abbr"><a href="#abbr_VPN">VPN</a></abbr> gateway to operate in tunnel 
								mode. The evaluator configures the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> and the <abbr class="dyn-abbr"><a href="#abbr_VPN">VPN</a></abbr> gateway to use any of the allowable cryptographic algorithms, 
								authentication methods, etc. to ensure an allowable <abbr class="dyn-abbr"><a href="#abbr_SA">SA</a></abbr> can be negotiated. The evaluator shall then
								initiate a connection from the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> to connect to the <abbr class="dyn-abbr"><a href="#abbr_VPN">VPN</a></abbr> gateway peer. The evaluator observes (for example,
								in the audit trail and the captured packets) that a successful connection was established using tunnel
								mode.
							</li>
							<li><b>Test 2: </b>[conditional] If transport mode is selected, the evaluator uses the operational guidance to
								configure the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> to operate in transport mode and also configures an <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> peer to accept <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr>
								connections using transport mode. The evaluator configures the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> and the endpoint device to use any
								of the allowed cryptographic algorithms, authentication methods, etc. to ensure an allowable <abbr class="dyn-abbr"><a href="#abbr_SA">SA</a></abbr> can be
								negotiated. The evaluator then initiates a connection from the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> to connect to the remote endpoint.
								The evaluator observes (for example, in the audit trail and the captured packets) that a successful
								connection was established using the transport mode.
							</li>
							<li><b>Test 3: </b>[conditional] If both tunnel mode and transport mode are selected, the evaluator shall modify the
								testing for <a href="#FCS_IPSEC_EXT.1">FCS_IPSEC_EXT.1</a> to include the supported mode for <abbr class="dyn-abbr"><a href="#abbr_SPD">SPD</a></abbr> PROTECT entries to show that they
								apply only to traffic that is transmitted or received using the indicated mode.
							</li>
						</ul>
					<br/>
				<div class="element-activity-header"><a href="#FCS_IPSEC_EXT.1.3">FCS_IPSEC_EXT.1.3</a></div>
					<div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div>
						The evaluator shall examine the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> to verify that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> provides a description of how a packet is
						processed against the <abbr class="dyn-abbr"><a href="#abbr_SPD">SPD</a></abbr> and that if no rules are found to match, that a final rule exists, either implicitly
						or explicitly, that causes the network packet to be discarded.<br/>
					<br/>
					<div class="eacategory">Guidance</div>
						The evaluator shall check that the operational guidance provides instructions on how to construct or
						acquire the <abbr class="dyn-abbr"><a href="#abbr_SPD">SPD</a></abbr> and uses the guidance to configure the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> for the following test.<br/>
					<br/>
					<div class="eacategory">Tests</div>
						The evaluator shall perform the following test:<p></p>
						The evaluator shall configure the <abbr class="dyn-abbr"><a href="#abbr_SPD">SPD</a></abbr> such that it has entries that contain operations that DISCARD,
						PROTECT, and (if applicable) BYPASS network packets. The evaluator may use the <abbr class="dyn-abbr"><a href="#abbr_SPD">SPD</a></abbr> that was created
						for verification of <a href="#FCS_IPSEC_EXT.1.1">FCS_IPSEC_EXT.1.1</a>. The evaluator shall construct a network packet that matches a
						BYPASS entry and send that packet. The evaluator should observe that the network packet is passed to
						the proper destination interface with no modification. The evaluator shall then modify a field in the packet
						header; such that it no longer matches the evaluator-created entries (there may be a <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr>-created final
						entry that discards packets that do not match any previous entries). The evaluator sends the packet, and
						observes that the packet was not permitted to flow to any of the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr>s interfaces.
					<br/>
				<div class="element-activity-header"><a href="#FCS_IPSEC_EXT.1.4">FCS_IPSEC_EXT.1.4</a></div>
					<div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div>
						The evaluator shall examine the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> to verify that the algorithms AES-GCM-128 and AES-GCM-256 are
						implemented. If the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author has selected either AES-CBC-128 or AES-CBC-256 in the requirement, 
						then the evaluator verifies the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes these as well. In addition, the evaluator ensures 
						that the SHA-based HMAC algorithm conforms to the algorithms specified in the relevant iteration of
						<a href="#FCS_COP.1">FCS_COP.1</a> from the incorporating <abbr class="dyn-abbr"><a href="#abbr_PP">PP</a></abbr> that applies to keyed-hash message authentication.<br/>
					<br/>
					<div class="eacategory">Guidance</div>
						The evaluator checks the operational guidance to ensure it provides instructions on how the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> is
						configured to use the algorithms selected in this component and whether this is performed through direct
						configuration, defined during initial installation, or defined by acquiring configuration settings from an
						environmental component.<br/>
					<br/>
					<div class="eacategory">Tests</div>
						<ul>
							<li><b>Test 1: </b>
								The evaluator shall configure the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> as indicated in the operational guidance configuring the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr>
								to using each of the AES-GCM-128 and AES-GCM-256 algorithms, and attempt to establish a connection
								using <abbr class="dyn-abbr"><a href="#abbr_ESP">ESP</a></abbr>. If the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> Author has selected either AES-CBC-128 or AES-CBC-256, the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> is configured to use
								those algorithms and the evaluator attempts to establish a connection using <abbr class="dyn-abbr"><a href="#abbr_ESP">ESP</a></abbr> for those algorithms
								selected.
							</li>
						</ul>
					<br/>
				<div class="element-activity-header"><a href="#FCS_IPSEC_EXT.1.5">FCS_IPSEC_EXT.1.5</a></div>
					<div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div>
						The evaluator shall examine the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> to verify that IKEv1 or IKEv2 (or both) are implemented. If IKEv1 is
						implemented, the evaluator shall verify that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> indicates whether or not <abbr class="dyn-abbr"><a href="#abbr_XAUTH">XAUTH</a></abbr> is supported, and
						that aggressive mode is not used for IKEv1 Phase 1 exchanges (i.e. only main mode is used). It may be that
						these are configurable options.<br/>
					<br/>
					<div class="eacategory">Guidance</div>
						The evaluator shall check the operational guidance to ensure it instructs the administrator how to
						configure the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> to use IKEv1 or IKEv2 (as selected), and uses the guidance to configure the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> to
						perform NAT traversal for the test below. If <abbr class="dyn-abbr"><a href="#abbr_XAUTH">XAUTH</a></abbr> is implemented, the evaluator shall verify that the
						operational guidance provides instructions on how it is enabled or disabled. <p></p>
						If the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> supports IKEv1, the evaluator shall verify that the operational guidance either asserts that only	
						main mode is used for Phase 1 exchanges, or provides instructions for disabling aggressive mode.<br/>
					<br/>
					<div class="eacategory">Tests</div>
						<ul>
							<li><b>Test 1: </b>
								The evaluator shall configure the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> so that it will perform NAT traversal processing as described
								in the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> and <a href="#bibRFC7296">[RFC 7296]</a>, section 2.23. The evaluator shall initiate an <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> connection and determine that
								the NAT is successfully traversed. If the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> supports IKEv1 with or without <abbr class="dyn-abbr"><a href="#abbr_XAUTH">XAUTH</a></abbr>, the evaluator shall
								verify that this test can be successfully repeated with <abbr class="dyn-abbr"><a href="#abbr_XAUTH">XAUTH</a></abbr> enabled and disabled in the manner specified
								by the operational guidance. If the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> supports only IKEv1 with <abbr class="dyn-abbr"><a href="#abbr_XAUTH">XAUTH</a></abbr>, the evaluator shall verify that
								connections not using <abbr class="dyn-abbr"><a href="#abbr_XAUTH">XAUTH</a></abbr> are unsuccessful. If the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> supports only IKEv1 without <abbr class="dyn-abbr"><a href="#abbr_XAUTH">XAUTH</a></abbr>, the
								evaluator shall verify that connections using <abbr class="dyn-abbr"><a href="#abbr_XAUTH">XAUTH</a></abbr> are unsuccessful.</li>
							<li><b>Test 2: </b>[conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> supports IKEv1, the evaluator shall perform any applicable operational
								guidance steps to disable the use of aggressive mode and then attempt to establish a connection using an
								IKEv1 Phase 1 connection in aggressive mode. This attempt should fail. The evaluator shall show that the
								<abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> rejects a <abbr class="dyn-abbr"><a href="#abbr_VPN">VPN</a></abbr> gateway from initiating an IKEv1 Phase 1 connection in aggressive mode. The
								evaluator should then show that main mode exchanges are supported.</li>
						</ul>
					<br/>
				<div class="element-activity-header"><a href="#FCS_IPSEC_EXT.1.6">FCS_IPSEC_EXT.1.6</a></div>
					<div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div>
						The evaluator shall ensure the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> identifies the algorithms used for encrypting the IKEv1 or IKEv2
						payload, and that the algorithms AES-CBC-128, AES-CBC-256 are specified, and if others are chosen in the
						selection of the requirement, those are included in the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> discussion.<br/>
					<br/>
					<div class="eacategory">Guidance</div>
						The evaluator checks the operational guidance to ensure it provides instructions on how the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> is
						configured to use the algorithms selected in this component and whether this is performed through direct
						configuration, defined during initial installation, or defined by acquiring configuration settings from an
						environmental component.<br/>
					<br/>
					<div class="eacategory">Tests</div>
						The evaluator shall use the operational guidance to configure the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> (or to configure the Operational
						Environment to have the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> receive configuration) to perform the following test for each ciphersuite
						selected for each version of <abbr class="dyn-abbr"><a href="#abbr_IKE">IKE</a></abbr> selected:<p></p>
						The evaluator shall configure the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> to use the ciphersuite under test to encrypt the IKEv1 or
						IKEv2 payload and establish a connection with a peer device, which is configured to accept the
						payload encrypted only using the indicated ciphersuite. The evaluator will confirm the algorithm was that used
						in the negotiation. The evaluator will confirm that the connection is successful by confirming that data
						can be passed through the connection once it is established. For example, the evaluator may connect to
						a webpage on the remote network and verify that it can be reached.
					<br/>
				<div class="element-activity-header"><a href="#FCS_IPSEC_EXT.1.7">FCS_IPSEC_EXT.1.7</a></div>
					<div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div>There are no <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> EAs for this requirement.<br/><br/>
					<div class="eacategory">Guidance</div>The evaluator shall check the operational guidance to ensure it provides instructions on how the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr>
						configures the values for <abbr class="dyn-abbr"><a href="#abbr_SA">SA</a></abbr> lifetimes. In addition, the evaluator shall check that the guidance has the
						option for either the Administrator or <abbr class="dyn-abbr"><a href="#abbr_VPN">VPN</a></abbr> gateway to configure Phase 1 SAs if time-based limits are
						supported. Currently there are no values mandated for the number of packets or number of bytes, the
						evaluator shall simply check the operational guidance to ensure that this can be configured if selected in
						the requirement.<br/>
					<br/>
					<div class="eacategory">Tests</div>
						When testing this functionality, the evaluator needs to ensure that both <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> endpoints are configured
						appropriately. From the RFC: A difference between IKEv1 and IKEv2 is that in IKEv1 <abbr class="dyn-abbr"><a href="#abbr_SA">SA</a></abbr> lifetimes were
						negotiated. In IKEv2, each end of the <abbr class="dyn-abbr"><a href="#abbr_SA">SA</a></abbr> is responsible for enforcing its own lifetime policy on the <abbr class="dyn-abbr"><a href="#abbr_SA">SA</a></abbr> and
						rekeying the <abbr class="dyn-abbr"><a href="#abbr_SA">SA</a></abbr> when necessary. If the two ends have different lifetime policies, the end with the shorter
						lifetime will end up always being the one to request the rekeying. If the two ends have the same lifetime
						policies, it is possible that both will initiate a rekeying at the same time (which will result in redundant
						SAs). To reduce the probability of this happening, the timing of rekeying requests SHOULD be jittered.<p></p>
						Each of the following tests shall be performed for each version of <abbr class="dyn-abbr"><a href="#abbr_IKE">IKE</a></abbr> selected in the <a href="#FCS_IPSEC_EXT.1.5">FCS_IPSEC_EXT.1.5</a>
						protocol selection:<p></p>
						Each of the following tests shall be performed for each version of <abbr class="dyn-abbr"><a href="#abbr_IKE">IKE</a></abbr> selected in the
						<a href="#FCS_IPSEC_EXT.1.5">FCS_IPSEC_EXT.1.5</a> protocol selection:
						<ul>
							<li><b>Test 1: </b>The evaluator shall configure a maximum lifetime in terms of the number of packets (or
								bytes) allowed following the operational guidance. The evaluator shall establish an <abbr class="dyn-abbr"><a href="#abbr_SA">SA</a></abbr> and determine that
								once the allowed number of packets (or bytes) through this <abbr class="dyn-abbr"><a href="#abbr_SA">SA</a></abbr> is exceeded, the connection is closed.</li>
							<li><b>Test 2: </b>The evaluator shall construct a test where a Phase 1 <abbr class="dyn-abbr"><a href="#abbr_SA">SA</a></abbr> is established and attempted
								to be maintained for more than 24 hours before it is renegotiated. The evaluator shall observe that this
								<abbr class="dyn-abbr"><a href="#abbr_SA">SA</a></abbr> is closed or renegotiated in 24 hours or less. If such an action requires that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> be configured in a
								specific way, the evaluator shall implement tests demonstrating that the configuration capability of the
								<abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> works as documented in the operational guidance.</li>
							<li><b>Test 3: </b>The evaluator shall perform a test similar to Test 2 for Phase 2 SAs, except that the
								lifetime will be 8 hours or less instead of 24 hours or less.</li>
							<li><b>Test 4: </b>If a fixed limit for IKEv1 SAs is supported, the evaluator shall establish an <abbr class="dyn-abbr"><a href="#abbr_SA">SA</a></abbr> and
								observe that the connection is closed after the fixed traffic or time value is reached.</li>
						</ul>
					<br/>
				<div class="element-activity-header"><a href="#FCS_IPSEC_EXT.1.8">FCS_IPSEC_EXT.1.8</a></div>
					<div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div>
						The evaluator shall check to ensure that the DH groups specified in the requirement are listed as being
						supported in the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr>. If there is more than one DH group supported, the evaluator checks to ensure the
						<abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes how a particular DH group is specified/negotiated with a peer.<br/>
					<br/>
					<div class="eacategory">Guidance</div>There are no AGD EAs for this requirement.<br/><br/>
					<div class="eacategory">Tests</div>The evaluator shall perform the following test: 
						<ul>
							<li><b>Test 1: </b>For each supported DH group, the evaluator shall test to ensure that all supported <abbr class="dyn-abbr"><a href="#abbr_IKE">IKE</a></abbr> 
								protocols can be successfully completed using that particular DH group.
							</li>
						</ul>
					<br/>
				<div class="element-activity-header"><a href="#FCS_IPSEC_EXT.1.9">FCS_IPSEC_EXT.1.9</a></div>
					<div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div>
						The evaluator shall check to ensure that, for each DH group supported, the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes the process for
						generating "x" (as defined in <a href="#FCS_IPSEC_EXT.1.9">FCS_IPSEC_EXT.1.9</a>) and each nonce. The evaluator shall verify that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr>
						indicates that the random number generated that meets the requirements in this <abbr class="dyn-abbr"><a href="#abbr_FP">FP</a></abbr> is used, and that the
						length of "x" and the nonces meet the stipulations in the requirement.<br/>
					<br/>
					<div class="eacategory">Guidance</div>There are no AGD EAs for this requirement.<br/><br/>
					<div class="eacategory">Tests</div>There are no test EAs for this requirement.<br/>
				<div class="element-activity-header"><a href="#FCS_IPSEC_EXT.1.10">FCS_IPSEC_EXT.1.10</a></div>
					EAs for this element are tested through EAs for <a href="#FCS_IPSEC_EXT.1.9">FCS_IPSEC_EXT.1.9</a>.
					
				<div class="element-activity-header"><a href="#FCS_IPSEC_EXT.1.11">FCS_IPSEC_EXT.1.11</a></div>
					<div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div>
						The evaluator ensures that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> identifies RSA or ECDSA or both as being used to perform peer
						authentication.<p></p>
						If any selection with pre-shared keys is chosen in the selection, the evaluator shall check to ensure that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes
						how those selections work in conjunction with authentication of <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> connections.<p></p>
						The evaluator shall ensure that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes how the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> compares the peers presented identifier
						to the reference identifier. This description shall include whether the certificate presented identifier is
						compared to the ID payload presented identifier, which field(s) of the certificate are used as the presented
						identifier (<abbr class="dyn-abbr"><a href="#abbr_DN">DN</a></abbr>, Common Name, or SAN) and, if multiple fields are supported, the logical order comparison.
						If the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author assigned an additional identifier type, the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> description shall also include a description
						of that type and the method by which that type is compared to the peers presented certificate.<br/>
					<br/>
					<div class="eacategory">Guidance</div>
						If any selection with Pre-shared Keys is selected, the evaluator shall check that the operational guidance 
						describes any configuration necessary to enable any selected authentication mechanisms. <p></p>
						If any method other than no other method is selected, the evaluator shall check that the operational guidance 
						describes any configuration necessary to enable any selected authentication mechanisms.<p></p>
						The evaluator ensures the operational guidance describes how to set up the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> to use the cryptographic
						algorithms RSA or ECDSA, as selected.<p></p>
						In order to construct the environment and configure the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> for the following tests, the evaluator will
						ensure that the operational guidance also describes how to configure the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> to connect to a trusted <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr>,
						and ensure a valid certificate for that <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> is loaded into the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> as a trusted <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr>.<p></p>
						The evaluator shall also ensure that the operational guidance includes the configuration of the reference
						identifiers for the peer.<br/>
					<br/>
					<div class="eacategory">Tests</div>

						For efficiencys sake, the testing that is performed here has been combined with the testing for
						<b><a href="#FIA_X509_EXT.2">FIA_X509_EXT.2</a></b> and <b>FIA_X509_EXT.3</b> (for <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> connections and depending on the <abbr class="dyn-abbr"><a href="#abbr_Base-PP">Base-PP</a></abbr>),
						<b><a href="#FCS_IPSEC_EXT.1.12">FCS_IPSEC_EXT.1.12</a></b>, and <b><a href="#FCS_IPSEC_EXT.1.13">FCS_IPSEC_EXT.1.13</a></b>. The following tests shall be repeated for each peer
						authentication protocol selected in the <b><a href="#FCS_IPSEC_EXT.1.11">FCS_IPSEC_EXT.1.11</a></b> selection above:
						<ul>
							<li><b>Test 1: </b>The evaluator shall have the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> generate a public-private key pair, and submit a <abbr class="dyn-abbr"><a href="#abbr_CSR">CSR</a></abbr> (Certificate
								Signing Request) to a <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> (trusted by both the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> and the peer <abbr class="dyn-abbr"><a href="#abbr_VPN">VPN</a></abbr> used to establish a connection) for
								its signature. The values for the <abbr class="dyn-abbr"><a href="#abbr_DN">DN</a></abbr> (Common Name, Organization, Organizational Unit, and Country) will
								also be passed in the request. Alternatively, the evaluator may import to the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> a previously generated
								private key and corresponding certificate.
							</li>
							<li><b>Test 2: </b>The evaluator shall configure the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> to use a private key and associated certificate signed by a
								trusted <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> and shall establish an <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> connection with the peer.                
							</li>
							<li><b>Test 3: </b>The evaluator shall test that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> can properly handle revoked certificates  conditional on
								whether CRL or <abbr class="dyn-abbr"><a href="#abbr_OCSP">OCSP</a></abbr> is selected; if both are selected, and then a test is performed for each method. For
								this current version of the <abbr class="dyn-abbr"><a href="#abbr_PP-Module">PP-Module</a></abbr>, the evaluator has to only test one up in the trust chain (future
								drafts may require to ensure the validation is done up the entire chain). The evaluator shall ensure that a
								valid certificate is used, and that the <abbr class="dyn-abbr"><a href="#abbr_SA">SA</a></abbr> is established. The evaluator then attempts the test with a
								certificate that will be revoked (for each method chosen in the selection) to ensure when the certificate
								is no longer valid that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> will not establish an <abbr class="dyn-abbr"><a href="#abbr_SA">SA</a></abbr>
							</li>
							<li><b>Test 4: </b>[conditional] For each selection made, the evaluator shall verify factors are required, as indicated in the
								operational guidance, to establish an <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> connection with the server. 
							</li>
							For each supported identifier type (excluding DNs), the evaluator shall repeat the following tests:
							<li><b>Test 5: </b>For each field of the certificate supported for comparison, the evaluator shall configure the peers
								reference identifier on the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> (per the administrative guidance) to match the field in the peers
								presented certificate and shall verify that the <abbr class="dyn-abbr"><a href="#abbr_IKE">IKE</a></abbr> authentication succeeds.
							</li>
							<li><b>Test 6: </b>For each field of the certificate support for comparison, the evaluator shall configure the peers
								reference identifier on the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> (per the administrative guidance) to not match the field in the peers
								presented certificate and shall verify that the <abbr class="dyn-abbr"><a href="#abbr_IKE">IKE</a></abbr> authentication fails.
							</li>
							The following tests are conditional:
							<li><b>Test 7: </b>[conditional] If, according to the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr>, the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> supports both Common Name and SAN certificate
								fields and uses the preferred logic outlined in the Application Note, the tests above with the Common
								Name field shall be performed using peer certificates with no SAN extension. Additionally, the evaluator
								shall configure the peers reference identifier on the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> to not match the SAN in the peers presented
								certificate but to match the Common Name in the peers presented certificate, and verify that the <abbr class="dyn-abbr"><a href="#abbr_IKE">IKE</a></abbr>
								authentication fails.
							</li>
							<li><b>Test 8: </b>[conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> supports <abbr class="dyn-abbr"><a href="#abbr_DN">DN</a></abbr> identifier types, the evaluator shall configure the peer's
								reference identifier on the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> (per the administrative guidance) to match the subject <abbr class="dyn-abbr"><a href="#abbr_DN">DN</a></abbr> in the peer's
								presented certificate and shall verify that the <abbr class="dyn-abbr"><a href="#abbr_IKE">IKE</a></abbr> authentication succeeds. To demonstrate a bit-wise
								comparison of the <abbr class="dyn-abbr"><a href="#abbr_DN">DN</a></abbr>, the evaluator shall change a single bit in the <abbr class="dyn-abbr"><a href="#abbr_DN">DN</a></abbr> (preferably, in an Object Identifier
								(OID) in the <abbr class="dyn-abbr"><a href="#abbr_DN">DN</a></abbr>) and verify that the <abbr class="dyn-abbr"><a href="#abbr_IKE">IKE</a></abbr> authentication fails. <b>To demonstrate a comparison of <abbr class="dyn-abbr"><a href="#abbr_DN">DN</a></abbr> values,
								the evaluator shall change any one of the four <abbr class="dyn-abbr"><a href="#abbr_DN">DN</a></abbr> values and verify that the <abbr class="dyn-abbr"><a href="#abbr_IKE">IKE</a></abbr> authentication fails.</b>
							</li>
							<li><b>Test 9: </b>[conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> supports both IPv4 and IPv6 and supports IP address identifier types, the
								evaluator must repeat test 1 and 2 with both IPv4 address identifiers and IPv6 identifiers. Additionally,
								the evaluator shall verify that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> verifies that the IP header matches the identifiers by setting the
								presented identifiers and the reference identifier with the same IP address that differs from the actual IP
								address of the peer in the IP headers and verifying that the <abbr class="dyn-abbr"><a href="#abbr_IKE">IKE</a></abbr> authentication fails.
							</li>
							<li><b>Test 10: </b>[conditional] If, according to the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr>, the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> performs comparisons between the peers ID
								payload and the peers certificate, the evaluator shall repeat the following test for each combination of
								supported identifier types and supported certificate fields (as above). The evaluator shall configure the
								peer to present a different ID payload than the field in the peers presented certificate and verify that the
								<abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> fails to authenticate the <abbr class="dyn-abbr"><a href="#abbr_IKE">IKE</a></abbr> peer.
							</li>
						</ul>
					<br/>
				<div class="element-activity-header"><a href="#FCS_IPSEC_EXT.1.12">FCS_IPSEC_EXT.1.12</a></div>
					EAs for this element are tested through EAs for <a href="#FCS_IPSEC_EXT.1.11">FCS_IPSEC_EXT.1.11</a>.
					
				<div class="element-activity-header"><a href="#FCS_IPSEC_EXT.1.13">FCS_IPSEC_EXT.1.13</a></div>
					EAs for this element are tested through EAs for <a href="#FCS_IPSEC_EXT.1.11">FCS_IPSEC_EXT.1.11</a>.
					
				<div class="element-activity-header"><a href="#FCS_IPSEC_EXT.1.14">FCS_IPSEC_EXT.1.14</a></div>
					<div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div>
						The evaluator shall check that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes the potential strengths (in terms of the number of bits in
						the symmetric key) of the algorithms that are allowed for the <abbr class="dyn-abbr"><a href="#abbr_IKE">IKE</a></abbr> and <abbr class="dyn-abbr"><a href="#abbr_ESP">ESP</a></abbr> exchanges. The <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> shall also
						describe the checks that are done when negotiating IKEv1 Phase 2 and IKEv2 CHILD_SA suites to ensure
						that the strength (in terms of the number of bits of key in the symmetric algorithm) of the negotiated
						algorithm is less than or equal to that of the <abbr class="dyn-abbr"><a href="#abbr_IKE">IKE</a></abbr> <abbr class="dyn-abbr"><a href="#abbr_SA">SA</a></abbr> negotiation that is being protected.<br/>
					<br/>
					<div class="eacategory">Guidance</div>There are no AGD EAs for this requirement.<br/><br/>
					<div class="eacategory">Tests</div>The evaluator follows the guidance to configure the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> to perform the following tests for each version
						of <abbr class="dyn-abbr"><a href="#abbr_IKE">IKE</a></abbr> supported:
						<ul>
							<li><b>Test 1: </b>The evaluator shall successfully negotiate an <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> connection using each of the supported algorithms 
							and hash functions identified in the requirements.
							</li>
							<li><b>Test 2: </b>The evaluator shall attempt to establish an <abbr class="dyn-abbr"><a href="#abbr_SA">SA</a></abbr> for <abbr class="dyn-abbr"><a href="#abbr_ESP">ESP</a></abbr> that selects an encryption algorithm with
								greater strength than that being used for the <abbr class="dyn-abbr"><a href="#abbr_IKE">IKE</a></abbr> <abbr class="dyn-abbr"><a href="#abbr_SA">SA</a></abbr> (i.e., symmetric algorithm with a key size larger 
								than that being used for the <abbr class="dyn-abbr"><a href="#abbr_IKE">IKE</a></abbr> <abbr class="dyn-abbr"><a href="#abbr_SA">SA</a></abbr>). Such attempts should fail.
							</li>
							<li><b>Test 3: </b>The evaluator shall attempt to establish an <abbr class="dyn-abbr"><a href="#abbr_IKE">IKE</a></abbr> <abbr class="dyn-abbr"><a href="#abbr_SA">SA</a></abbr> using an algorithm that is not one of the supported 
								algorithms and hash functions identified in the requirements. Such an attempt should fail.
							</li>
							<li><b>Test 4: </b>The evaluator shall attempt to establish an <abbr class="dyn-abbr"><a href="#abbr_SA">SA</a></abbr> for <abbr class="dyn-abbr"><a href="#abbr_ESP">ESP</a></abbr> (assumes the proper parameters where used to 
								establish the <abbr class="dyn-abbr"><a href="#abbr_IKE">IKE</a></abbr> <abbr class="dyn-abbr"><a href="#abbr_SA">SA</a></abbr>) that selects an encryption algorithm that is not identified in <a href="#FCS_IPSEC_EXT.1.4">FCS_IPSEC_EXT.1.4</a>.
								Such an attempt should fail.
							</li>
						</ul>
					<br/>
				</div></div></div>
		
      

	
    <h2 id="s-fia" class="indexable" data-level="2">3.3 Identification and Authentication (FIA)</h2>
        The <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> may support pre-shared keys for use in establishing an <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> connection. <abbr class="dyn-abbr"><a href="#abbr_PSK">PSK</a></abbr> in the context of this document refer
		to generated values, memorized values subject to conditioning, one time passwords, and combinations of the
		above as described in <a href="#FIA_PSK_EXT.1.2">FIA_PSK_EXT.1.2</a>.  

        
		
        

	  
		
        

		
				
        

        
		
        

        
		
        
		
		
        
     
        
        
        
		
        <div class="comp" id="FIA_X509_EXT.1"><h4>FIA_X509_EXT.1 X.509 Certificate Validation</h4>
			<div class="element"><div class="reqid" id="FIA_X509_EXT.1.1"><a href="#FIA_X509_EXT.1.1" class="abbr">FIA_X509_EXT.1.1</a></div><div class="reqdesc">
					The application shall 
					[<b>selection</b><b>, choose one of</b>: <i id="_s_153">invoke platform-provided functionality</i>, <i id="_s_154">implement functionality</i>]
					to validate certificates in accordance with the following rules:<ul>
						<li>RFC 5280 certificate validation and certificate path validation.</li>
						<li>The certificate path must terminate with a trusted <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> certificate.</li>
						<li>The application shall validate a certificate path by ensuring the presence of the 
							basicConstraints extension and that the <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> flag is set to TRUE for all <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> 
							certificates, and that any path constraints are met.
						</li>
						<li>The application shall validate that any <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> certificate includes caSigning purpose in the key
							usage field</li>
						<li>The application shall validate the revocation status of the certificate using 
							[<b>selection</b>: <i id="_s_155"><abbr class="dyn-abbr"><a href="#abbr_OCSP">OCSP</a></abbr> as specified in RFC 6960</i>, <i id="_s_156">CRL as specified in RFC 5280 Section 6.3</i>, <i id="_s_157">CRL as specified in RFC 8603</i>, <i id="_s_158">an <abbr class="dyn-abbr"><a href="#abbr_OCSP">OCSP</a></abbr> TLS Status Request Extension (<abbr class="dyn-abbr"><a href="#abbr_OCSP">OCSP</a></abbr> stapling) as specified in RFC 6066</i>, <i id="_s_159"><abbr class="dyn-abbr"><a href="#abbr_OCSP">OCSP</a></abbr> TLS Multi-Certificate Status Request Extension (i.e., <abbr class="dyn-abbr"><a href="#abbr_OCSP">OCSP</a></abbr> Multi-Stapling) as specified in RFC 6961</i>].
						</li>
						<li>The application shall validate the extendedKeyUsage (EKU) field according to the 
							following rules:<ul>
							<li>Certificates used for trusted updates and executable code integrity verification 
								shall have the Code Signing Purpose (id-kp 3 with OID 1.3.6.1.5.5.7.3.3) in the 
								extendedKeyUsage field.
							</li>
							<li>Server certificates presented for TLS shall have the Server Authentication
								purpose (id-kp 1 with OID 1.3.6.1.5.5.7.3.1) in the EKU field.
							</li>
							<li>
								Client certificates presented for TLS shall have the Client Authentication purpose 
								(id-kp 2 with OID 1.3.6.1.5.5.7.3.2) in the EKU field.
							</li>
							<li>
								S/MIME certificates presented for email encryption and signature shall have the 
								Email Protection purpose (id-kp 4 with OID 1.3.6.1.5.5.7.3.4) in the EKU field.
							</li>
							<li>
								<abbr class="dyn-abbr"><a href="#abbr_OCSP">OCSP</a></abbr> certificates presented for <abbr class="dyn-abbr"><a href="#abbr_OCSP">OCSP</a></abbr> responses shall have the <abbr class="dyn-abbr"><a href="#abbr_OCSP">OCSP</a></abbr> Signing purpose 
								(id-kp 9 with OID 1.3.6.1.5.5.7.3.9) in the EKU field.
							</li>
							<li>
								Server certificates presented for EST shall have the CMC Registration Authority 
								(RA) purpose (id-kp-cmcRA with OID 1.3.6.1.5.5.7.3.28) in the EKU field.
							</li></ul>
						</li>
					</ul>
				<div class="appnote"><span class="note-header">Application Note: </span><span class="note">
					<a href="#FIA_X509_EXT.1.1">FIA_X509_EXT.1.1</a> lists the rules for validating certificates. The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author shall select whether
					revocation status is verified using <abbr class="dyn-abbr"><a href="#abbr_OCSP">OCSP</a></abbr> or CRLs. <a href="#FIA_X509_EXT.2">FIA_X509_EXT.2</a> requires that certificates are
					used for HTTPS, TLS, and DTLS; this use requires that the extendedKeyUsage rules are verified.
					If <abbr class="dyn-abbr"><a href="#abbr_OCSP">OCSP</a></abbr> is not supported the EKU provision for checking the <abbr class="dyn-abbr"><a href="#abbr_OCSP">OCSP</a></abbr> Signing purpose is met by 
					default.<p></p>
					This requirement is included if the protocol(s) selected in FTP_DIT_EXT.1.1 require the use of
					certificates. If the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> implements TLS as a HTTPS/TLS server with no mutual authentication,
					this requirement is not applicable.<p></p>
					<abbr class="dyn-abbr"><a href="#abbr_OCSP">OCSP</a></abbr> stapling and <abbr class="dyn-abbr"><a href="#abbr_OCSP">OCSP</a></abbr> multi-stapling only support TLS server certificate validation. If other 
					certificate types are validated, either <abbr class="dyn-abbr"><a href="#abbr_OCSP">OCSP</a></abbr> or CRL should be claimed.<p></p>
					Regardless of the selection of "<i>implement functionality or invoke platform-provided 
					functionality</i>," the validation is expected to end in a trusted root <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> certificate in a root
					store managed by the platform.
				</span></div></div></div>
			<div class="element"><div class="reqid" id="FIA_X509_EXT.1.2"><a href="#FIA_X509_EXT.1.2" class="abbr">FIA_X509_EXT.1.2</a></div><div class="reqdesc">
					The application shall treat a certificate as a <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> certificate only if the 
					basicConstraints extension is present and the <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> flag is set to TRUE.
				<div class="appnote"><span class="note-header">Application Note: </span><span class="note">
					This requirement applies to certificates that are used and processed by the 
					<abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> and restricts the certificates that may be added as trusted <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> certificates.
				</span></div></div></div>
        <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="element-activity-header"><a href="#FIA_X509_EXT.1.1">FIA_X509_EXT.1.1</a></div>
					<div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div>
						The evaluator shall ensure the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes where the check of validity of the certificates
						takes place. The evaluator ensures the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> also provides a description of the certificate 
						path validation algorithm.<p></p>
					<br/>
					<div class="eacategory">Guidance</div>None.<p></p><br/>
					<div class="eacategory">Tests</div>
						The tests described must be performed in conjunction with the other certificate services evaluation 
						activities, including the functions in <a href="#FIA_X509_EXT.2">FIA_X509_EXT.2</a>.1. The tests for the extendedKeyUsage rules are 
						performed in conjunction with the uses that require those rules. If the application supports chains of
						length four or greater, the evaluator shall create a chain of at least four certificates: 
						the node certificate to be tested, two Intermediate CAs, and the self-signed Root <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr>. If 
						the application supports a maximum trust depth of two, then a chain with no Intermediate
						<abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> should instead be created.
						<ul>
							<li><b>Test 1: </b>
								The evaluator shall demonstrate that validating a certificate without a valid certification path results in the function 
								failing, for each of the following reasons, in turn:<ul>
								<li>by establishing a certificate path in which one of the issuing certificates is not a <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> certificate,</li>
								<li>by omitting the basicConstraints field in one of the issuing certificates,</li>
								<li>by setting the basicConstraints field in an issuing certificate to have <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr>=False,</li>
								<li>by omitting the <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> signing bit of the key usage field in an issuing certificate, and</li>
								<li>by setting the path length field of a valid <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> field to a value strictly less than the certificate path.</li>
								</ul>
								The evaluator shall then establish a valid certificate path consisting of valid <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> certificates, and demonstrate that the 
								function succeeds. The evaluator shall then remove trust in one of the <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> certificates, and show that the function fails.
							</li>
							<li><b>Test 2: </b>
								The evaluator shall demonstrate that validating an expired certificate results in the function failing.
							</li>
							<li><b>Test 3: </b>
								The evaluator shall test that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> can properly handle revoked certificates-conditional on whether
								CRL, <abbr class="dyn-abbr"><a href="#abbr_OCSP">OCSP</a></abbr>, <abbr class="dyn-abbr"><a href="#abbr_OCSP">OCSP</a></abbr> Stapling or <abbr class="dyn-abbr"><a href="#abbr_OCSP">OCSP</a></abbr> Multi-stapling is selected; if multiple methods are selected, then
								the following tests shall be performed for each method:
								<ul>
								<li>The evaluator shall test revocation of the node certificate.</li>
								<li>The evaluator shall also test revocation of an intermediate <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> certificate (i.e. the intermediate
									<abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> certificate should be revoked by the root <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr>), if intermediate <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> certificates are supported.
									If <abbr class="dyn-abbr"><a href="#abbr_OCSP">OCSP</a></abbr> stapling per RFC 6066 is the only supported revocation method, this test is omitted.</li>
								<li>The evaluator shall ensure that a valid certificate is used, and that the validation function 
									succeeds. The evaluator then attempts the test with a certificate that has been revoked (for each 
									method chosen in the selection) to ensure when the certificate is no longer valid that the 
									validation function fails.</li>
								</ul>
							</li>
							<li><b>Test 4: </b>
								If any <abbr class="dyn-abbr"><a href="#abbr_OCSP">OCSP</a></abbr> option is selected, the evaluator shall configure the <abbr class="dyn-abbr"><a href="#abbr_OCSP">OCSP</a></abbr> server or use a
								man-in-the-middle tool to present a certificate that does not have the <abbr class="dyn-abbr"><a href="#abbr_OCSP">OCSP</a></abbr> signing purpose and verify
								that validation of the <abbr class="dyn-abbr"><a href="#abbr_OCSP">OCSP</a></abbr> response fails. If CRL is selected, the evaluator shall configure the <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> 
								to sign a CRL with a certificate that does not have the cRLsign key usage bit set, and verify that
								validation of the CRL fails.
							</li>
							<li><b>Test 5: </b>
								The evaluator shall modify any byte in the first eight bytes of the certificate and demonstrate that 
								the certificate fails to validate. (The certificate will fail to parse correctly.)
							</li>
							<li><b>Test 6: </b>
								 The evaluator shall modify any byte in the last byte of the certificate and demonstrate that the 
								 certificate fails to validate. (The signature on the certificate will not validate.)
							</li>
							<li><b>Test 7: </b>
								The evaluator shall modify any byte in the public key of the certificate and demonstrate that the
								certificate fails to validate. (The signature on the certificate will not validate.)
							</li>
							<li><b>Test 8: </b>
								 (Conditional on support for EC certificates as indicated in <a href="#FCS_COP.1">FCS_COP.1</a>/Sig). The evaluator shall establish a valid,
								 trusted certificate chain consisting of an EC leaf certificate, an EC Intermediate <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> certificate not 
								 designated as a trust anchor, and an EC certificate designated as a trusted anchor, where the elliptic 
								 curve parameters are specified as a named curve. The evaluator shall confirm that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> validates 
								 the certificate chain.
							</li>
							<li><b>Test 9: </b>
								(Conditional on support for EC certificates as indicated in <a href="#FCS_COP.1">FCS_COP.1</a>/Sig). The evaluator shall replace
								the intermediate certificate in the certificate chain for Test 9 with a modified certificate, where 
								the modified intermediate <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> has a public key information field where the EC parameters uses an 
								explicit format version of the Elliptic Curve parameters in the public key information field of the
								intermediate <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> certificate from Test 9, and the modified Intermediate <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> certificate is signed by 
								the trusted EC root <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr>, but having no other changes. The evaluator shall confirm the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> treats the
								certificate as invalid.
							</li>
						</ul>
					<br/>
				<div class="element-activity-header"><a href="#FIA_X509_EXT.1.2">FIA_X509_EXT.1.2</a></div>
					<div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div>None.<p></p><br/>
					<div class="eacategory">Guidance</div>None.<p></p><br/>
					<div class="eacategory">Tests</div>
						The tests described must be performed in conjunction with the other certificate 
						services evaluation activities, including the functions in <a href="#FIA_X509_EXT.2">FIA_X509_EXT.2</a>.1.
						If the application supports chains of length four or greater, 
						the evaluator shall create a chain of at least four certificates: the 
						node certificate to be tested, two Intermediate CAs, and the self-signed Root <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr>.
						If the application supports a maximum trust depth of two, then a chain with
						no Intermediate <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> should instead be created.
						<ul>
							<li><b>Test 1: </b>
								The evaluator shall ensure that the certificate of at least one of the CAs in the chain does not contain the 
								basicConstraints extension. The evaluator shall confirm that validation of the certificate path 
								fails (i) as part of the validation of the peer certificate belonging to this chain; and/or 
								(ii) when attempting to add the <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> certificate without the basicConstraints extension to the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr>'s trust store.
							</li>
							<li><b>Test 2: </b>
								The evaluator shall ensure that the certificate of at least one of the CAs in the chain has the <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> flag in the 
								basicConstraints extension not set (or set to FALSE). The evaluator shall confirm that validation of the certificate 
								path fails (i) as part of the validation of the peer certificate belonging to this chain; and/or (ii) when attempting 
								to add the <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> certificate with the <abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr> flag not set (or set to FALSE) in the basicConstraints extension to the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr>'s trust store.
							</li>
						</ul>
					<br/>
				</div></div></div>	   
	    
      
      

<h1 id="opt-app" class="indexable" data-level="A">Appendix A -  Optional Requirements</h1>
    As indicated in the introduction to this Package, the baseline requirements (those that must be
	  performed by the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr>) are contained in the body of this Package.
    This appendix contains three other types of optional requirements that may be included in the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr>, but are not required in order
	  to conform to this Package.
    However, applied modules, packages and/or use cases may refine specific requirements as mandatory. <br/><br/>

   The first type (<a href="#optional-reqs" class="dynref">A.1 Strictly Optional  Requirements</a>) are strictly optional requirements that are independent of the
	  <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> implementing any function.
   If the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> fulfills any of these requirements or supports a certain functionality, the vendor is encouraged to include the SFRs
	  in the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr>, but are not required in order to conform to this Package.<br/><br/>

  The second type (<a href="#objective-reqs" class="dynref">A.2 Objective  Requirements</a>) are objective requirements that describe security functionality not yet 
	  widely available in commercial technology.
   The requirements are not currently mandated in the body of this Package, but will be included in
	  the baseline requirements in future versions of this Package. Adoption by vendors is
	  encouraged and expected as soon as possible.<br/><br/>

  The third type (<a href="#feat-based-reqs" class="dynref">A.3 Implementation-Based  Requirements</a>) 
are dependent on the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> implementing a particular function.
If the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> fulfills any of these requirements, the vendor must either add the related <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> or disable the functionality for the
	  evaluated configuration. 
  <h2 id="optional-reqs" class="indexable" data-level="2">A.1 Strictly Optional  Requirements
    </h2><p>This Package does not define any 
            Strictly Optional requirements.</p><h2 id="objective-reqs" class="indexable" data-level="2">A.2 Objective  Requirements
    </h2><p>This Package does not define any 
            Objective requirements.</p><h2 id="feat-based-reqs" class="indexable" data-level="2">A.3 Implementation-Based  Requirements
    </h2><p>This Package does not define any 
            Implementation-Based requirements.</p><h1 id="sel-based-reqs" class="indexable" data-level="A">Appendix B -  Selection-Based  Requirements
    </h1>
	<p>As indicated in the introduction to this Package,
        the baseline requirements
        (those that must be performed by the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> or its underlying platform)
        are contained in the body of this Package.
        There are additional requirements based on selections in the body of 
        the Package:
        if certain selections are made, then additional requirements below must be included.
 	</p>
		 <h2 id="sel-based-reqs-audit" class="indexable" data-level="2">B.1 
              Auditable Events for Selection-Based  Requirements
           </h2>
         <p>The auditable events in the table below are included in a Security Target if both the associated requirement is included and the incorporating <abbr class="dyn-abbr"><a href="#abbr_PP">PP</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_PP-Module">PP-Module</a></abbr> supports audit event reporting through FAU_GEN.1 and any other criteria in the incorporating <abbr class="dyn-abbr"><a href="#abbr_PP">PP</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_PP-Module">PP-Module</a></abbr> are met.</p>
         <table class="" border="1"><caption><span class="ctr" data-myid="t-audit-sel-based" data-counter-type="ct-Table" id="t-audit-sel-based">Table <span class="counter">2</span></span>: Auditable Events for Selection-based Requirements</caption><tr><th>Requirement</th><th>Auditable Events</th><th>Additional Audit Record Contents</th></tr><tr><td><a href="#FCS_EAP_EXT.1">FCS_EAP_EXT.1</a></td><td>No events specified.</td><td>N/A</td></tr><tr><td><a href="#FIA_HOTP_EXT.1">FIA_HOTP_EXT.1</a></td><td>No events specified.</td><td>N/A</td></tr><tr><td><a href="#FIA_PSK_EXT.1">FIA_PSK_EXT.1</a></td><td>No events specified.</td><td>N/A</td></tr><tr><td><a href="#FIA_PSK_EXT.2">FIA_PSK_EXT.2</a></td><td>No events specified.</td><td>N/A</td></tr><tr><td><a href="#FIA_PSK_EXT.3">FIA_PSK_EXT.3</a></td><td>No events specified.</td><td>N/A</td></tr><tr><td><a href="#FIA_PSK_EXT.4">FIA_PSK_EXT.4</a></td><td>No events specified.</td><td>N/A</td></tr><tr><td><a href="#FIA_PSK_EXT.5">FIA_PSK_EXT.5</a></td><td>No events specified.</td><td>N/A</td></tr><tr><td><a href="#FIA_TOTP_EXT.1">FIA_TOTP_EXT.1</a></td><td>No events specified.</td><td>N/A</td></tr></table><h2 id="-sel-based" class="indexable" data-level="2">B.2 Cryptographic Support (FCS)</h2><div class="comp" id="FCS_EAP_EXT.1"><h4>FCS_EAP_EXT.1 EAP-TLS</h4><div class="statustag"><b><i>The inclusion of this selection-based component depends upon selection in
           <a href="#FCS_IPSEC_EXT.1.11">FCS_IPSEC_EXT.1.11</a>.
           </i></b></div>
			
			
			<div class="element"><div class="reqid" id="FCS_EAP_EXT.1.1"><a href="#FCS_EAP_EXT.1.1" class="abbr">FCS_EAP_EXT.1.1</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall implement
					[<b>selection</b>: <i id="_s_1"><abbr class="dyn-abbr"><a href="#abbr_EAP">EAP</a></abbr>-TLS protocol as specified in <a href="#bibRFC5216">[RFC 5216]</a></i>, <i id="_s_2"><abbr class="dyn-abbr"><a href="#abbr_EAP">EAP</a></abbr>-TTLS as specified in <a href="#bibRFC5281">[RFC 5281]</a></i>]
					as updated by <a href="#bibRFC8996">[RFC 8996]</a> with TLS implemented using mutual authentication in accordance
					with the <a href="#bibNIAPFPTLS">[Functional Package for TLS]</a>.
				</div></div>
			<div class="element"><div class="reqid" id="FCS_EAP_EXT.1.2"><a href="#FCS_EAP_EXT.1.2" class="abbr">FCS_EAP_EXT.1.2</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall generate random values used in the
					[<b>selection</b>: <i id="_s_3"><abbr class="dyn-abbr"><a href="#abbr_EAP">EAP</a></abbr>-TLS</i>, <i id="_s_4"><abbr class="dyn-abbr"><a href="#abbr_EAP">EAP</a></abbr>-TTLS</i>]
					exchange using the RBG specified in <a href="#FCS_RBG_EXT.1">FCS_RBG_EXT.1</a>.
				</div></div>
			<div class="element"><div class="reqid" id="FCS_EAP_EXT.1.3"><a href="#FCS_EAP_EXT.1.3" class="abbr">FCS_EAP_EXT.1.3</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall support peer authentication using certificates and
					[<b>selection</b>: <i id="_s_5"><abbr class="dyn-abbr"><a href="#abbr_PSK">PSK</a></abbr></i>, <i id="_s_6">HOTP</i>, <i id="_s_7">TOTP</i>, <i id="_s_8">[<b>assignment</b>: 
     <span class="assignable-content">other Authentication-verification protocols</span>]</i>, <i id="_s_9">no other authentication</i>]
					as updated by <a href="#bibRFC8996">[RFC 8996]</a> with TLS implemented using mutual authentication in
					accordance with the <a href="#bibNIAPFPTLS">[Functional Package for TLS]</a>.
				</div></div>
			<div class="element"><div class="reqid" id="FCS_EAP_EXT.1.4"><a href="#FCS_EAP_EXT.1.4" class="abbr">FCS_EAP_EXT.1.4</a></div><div class="reqdesc">
					The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall not forward a <abbr class="dyn-abbr"><a href="#abbr_EAP">EAP</a></abbr>-success response if the client certificate is not valid according 
					to <a href="#FIA_X509_EXT.1">FIA_X509_EXT.1</a>.
				</div></div>
			<div class="element"><div class="reqid" id="FCS_EAP_EXT.1.5"><a href="#FCS_EAP_EXT.1.5" class="abbr">FCS_EAP_EXT.1.5</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall use the MSK from the 
					[<b>selection</b>: <i id="_s_10"><abbr class="dyn-abbr"><a href="#abbr_EAP">EAP</a></abbr>-TLS</i>, <i id="_s_11"><abbr class="dyn-abbr"><a href="#abbr_EAP">EAP</a></abbr>-TTLS</i>] response as the IKEv2 shared secret in the authentication payload.
				</div></div>    
			
        <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"><a href="#FCS_EAP_EXT.1">FCS_EAP_EXT.1</a></div>
					
					
					
				<div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div>
						The evaluator shall verify that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes the use of <abbr class="dyn-abbr"><a href="#abbr_EAP">EAP</a></abbr> options for each of the 
						selected peer authentication mechanisms, that TLS with mutual authentication is used, that the
						random values are from an appropriate source, and that the <abbr class="dyn-abbr"><a href="#abbr_EAP">EAP</a></abbr> MSK is derived from the TLS
						master key and is used as the IKEv2 shared key.
					<div class="eacategory">Guidance</div>
						The evaluator shall verify that the guidance documents describe any configurable features of 
						the <abbr class="dyn-abbr"><a href="#abbr_EAP">EAP</a></abbr> or TLS functionality, including instructions for configuration of the authenticators
						and registration processes for clients.
					<div class="eacategory">Tests</div>
						Testing for TLS functionality is in accordance with the TLS package.<p></p>
						For each supported <abbr class="dyn-abbr"><a href="#abbr_EAP">EAP</a></abbr> method claimed in <a href="#FCS_EAP_EXT.1.1">FCS_EAP_EXT.1.1</a> and for each authentication method 
						claimed in <a href="#FCS_EAP_EXT.1.3">FCS_EAP_EXT.1.3</a>, the evaluator shall perform the following tests:
						<ul>
							<li><b>Test 1: </b>The evaluator shall follow AGD guidance to configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to use the <abbr class="dyn-abbr"><a href="#abbr_EAP">EAP</a></abbr> method
								claimed. The evaluator shall follow AGD guidance to configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to use the 
								authentication method claimed and, for <abbr class="dyn-abbr"><a href="#abbr_EAP">EAP</a></abbr>-TTLS, register an endpoint with appropriate
								key material required for the authentication method. The evaluator shall establish an 
								<abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> connection using a test endpoint with a valid certificate and, for <abbr class="dyn-abbr"><a href="#abbr_EAP">EAP</a></abbr>-TTLS, 
								configured to provide a correct value for the configured authenticator. The evaluator
								shall observe that the <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> connection is successful.</li>
							<li><b>Test 2: </b>[conditional] If <abbr class="dyn-abbr"><a href="#abbr_EAP">EAP</a></abbr>-TTLS is supported, the evaluator shall cause the test endpoint with a
								valid certificate to send an invalid authenticator for the claimed authentication method:<ul>
								<li>For HOTP, replay the HOTP value sent previously.</li>
								<li>For TOTP or <abbr class="dyn-abbr"><a href="#abbr_PSK">PSK</a></abbr>, modify a byte of the properly constructed value,and observe that
									the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> aborts the connection.</li></ul>
							</li>
							<li><b>Test 3: </b>The evaluator shall establish a new, valid certificate for a test endpoint using an 
								identifier not corresponding to a registered user. For <abbr class="dyn-abbr"><a href="#abbr_EAP">EAP</a></abbr>-TTLS, the evaluator shall cause
								the test endpoint using this certificate to send a correct authenticator value for the
								registered user. The evaluator shall initiate an <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> connection from the test endpoint
								to the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> aborts the connection.</li>
							<li><b>Test 4: </b>The evaluator shall follow AGD guidance to configure the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> to use a supported <abbr class="dyn-abbr"><a href="#abbr_EAP">EAP</a></abbr> method
								and register the user with key material for required for a supported authentication method.
								The evaluator shall configure a test endpoint to respond to an IKEv2 exchange with 
								<abbr class="dyn-abbr"><a href="#abbr_EAP">EAP</a></abbr>-request, providing valid phase 1 handshake and valid TLS handshake, but computing 
								the phase 2 shared key using standard (non-EAP) methods. The evaluator shall initiate 
								an <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> connection between the test endpoint and the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>, and observe that the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> aborts
								the connection.
							</li>
						</ul>
					</div></div></div><h2 id="s-fia-sel-based" class="indexable" data-level="2">B.3 Identification and Authentication (FIA)</h2><div class="comp" id="FIA_HOTP_EXT.1"><h4>FIA_HOTP_EXT.1 HMAC-Based One-Time Password Pre-Shared Keys</h4><div class="statustag"><b><i>The inclusion of this selection-based component depends upon selection in
           <a href="#FIA_PSK_EXT.4.2">FIA_PSK_EXT.4.2</a>.
           </i></b></div>
			
			<div class="element"><div class="reqid" id="FIA_HOTP_EXT.1.1"><a href="#FIA_HOTP_EXT.1.1" class="abbr">FIA_HOTP_EXT.1.1</a></div><div class="reqdesc">
					The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall support HMAC-Based One-Time Password authentication (HOTP) in accordance with
					<a href="#bibRFC4226">[RFC 4226]</a> to authenticate the user before establishing an <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> connection. 
				</div></div>
			<div class="element"><div class="reqid" id="FIA_HOTP_EXT.1.2"><a href="#FIA_HOTP_EXT.1.2" class="abbr">FIA_HOTP_EXT.1.2</a></div><div class="reqdesc">
					The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall generate a HOTP seed of 
					[<b>selection</b>: <i id="_s_75">128</i>, <i id="_s_76">256</i>] bits in accordance with <a href="#FCS_RBG_EXT.1">FCS_RBG_EXT.1</a>.
				</div></div>
			<div class="element"><div class="reqid" id="FIA_HOTP_EXT.1.3"><a href="#FIA_HOTP_EXT.1.3" class="abbr">FIA_HOTP_EXT.1.3</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall generate a new HOTP seed value for each <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> connection.</div></div>
			<div class="element"><div class="reqid" id="FIA_HOTP_EXT.1.4"><a href="#FIA_HOTP_EXT.1.4" class="abbr">FIA_HOTP_EXT.1.4</a></div><div class="reqdesc">
					The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall utilize 
					[<b>selection</b>: <i id="_s_77">HMAC-SHA-1</i>, <i id="_s_78">HMAC-SHA-256</i>, <i id="_s_79">HMAC-SHA-384</i>, <i id="_s_80">HMAC-SHA-512</i>] 
					with key sizes [<b>assignment</b>: 
     <span class="assignable-content">key size (in bits) used in HMAC</span>] 
					to derive a HOTP hash from the HOTP seed and counter.
				<div class="appnote"><span class="note-header">Application Note: </span><span class="note">
					The assignment must be consistent with the key sizes supported by the relevant iteration of <a href="#FCS_COP.1">FCS_COP.1</a>.
				</span></div></div></div>
			<div class="element"><div class="reqid" id="FIA_HOTP_EXT.1.5"><a href="#FIA_HOTP_EXT.1.5" class="abbr">FIA_HOTP_EXT.1.5</a></div><div class="reqdesc">
					The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall truncate the HOTP hash per <a href="#FIA_HOTP_EXT.1.4">FIA_HOTP_EXT.1.4</a> to create a HOTP of  
					[<b>selection</b><b>, choose one of</b>: <ul><li style=""><i id="_s_81">administrator configurable character length of at least 6</i>, </li><li style=""><i id="_s_82">preset character length of
							[<b>selection</b><b>, choose one of</b>: <i id="_s_83">6</i>, <i id="_s_84">7</i>, <i id="_s_85">8</i>, <i id="_s_86">9</i>, <i id="_s_87">10</i>]
						</i></li></ul>].
				<div class="appnote"><span class="note-header">Application Note: </span><span class="note">
					The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author may either provide a configurable character length of at
					least 6 or a preset size between 6 and 10.
				</span></div></div></div>
			<div class="element"><div class="reqid" id="FIA_HOTP_EXT.1.6"><a href="#FIA_HOTP_EXT.1.6" class="abbr">FIA_HOTP_EXT.1.6</a></div><div class="reqdesc">
					The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall 
					[<b>selection</b>: <ul><li style=""><i id="_s_88">throttle invalid requests to 
							[<b>selection</b>: <i id="_s_89">administrator configurable value</i>, <i id="_s_90">[<b>assignment</b>: 
     <span class="assignable-content">value less than 10</span>]</i>] per minute
						</i>, </li><li style=""><i id="_s_91">lock the associated account after 
							[<b>selection</b>: <i id="_s_92">administrator configurable value</i>, <i id="_s_93">[<b>assignment</b>: 
     <span class="assignable-content">value less than 10</span>]</i>] failed attempts until 
							[<b>selection</b>: <i id="_s_94">an administrator unlocks the account</i>, <i id="_s_95">a configurable time period</i>]
						</i></li></ul>].
				<div class="appnote"><span class="note-header">Application Note: </span><span class="note">
					The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author may select throttle requests, account lockout, or both.
				</span></div></div></div>
			<div class="element"><div class="reqid" id="FIA_HOTP_EXT.1.7"><a href="#FIA_HOTP_EXT.1.7" class="abbr">FIA_HOTP_EXT.1.7</a></div><div class="reqdesc">
					The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall not verify HOTP attempts outside of the counter look ahead window of 
					[<b>selection</b>: <i id="_s_96">a configurable value</i>, <i id="_s_97">[<b>assignment</b>: 
     <span class="assignable-content">a value less than or equal to 3</span>]</i>] for resynchronization.
				</div></div>
			<div class="element"><div class="reqid" id="FIA_HOTP_EXT.1.8"><a href="#FIA_HOTP_EXT.1.8" class="abbr">FIA_HOTP_EXT.1.8</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall increment the counter after each successful authentication.<div class="appnote"><span class="note-header">Application Note: </span><span class="note">
					The HOTP seed and all derived values are considered secret keys for purposes of protection.<p></p>
					This requirement must be claimed if "<i>verify the HOTP</i>" is selected in <a href="#FIA_PSK_EXT.4.2">FIA_PSK_EXT.4.2</a>.
				</span></div></div></div>
			
        <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"><a href="#FIA_HOTP_EXT.1">FIA_HOTP_EXT.1</a></div>
					
					
					
				<div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div>
						The evaluator shall confirm the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes how the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> complies with <a href="#bibRFC4226">[RFC 4226]</a>.<p></p>
						The evaluator shall confirm the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes how the HOTP seed is generated and ensure it 
							aligns with <a href="#FCS_RBG_EXT.1">FCS_RBG_EXT.1</a>.<p></p>
						The evaluator shall confirm the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes how the HOTP seed is protected and ensure it
							aligns with the storage requirements of the base <abbr class="dyn-abbr"><a href="#abbr_PP">PP</a></abbr>.<p></p>
						The evaluator shall confirm the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes how a new HOTP seed is assigned for each client
							and how each client is uniquely identified.<p></p>
						The evaluator shall confirm the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes how the HOTP seed is conditioned into a HOTP hash
							and verify it matches the selection in <a href="#FIA_HOTP_EXT.1.4">FIA_HOTP_EXT.1.4</a>.<p></p>
						The evaluator shall confirm the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes how the HOTP hash is truncated and verify it
							matches the selection in <a href="#FIA_HOTP_EXT.1.5">FIA_HOTP_EXT.1.5</a>.<p></p>
						The evaluator shall confirm the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes how the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> handles multiple incoming invalid 
							requests and verify it provides anti-hammer mechanism that match the selections 
							<a href="#FIA_HOTP_EXT.1.6">FIA_HOTP_EXT.1.6</a>.<p></p>
						The evaluator shall confirm the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes how the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> handles resynchronization and how it
							rejects attempts outside of the look-ahead window selected in <a href="#FIA_TOTP_EXT.1.7">FIA_TOTP_EXT.1.7</a>.<p></p>
						The evaluator shall confirm the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes how the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> how the counter is incremented after 
							each successful authentication.<p></p>
					<div class="eacategory">Guidance</div>
						The evaluator shall verify the operational guidance contains all configuration guidance for
						setting any administrative value that is configurable in the <a href="#FIA_HOTP_EXT.1">FIA_HOTP_EXT.1</a> requirements.
					<div class="eacategory">Tests</div>
						The evaluator shall configure the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> to use a supported HOTP factor then:
						<ul>
							<li><b>Test 1: </b>Attempt to establish a connection using a factor from a different client, the test 
								passes if the client fails to connect.</li>
							<li><b>Test 2: </b>Attempt multiple connections outside the boundary set in <a href="#FIA_HOTP_EXT.1.6">FIA_HOTP_EXT.1.6</a> and verify 
								the remediation is triggered.  The test passes if remediation is triggered as defined 
								in the selections and assignments.</li>
							<li><b>Test 3: </b>Attempt to use a HOTP that is outside of the value allowed with for resynchronization.
								The test passes if the client fails to connect.</li>
							<li><b>Test 4: </b>Attempt to connect with a valid HOTP, disconnect and attempt to authenticate again
								with the same HOTP value.  The test passes if the client connects the first time and 
								fails to connect the second time. If the HOTP generated is duplicated the test may be
								repeated.</li>
						</ul>
					</div></div></div><div class="comp" id="FIA_PSK_EXT.1"><h4>FIA_PSK_EXT.1 Pre-Shared Key Composition</h4><div class="statustag"><b><i>The inclusion of this selection-based component depends upon selection in
           <a href="#FCS_IPSEC_EXT.1.11">FCS_IPSEC_EXT.1.11</a>.
           </i></b></div>
			 
			
					
			<div class="element"><div class="reqid" id="FIA_PSK_EXT.1.1"><a href="#FIA_PSK_EXT.1.1" class="abbr">FIA_PSK_EXT.1.1</a></div><div class="reqdesc">
					The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall be capable of using pre-shared keys for establishing <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> connections. 
				</div></div>
			<div class="element"><div class="reqid" id="FIA_PSK_EXT.1.2"><a href="#FIA_PSK_EXT.1.2" class="abbr">FIA_PSK_EXT.1.2</a></div><div class="reqdesc">
					The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall be able to accept the following as pre-shared keys: 
					[<b>selection</b>: <i id="pskgen">Generated bit-based</i>, <i id="pskpw">Password-based</i>, <i id="pskhotp">HMAC based one time password</i>, <i id="psktotp">Time based one time password</i>, <i id="pskgenhotp">Combination of a generated bit-based and HMAC-based one-time password</i>, <i id="pskgentotp">Combination of a generated bit-based and time-based one-time password</i>, <i id="pskpwhotp">Combination of a password-based and HMAC-based one-time password</i>, <i id="pskpwtotp">Combination of a password-based and time-based one-time password</i>] keys.
				<div class="appnote"><span class="note-header">Application Note: </span><span class="note">
					If any selection including "<i>generated bit-based</i>" keys is selected, then <a href="#FIA_PSK_EXT.2">FIA_PSK_EXT.2</a> must be claimed.<p></p>
					If any selection including "<i>password-based</i>" keys is selected then <a href="#FIA_PSK_EXT.3">FIA_PSK_EXT.3</a> must be claimed. <p></p>
					If any selection including "<i>HMAC-based one-time password</i>" keys is selected then <a href="#FIA_PSK_EXT.4">FIA_PSK_EXT.4</a> must be claimed.<p></p> 
					If any selection including "<i>time-based one-time password</i>" is selected then <a href="#FIA_PSK_EXT.5">FIA_PSK_EXT.5</a> must be claimed.<p></p> 
					This requirement must be claimed if "<i>Pre-shared keys</i>" is selected in <a href="#FCS_IPSEC_EXT.1.11">FCS_IPSEC_EXT.1.11</a>.
				</span></div></div></div>
			
        <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"><a href="#FIA_PSK_EXT.1">FIA_PSK_EXT.1</a></div>
					    
					         
					
				<div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div>
						The evaluator shall examine the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> to ensure that it identifies that <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> connections may use
						pre-shared keys.  The evaluator shall confirm that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> states which pre-shared key selections 
						are supported. 
					<div class="eacategory">Guidance</div>
						The evaluator shall examine the operational guidance to determine that it provides guidance to 
						administrators on how to configure all selected pre-shared key options if any configuration is 
						required.
					<div class="eacategory">Tests</div>
						The evaluator shall also perform the following tests for each protocol (or instantiation of a 
						protocol, if performed by a different implementation on the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr>). 
						<ul>
							<li><b>Test 1: </b>
								For each mechanism selected in <a href="#FIA_PSK_EXT.1.2">FIA_PSK_EXT.1.2</a> the evaluator shall attempt to establish a 
								connection and confirm that the connection requires the selected factors in the <abbr class="dyn-abbr"><a href="#abbr_PSK">PSK</a></abbr> to 
								establish the connection. 
							</li>
						</ul>
					</div></div></div><div class="comp" id="FIA_PSK_EXT.2"><h4>FIA_PSK_EXT.2 Generated Pre-Shared Keys</h4><div class="statustag"><b><i>The inclusion of this selection-based component depends upon selection in
           <a href="#FIA_PSK_EXT.1.2">FIA_PSK_EXT.1.2</a>.
           </i></b></div>
			
			
			
			<div class="element"><div class="reqid" id="FIA_PSK_EXT.2.1"><a href="#FIA_PSK_EXT.2.1" class="abbr">FIA_PSK_EXT.2.1</a></div><div class="reqdesc">
					The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall be able to 
					[<b>selection</b>: <ul><li style=""><i id="_s_106">accept externally generated</i>, </li><li style=""><i id="_s_107">generate 
							[<b>selection</b>: <i id="_s_108">128</i>, <i id="_s_109">256</i>] bit-based pre-shared keys via <a href="#FCS_RBG_EXT.1">FCS_RBG_EXT.1</a>. 
						</i></li></ul>]
				<div class="appnote"><span class="note-header">Application Note: </span><span class="note">
					Generated PSKs are expected to be shared between components via an out of band mechanism. <p></p>            
					This requirement must be claimed if any selection in <a href="#FIA_PSK_EXT.1.2">FIA_PSK_EXT.1.2</a> includes "<i>generated bit-based</i>" keys.
				</span></div></div></div>
			
        <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"><a href="#FIA_PSK_EXT.2">FIA_PSK_EXT.2</a></div>
					
					
					
				<div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div>
						If "<i>generate</i>" is selected the evaluator shall confirm that this process uses the RBG specified
						in <a href="#FCS_RBG_EXT.1">FCS_RBG_EXT.1</a> and the output matches the size selected in <a href="#FIA_PSK_EXT.2.1">FIA_PSK_EXT.2.1</a>. <p></p>
					<div class="eacategory">Guidance</div>
						The evaluator shall confirm the operational guidance contains instructions for entering 
						generated pre-shared keys. 
					<div class="eacategory">Tests</div>
						<ul>
							<li><b>Test 1: </b>[conditional] If "<i>generate</i>" was selected the evaluator shall generate a
								pre-shared key and confirm the output matches the size selected in <a href="#FIA_PSK_EXT.2.1">FIA_PSK_EXT.2.1</a>.
							</li>
						</ul>
					</div></div></div><div class="comp" id="FIA_PSK_EXT.3"><h4>FIA_PSK_EXT.3 Password-Based Pre-Shared Keys</h4><div class="statustag"><b><i>The inclusion of this selection-based component depends upon selection in
           <a href="#FIA_PSK_EXT.1.2">FIA_PSK_EXT.1.2</a>.
           </i></b></div>
			
			
			
			<div class="element"><div class="reqid" id="FIA_PSK_EXT.3.1"><a href="#FIA_PSK_EXT.3.1" class="abbr">FIA_PSK_EXT.3.1</a></div><div class="reqdesc">
					The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall support a <abbr class="dyn-abbr"><a href="#abbr_PSK">PSK</a></abbr> of up to [<b>assignment</b>: 
     <span class="assignable-content">positive integer of 64 or more</span>] 
					characters. 
				<div class="appnote"><span class="note-header">Application Note: </span><span class="note">
					The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author assigns the maximum size of the <abbr class="dyn-abbr"><a href="#abbr_PSK">PSK</a></abbr> it supports; it must support at least 
					64 characters or a length defined by the platform. 
				</span></div></div></div>
			<div class="element"><div class="reqid" id="FIA_PSK_EXT.3.2"><a href="#FIA_PSK_EXT.3.2" class="abbr">FIA_PSK_EXT.3.2</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall allow PSKs to be composed of any combination of upper case characters, 
					lower case characters, numbers, and the following special characters: 
					"!", "@", "#", "$", "%", "^", "&amp;", "*", "(", and ")", and 
					[<b>selection</b>: <i id="_s_110">[<b>assignment</b>: 
     <span class="assignable-content">other supported special characters</span>]</i>, <i id="_s_111">no other characters</i>]
				<div class="appnote"><span class="note-header">Application Note: </span><span class="note">
					The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author assigns any other supported characters; if there are no other supported characters, 
					then "<i>no other characters</i>" should be selected. 
				</span></div></div></div>
			<div class="element"><div class="reqid" id="FIA_PSK_EXT.3.3"><a href="#FIA_PSK_EXT.3.3" class="abbr">FIA_PSK_EXT.3.3</a></div><div class="reqdesc">
					The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall perform Password-based Key Derivation Functions in accordance with a specified 
					cryptographic algorithm 
					[<b>selection</b>: <i id="_s_112">HMAC-SHA-256</i>, <i id="_s_113">HMAC-SHA-384</i>, <i id="_s_114">HMAC-SHA-512</i>], with 
					[<b>assignment</b>: 
     <span class="assignable-content">positive integer of 4096 or more</span>] iterations], and
					output cryptographic key sizes 
					[<b>selection</b>: <i id="_s_115">128</i>, <i id="_s_116">256</i>] that meet the following: <a href="#bibNIST800132">[NIST SP 800-132 Part 1]</a>.
				<div class="appnote"><span class="note-header">Application Note: </span><span class="note">
					The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author selects the parameters based on the PBKDF used by the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr>. 
				</span></div></div></div>
			<div class="element"><div class="reqid" id="FIA_PSK_EXT.3.4"><a href="#FIA_PSK_EXT.3.4" class="abbr">FIA_PSK_EXT.3.4</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall not accept PSKs less than 
					[<b>selection</b>: <i id="_s_117">a value settable by the administrator</i>, <i id="_s_118">[<b>assignment</b>: 
     <span class="assignable-content">minimum <abbr class="dyn-abbr"><a href="#abbr_PSK">PSK</a></abbr> length accepted by the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr>, must be &gt;= 6</span>]</i>] and greater than the maximum <abbr class="dyn-abbr"><a href="#abbr_PSK">PSK</a></abbr> length defined in <a href="#FIA_PSK_EXT.3.1">FIA_PSK_EXT.3.1</a>.
				<div class="appnote"><span class="note-header">Application Note: </span><span class="note">
					If the minimum length is settable, then <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author chooses "<i>a value settable by the administrator</i>".
					If the minimum length is not settable, the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author fills in the assignment with the minimum 
					length the <abbr class="dyn-abbr"><a href="#abbr_PSK">PSK</a></abbr> must be. This requirement is to ensure bounds work properly.
				</span></div></div></div>
			<div class="element"><div class="reqid" id="FIA_PSK_EXT.3.5"><a href="#FIA_PSK_EXT.3.5" class="abbr">FIA_PSK_EXT.3.5</a></div><div class="reqdesc">
					The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall generate all salts using an RBG that meets <a href="#FCS_RBG_EXT.1">FCS_RBG_EXT.1</a> and with entropy corresponding 
					to the key size selected for PBKDF in <a href="#FIA_PSK_EXT.3.3">FIA_PSK_EXT.3.3</a>.
				</div></div>
			<div class="element"><div class="reqid" id="FIA_PSK_EXT.3.6"><a href="#FIA_PSK_EXT.3.6" class="abbr">FIA_PSK_EXT.3.6</a></div><div class="reqdesc">
					The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall require the <abbr class="dyn-abbr"><a href="#abbr_PSK">PSK</a></abbr> to be entered before every initiated connection.
				</div></div>   
            <div class="element"><div class="reqid" id="FIA_PSK_EXT.3.7"><a href="#FIA_PSK_EXT.3.7" class="abbr">FIA_PSK_EXT.3.7</a></div><div class="reqdesc">
					The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall 
					[<b>selection</b>: <i id="_s_119">provide a password strength meter</i>, <i id="_s_120">check the password against a blacklist</i>, <i id="_s_121">perform no action to assist the user in choosing a strong password</i>]. 
				<div class="appnote"><span class="note-header">Application Note: </span><span class="note">
                    For <a href="#FIA_PSK_EXT.3.7">FIA_PSK_EXT.3.7</a>, the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author may select one, both, or neither of the functions in alignment
					with <a href="#bibNIST80063b">[NIST SP 800-63B]</a>.<p></p>
					This requirement is selection dependent on <a href="#FIA_PSK_EXT.1">FIA_PSK_EXT.1</a>. 
				</span></div></div></div>
			
        <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"><a href="#FIA_PSK_EXT.3">FIA_PSK_EXT.3</a></div>
					
					
					
				<div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div>
						The evaluator shall examine the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> to ensure it describes the process by which the bit-based
						pre-shared keys used. If generated is selected the evaluator shall confirm that this process
						uses the RBG specified in <a href="#FCS_RBG_EXT.1">FCS_RBG_EXT.1</a>. <p></p>
						Support for length: The evaluators shall check to ensure that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes the allowable 
						ranges for <abbr class="dyn-abbr"><a href="#abbr_PSK">PSK</a></abbr> lengths, and that at least 64 characters or a length defined by the platform may
						be specified by the user.<p></p>
						Support for character set: The evaluator shall check to ensure that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes the
						allowable character set and that it contains the characters listed in the <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr>.<p></p>
						Support for PBKDF: The evaluator shall examine the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> to ensure that the use of PBKDF2 is 
						described and that the key sizes match that described by the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author.<p></p>
						The evaluator shall check that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes the method by which the <abbr class="dyn-abbr"><a href="#abbr_PSK">PSK</a></abbr> is first encoded
						and then fed to the hash algorithm. The settings for the algorithm (padding, blocking, etc.)
						shall be described, and the evaluator shall verify that these are supported by the selections 
						in this component as well as the selections concerning the hash function itself. <p></p>
						For the NIST SP 800-132-based conditioning of the <abbr class="dyn-abbr"><a href="#abbr_PSK">PSK</a></abbr>, the required evaluation activities will 
						be performed when doing the evaluation activities for the appropriate requirements
						(e.g., <a href="#FCS_COP.1">FCS_COP.1</a>/KeyedHash). <p></p>
						The evaluator shall confirm that the minimum length is described.<p></p>
						The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author shall provide a description in the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> regarding the salt generation. The
						evaluator shall confirm that the salt is generated using an RBG described in <a href="#FCS_RBG_EXT.1">FCS_RBG_EXT.1</a>.<p></p>
						[conditional] If "<i>password strength meter</i>" or "<i>password blacklist</i>" is
						selected, the evaluator shall examine the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> to ensure any password checking functionality
						provided by the <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> is described and contains details on how the function operates.<p></p>
					<div class="eacategory">Guidance</div>
						The evaluator shall confirm the operational guidance contains instructions for entering 
						bit-based pre-shared keys for each protocol identified in the requirement, or generating a 
						bit-based pre-shared key (or both). The evaluator shall confirm that any configuration
						management functions related to pre-shared keys that are performed by the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> are specified 
						in the operational guidance.  <p></p>
						The guidance must specify the allowable characters for pre-shared keys, and that list must
						include, at minimum, the same items contained in <a href="#FIA_PSK_EXT.3.2">FIA_PSK_EXT.3.2</a>. <p></p>
						The evaluator shall confirm the operational guidance contains any necessary instructions for 
						enabling and configurating password checking functionality. <p></p>
					<div class="eacategory">Tests</div>
						Support for Password/Passphrase characteristics: In addition to the analysis above, the 
						evaluator shall also perform the following tests on a <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> configured according to the
						Operational Guidance:
						<ul>
							<li><b>Test 1: </b>The evaluator shall compose a pre-shared key of at least 64 characters that contains
								a combination of the allowed characters in accordance with the <a href="#FIA_PSK_EXT.1">FIA_PSK_EXT.1</a>.3 and
								verify that a successful protocol negotiation can be performed with the key. </li>
							<li><b>Test 2: </b>[conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> supports pre-shared keys of multiple lengths, the evaluator
								shall repeat Test 1 using the minimum length and invalid lengths that are below the 
								minimum length, above the maximum length, null length, empty length, or zero length. 
								The minimum test should be successful, and the invalid lengths must be rejected by the
								<abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr>. </li>
							<li><b>Test 3: </b>[conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> initiates connections, initiate and establish a remote
								connection, disconnect from the connection, verify that the <abbr class="dyn-abbr"><a href="#abbr_PSK">PSK</a></abbr> is required when 
								initiating the connection a second time.</li>
							<li><b>Test 4: </b>[conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> supports a password meter, the evaluator shall enter a
								password and verify the password checker responds per the description in the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr>.</li>
							<li><b>Test 5: </b>[conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> supports a password blacklist, the evaluator shall enter
								a blacklisted password and verify that the password is rejected or flagged as such.</li>
						</ul>
					</div></div></div><div class="comp" id="FIA_PSK_EXT.4"><h4>FIA_PSK_EXT.4 HMAC-Based One-Time Password Pre-shared Keys Support</h4><div class="statustag"><b><i>The inclusion of this selection-based component depends upon selection in
           <a href="#FIA_PSK_EXT.1.2">FIA_PSK_EXT.1.2</a>.
           </i></b></div>
			
			
			
			<div class="element"><div class="reqid" id="FIA_PSK_EXT.4.1"><a href="#FIA_PSK_EXT.4.1" class="abbr">FIA_PSK_EXT.4.1</a></div><div class="reqdesc">
					The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall accept and send a HOTP while initiating an <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> connection.
				</div></div>
			<div class="element"><div class="reqid" id="FIA_PSK_EXT.4.2"><a href="#FIA_PSK_EXT.4.2" class="abbr">FIA_PSK_EXT.4.2</a></div><div class="reqdesc"> The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall 
					[<b>selection</b><b>, choose one of</b>: <i id="sel-verify-hotp">verify the HOTP</i>, <i id="_s_123">verify the HOTP via an external authentication server</i>] before establishing an incoming connection.
				<div class="appnote"><span class="note-header">Application Note: </span><span class="note">
					If "<i>verify the HOTP</i>" is selected, then <a href="#FIA_HOTP_EXT.1">FIA_HOTP_EXT.1</a> must be included.<p></p>       
					This requirement must be claimed if "<i>HMAC-based one-time password</i>" is included in a selection
					in <a href="#FIA_PSK_EXT.1.2">FIA_PSK_EXT.1.2</a>.
				</span></div></div></div>
			
        <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"><a href="#FIA_PSK_EXT.4">FIA_PSK_EXT.4</a></div>
					
					
					
				<div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div>
						The evaluator shall verify the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes how the HOTP is input into the client and how that
						value is sent to the server.<p></p>
						The evaluator shall verify the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes how the HOTP is accepted from an incoming 
						connection and how that value is verified, either by the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> or by an external authentication 
						server.<p></p>
					<div class="eacategory">Guidance</div>
						The evaluator shall verify the operational guidance contains any configuration necessary to
						enable HOTP.<p></p>
					<div class="eacategory">Tests</div>
						<ul>
							<li><b>Test 1: </b>The evaluator shall configure the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> to use a supported HOTP factor, then attempt to
								establish a connection using that factor.</li>
							<li><b>Test 2: </b>The evaluator shall verify the client prompts the user for the HOTP before initiating
								the connection.  </li>
							<li><b>Test 3: </b>The evaluator shall verify the server validates the HOTP or receives confirmation 
								from an authentication server before establishing the channel.</li>
						</ul>
					</div></div></div><div class="comp" id="FIA_PSK_EXT.5"><h4>FIA_PSK_EXT.5 Time Based One Time Password Pre-shared Keys Support</h4><div class="statustag"><b><i>The inclusion of this selection-based component depends upon selection in
           <a href="#FIA_PSK_EXT.1.2">FIA_PSK_EXT.1.2</a>.
           </i></b></div>
			
			
			
			<div class="element"><div class="reqid" id="FIA_PSK_EXT.5.1"><a href="#FIA_PSK_EXT.5.1" class="abbr">FIA_PSK_EXT.5.1</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall accept and send a TOTP while initiating an <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> connection.</div></div>
			<div class="element"><div class="reqid" id="FIA_PSK_EXT.5.2"><a href="#FIA_PSK_EXT.5.2" class="abbr">FIA_PSK_EXT.5.2</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall 
					[<b>selection</b><b>, choose one of</b>: <i id="sel-psk5-ext-e2-verify">verify the TOTP</i>, <i id="_s_125">verify the TOTP via an external authentication server</i>] before establishing an incoming connection.
				<div class="appnote"><span class="note-header">Application Note: </span><span class="note">
					If "<i>verify the TOTP</i>" is selected then <a href="#FIA_TOTP_EXT.1">FIA_TOTP_EXT.1</a> must be claimed.<p></p>
					This requirement must be claimed if "<i>Time-based one-time password</i>" is included in a selection
					in <a href="#FIA_PSK_EXT.1.2">FIA_PSK_EXT.1.2</a>.
				</span></div></div></div>
			
        <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"><a href="#FIA_PSK_EXT.5">FIA_PSK_EXT.5</a></div>
					
					
					
				<div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div>
						The evaluator shall verify the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes how the TOTP is input into the client and how that
						value is sent to the server.<p></p>
						The evaluator shall verify the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes how the TOTP is accepted from an incoming
						connection and how that value is verified, either by the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> or by an external authentication
						server.<p></p>
					<div class="eacategory">Guidance</div>
						The evaluator shall verify the operational guidance contains any configuration necessary to
						enable TOTP.
					<div class="eacategory">Tests</div>
						<ul>
							<li><b>Test 1: </b>The evaluator shall configure the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> to use a supported TOTP factor, then attempt
								to establish a connection using that factor.  </li>
							<li><b>Test 2: </b>The evaluator shall verify the client prompts the user for the TOTP before initiating
								the connection.  </li>
							<li><b>Test 3: </b>The evaluator shall verify the server validates the TOTP or receives confirmation 
								from an authentication server before establishing the channel.</li>
						</ul>
					</div></div></div><div class="comp" id="FIA_TOTP_EXT.1"><h4>FIA_TOTP_EXT.1 Time-Based One-Time Password Pre-Shared Keys</h4><div class="statustag"><b><i>The inclusion of this selection-based component depends upon selection in
           <a href="#FIA_PSK_EXT.5.2">FIA_PSK_EXT.5.2</a>.
           </i></b></div>
			
			<div class="element"><div class="reqid" id="FIA_TOTP_EXT.1.1"><a href="#FIA_TOTP_EXT.1.1" class="abbr">FIA_TOTP_EXT.1.1</a></div><div class="reqdesc">
					The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall support Time-Based One-Time Password (TOTP) authentication in accordance 
					with <a href="#bibRFC6238">[RFC 6238]</a> to authenticate the user before establishing an <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> connection. 
				</div></div>
			<div class="element"><div class="reqid" id="FIA_TOTP_EXT.1.2"><a href="#FIA_TOTP_EXT.1.2" class="abbr">FIA_TOTP_EXT.1.2</a></div><div class="reqdesc">
					The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall generate a TOTP seed according to <a href="#FCS_RBG_EXT.1">FCS_RBG_EXT.1</a> of 
					[<b>selection</b>: <i id="_s_126">128</i>, <i id="_s_127">256</i>] bits.
				</div></div>
			<div class="element"><div class="reqid" id="FIA_TOTP_EXT.1.3"><a href="#FIA_TOTP_EXT.1.3" class="abbr">FIA_TOTP_EXT.1.3</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall generate a new TOTP seed for each <abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr> connection.</div></div>
			<div class="element"><div class="reqid" id="FIA_TOTP_EXT.1.4"><a href="#FIA_TOTP_EXT.1.4" class="abbr">FIA_TOTP_EXT.1.4</a></div><div class="reqdesc">
					The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall utilize 
					[<b>selection</b>: <i id="_s_128">HMAC-SHA-1</i>, <i id="_s_129">HMAC-SHA-256</i>, <i id="_s_130">HMAC-SHA-384</i>, <i id="_s_131">HMAC-SHA-512</i>] with key sizes 
					[<b>assignment</b>: 
     <span class="assignable-content">key size (in bits) used in HMAC</span>] 
					to derive a TOTP hash from the TOTP seed and current time provided by NTP.
				<div class="appnote"><span class="note-header">Application Note: </span><span class="note">
					The selection must be consistent with the key sizes permitted by the relevant iteraton of <a href="#FCS_COP.1">FCS_COP.1</a>.
				</span></div></div></div>
			<div class="element"><div class="reqid" id="FIA_TOTP_EXT.1.5"><a href="#FIA_TOTP_EXT.1.5" class="abbr">FIA_TOTP_EXT.1.5</a></div><div class="reqdesc">
					The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall truncate the TOTP hash per <a href="#FIA_TOTP_EXT.1.4">FIA_TOTP_EXT.1.4</a> to create a TOTP of  
					[<b>selection</b>: <ul><li style=""><i id="_s_132">administrator configurable character length of at least 6</i>, </li><li style=""><i id="_s_133">preset character length of
							[<b>selection</b><b>, choose one of</b>: <i id="_s_134">6</i>, <i id="_s_135">7</i>, <i id="_s_136">8</i>, <i id="_s_137">9</i>, <i id="_s_138">10</i>]
						</i></li></ul>].
				<div class="appnote"><span class="note-header">Application Note: </span><span class="note">
				    The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> author may either provide a configurable character length of at least 6 or a preset 
					size between 6 and 10.
				</span></div></div></div>
			<div class="element"><div class="reqid" id="FIA_TOTP_EXT.1.6"><a href="#FIA_TOTP_EXT.1.6" class="abbr">FIA_TOTP_EXT.1.6</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall
					[<b>selection</b>: <ul><li style=""><i id="_s_139">throttle invalid requests to 
							[<b>selection</b>: <i id="_s_140">administrator configurable value</i>, <i id="_s_141">[<b>assignment</b>: 
     <span class="assignable-content">value less than 10</span>]</i>] per minute</i>, </li><li style=""><i id="_s_142">lock the associated account after 
							[<b>selection</b>: <i id="_s_143">administrator configurable value</i>, <i id="_s_144">[<b>assignment</b>: 
     <span class="assignable-content">value less than 10</span>]</i>] failed attempts until 
							[<b>selection</b>: <i id="_s_145">an administrator unlocks the account</i>, <i id="_s_146">a configurable time period</i>]
						</i></li></ul>].
				<div class="appnote"><span class="note-header">Application Note: </span><span class="note">
				    The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> may select throttle requests, account lockout, or both.
				</span></div></div></div>
			<div class="element"><div class="reqid" id="FIA_TOTP_EXT.1.7"><a href="#FIA_TOTP_EXT.1.7" class="abbr">FIA_TOTP_EXT.1.7</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall set a time-step size of 
					[<b>selection</b>: <i id="_s_147">a configurable value</i>, <i id="_s_148">[<b>assignment</b>: 
     <span class="assignable-content">a value less than or equal to 30</span>]</i>] seconds.
				</div></div>
			<div class="element"><div class="reqid" id="FIA_TOTP_EXT.1.8"><a href="#FIA_TOTP_EXT.1.8" class="abbr">FIA_TOTP_EXT.1.8</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall not validate a drift of more than 
					[<b>selection</b>: <i id="_s_149">a configurable value</i>, <i id="_s_150">[<b>assignment</b>: 
     <span class="assignable-content">a value less than or equal to 3</span>]</i>] time-steps.            
				</div></div>
			<div class="element"><div class="reqid" id="FIA_TOTP_EXT.1.9"><a href="#FIA_TOTP_EXT.1.9" class="abbr">FIA_TOTP_EXT.1.9</a></div><div class="reqdesc">The <abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> shall 
					[<b>selection</b><b>, choose one of</b>: <i id="_s_151">allow resynchronization by recording time drift within the limit of FIA_TOTP_EXT.2.8</i>, <i id="_s_152">not permit resynchronization</i>].           
				<div class="appnote"><span class="note-header">Application Note: </span><span class="note">
					The TOTP seed and all derived values are considered secret keys for purposes of protection.<p></p>
					This requirement must be claimed if "verify the TOTP" is selected in FCS_PSK_EXT.5.2.
				</span></div></div></div>
			
        <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"><a href="#FIA_TOTP_EXT.1">FIA_TOTP_EXT.1</a></div>
					
					
					
				<div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div>
						The evaluator shall confirm the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes how the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> complies with <a href="#bibRFC6238">[RFC 6238]</a><p></p>.
						The evaluator shall confirm the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes how the TOTP seed is generated and ensure it
							aligns with <a href="#FCS_RBG_EXT.1">FCS_RBG_EXT.1</a>.<p></p>
						The evaluator shall confirm the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes how the TOTP seed is protected and ensure it
							aligns with the storage requirements of the base <abbr class="dyn-abbr"><a href="#abbr_PP">PP</a></abbr>. <p></p>
						The evaluator shall confirm the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes how a new TOTP seed is assigned for each client
							and how each client is uniquely identified.<p></p>
						The evaluator shall confirm the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes how the TOTP seed is conditioned into a TOTP
							hash and verify it matches the selection in <a href="#FIA_TOTP_EXT.1.4">FIA_TOTP_EXT.1.4</a>.<p></p>
						The evaluator shall confirm the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes how the TOTP hash is truncated and verify it
							matches the selection in <a href="#FIA_TOTP_EXT.1.5">FIA_TOTP_EXT.1.5</a>.<p></p>
						The evaluator shall confirm the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes how the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> handles multiple incoming requests
							and verify it provides anti-hammer mechanism that matches the selections FIA_TOTP_EXT.2.6.<p></p>
						The evaluator shall confirm the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes how the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> sets a time-step value and verify it
							matches the selections in the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr>.<p></p>
						The evaluator shall confirm the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes how the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> handles drift and resynchronization
							and verify it matches the selections.  The evaluator shall ensure the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes how 
							time is kept and drift is calculated.  If drift is recorded the evaluator shall ensure the 
							<abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> how this is done.<p></p>
					<div class="eacategory">Guidance</div>
						The evaluator shall verify the operational guidance contains all configuration guidance for
						setting any administrative value that is configurable in the <a href="#FIA_TOTP_EXT.1">FIA_TOTP_EXT.1</a> requirements.
					<div class="eacategory">Tests</div>
						The evaluator shall configure the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> to use a supported TOTP factor then:
						<ul>
							<li><b>Test 1: </b>Attempt to establish a connection using a factor from a different client, the test
								passes if the client fails to connect.</li>
							<li><b>Test 2: </b>Attempt multiple connections outside the boundary set in <a href="#FIA_TOTP_EXT.1.6">FIA_TOTP_EXT.1.6</a> and verify
								the remediation is triggered.  The test passes if remediation is triggered as defined in
								the selections and assignments.</li>
							<li><b>Test 3: </b>Attempt to use a TOTP that is outside of the value allowed with for resynchronization.
								The test passes if the client fails to connect.</li>
							<li><b>Test 4: </b>Attempt to connect with a valid TOTP, disconnect and attempt to authenticate again 
								with the same TOTP.  The test passes if the client connects the first time and fails to
								connect the second time. If the TOTP generated is duplicated the test may be repeated.</li>
						</ul>
					</div></div></div><h1 id="use-case-appendix" class="indexable" data-level="A">Appendix C -  Use Case Templates</h1><h2 id="appendix-uc-ipsec-endpoint" class="indexable" data-level="2">C.1 IPsec Endpoint</h2>
		The configuration for <i><a href="#uc-ipsec-endpoint" class="dynref">[USE CASE 1] IPsec Endpoint</a></i> modifies
		the base requirements as follows:<br/>
					<div class="uc_inc_fcomp">Include <a href="#FCS_IPSEC_EXT.1">FCS_IPSEC_EXT.1</a> in the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> </div>
				<h2 id="appendix-uc-EAP" class="indexable" data-level="2">C.2 EAP</h2>
		The configuration for <i><a href="#uc-EAP" class="dynref">[USE CASE 2] EAP</a></i> modifies
		the base requirements as follows:<br/>
					
				<h2 id="appendix-uc-pre-shared-keys" class="indexable" data-level="2">C.3 Pre-Shared Keys</h2>
		The configuration for <i><a href="#uc-pre-shared-keys" class="dynref">[USE CASE 3] Pre-Shared Keys</a></i> modifies
		the base requirements as follows:<br/>
					<div class="uc_inc_fcomp">Include <a href="#FIA_PSK_EXT.1">FIA_PSK_EXT.1</a> in the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> </div>
				<h1 id="acronyms" class="indexable" data-level="A">Appendix D -  Acronyms</h1><table><tr class="header"><th>Acronym</th><th>Meaning</th></tr><tr><td><span class="term" id="abbr_Base-PP"><abbr class="dyn-abbr"><a href="#abbr_Base-PP">Base-PP</a></abbr></span></td><td><span id="long_abbr_Base-PP">Base Protection Profile</span></td></tr>
<tr><td><span class="term" id="abbr_CA"><abbr class="dyn-abbr"><a href="#abbr_CA">CA</a></abbr></span></td><td><span id="long_abbr_CA">Certificate Authority</span></td></tr>
<tr><td><span class="term" id="abbr_CC"><abbr class="dyn-abbr"><a href="#abbr_CC">CC</a></abbr></span></td><td><span id="long_abbr_CC">Common Criteria</span></td></tr>
<tr><td><span class="term" id="abbr_CEM"><abbr class="dyn-abbr"><a href="#abbr_CEM">CEM</a></abbr></span></td><td><span id="long_abbr_CEM">Common Evaluation Methodology</span></td></tr>
<tr><td><span class="term" id="abbr_CSR"><abbr class="dyn-abbr"><a href="#abbr_CSR">CSR</a></abbr></span></td><td><span id="long_abbr_CSR">Certificate Signing Request</span></td></tr>
<tr><td><span class="term" id="abbr_DN"><abbr class="dyn-abbr"><a href="#abbr_DN">DN</a></abbr></span></td><td><span id="long_abbr_DN">Distinguished Name</span></td></tr>
<tr><td><span class="term" id="abbr_EAP"><abbr class="dyn-abbr"><a href="#abbr_EAP">EAP</a></abbr></span></td><td><span id="long_abbr_EAP">Extensible Authentication Protocol</span></td></tr>
<tr><td><span class="term" id="abbr_ECP"><abbr class="dyn-abbr"><a href="#abbr_ECP">ECP</a></abbr></span></td><td><span id="long_abbr_ECP">Eliptic Curve group modulo a Prime</span></td></tr>
<tr><td><span class="term" id="abbr_EP"><abbr class="dyn-abbr"><a href="#abbr_EP">EP</a></abbr></span></td><td><span id="long_abbr_EP">Extended Package</span></td></tr>
<tr><td><span class="term" id="abbr_ESN"><abbr class="dyn-abbr"><a href="#abbr_ESN">ESN</a></abbr></span></td><td><span id="long_abbr_ESN">Extended Sequence Number</span></td></tr>
<tr><td><span class="term" id="abbr_ESP"><abbr class="dyn-abbr"><a href="#abbr_ESP">ESP</a></abbr></span></td><td><span id="long_abbr_ESP">Encapsulating Security Payload</span></td></tr>
<tr><td><span class="term" id="abbr_FP"><abbr class="dyn-abbr"><a href="#abbr_FP">FP</a></abbr></span></td><td><span id="long_abbr_FP">Functional Package</span></td></tr>
<tr><td><span class="term" id="abbr_FQDN"><abbr class="dyn-abbr"><a href="#abbr_FQDN">FQDN</a></abbr></span></td><td><span id="long_abbr_FQDN">Fully Qualified Domain Name</span></td></tr>
<tr><td><span class="term" id="abbr_ICMP"><abbr class="dyn-abbr"><a href="#abbr_ICMP">ICMP</a></abbr></span></td><td><span id="long_abbr_ICMP">Internet Control Message Protocol</span></td></tr>
<tr><td><span class="term" id="abbr_IKE"><abbr class="dyn-abbr"><a href="#abbr_IKE">IKE</a></abbr></span></td><td><span id="long_abbr_IKE">Internet Key Exchange</span></td></tr>
<tr><td><span class="term" id="abbr_IPsec"><abbr class="dyn-abbr"><a href="#abbr_IPsec">IPsec</a></abbr></span></td><td><span id="long_abbr_IPsec">Internet Protocol Security</span></td></tr>
<tr><td><span class="term" id="abbr_ISAKMP"><abbr class="dyn-abbr"><a href="#abbr_ISAKMP">ISAKMP</a></abbr></span></td><td><span id="long_abbr_ISAKMP">Internet Security Association and Key Management Protocol</span></td></tr>
<tr><td><span class="term" id="abbr_OCSP"><abbr class="dyn-abbr"><a href="#abbr_OCSP">OCSP</a></abbr></span></td><td><span id="long_abbr_OCSP">Online Certificate Status Protocol</span></td></tr>
<tr><td><span class="term" id="abbr_OE"><abbr class="dyn-abbr"><a href="#abbr_OE">OE</a></abbr></span></td><td><span id="long_abbr_OE">Operational Environment</span></td></tr>
<tr><td><span class="term" id="abbr_PP"><abbr class="dyn-abbr"><a href="#abbr_PP">PP</a></abbr></span></td><td><span id="long_abbr_PP">Protection Profile</span></td></tr>
<tr><td><span class="term" id="abbr_PP-Configuration"><abbr class="dyn-abbr"><a href="#abbr_PP-Configuration">PP-Configuration</a></abbr></span></td><td><span id="long_abbr_PP-Configuration">Protection Profile Configuration</span></td></tr>
<tr><td><span class="term" id="abbr_PP-Module"><abbr class="dyn-abbr"><a href="#abbr_PP-Module">PP-Module</a></abbr></span></td><td><span id="long_abbr_PP-Module">Protection Profile Module</span></td></tr>
<tr><td><span class="term" id="abbr_PSK"><abbr class="dyn-abbr"><a href="#abbr_PSK">PSK</a></abbr></span></td><td><span id="long_abbr_PSK">Pre-Shared Key</span></td></tr>
<tr><td><span class="term" id="abbr_SA"><abbr class="dyn-abbr"><a href="#abbr_SA">SA</a></abbr></span></td><td><span id="long_abbr_SA">Security Association</span></td></tr>
<tr><td><span class="term" id="abbr_SAR"><abbr class="dyn-abbr"><a href="#abbr_SAR">SAR</a></abbr></span></td><td><span id="long_abbr_SAR">Security Assurance Requirement</span></td></tr>
<tr><td><span class="term" id="abbr_SFR"><abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr></span></td><td><span id="long_abbr_SFR">Security Functional Requirement</span></td></tr>
<tr><td><span class="term" id="abbr_SPD"><abbr class="dyn-abbr"><a href="#abbr_SPD">SPD</a></abbr></span></td><td><span id="long_abbr_SPD">Security Policy Database</span></td></tr>
<tr><td><span class="term" id="abbr_ST"><abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr></span></td><td><span id="long_abbr_ST">Security Target</span></td></tr>
<tr><td><span class="term" id="abbr_TOE"><abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr></span></td><td><span id="long_abbr_TOE">Target of Evaluation</span></td></tr>
<tr><td><span class="term" id="abbr_TSF"><abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr></span></td><td><span id="long_abbr_TSF"><abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> Security Functionality</span></td></tr>
<tr><td><span class="term" id="abbr_TSFI" data-plural="TSFIs"><abbr class="dyn-abbr"><a href="#abbr_TSFI">TSFI</a></abbr></span></td><td><span id="long_abbr_TSFI"><abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> Interface</span></td></tr>
<tr><td><span class="term" id="abbr_TSS"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></span></td><td><span id="long_abbr_TSS"><abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> Summary Specification</span></td></tr>
<tr><td><span class="term" id="abbr_UDP"><abbr class="dyn-abbr"><a href="#abbr_UDP">UDP</a></abbr></span></td><td><span id="long_abbr_UDP">User Datagram Protocol</span></td></tr>
<tr><td><span class="term" id="abbr_VPN"><abbr class="dyn-abbr"><a href="#abbr_VPN">VPN</a></abbr></span></td><td><span id="long_abbr_VPN">Virtual Private Network</span></td></tr>
<tr><td><span class="term" id="abbr_XAUTH"><abbr class="dyn-abbr"><a href="#abbr_XAUTH">XAUTH</a></abbr></span></td><td><span id="long_abbr_XAUTH">Extended Authentication</span></td></tr>
<tr><td><span class="term" id="abbr_cPP" data-plural="cPPs"><abbr class="dyn-abbr"><a href="#abbr_cPP">cPP</a></abbr></span></td><td><span id="long_abbr_cPP">Collaborative Protection Profile</span></td></tr>
</table><h1 id="appendix-bibliography" class="indexable" data-level="A">Appendix E -  Bibliography</h1><table><tr class="header"><th>Identifier</th><th>Title</th></tr><tr><td><span id="bibNIAPFPTLS">[Functional Package for TLS]</span></td><td>
				<a href="https://www.niap-ccevs.org/Profile/Info.cfm?id=439">
					Functional Package for Transport Layer Security (TLS)</a>
			</td></tr><tr><td><span id="bibNIST800132">[NIST SP 800-132 Part 1]</span></td><td>
				<a href="https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-132.pdf">
				Recommendation for Password-Based Key Derivation Part 1: Storage Applications</a>
			</td></tr><tr><td><span id="bibNIST80057">[NIST SP 800-57 Part 1 Rev. 5]</span></td><td>
				<a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf">
					Recommendation for Key Management: Part 1 - General</a>
			</td></tr><tr><td><span id="bibNIST80063b">[NIST SP 800-63B]</span></td><td>
				<a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-63b.pdf">
					Digital Identity Guidelines: Authentication and Lifecycle Management</a>
			</td></tr><tr><td><span id="bibRFC2407">[RFC 2407]</span></td><td>
				<a href="https://tools.ietf.org/html/rfc2407">The Internet IP Security Domain of Interpretation for ISAKMP</a>
			</td></tr><tr><td><span id="bibRFC2408">[RFC 2408]</span></td><td>
				<a href="https://tools.ietf.org/html/rfc2408">Internet Security Association and Key Management Protocol (ISAKMP)</a>
			</td></tr><tr><td><span id="bibRFC2409">[RFC 2409]</span></td><td>
				<a href="https://tools.ietf.org/html/rfc2409">The Internet Key Exchange (IKE)</a>
			</td></tr><tr><td><span id="bibRFC3602">[RFC 3602]</span></td><td>
				<a href="https://tools.ietf.org/html/rfc3602">The AES-CBC Cipher Algorithm and Its Use with IPsec</a>
			</td></tr><tr><td><span id="bibRFC4106">[RFC 4106]</span></td><td>
				<a href="https://tools.ietf.org/html/rfc4106">The Use of Galois/Counter Mode (GCM)
					in IPsec Encapsulating Security Payload (ESP)</a>
			</td></tr><tr><td><span id="bibRFC4109">[RFC 4109]</span></td><td>
				<a href="https://tools.ietf.org/html/rfc4109">Algorithms for Internet Key Exchange version 1 (IKEv1)</a>
			</td></tr><tr><td><span id="bibRFC4226">[RFC 4226]</span></td><td>
				<a href="https://tools.ietf.org/html/rfc4226">HOTP: An HMAC-Based One-Time Password Algorithm</a>
			</td></tr><tr><td><span id="bibRFC4301">[RFC 4301]</span></td><td>
				<a href="https://tools.ietf.org/html/rfc4301">Security Architecture for the Internet Protocol</a>
			</td></tr><tr><td><span id="bibRFC4303">[RFC 4303]</span></td><td>
				<a href="https://tools.ietf.org/html/rfc4303">IP Encapsulating Security Payload (ESP)</a>
			</td></tr><tr><td><span id="bibRFC4304">[RFC 4304]</span></td><td>
				<a href="https://tools.ietf.org/html/rfc4304">Extended Sequence Number (ESN) Addendum to
					IPsec Domain of Interpretation (DOI) for Internet Security Association
					and Key Management Protocol (ISAKMP)</a>
			</td></tr><tr><td><span id="bibRFC4868">[RFC 4868]</span></td><td>
				<a href="https://tools.ietf.org/html/rfc4868">Using HMAC-SHA-256, HMAC-SHA-384, and HMAC-SHA-512 with IPsec</a>
			</td></tr><tr><td><span id="bibRFC4945">[RFC 4945]</span></td><td>
				<a href="https://tools.ietf.org/html/rfc4945">The Internet IP Security PKI Profile of IKEv1/ISAKMP, IKEv2, and PKIX</a>
			</td></tr><tr><td><span id="bibRFC5216">[RFC 5216]</span></td><td>
				<a href="https://tools.ietf.org/html/rfc5216">The EAP-TLS Authentication Protocol</a>
			</td></tr><tr><td><span id="bibRFC5281">[RFC 5281]</span></td><td>
				<a href="https://tools.ietf.org/html/rfc5281">Extensible Authentication Protocol Tunneled Transport
					Layer Security Authenticated Protocol Version 0 (EAP-TTLSv0)</a>
			</td></tr><tr><td><span id="bibRFC5282">[RFC 5282]</span></td><td>
				<a href="https://tools.ietf.org/html/rfc5282">Using Authenticated Encryption Algorithms with the 
					Encrypted Payload of the Internet Key Exchange version 2 (IKEv2) Protocol</a>
			</td></tr><tr><td><span id="bibRFC6238">[RFC 6238]</span></td><td>
				<a href="https://tools.ietf.org/html/rfc6238">TOTP: Time-Based One-Time Password Algorithm</a>
			</td></tr><tr><td><span id="bibRFC6379">[RFC 6379]</span></td><td>
				<a href="https://tools.ietf.org/html/rfc6379">Suite B Cryptographic Suites for IPsec</a>
			</td></tr><tr><td><span id="bibRFC7296">[RFC 7296]</span></td><td>
				<a href="https://tools.ietf.org/html/rfc7296">Internet Key Exchange Protocol Version 2 (IKEv2)</a>
			</td></tr><tr><td><span id="bibRFC8247">[RFC 8247]</span></td><td>
				<a href="https://tools.ietf.org/html/rfc8247">Algorithm Implementation Requirements and Usage Guidance
					for the Internet Key Exchange Protocol Version 2 (IKEv2)</a>
			</td></tr><tr><td><span id="bibRFC8784">[RFC 8784]</span></td><td>
				<a href="https://tools.ietf.org/html/rfc8784">Mixing Preshared Keys in the Internet Key Exchange Protocol Version 2
					(IKEv2) for Post-quantum Security</a>
			</td></tr><tr><td><span id="bibRFC8996">[RFC 8996]</span></td><td>
				<a href="https://tools.ietf.org/html/rfc8996">Deprecating TLS 1.0 and TLS 1.1</a>
			</td></tr><tr><td><span id="bibCC">[<abbr class="dyn-abbr"><a href="#abbr_CC">CC</a></abbr>]</span></td><td>Common Criteria for Information Technology Security Evaluation - <ul>
            <li><a href="http://www.commoncriteriaportal.org/files/ccfiles/CCPART1V3.1R5.pdf">Part
                1: Introduction and General Model</a>, CCMB-2017-04-001, Version 3.1 Revision 5,
              April 2017.</li>
            <li><a href="http://www.commoncriteriaportal.org/files/ccfiles/CCPART2V3.1R5.pdf">Part
                2: Security Functional Components</a>, CCMB-2017-04-002, Version 3.1 Revision 5,
              April 2017.</li>
            <li><a href="http://www.commoncriteriaportal.org/files/ccfiles/CCPART3V3.1R5.pdf">Part
                3: Security Assurance Components</a>, CCMB-2017-04-003, Version 3.1 Revision 5,
              April 2017.</li>
          </ul></td></tr></table></body></html>