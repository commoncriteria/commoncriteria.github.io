<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html><head><title></title><script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script><script type='text/x-mathjax-config'>
            MathJax.Hub.Config({
            extensions: ["tex2jax.js"],
            jax: ["input/TeX", "output/HTML-CSS"],
            showMathMenu: false,
            tex2jax: {
              inlineMath: [ ['$','$'], ["\\(","\\)"] ],
              displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
              processEscapes: true
            },
            styles: {

                ".MathJax_Display": {
                "text-align": "left !important",
                margin:       "0em 0em !important"
            }}
            });
        </script><script type='text/javascript'>// 

// Called on page load to parse URL parameters and perform actions on them.
function init(){
    if(getQueryVariable("expand") == "on"){
      expand();
    }
}
// // 
const AMPERSAND=String.fromCharCode(38);

// Pass a URL variable to this function and it will return its value
function getQueryVariable(variable)
{
    var query = window.location.search.substring(1);
    var vars = query.split(AMPERSAND);
    for (var i=0;i!=vars.length;i++) {
        var pair = vars[i].split("=");
        if(pair[0] == variable){return pair[1];}
    }
    return(false);
}


//    Expands all evaluation activities
function expand(){
    var ap = document.getElementsByClassName('activity_pane');
    for (var ii = 0; ii!=ap.length; ii++) {
        ap[ii].classList.remove('hide');
    }
}

// Function to expand and contract a given div
function toggle(descendent) {
    var cl = descendent.parentNode.parentNode.classList;
    if (cl.contains('hide')){
      cl.remove('hide');
    }
    else{
      cl.add('hide');
    }
}

// Expands targets if they are hidden
function showTarget(id){
    var element = document.getElementById(id);
    while (element != document.body.rootNode ){
	element.classList.remove("hide");
	element = element.parentElement;
    }
}


// </script><style type='text/css'>
    #toc a{
        display: block;
    }

    a[id^="ajq_"]{
        color:black;
    }

    
    body{
       max-width: 900px;
       margin: auto;
    }
    #toc span{
       margin-left: 20px;
    }
    .assignable-content{
      font-style: italic;
    }
    .refinement{
      text-decoration: underline;
    }
    div.eacategory{
      font-style: italic;
      font-weight: bold;
    }
    .activity_pane .toggler::after, .activity_pane .toggler{ 
       display: inline-block;
       height: auto;
       content: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8A\
       AAAPCAYAAAA71pVKAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAQOFAAEDhQGl\
       VDz+AAAAB3RJTUUH4gIXFDM7fhmr1wAAAfRJREFUKM+dkk9I02EYxz/P+25uurWR\
       tTkzI4NGl4jQgkq71K1DhnTQIDolRAQFQYSHTtGhU4e6eujQofBSFLOg0C4RUSjh\
       FnmqTTdKpj/mfv/eX4cUpmRYn9vz8v3w8D7PA/AWGADCbI4QcAb4AnAF8IBJEdX+\
       N0tEda40C4AHADviW1LFvpOX6+FwtAacVzqkGiWtwxo4F21OuPu7+yvxRNoDEhpY\
       cpzavkQyc7D76FCk+vN7j7VU6RdR4xAsikjGGP9FKrN3sPfEpajv2i2zhckR4JUG\
       UCr0erFavLkn2ytd2WPxcFOsZb74+SIQA0YPHBqIdB8Z6tChJv1m/N4P33OGAUsD\
       BIFxPNcOkq07jyeSbbo1tTu2q6vHEqU7D/ddSKcz2ZQJjBSmx925b9NjwEMAafha\
       eyQa/3Dq7O0243sCIEoRGAOA59nm5dM7OHVruzH+AkDjYEp23RrLT+U8Ub+fV0UR\
       oVyaMfVa9fqquF5GKX3ja2FCuc6yWbMipYNP755UgEdr8o2FMf5ivVYdKRfzRkRW\
       RfJTOc+2rWdAcUN5hdGP7x8viGgAXLvGbGFCKxW6tj74J3nOqVvP89M5V6kQ86UZ\
       f7lWvWWMt7Sp41VKb21uSfqnB++6kWi8BLTzL4ioq7H4tgC4z3/QAZSBxEaBXygN\
       v+jeFnAPAAAAAElFTkSuQmCC');
       max-width: 15px;
    }


    a {
      text-decoration: none;
      word-wrap: break-word;
    }
    a.abbr:link{
      color:black;
      text-decoration:none;
    }
    a.abbr:visited{
      color:black;
      text-decoration:none;
    }
    a.abbr:hover{
      color:blue;
      text-decoration:none;
    }
    a.abbr:hover:visited{
      color:purple;
      text-decoration:none;
    }
    a.abbr:active{
      color:red;
      text-decoration:none;
    }
    .note-header{
      font-weight: bold;
    }
    .note p:first-child{
      display: inline;
    }


    /* Tooltip container */
    .tooltipped {
       position: relative;
       display: inline-block;
       border-bottom: 1px dotted black; /* If you want dots under the hoverable text */
    }

    /* Tooltip text */
    .tooltiptext {
       visibility: hidden;
       width: 120px;
       background-color: black;
       color: #fff;
       text-align: center;
       padding: 5px 0;
       border-radius: 6px;
    
       /* Position the tooltip text - see examples below! */
       position: absolute;
       z-index: 1;
   }

   /* Show the tooltip text when you mouse over the tooltip container */
   .tooltipped:hover .tooltiptext {
       visibility: visible;
   }

   table.mfs td{
       text-align: center;
   }
   table.mfs td:first-child{
       text-align: left;
   }
   table{
              margin:auto;
              margin-top:1em;
              border-collapse:collapse; /*border: 1px solid black;*/
          }
          td{
              text-align:left;
              padding:8px 8px;
          }
          th{
              padding:8px 8px;
          }
          tr.header{
              border-bottom:3px solid gray;
              padding:8px 8px;
              text-align:left;
              font-weight:bold; /*font-size: 90%; font-family: verdana, arial, helvetica, sans-serif; */
          }
          table tr:nth-child(2n+2){
              background-color:#F4F4F4;
          }

   


          .figure{
              font-weight:bold;
          }
          h1{
              page-break-before:always;
              text-align:left;
              font-size:200%;
              margin-top:2em;
              margin-bottom:2em;
              font-family:verdana, arial, helvetica, sans-serif;
              margin-bottom:1.0em;
          }
          h1.title{
              text-align:center;
          }
          h2{
              font-size:125%;
              border-bottom:solid 1px gray;
              margin-bottom:1.0em;
              margin-top:2em;
              margin-bottom:0.75em;
              font-family:verdana, arial, helvetica, sans-serif;
          }
          h3{
              font-size:110%;
              margin-bottom:0.25em;
              font-family:verdana, arial, helvetica, sans-serif;
          }
          h4{
              margin-left:0%;
              font-size:100%;
              margin-bottom:0.75em;
              font-family:verdana, arial, helvetica, sans-serif;
          }
          h5,
          h6{
              margin-left:6%;
              font-size:90%;
              margin-bottom:0.5em;
              font-family:verdana, arial, helvetica, sans-serif;
          }
          p{
              margin-bottom:0.6em;
              margin-top:0.2em;
          }
          pre{
              margin-bottom:0.5em;
              margin-top:0.25em;
              margin-left:3%;
              font-family:monospace;
              font-size:90%;
          }
          ul{
              margin-bottom:0.5em;
              margin-top:0.25em;
          }
          td{
              vertical-align:top;
          }
          dl{
              margin-bottom:0.5em;
              margin-top:0.25em;
          }
          dt{
              margin-top:0.7em;
              font-weight:bold;
              font-family:verdana, arial, helvetica, sans-serif;
          }

          a.linkref{
              font-family:verdana, arial, helvetica, sans-serif;
              font-size:90%;
          }

          *.simpleText{
              margin-left:10%;
          }
          *.propertyText{
              margin-left:10%;
              margin-top:0.2em;
              margin-bottom:0.2em
          }
          *.toc{
              background:#FFFFFF;
          }
          *.toc2{
              background:#FFFFFF;
          }
          div.comp{
              margin-left:8%;
              margin-top:1em;
              margin-bottom:1em;
          }
          div.element{
              margin-bottom:1em;
          }
          div.appnote{
              margin-left:0%;
              margin-top:1em;
          }
          .comment-aa{
              background-color:beige;
              color:green;
          }
          div.subaact{
              margin-left:0%;
              margin-top:1em;
          }
          div.activity_pane_body{
              margin-left:0%;
              margin-top:1em;
              margin-bottom:1em;
              padding:1em;
              border:2px solid #888888;
              border-radius:3px;
              display:block;
              margin-left:0%;
              margin-top:1em;
              margin-bottom:1em;
              box-shadow:0 2px 2px 0 rgba(0,0,0,.14),0 3px 1px -2px rgba(0,0,0,.2),0 1px 5px 0 rgba(0,0,0,.12);
          }
          div.optional-appendicies{
              display:none;
          }

          div.statustag{
              margin-left:0%;
              margin-top:1em;
              margin-bottom:1em;
              padding: 0.6em;
              border:2px solid #888888;
              border-radius:3px;
          }

          div.toc{
              margin-left:8%;
              margin-bottom:4em;
              padding-bottom:0.75em;
              padding-top:1em;
              padding-left:2em;
              padding-right:2em;
          }
          span.SOlist{
              font-size:90%;
              font-family:verdana, arial, helvetica, sans-serif;
          }
          h2.toc{
              border-bottom:none;
              margin-left:0%;
              margin-top:0em;
          }
          p.toc{
              margin-left:2em;
              margin-bottom:0.2em;
              margin-top:0.5em;
          }
          p.toc2{
              margin-left:5em;
              margin-bottom:0.1em;
              margin-top:0.1em;
          }
          div.center{
              display:block;
              margin-left:auto;
              margin-right:auto;
              text-align:center;
          }
          div.figure{
              display:block;
              margin-left:auto;
              margin-right:auto;
              text-align:center;
              margin-top:1em;
          }
          div.activity_pane_header{
              display:table-cell;
              vertical-align:middle;
              padding-top:10px
          }
          span.activity_pane_label{
              vertical-align:middle;
              color:black;
              text-decoration:none;
              font-size:100%;
              font-weight:bold; /*font-family: verdana, arial, helvetica, sans-serif; */
          }

          @media screen{
              *.reqid{
                  float:left;
                  font-size:90%;
                  font-family:verdana, arial, helvetica, sans-serif;
                  margin-right:1em;
              }
              *.req{
                  margin-left:0%;
                  margin-top:1em;
                  margin-bottom:1em;
              }
              *.reqdesc{
                  margin-left:20%;
              }

              .activity_pane.hide .toggler::after, .activity_pane.hide .toggler{
	          content: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8A\
		  AAAPCAYAAAA71pVKAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAQOFAAEDhQGl\
		  VDz+AAAAB3RJTUUH4gIXFC4BR3keeQAAAfZJREFUKM+d0k1PE1EUBuB37h2nQ+30\
		  w5YObR0FhIppqBgWuDCaSBQjiQZNTIxLfoAkBHXh2vg7xID+ABPXBl3UdAMaN1CR\
		  j5ZijZ22DKW9d44LP1KMROvZnMU5z+KcvBzAAgADwCdV1RzXlYQ26tYhrYM6u/qX\
		  ATwCcKodrAOYv3z9IV28OuP6/NHPAGYZ45G/QQ5AAFjNbyzdTA2NewcGx7xeI5wu\
		  FZenQOQQuasHncN/9IJo1sn+unkpbqVFIJhgydQo13VjDKCJSnnLBJAHUPoTBoA3\
		  uzvlfiNgDhn+KMiVCB6xYCZSoaPHz5wrba/cbuztpBWFvQLI+R2DSGZqleKNuJX2\
		  cVVjAIExDo/uV7pPjGhSNntrleI9+n7Ox33Y549Wq/ZWTyh8rNcfjPlaZ4xzZvUM\
		  ezrNvnJ+fXFCiL2k2rpQq2wnAqH4tYjZFyZq/Y8CKZoim51z1nIZQ4jGNIC5fZhz\
		  7fHA4JVuj26AyIWiMDSbdTi1L/T29RO7ahdfKgqbInJLANCKZ6Kx5J24dVowztW6\
		  Y+8WNt91FNYXc4WN988BzAL4QOT+Aj/x8GFf+MHI+UlI2cBS9kVlLZfxSFdMS9GY\
		  V1WtKETDPShhz85emLRHx++TETBLAJ4qCov8c7ajsZMr/5PtBQB3AXSpqsbagd8A\
		  O+HMRUtPNsQAAAAASUVORK5CYII=');
              }

              .activity_pane.hide .activity_pane_body{
                  display:none;
              }
              div.statustag{
                  box-shadow:4px 4px 3px #888888;
              }
          }


          @media print{
              *.reqid{
                  font-size:90%;
                  font-family:verdana, arial, helvetica, sans-serif;
              }
              *.req{
                  margin-left:0%;
                  margin-top:1em;
                  margin-bottom:1em;
              }
              *.reqdesc{
                  margin-left:20%;
              }
              div.activity_pane_body{
                  padding:1em;
                  border:2px solid #888888;
                  border-radius:3px;
                  display:block;
              }

	            img[src="images/collapsed.png"] { display:none;}

          }
	</style></head><body onLoad='init()'><h1 class='title' style='page-break-before:auto;'>PP-Module for File Encryption</h1><noscript><h1 style='text-align:center; border-style: dashed; border-width: medium; border-color: red;'>This page is best viewed with JavaScript enabled!</h1></noscript><div class='center'><img src='images/niaplogo.png' alt='NIAP Logo'></img><br/><p></p>Version: 1.0<p></p>2019-07-25<p></p><b>National Information Assurance Partnership</b></div><h2 style='page-break-before:always;'>Revision History</h2><table><tr class='header'><th>Version</th><th>Date</th><th>Comment</th></tr><tr><td>v 1.0</td><td>2019-07-25</td><td>Initial Release</td></tr></table><h2>Contents</h2><div class='toc' id='toc'><a href='#int' style='text-indent:0px'>1<span>Introduction</span></a><a href='#ppoverview' style='text-indent:10px'>1.1<span>Overview</span></a><a href='#glossary' style='text-indent:10px'>1.2<span>Terms</span></a><a href='#' style='text-indent:20px'>1.2.1<span>Common Criteria Terms</span></a><a href='#' style='text-indent:20px'>1.2.2<span>Technical Terms</span></a><a href='#complianttargets' style='text-indent:10px'>1.3<span>Compliant Targets of Evaluation</span></a><a href='#TOEboundary' style='text-indent:20px'>1.3.1<span>TOE Boundary</span></a><a href='#usecases' style='text-indent:10px'>1.4<span>Use Cases</span></a><a href='#conf' style='text-indent:0px'>2<span>Conformance Claims</span></a><a href='#spd' style='text-indent:0px'>3<span>Security Problem Description</span></a><a href='#threats' style='text-indent:10px'>3.1<span>Threats</span></a><a href='#assumptions' style='text-indent:10px'>3.2<span>Assumptions</span></a><a href='#OSPs' style='text-indent:10px'>3.3<span>Organizational Security Policies</span></a><a href='#obj' style='text-indent:0px'>4<span>Security Objectives</span></a><a href='#objtoe' style='text-indent:10px'>4.1<span>Security Objectives for the TOE</span></a><a href='#objenv' style='text-indent:10px'>4.2<span>Security Objectives for the Operational Environment</span></a><a href='#SOR' style='text-indent:10px'>4.3<span>Security Objectives Rationale</span></a><a href='#sfr' style='text-indent:0px'>5<span>Security Requirements</span></a><a href='#App' style='text-indent:10px'>5.1<span>App 
      PP Security Functional Requirements Direction
    </span></a><a href='#modsfr-App' style='text-indent:20px'>5.1.1<span>
      Modified SFRs
    </span></a><a href='#man-sfrs' style='text-indent:10px'>5.2<span>TOE Security Functional Requirements</span></a><a href='#fcs' style='text-indent:20px'>5.2.1<span>Cryptographic Support (FCS)</span></a><a href='#fdp' style='text-indent:20px'>5.2.2<span>User Data Protection (FDP)</span></a><a href='#fia' style='text-indent:20px'>5.2.3<span>Identification and Authentication (FIA)</span></a><a href='#fmt' style='text-indent:20px'>5.2.4<span>Security Management (FMT)</span></a><a href='#fpt' style='text-indent:20px'>5.2.5<span>Protection of the TSF (FPT)</span></a><a href='#mod-conrat' style='text-indent:0px'>6<span>Consistency Rationale</span></a><a href='#conrat-App' style='text-indent:10px'>6.1<span>Application Software Protection Profile
      </span></a><a href='#contoe-App' style='text-indent:20px'>6.1.1<span>
	Consistency of TOE Type
      </span></a><a href='#consecprob-App' style='text-indent:20px'>6.1.2<span>
	Consistency of Security Problem Definition
      </span></a><a href='#conobj-App' style='text-indent:20px'>6.1.3<span>
	Consistency of Objectives
      </span></a><a href='#conreq-App' style='text-indent:20px'>6.1.4<span>
	Consistency of Requirements
      </span></a><a href='#opt-sfrs' style='text-indent:0px'>Appendix A - <span>Optional SFRs</span></a><a href='#sel-sfrs' style='text-indent:0px'>Appendix B - <span>Selection-based SFRs</span></a><a href='#obj-sfrs' style='text-indent:0px'>Appendix C - <span>Objective SFRs</span></a><a href='#ext-comp-defs' style='text-indent:0px'>Appendix D - <span>Extended Component Definitions</span></a><a href='#ext-comp-defs-bg' style='text-indent:10px'>D.1<span>Background and Scope</span></a><a href='#ext-comp-defs-bg' style='text-indent:10px'>D.2<span>Extended Component Definitions</span></a><a href='#KMD' style='text-indent:0px'>Appendix E - <span>Key Management Description</span></a><a href='#bibliography' style='text-indent:0px'>Appendix F - <span>Bibliography</span></a><a href='#acronyms' style='text-indent:0px'>Appendix G - <span>Acronyms</span></a></div><h1 class='indexable' data-level='1' id='int'>1 Introduction</h1>
    <h2 class='indexable' data-level='2' id='ppoverview'>1.1 Overview</h2> 
 The scope of the File Encryption <a href='#abbr_PP-Module' class='abbr'><abbr title='Protection Profile Module'>PP-Module</abbr></a> is to describe the security functionality of a file encryption 
	    product in terms of [<a href='#abbr_CC' class='abbr'><abbr title='Common Criteria'>CC</abbr></a>] and to define functional and assurance requirements for such products. 
	    This <a href='#abbr_PP-Module' class='abbr'><abbr title='Protection Profile Module'>PP-Module</abbr></a> is intended for use with the following Base-PP <br/> <br/> <ul>
        <li>Application Software Protection Profile, Version 1.3</li>
      </ul>
      <br/> This Base-PP is valid because a file encryption product is
      a 3rd party application or application included with a operating system.

    <br/> <br/>File encryption is the process of encrypting individual files or sets of
    files (or volumes, or containers, etc.) on an end user device and permitting access to the
    encrypted data only after proper authentication is provided. Encryption products that
    conform to this PP-Module must render information inaccessible to anyone (or, in the case of other
    software on the machine, anything) that does not have the proper authentication credential.  
    The encrypted files may be on a local machine or may be sent to other devices.

      <br/> <br/>The foremost security objective of file
      encryption is to force an adversary to perform a cryptographic exhaust against a
      prohibitively large key space. Technology is changing at a rapid rate and the
      definition of mobile devices and traditional laptop/PC devices is quickly merging.
      Requirements can diverge slightly for Mobile vs Laptop/PC and the Evaluation Activities will
      describe any differences. Either of these use cases may be an enterprise managed file encryption client. 
      Some of the security functionality may be provided by the OE.
      The vendor is required to provide configuration guidance (AGD_PRE, AGD_OPE) to correctly install and 
      administer the TOE for every operational environment supported.<br/>  

      <br/> The data that is to be secured by the encryption product is encrypted using a File
      Encryption Key (FEK). A file encryptor may have zero or more Key Encryption Keys (KEKs) that
      protect (encrypt) the FEK. The number of keys and the types of keys may vary, but the design
      should follow one of the following models:<br/>
      <ol>
        <li>Condition a Password/Passphrase directly into a FEK</li>
        <li>Condition a Password/Passphrase into a KEK that is used to encrypt the randomly
          generated FEK directly or through a chaining of more than one KEK (these KEKs would be
          randomly generated).</li>
        <li>Use a software certificate or an external token to protect the FEK.</li>
      </ol> From a terminology standpoint, a KEK is either a symmetric key or an
      asymmetric key pair, and is used for both encryption and decryption of the
      FEK. If a distinction needs to be made between the public key (which encrypts the FEK) and
      the private key (which decrypts the FEK), this is done in the requirements and the evaluation
      activities.<br/> <br/> 

      The TOE may be capable of supporting multiple users with different authorization factors, such that different users
      are able to use the same platform and not be able to read each other's encrypted files. The
      TOE may also support the ability for users to share an encrypted file without sharing an
      authorization factor, but this is not required. In order to claim this capability, the TOE must allow
      sharing of at least one encrypted resource among different users of the TOE who possess
      different authorization factors (e.g., two different smart cards, two different passwords, one
      using a password and another using a smart card). If this capability is supported, then the ST
      author adds FIA_FCT_EXT.1.1.<br/> <br/> 

      <b>Authorization</b> <br/> One or more authorization factors must be established before data can
      be encrypted. This authorization factor(s) must be presented to the file encryption product
      in order for the user to request that the product decrypt the data. Authorization factors
      may be uniquely associated with individual users or may be associated with a community of
      users. The TOE is not required to support multiple types of authorization factors (e.g.,
      both passphrases and external authorization factors). If the ST author defines additional
      authorization factors, they must be fully documented and cannot diminish the strength of the
      passphrase and/or external token authorization factors. <br/> <br/>
      The password/passphrase authorization factors must be conditioned such that they are
      at least the same size (bit length) as the key they are protecting. 
      While this PP-Module does not dictate how these authentication factors are created, a
      good operational practice is for an administrator to generate the password or passphrase to
      ensure sufficient entropy.  Passphrases are preferred over passwords, since it is easier for users to remember and type in a sequence of
      words than recall a password and type in a long string of random characters.<br/><br/>

      <b>Administration</b> <br/> The base requirements of the TOE do not require the TOE to maintain an
      administrative role. Typically, administrators possess privilege to invoke
      functionality on the TOE that is not available to general users. For stand alone file encryption
      products, however, once the product is installed there should be little need for
      administrative involvement.  For enterprise managed file encryption products, the TOE may be remotely administered. <br/><br/>

      <b>Data Authentication (optional)</b> <br/> Because modification of ciphertext data
      for certain modes of encryption will enable unidentified plaintext manipulation, care must
      be taken by the TOE to mitigate against forged or maliciously modified ciphertext data. The
      PP-Module defines requirements for how the TOE must provide data authentication services, allowing
      the TOE to implement authenticated block cipher, keyed hash function or asymmetric signing
      features. Depending on the implementation, the TOE will be responsible for meeting at least
      one of the aforementioned requirements. In all cases, unsuccessful authentication of the
      data should not allow the user to see the decrypted ciphertext and notification should be
      provided to the user if such an event were to occur.<br/> <br/> A keyed hashing service may also
      be used to accomplish data authentication. This will involve using an approved keyed hashing
      service in accordance with FCS_COP.1(4) and proper protection of the File Authentication Key
      (FAK); the FAK being the secret value used as input to the keyed hash function. FAKs should
      be numerically different from the FEK, but will be protected in all of the same manners as
      the FEK. The primary requirement dictating implementation of data authentication using a
      keyed hash function is FDP_AUT_EXT.2.<br/> <br/> Lastly, asymmetric signing in conjunction with a
      secure hash function may be used to authenticate the data. The implementation must use an
      approved signing algorithm in accordance with FCS_COP.1(3) (from the <a href='#bibAppPP'>[AppPP]</a>) and an approved secure hashing function in accordance with
      FCS_COP.1(2) (from the <a href='#bibAppPP'>[AppPP]</a>). The primary requirement addressing data
      authentication via asymmetric signing is FDP_AUT_EXT.3. <br/><br/>

      <b>The TOE and Its Supporting Environment:</b><br/>
      Since the TOE is purely a software solution, it must rely on the TOE Operational Environment (system
      hardware, firmware, and operating system) for its execution domain and its proper usage. The
      vendor is expected to provide sufficient installation and configuration instructions (for
      each platform listed in the ST) to identify Operational Environment(s) with the necessary
      features and to provide instructions for how to configure it correctly and securely. <br/> <br/>

      The PP-Module contains requirements (Section 5 that must be met by either the TOE or the platform
      on which it operates. A "platform" is defined as a separate entity whose functions may be
      used by the TOE, but is not part of the TOE. A third-party library used by the TOE is not
      considered part of the TOE's "platform", but (for instance) cryptographic functionality that
      is built into an Operating System on which the TOE executes can be considered part of the
      platform. <br/> <br/> 

      Likewise, an external entity (such as a smart card) that performs
      cryptographic operations with respect to the FEK would also be considered a part of the "TOE
      Platform".
      
      <br/><br/> The ST author will make the appropriate selection based on where
      that element is implemented. It is allowable for some elements in a component to be
      implemented by the TOE, while other elements in that same component may be implemented by
      the platform; in these cases, further guidance is given in the application notes and
      Supporting Documentation.<br/>  <br/> In some cases, the TOE vendor will have to provide specific
      configuration guidance for the Operational Environment to enable the TOE to meet its
      security objectives. These include:<br/> For non-mobile systems:<br/>
      <ul>
        <li>Instructions for how to configure the operational environment so that the system
          powers down completely after a period of user inactivity for every operating system that
          the product supports.</li>
        <li>Instructions for how to disable power managed state (e.g., hibernate/sleep)
          capabilities.</li>
      </ul> For mobile systems:<br/>
      <ul>
        <li>Instructions for how to configure the operational environment to provide necessary
          behavior in support of TOE functionality when transition to a locked state after
          inactivity period and manually engaging the lock functionality.</li>
      </ul> It should be noted that if the TOE possesses the capability to correctly protect
      information in one or more of an underlying platform's power managed modes, they can use the
      FDP_PM_EXT.1 requirement in Appendix A.<br/><br/> Authorized users of the TOE are those users
      possessing valid authorization factors for the TOE. While some of these functions specified
      in the PP-Module might be considered "administrative" functions for other types of TOEs, for file
      encryption products it is the expectation that all of these functions can be performed by
      the end user of the software. 
    

    <h2 class='indexable' data-level='2' id='glossary'>1.2 Terms</h2>
      <h3 class='indexable' data-level='3' id=''>1.2.1 Common Criteria Terms</h3> 
        <table><tr><td><span id='abbr_CC'>Common Criteria (<abbr>CC</abbr>)</span></td><td>Common Criteria for Information Technology Security
              Evaluation.</td></tr><tr><td><span id='abbr_PP'>Protection Profile (<abbr>PP</abbr>)</span></td><td>An implementation-independent set of security requirements for a category
              of products.</td></tr><tr><td><span id='abbr_PP-Configuration'>Protection Profile Configuration (<abbr>PP-Configuration</abbr>)</span></td><td> A comprehensive set of security requirements for a product type that 
		    consists of at least one Base-PP and at least one PP-Module.</td></tr><tr><td><span id='abbr_PP-Module'>Protection Profile Module (<abbr>PP-Module</abbr>)</span></td><td>An implementation-independent statement of security needs for a TOE type complementary to one or more Base Protection Profiles.</td></tr><tr><td><span id='abbr_SAR'>Security Assurance Requirement (<abbr>SAR</abbr>)</span></td><td>A requirement to assure the security of the <a href='#abbr_TOE' class='abbr'><abbr title='Target of Evaluation'>TOE</abbr></a>.
            </td></tr><tr><td><span id='abbr_SFR'>Security Functional Requirement (<abbr>SFR</abbr>)</span></td><td>A requirement for security enforcement by the <a href='#abbr_TOE' class='abbr'><abbr title='Target of Evaluation'>TOE</abbr></a>.
            </td></tr><tr><td><span id='abbr_ST'>Security Target (<abbr>ST</abbr>)</span></td><td>A set of implementation-dependent security requirements for a specific
              product.</td></tr><tr><td><span id='abbr_TOE'>Target of Evaluation (<abbr>TOE</abbr>)</span></td><td>The product under evaluation. In this case, file encryption software and its
              supporting documentation.</td></tr><tr><td><span id='abbr_TSF'>TOE Security Functionality (<abbr>TSF</abbr>)</span></td><td>The security functionality of the product under evaluation.</td></tr><tr><td><span id='abbr_TSS'>TOE Summary Specification (<abbr>TSS</abbr>)</span></td><td>A description of how a <a href='#abbr_TOE' class='abbr'><abbr title='Target of Evaluation'>TOE</abbr></a> satisfies the SFRs in a <a href='#abbr_ST' class='abbr'><abbr title='Security Target'>ST</abbr></a>. </td></tr></table>
      

      <h3 class='indexable' data-level='3' id=''>1.2.2 Technical Terms</h3>
        <table><tr><td>Administrator</td><td> Authorized Users with higher privileges and typically handle configuration
              and management functions, such as configuring and updating the TOE. </td></tr><tr><td>Authorization factor (AF) </td><td>A value submitted by the user, present on the host, or present on a
              separate protected hardware physical device used to establish that the user (and
              potentially the host) is in the community authorized to use the TOE. The authorization
              factors are used to generate the KEK. Note that these AFs are not used to establish
              the particular identity of the user. </td></tr><tr><td>Authorized User </td><td>A user who has been provided Authorization factors by the administrator to
              use the TOE. </td></tr><tr><td>Data Encryption </td><td>The process of encrypting all user data written to volatile memory.
            </td></tr><tr><td>Deterministic Random Bit Generator (DRBG)</td><td>A cryptographic algorithm that produces a sequence of bits from a secret
              initial seed value. Without knowledge of the seed value, the output sequence should be
              unpredictable up to the security level of the DRBG. </td></tr><tr><td>Entropy Source </td><td>This cryptographic function provides a seed for a random bit generator by
              accumulating the outputs from one or more noise sources. The functionality includes a
              measure of the minimum work required to guess a given output and tests to ensure that
              the noise sources are operating properly. </td></tr><tr><td>File/Set of files </td><td>The user data that is selected to be encrypted, which can include
              individual file encryption (with a FEK per file) or a set of files encrypted with a
              single FEK. </td></tr><tr><td>File Authentication Key (FAK) </td><td>The secret value used as input when a keyed hash function is used to
              perform data authentication. </td></tr><tr><td>File Encryption Key (FEK) </td><td>The key that is used by the encryption algorithm to encrypt the selected
              user data on the host machine. </td></tr><tr><td>Key Chaining</td><td>The method of using multiple layers of encryption keys to protect data. 
              A top layer key encrypts a lower layer key which encrypts the data; this method can have any number of layers.</td></tr><tr><td>Key Encryption Key (KEK) </td><td>The key that is used to encrypt another key. </td></tr><tr><td>Keying Material </td><td>The KEK, FEK, authorization factors and random numbers or any other values
              from which keys are derived. </td></tr><tr><td>Key Sanitization</td><td>A method of sanitizing encrypted data by securely overwriting the key, as described in the key destruction requirement, that was encrypting the data. 
            </td></tr><tr><td>Noise Source </td><td>The component of an RBG that contains the non-deterministic,
              entropy-producing activity. </td></tr><tr><td>Operational Environment </td><td>Hardware and software that are outside the TOE boundary that support the
              TOE functionality and security policy, including the platform, its firmware, and
              the operating system. </td></tr><tr><td>Password </td><td>A short string of characters used for authorization to the data on the
              device. </td></tr><tr><td>Passphrase</td><td>A string of words that may be used for authorization to the data
              on the device. </td></tr><tr><td>Primary Key Chain</td><td>The direct key chain from the authorization factor to the FEK.</td></tr><tr><td>Random Bit Generator (RBG) </td><td>A cryptographic function composed of an entropy source and DRBG that is
              invoked for random bits needed to produce keying material.</td></tr><tr><td>Sensitive Data </td><td>Any data of which the compromise with respect to loss, misuse, or
              unauthorized access to or modification of could adversely affect the interest of the
              TOE user. </td></tr><tr><td>Shutdown </td><td>Power down or unintentional loss of power of the TOE or platform.
            </td></tr><tr><td>Supplemental Key Chain</td><td>Other key chains that add protection or functionality without compromising the security of the primary key chain.</td></tr><tr><td>System files </td><td>Files that reside on the host machine that are used in the operation of
              the file encryption software. </td></tr><tr><td>Temporary File </td><td>A file created by an application for short term storage of sensitive data.
            </td></tr><tr><td>Trusted Host </td><td>Source/destination host configured and maintained to provide the TOE with
              appropriate IT security commensurate with the value of the user data protected by the
              TOE. </td></tr><tr><td>Unauthorized User </td><td>A user who has not been authorized to use the TOE and decrypt encrypted
              user data. </td></tr><tr><td>User Data </td><td>All data that originate on the host, or is derived from data that
              originate on the host, excluding system files and signed firmware updates from the TOE
              manufacturer. </td></tr><tr><td>Volatile memory </td><td>Memory that loses its content when power is turned off. </td></tr><tr><td>Zeroize</td><td>This term is used to make a distinction between dereferencing a memory
              location and actively overwriting it with a constant. Keying material needs to be
              overwritten when it is no longer needed. </td></tr></table>
      
    

    <h2 class='indexable' data-level='2' id='complianttargets'>1.3 Compliant Targets of Evaluation</h2> This PP-Module specifically
      addresses encryption of a set of data. This PP-Module addresses the primary threat that an
      unauthorized user will obtain access to a host machine containing encrypted information and be
      able to extract the sensitive data through the process of decryption. The Target of Evaluation
      (TOE) defined in this PP-Module is an encryption product that will inherently encrypt all of that
      data that the user selects to encrypt. For ease of explanation, "file" will frequently be used
      to refer to the object that is encrypted (however, it could be any number of things - folders,
      volumes, containers, etc.).<br/> <br/>  
      <h3 class='indexable' data-level='3' id='TOEboundary'>1.3.1 TOE Boundary</h3>
        <p>
          The application, which consists of the software provided by its vendor,
          is installed onto the platform(s) it operates on.  It executes on the platform, which
          may be an operating system, hardware environment, 
          a software based execution environment, 
          or some combination of these. Those platforms may themselves run within other
          environments, such as virtual machines or operating systems, that completely abstract away the underlying hardware
          from the application. The TOE is not accountable for security functionality that is implemented by 
          platform layers that are abstracted away.
          Some evaluation activities are specific to the particular platform
          on which the application runs, in order to provide precision and
          repeatability. The only platforms currently recognized by <a href='#bibAppPP'>[AppPP]</a> and this module are those specified in SFR Evaluation Activities.
          To test on a platform for which there are no EAs, a Vendor should contact NIAP with recommended EAs.
          NIAP will determine if the proposed platform is appropriate for the PP and accept, reject,
          or develop EAs as necessary in coordination with the technical community.
        </p><p>	
          The TOE includes 
          any software in the application installation package, even those pieces that may 
          extend or modify the functionality of the underlying platform, such as kernel drivers.  
          Some platforms come bundled with file encryption product and these too
          should be considered subject to the requirements defined in this
          document although the expectation of formal Common Criteria evaluation
          depends upon the national scheme.  <abbr title='Basic Input/Output             System'>BIOS</abbr> and other firmware, the operating system kernel,
          and other systems software (and drivers) provided as part of the
          platform are outside the scope of this document.  
          
        </p>
      
    

    <h2 class='indexable' data-level='2' id='usecases'>1.4 Use Cases</h2>
      <dl><dt> [USE CASE 1] Unmanaged Endpoint</dt><dd>The traditional ability to encrypt files without external management and power down the machine and know the data is securely protected.</dd><dt> [USE CASE 2] Managed Endpoint</dt><dd>The traditional ability to encrypt files and power down the machine and know the data is securely protected, while communicating with an Enterprise Management server.</dd><dt> [USE CASE 3] Encrypted Distribution</dt><dd>The ability to encrypt a file on a machine and then send the encrypted file securely using a non-encrypted data in transit method.</dd></dl>
    
  <h1 class='indexable' data-level='1' id='conf'>2 Conformance Claims</h1>
    <dl><dt>Conformance Statement</dt><dd>
          <p>
            This <a href='#abbr_PP-Module' class='abbr'><abbr title='Protection Profile Module'>PP-Module</abbr></a> inherits exact conformance as required from the specified Base-PP and as defined in the <a href='#bibCC'>[CC]</a> and CEM addenda for Exact Conformance, Selection-Based SFRs, and Optional SFRs (dated May 2017).
            
            This PP-Module is conformant to Parts 2 (extended) and 3 (extended) of Common Criteria Version 3.1, Revision 5 [CC]. 
            
            The following PPs and PP-Modules are allowed to be specified in a PP-Configuration with this PP-Module.
            <ul><li>PP-Module for VPN Client, Version 2.1</li>
            <li>PP-Module for File Encryption Enterprise Management, Version 1.0</li></ul>
          </p>
		<br/><br/>
		If claiming compliance to a PP-Configuration that includes multiple PP-Modules, the ST author must ensure any duplicative SFRs are iterated using unique identifiers. This will allow the reader to easily determine which iteration applies to each TOE component
        </dd></dl>
  <h1 class='indexable' data-level='1' id='spd'>3 Security Problem Description</h1> The primary asset that is being protected
    is the sensitive user data stored on a system. The threat model thus focuses on a host machine
    that has been compromised by an unauthorized user. This section addresses threats to the TOE
    only. 

    <h2 class='indexable' data-level='2' id='threats'>3.1 Threats</h2> A threat consists of a threat agent, an asset, and
      an adverse action of that threat agent on that asset. The model in this PP-Module only addresses
      risks that arise from the host machine being compromised by an unauthorized user.<br/><br/>

      For this PP-Module, the TOE is not expected to defend against all threats related to malicious software
      that may reside in user data files. For instance, the TOE is not responsible for detecting
      malware in the data selected by the user for encryption (that is a responsibility of the host
      environment). Once the file encryption product is operational in a host system, the threats
      against the data from potentially malicious software on the host are also not in the threat
      model of this PP-Module. For example, there are no requirements in this PP-Module addressing a malicious
      host capturing a password-based authorization factor, nor a malicious process reading the
      memory of an application program that is operating on a decrypted file.<br/><br/> 

      Note that this PP-Module
      does not repeat the threats identified in the <a href='#bibAppPP'>[AppPP]</a>, though they all
      apply given the conformance and hence dependence of this PP-Module on the <a href='#bibAppPP'>[AppPP]</a>.
      <br/><br/>

      Note also that while the <a href='#bibAppPP'>[AppPP]</a> contains only threats to the ability of
      the TOE to provide its security functions, this PP-Module focuses on threats to resources in the
      operational environment. Together the threats of <a href='#bibAppPP'>[AppPP]</a> and those defined in this PP-Module define
      the comprehensive set of security threats addressed by a file encryption TOE. 
      <dl><dt>T.UNAUTHORIZED_DATA_ACCESS</dt><dd>
            <b>Unauthorized Data Access:</b> An attacker has access to an account that is not permitted to decrypt 
          files or has no access and uses forensic tools for examination.</dd><dt>T.MANAGEMENT_ACCESS</dt><dd>
            <b>Management Access:</b> An authorized user may perform sensitive management functions without authorization or a legitimate user may lack the ability to perform
            necessary security operations due to a lack of supported management functionality.</dd><dt>T.KEYING_MATERIAL_COMPROMISE</dt><dd>
            <b>Compromise of Keying Material:</b> An attacker exploits a weakness in the random number generation, 
            plaintext keys, and other keying material to decrypt an encrypted file. </dd><dt>T.UNSAFE_AUTHFACTOR_VERIFICATION</dt><dd>
            <b>Flawed Authentication Factor Verification:</b> An attacker exploits a flaw in the validation or conditioning of 
            the authorization factor. </dd><dt>T.KEYSPACE_EXHAUST</dt><dd>
            <b>Brute Force Attack:</b> An attacker is able to brute force the keyspace of the algorithms used to force disclosure of sensitive data.
          </dd><dt>T.PLAINTEXT_COMPROMISE</dt><dd>
            <b>Plaintext Compromise:</b> An attacker is able to uncover plaintext remains with forensic tools.
          </dd></dl>
    

    <h2 class='indexable' data-level='2' id='assumptions'>3.2 Assumptions</h2>
These assumptions are made on the Operational Environment in order to be able to ensure that the
security functionality specified in the PP-Module can be provided by the TOE. If the TOE is placed in an
Operational Environment that does not meet these assumptions, the TOE may no longer be able to
provide all of its security functionality.
      
      <dl><dt>A.AUTH_FACTOR</dt><dd>An authorized user will be responsible for ensuring that all externally
              derived authorization factors have sufficient strength and entropy to reflect the
              sensitivity of the data being protected. This can apply to password- or
              passphrase-based, ECC CDH, and RSA authorization factors.</dd><dt>A.EXTERNAL_FEK_PROTECTION</dt><dd>External entities that implement ECC CDH or RSA that are used to encrypt
              and decrypt a FEK have the following characteristics: 
              <li>meet national requirements for the cryptographic mechanisms implemented</li>
                <li>require authentication via a pin or other mechanisms prior to allowing access to protected information (the decrypted FEK, or the private key)</li>
                  <li>implement anti-hammer provisions where appropriate (for example, when a pin is the authentication factor).</li>
            </dd><dt>A.SHUTDOWN</dt><dd>An authorized user will not leave the machine in a mode where sensitive
              information persists in non-volatile storage.</dd><dt>A.STRONG_OE_CRYPTO</dt><dd>All cryptography implemented in the Operational Environment and used by the
              TOE will meet the requirements listed in this PP-Module. This includes
              generation of external token authorization factors by a RBG.</dd><dt>A.FILE_INTEGRITY </dt><dd>When the file is in transit, it is not modified, otherwise if that
              possibility exists, the appropriate selections in Appendix B are chosen for Data
              Authentication.</dd></dl>
      
    
     <h2 class='indexable' data-level='2' id='OSPs'>3.3 Organizational Security Policies</h2>
      There are no Organizational Security Policies for the PP-Module.
       
  <h1 class='indexable' data-level='1' id='obj'>4 Security Objectives</h1> 
    The Security Problem described in
    <a href='#spd' class='dynref'>Section 3 Security Problem Description</a> will be addressed by a combination of cryptographic capabilities. Compliant TOEs
    will provide security functionality that addresses threats to the TOE. The following subsections provide a description of the
    security objectives required to meet the threats previously discussed. The
    description of these security objectives are in addition to that described in the <a href='#bibAppPP'>[AppPP]</a>.<br/> 
    <h2 class='indexable' data-level='2' id='objtoe'>4.1 Security Objectives for the TOE</h2> 
      <dl><dt>O.KEY_MATERIAL_PROTECTION</dt><dd>
            <b>Protection of Key Material:</b> The TOE must ensure that sensitive plaintext key material used
            in performing its operations is cleared once it is no longer needed. Key material must
            be identified; its use and intermediate storage areas must also be identified; and then
            those storage areas must be cleared in a timely manner and without interruptions. For
            example, authorization factors are only needed until the KEK is formed; at that point,
            volatile memory areas containing the authorization factors should be cleared. <p></p> Addressed by: <span class='SOlist'><span class=''><a href='#FCS_CKM_EXT.4' class=''>FCS_CKM_EXT.4</a><span class='after'></span></span>, <span class=''><a href='#FPT_KYP_EXT.1' class=''>FPT_KYP_EXT.1</a><span class='after'></span></span></span></dd><dt>O.FEK_SECURITY</dt><dd>
            <b>Encryption Using a Strong FEK and KEK:</b> In order to ensure that brute force
            attacks are infeasible, the TOE must ensure that the cryptographic strength of the keys
            and authorization factors used to generate and protect the keys is sufficient to
            withstand attacks in the near-to-mid-term future. Password/passphrase 
            conditioning requirements are also levied to help ensure that a brute force attack
            against these authorization factors (when used) has a similar level of resistance.
          <p></p> Addressed by: <span class='SOlist'><span class='external-ref'>FCS_COP.1(1) (from Base-PP)</span>, <span class=''><a href='#FCS_CKM_EXT.2' class=''>FCS_CKM_EXT.2</a><span class='after'></span></span>, <span class=''><a href='#FCS_IV_EXT.1' class=''>FCS_IV_EXT.1</a><span class='after'></span></span>, <span class=''><a href='#FCS_KYC_EXT.1' class=''>FCS_KYC_EXT.1</a><span class='after'></span></span>, <span class=''><a href='#FCS_VAL_EXT.1' class=''>FCS_VAL_EXT.1</a><span class='after'></span></span>, <span class='external-ref'>FCS_CKM_EXT.3 (selection-based)</span>, <span class='external-ref'>FCS_CKM_EXT.6 (selection-based)</span>, <span class='external-ref'>FCS_COP.1(5) (selection-based)</span>, <span class='external-ref'>FCS_COP.1(6) (selection-based)</span>, <span class='external-ref'>FCS_COP.1(7) (selection-based)</span>, <span class='external-ref'>FCS_KDF_EXT.1 (selection-based)</span>, <span class='external-ref'>FCS_SMC_EXT.1 (selection-based)</span>, <span class='external-ref'>FCS_VAL_EXT.2 (selection-based)</span></span></dd><dt>O.WIPE_MEMORY</dt><dd>
            <b>Removal of Plaintext Data:</b> To address the threat of unencrypted copies of data
            being left in non-volatile memory or temporary files where it may be accessed by an
            unauthorized user, the TOE will ensure that plaintext data it creates is securely erased
            when no longer needed. The TOE's responsibility is to utilize the appropriate TOE
            platform method for secure erasure, but the TOE is not responsible for verifying that
            the secure erasure occurred as this will be the responsibility of the TOE platform. <p></p> Addressed by: <span class='SOlist'><span class=''><a href='#FDP_PRT_EXT.1' class=''>FDP_PRT_EXT.1</a><span class='after'></span></span>, <span class=''><a href='#FDP_PRT_EXT.2' class=''>FDP_PRT_EXT.2</a><span class='after'></span></span>, <span class='external-ref'>FDP_PRT_EXT.3 (optional)</span></span></dd><dt>O.PROTECT_DATA</dt><dd>
            <b>Protection of Data:</b> The TOE will encrypt data to protect the data from
            unauthorized access. Encrypting the file or set of files will protect the user data even
            when low-level tools that bypass operating system protections such as discretionary and
            mandatory access controls are available to an attacker. Users that are authorized to
            access the data must provide authorization factors to the TOE in order for the data to
            be decrypted and provided to the user.<br/><br/>
            
            The TOE will also optionally include data authentication functionality to protect data from unauthorized modification.
          <p></p> Addressed by: <span class='SOlist'><span class='external-ref'>FCS_COP.1(1) (from Base-PP)</span>, <span class=''><a href='#FCS_IV_EXT.1' class=''>FCS_IV_EXT.1</a><span class='after'></span></span>, <span class=''><a href='#FDP_PRT_EXT.1' class=''>FDP_PRT_EXT.1</a><span class='after'></span></span>, <span class=''><a href='#FDP_PRT_EXT.2' class=''>FDP_PRT_EXT.2</a><span class='after'></span></span>, <span class='external-ref'>FCS_CKM_EXT.5 (optional)</span>, <span class='external-ref'>FCS_COP_EXT.1 (optional)</span>, <span class='external-ref'>FDP_AUT_EXT.1 (optional)</span>, <span class='external-ref'>FDP_AUT_EXT.2 (optional)</span>, <span class='external-ref'>FDP_AUT_EXT.3 (optional)</span>, <span class='external-ref'>FDP_PM_EXT.1 (optional)</span>, <span class='external-ref'>FDP_PRT_EXT.3 (optional)</span>, <span class='external-ref'>FIA_FCT_EXT.1 (optional)</span></span></dd><dt>O.SAFE_AUTHFACTOR_VERIFICATION</dt><dd>
            <b>Safe Authentication Factor Verification:</b> In order to avoid exposing information
            that would allow an attacker to compromise or weaken any factors in the chain keys
            generated or protected by the authorization factors, the TOE will verify the valid
            authorization factor prior to the FEK being used to decrypt the data being
            protected.
          <p></p> Addressed by: <span class='SOlist'><span class=''><a href='#FCS_VAL_EXT.1' class=''>FCS_VAL_EXT.1</a><span class='after'></span></span>, <span class=''><a href='#FIA_AUT_EXT.1' class=''>FIA_AUT_EXT.1</a><span class='after'></span></span></span></dd><dt>O.MANAGE</dt><dd>The TOE will provide all the functions and facilities necessary to support
            the authorized administrators in their management of the security of the TOE, and
            restrict these functions and facilities from unauthorized use.<p></p> Addressed by: <span class='SOlist'><span class='external-ref'>FMT_MEC_EXT.1</span>, <span class=''><a href='#FMT_SMF.1(2)' class=''>FMT_SMF.1(2)</a><span class='after'></span></span></span></dd></dl>
    

    <h2 class='indexable' data-level='2' id='objenv'>4.2 Security Objectives for the Operational Environment</h2>
	The Operational Environment of the TOE implements technical and procedural measures to assist the TOE in correctly providing its security functionality (which is defined by the security objectives for the TOE).
	The security objectives for the Operational Environment consist of a set of statements describing the goals that the Operational Environment should achieve.
	This section defines the security objectives that are to be addressed by the IT domain or by non-technical or procedural means. The assumptions identified in Section 3 are incorporated as security objectives for the environment.
      
      <dl><dt>OE.AUTHORIZATION_FACTOR_STRENGTH</dt><dd>An authorized user will be responsible for ensuring that all externally
            derived authorization factors have sufficient strength and entropy to reflect the
            sensitivity of the data being protected. This can apply to password or
            passphrase based, ECC CDH, and RSA authorization factors.</dd><dt>OE.POWER_SAVE</dt><dd>The non-mobile operational environment must be configurable so that there
            exists at least one mechanism that will cause the system to enter a safe power state (A.SHUTDOWN). Any
            such mechanism (e.g., sleep, hibernate) that does not conform to this requirement must
            be capable of being disabled. The mobile operational environment must be
            configurable such that there exists at least one mechanism that will cause the system to
            lock upon a period of time. </dd><dt>OE.STRONG_ENVIRONMENT_CRYPTO</dt><dd>The Operating environment will provide a cryptographic function capability
            that is commensurate with the requirements and capabilities of the TOE.</dd></dl>
    

    <h2 class='indexable' data-level='2' id='SOR'>4.3 Security Objectives Rationale</h2>
    This section describes how the assumptions, threats, and organization security policies map to the security objectives.

    <table><tr class='header'><td>Threat, Assumption, or OSP</td><td>Security Objectives</td><td>Rationale</td></tr><tr><td>T.UNAUTHORIZED_DATA_ACCESS</td><td>O.PROTECT_DATA</td><td>The threat T.UNAUTHORIZED_DATA_ACCESS is countered by O.PROTECT_DATA as this
              provides for encryption of data.</td></tr><tr><td>T.MANAGEMENT_ACCESS</td><td>O.MANAGE</td><td>The threat T.UNAUTHORIZED_DATA_ACCESS is countered by O.MANAGE as this
              ensures proper management functionality.</td></tr><tr><td>T.KEYING_MATERIAL_COMPROMISE</td><td>O.KEY_MATERIAL_PROTECTION</td><td>The threat T.KEYING_MATERIAL_COMPROMISE is countered by O.KEY_MATERIAL_PROTECTION as this
              provides for protection of keys.</td></tr><tr><td>T.UNSAFE_AUTHFACTOR_VERIFICATION</td><td>O.SAFE_AUTHFACTOR_VERIFICATION</td><td>The threat T.UNSAFE_AUTHFACTOR_VERIFICATION is countered by O.SAFE_AUTHFACTOR_VERIFICATION as this
              provides for properly supported authentication factors.</td></tr><tr><td>T.KEYSPACE_EXHAUST</td><td>O.FEK_SECURITY</td><td>The threat T.KEYSPACE_EXHAUST is countered by O.FEK_SECURITY as this
              makes brute force attacks infeasible.</td></tr><tr><td>T.PLAINTEXT_COMPROMISE</td><td>O.WIPE_MEMORY</td><td>The threat T.PLAINTEXT_COMPROMISE is countered by O.WIPE_MEMORY as this
              provides data cleanup.</td></tr><tr><td>A.AUTH_FACTOR</td><td>OE.AUTHORIZATION_FACTOR_STRENGTH</td><td>The operational environment objective OE.AUTHORIZATION_FACTOR_STRENGTH is realized through A.AUTH_FACTOR.</td></tr><tr><td>A.EXTERNAL_FEK_PROTECTION</td><td>OE.STRONG_ENVIRONMENT_CRYPTO</td><td>The operational environment objective OE.STRONG_ENVIRONMENT_CRYPTO is realized through A.EXTERNAL_FEK_PROTECTION.</td></tr><tr><td>A.SHUTDOWN</td><td>OE.POWER_SAVE</td><td>The operational environment objective OE.POWER_SAVE is realized through A.SHUTDOWN.</td></tr><tr><td>A.STRONG_OE_CRYPTO</td><td>OE.STRONG_ENVIRONMENT_CRYPTO</td><td>The operational environment objective OE.STRONG_ENVIRONMENT_CRYPTO is realized through A.STRONG_OE_CRYPTO.</td></tr><tr><td>A.FILE_INTEGRITY </td><td>OE.STRONG_ENVIRONMENT_CRYPTO</td><td>The operational environment objective OE.STRONG_ENVIRONMENT_CRYPTO is realized through A.STRONG_OE_CRYPTO.</td></tr></table>
  <h1 class='indexable' data-level='1' id='sfr'>5 Security Requirements</h1>
     This chapter describes the security requirements
     which have to be fulfilled by the product under evaluation. Those requirements comprise functional
     components from Part 2 and assurance components from Part 3 of <a href='#bibCC'>[CC]</a>. The
     following notations are used:
     <ul><li><b>Refinement</b> operation (denoted by <b>bold text</b> or <strike>strikethrough
         text</strike>): is used to add details to a requirement (including replacing an assignment
         with a more restrictive selection) or to remove part of the requirement that is made irrelevant
         through the completion of another operation, and thus further restricts a requirement.
         </li><li><b>Selection</b> (denoted by <i>italicized text</i>): is used to select one or more options
         provided by the [CC] in stating a requirement.</li><li><b>Assignment</b> operation (denoted by <span class='assignable-content'>italicized text</span>): is used to assign a
         specific value to an unspecified parameter, such as the length of a password. Showing the
         value in square brackets indicates assignment.</li><li><b>Iteration</b> operation: are identified with a number inside parentheses (e.g.
         "(1)")</li></ul><h2 class='indexable' data-level='2' id='App'>5.1 App 
      PP Security Functional Requirements Direction
    </h2>
        The TOE is expected to rely on some of the security functions implemented by the application as a whole and evaluated against <a href='#bibAppPP'>[AppPP]</a>.
The following section describes any modifications that the ST author must make to the SFRs defined in the Base-PP in addition to what is mandated by section 5.2.       
      <h2 class='indexable' data-level='3' id='modsfr-App'>5.1.1 
      Modified SFRs
    </h2>
      This PP-Module does not modify any SFRs defined by the App PP.
    <h2 class='indexable' data-level='2' id='man-sfrs'>5.2 TOE Security Functional Requirements</h2>
	The following section describes the SFRs that must be satisfied by any TOE that claims conformance to this PP-Module.
	These SFRs must be claimed regardless of which PP-Configuration is used to define the TOE.
        <h3 class='indexable' data-level='3' id='fcs'>5.2.1 Cryptographic Support (FCS)</h3>
        
        <div class='comp' id='FCS_CKM_EXT.2'><h4>FCS_CKM_EXT.2 File Encryption Key (FEK) Generation</h4>

          

          
          
          
          

          <div class='element'><div class='reqid' id='FCS_CKM_EXT.2.1'><a href='#FCS_CKM_EXT.2.1' class='abbr'>FCS_CKM_EXT.2.1</a></div><div class='reqdesc'>
             The TSF shall 
              [<b>selection</b>: <ul><li><i> accept FEK from an enterprise management server</i>, </li><li><i> generate FEK cryptographic keys <br/>
                  [<b>selection</b>: <ul><li><i> using a Random Bit Generator as specified in FCS_RBG_EXT.1 <b>(from <a href='#bibAppPP'>[AppPP]</a>)</b> and with entropy corresponding to the security strength of AES key sizes of
                      [<b>selection</b>: <i>128 bit</i>, <i>256 bit</i>]</i>, </li><li><i> derived from a password/passphrase that is conditioned as defined in FCS_CKM_EXT.6 </i></li></ul>]
                </i></li></ul>].
            
            
          </div></div>


          <div class='element'><div class='reqid' id='FCS_CKM_EXT.2.2'><a href='#FCS_CKM_EXT.2.2' class='abbr'>FCS_CKM_EXT.2.2</a></div><div class='reqdesc'>
            The TSF shall use a unique FEK for each file (or set of files) using the
              mechanism on the client as specified in FCS_CKM_EXT.2.1.

            
          </div></div>
        </div>






        <div class='comp' id='FCS_CKM_EXT.4'><h4>FCS_CKM_EXT.4 Cryptographic Key Destruction</h4>
          
          
          
          
          
          
          
          <div class='element'><div class='reqid' id='FCS_CKM_EXT.4.1'><a href='#FCS_CKM_EXT.4.1' class='abbr'>FCS_CKM_EXT.4.1</a></div><div class='reqdesc'>
            The TSF shall destroy cryptographic keys in accordance with a specified cryptographic key destruction method 
              [<b>selection</b>: <ul><li><i> For volatile memory, the destruction shall be executed by a
                  [<b>selection</b>: <ul><li><i>single overwrite consisting of 
                      [<b>selection</b>: <i>a pseudo-random pattern using the TSF's RBG</i>, <i>zeroes</i>, <i>ones</i>, <i>new value of a key</i>, <i>[<b>assignment</b>: <span class='assignable-content'>any value that does not contain any CSP</span>]</i>]
                    </i>, </li><li><i>removal of power to the memory</i>, </li><li><i>destruction of reference to the key directly followed by a request for garbage collection</i></li></ul>]
                </i>, </li><li><i> For non-volatile memory, the destruction shall be executed by
                  [<b>selection</b>: <ul><li><i>destruction of all KEKs protecting the target key,
                      where none of the KEKs protecting the target key are derived
                    </i>, </li><li><i> the invocation of an interface provided by the underlying platform that
                  [<b>selection</b>: <ul><li><i>logically addresses the storage location of the key and performs a
                      [<b>selection</b>: <i>single</i>, <i>[<b>assignment</b>: <span class='assignable-content'>ST author defined multi-pass</span>]</i>]
                      overwrite consisting of 
                      [<b>selection</b>: <i>a pseudo-random pattern using the TSF's RBG</i>, <i>zeroes</i>, <i>ones</i>, <i>new value of a key</i>, <i>[<b>assignment</b>: <span class='assignable-content'>any value that does not contain any CSP</span>]</i>]
                    </i>, </li><li><i>instructs the underlying platform to destroy the abstraction that represents the key</i></li></ul>]
                    </i></li></ul>]


                </i></li></ul>].
            
            <div class='appnote'><span class='note-header'>Application Note: </span><span class='note'>              
              The interface referenced in the requirement could take different forms, the most likely 
              of which is an application programming interface to an OS kernel. There may be various levels of abstraction visible. 
              For instance, in a given implementation that overwrites a key stored in non-volatile memory, the application may have 
              access to the file system details and may be able to logically address specific memory locations. In another 
              implementation that instructs the underlying platform to destroy the representation of a key stored in non-volatile 
              memory, the application may simply have a handle to a resource and can only ask the platform to delete the resource, 
              as may be the case with a platforms secure key store. The latter implementation should only be used for the most 
              restricted access. The level of detail to which the TOE has access will be reflected in the TSS section of the ST. 
              Several selections allow assignment of a 'value that does not contain any CSP'. This means that the TOE uses some 
              other specified data not drawn from a source that may contain key material or reveal information about key material, 
              and not being any of the particular values listed as other selection options. The point of the phrase 'does not contain 
              any CSP' is to ensure that the overwritten data is carefully selected, and not taken from a general 'pool' that might 
              contain current or residual data that itself requires confidentiality protection.<br/><br/>

              For the selection "destruction of all KEKs protecting target key, where 
              none of the KEKs protecting the target key are derived", a key can be considered destroyed by destroying the key that 
              protects the key. If a key is wrapped or encrypted it is not necessary to "overwrite" that key, overwriting the key 
              that is used to wrap or encrypt the key used to encrypt/decrypt data, using the appropriate method for the memory 
              type involved, will suffice. For example, if a product uses a Key Encryption Key (KEK) to encrypt a File Encryption 
              Key (FEK), destroying the KEK using one of the methods in FCS_CKM_EXT.4 is sufficient, since the FEK would no longer 
              be usable (of course, presumes the FEK is still encrypted and the KEK cannot be recovered or re-derived). </span></div>

          </div></div>

          <div class='element'><div class='reqid' id='FCS_CKM_EXT.4.2'><a href='#FCS_CKM_EXT.4.2' class='abbr'>FCS_CKM_EXT.4.2</a></div><div class='reqdesc'>
            The TSF shall destroy all keys and key material when no longer needed.

            <div class='appnote'><span class='note-header'>Application Note: </span><span class='note'>
              
              Keys, including intermediate keys and key material that are no longer
              needed are destroyed by using an approved method, FCS_CKM_EXT.4.1. Examples of keys are
              intermediate keys, submasks. There may be instances where keys or key material
              that are contained in persistent storage are no longer needed and require destruction. 
              Base on their implementation, vendors will explain when certain keys are no longer needed. There
              are multiple situations in which key material is no longer necessary, for example, a wrapped
              key may need to be destroyed when a password is changed. However, there are instances
              when keys are allowed to remain in memory, for example, a device identification key. If a
              PIN was used for a smart card and managed by the TOE, ensuring that the PIN was properly destroyed must be addressed.
                              
              
            </span></div>
            
          </div></div>
        </div>


        
        <div class='comp' id='FCS_IV_EXT.1'><h4>FCS_IV_EXT.1 Initialization Vector Generation</h4>
          
          
          
          
          
          
          <div class='element'><div class='reqid' id='FCS_IV_EXT.1.1 '><a href='#FCS_IV_EXT.1.1 ' class='abbr'>FCS_IV_EXT.1.1 </a></div><div class='reqdesc'>
            The TSF shall [<b>selection</b>: <ul><li><i>invoke platform-provided functionality to generate IVs</i>, </li><li><i>generate IVs with the following properties
                [<b>selection</b>: <ul><li><i>CBC: IVs shall be non-repeating and unpredictable</i>, </li><li><i>CCM: Nonce shall be non-repeating and unpredictable</i>, </li><li><i>XTS: No IV. Tweak values shall be non-negative integers, assigned consecutively,
                  and starting at an arbitrary non-negative integer</i>, </li><li><i>GCM: IV shall be non-repeating. The number of invocations of GCM shall not exceed
                  2^32 for a given secret key</i></li></ul>]</i></li></ul>].
                        
            
            
          </div></div>
          
        </div>

        
        <div class='comp' id='FCS_KYC_EXT.1'><h4>FCS_KYC_EXT.1 Key Chaining and Key Storage</h4>
          
          
          
          
          
          
          
          
          <div class='element'><div class='reqid' id='FCS_KYC_EXT.1.1'><a href='#FCS_KYC_EXT.1.1' class='abbr'>FCS_KYC_EXT.1.1</a></div><div class='reqdesc'>
             The TSF shall maintain a key chain of: 
              [<b>selection</b>: <ul><li><i>a conditioned password as the [<i>FEK</i>]</i>, </li><li><i>[<i>KEKs</i>] originating from <b> 
                  [<b>selection</b>: <i>one or more authorization factors(s)</i>, <i>a file encryption enterprise management server</i>] </b> to <b> 
                  [<b>selection</b>: <i>the FEK(s)</i>, <i>a file encryption enterprise management server</i>] </b>
                  using the following method(s): 
                  [<b>selection</b>: <ul><li><i>utilization of the platform key storage</i>, </li><li><i>utilization of platform key storage that performs key wrap with a
                      TSF provided key</i>, </li><li><i>implementation of key wrapping as specified in FCS_COP.1<b>(5)</b></i>, </li><li><i>implementation of key combining as specified in FCS_SMC_EXT.1</i>, </li><li><i>implementation of key encryption as specified in FCS_COP.1<b>(7)</b></i>, </li><li><i>implementation of key transport as specified in FCS_COP.1<b>(6)</b></i>, </li><li><i>implementation of key derivation as specified in FCS_KDF_EXT.1</i></li></ul>] while maintaining an effective strength of 
                    [<b>selection</b>: <ul><li><i>
                        [<b>selection</b>: <i>128 bits</i>, <i>256 bits</i>] for symmetric keys
                      </i>, </li><li><i>
                        [<b>selection</b>: <i>128 bits</i>, <i>192 bits</i>, <i>256 bits</i>] for asymmetric keys
                      </i></li></ul>] commensurate with the strength of the FEK
                </i></li></ul>] 
              and 
              [<b>selection</b>: <ul><li><i> no supplemental key chains</i>, </li><li><i> other supplemental key chains that protect a key or keys in the primary key chain using the following method(s):
                  [<b>selection</b>: <ul><li><i>utilization of the platform key storage</i>, </li><li><i>utilization of platform key storage that performs key wrap with a
                      TSF provided key</i>, </li><li><i>implementation of key wrapping as specified in FCS_COP.1<b>(5)</b></i>, </li><li><i>implementation of key combining as specified in FCS_SMC_EXT.1</i>, </li><li><i>implementation of key encryption as specified in FCS_COP.1<b>(7)</b></i>, </li><li><i>implementation of key transport as specified in FCS_COP.1<b>(6)</b></i>, </li><li><i>implementation of key derivation as specified in FCS_KDF_EXT.1</i></li></ul>]</i></li></ul>].
            
            <div class='appnote'><span class='note-header'>Application Note: </span><span class='note'>
              
              
              Key Chaining is the method of using multiple layers of
              encryption keys to ultimately secure the FEK. The number of intermediate keys will
              vary. This applies to all keys that contribute to the ultimate wrapping or derivation
              of the FEK. For the first selection, the ST author
              selects the method used for the keychain.  <br/><br/>

              If the second option is chosen ("KEKs originating:")
              , then the ST author chooses all methods for production and protection of KEKs in the keychain 
              from the options in the second selection.  For this option, the ST author must also specify the 
              strength of the keys in the keychain.  It should be noted that "maintaining overall strength:
              commensurate with the overall strength of the FEK" is meant to cover the use case for this PP-Module 
              of a powered-off device being recovered by an adversary, who subsequently attempts to recover 
              the FEK through a compromise of the key chain. <br/><br/>

              The third selection in the requirement is used to select the types of keys used in the key chain 
              (both symmetric and asymmetric keys are allowed).  The bit sizes selected in the fourth 
              and fifth selections are chosen by the ST author to be commensurate with the strength of 
              the FEK in the following manner: for symmetric FEKs of 128 bits, the ST author can select 
              any of the choices for both symmetric and asymmetric keys.  For symmetric FEKs of 256 bits, 
              the ST author selects 256 bits if the symmetric key option is chosen and 192 bits or 256 bits 
              if the asymmetric key option is chosen.<br/><br/>

              If a supplemental keychain is used, then the ST author selects the second option in the sixth 
              selection and then chooses the method by which these keys are protected.  Keys in the 
              supplemental key chain may be of any size, as they only provide additional protection to the 
              primary key chain.  Compromise (according the PP-Module use case) of the secondary key chain cannot 
              circumvent the protection provided by the primary keychain. <br/><br/>

             If the selections where the TOE implements KEKs are chosen for the primary or supplemental key chains
             then FCS_CKM_EXT.3 shall be included.<br/><br/>

            The selections for an enterprise management server permit the key chain may originate or terminate from 
            an enterprise management server.  <br/><br/>
              The server may provide a key needed to start a chain or the server may receive a key that ends a chain.  <br/><br/>
              The key management internal to the server is not evaluated here. This permits the enterprise management server to 
            function in the middle of a larger key chain.</span></div>
            
          </div></div>
          
          
          
        </div>

        
        <div class='comp' id='FCS_VAL_EXT.1'><h4>FCS_VAL_EXT.1 Validation</h4>
      
          
          
          
          
          
          
          
          
          <div class='element'><div class='reqid' id='FCS_VAL_EXT.1.1 '><a href='#FCS_VAL_EXT.1.1 ' class='abbr'>FCS_VAL_EXT.1.1 </a></div><div class='reqdesc'>
            
            The TSF shall perform validation of the [<i>user</i>] by 
              [<b>selection</b>: <ul><li><i>receiving assertion of the subject's validity from [<b>assignment</b>: <span class='assignable-content'>Operational Environment component responsible for authentication</span>]</i>, </li><li><i>validating the [<b>selection</b>: <i>submask</i>, <i>intermediate key</i>] using the following methods: [<b>selection</b>: <ul><li><i>key wrap as specified in FCS_COP.1<b>(5)</b></i>, </li><li><i>hash the 
                    [<b>selection</b>: <i>submask</i>, <i>intermediate key</i>, <i>FEK</i>] as specified in FCS_COP.1<b>(2)</b> <b>(from <a href='#bibAppPP'>[AppPP]</a>)</b> and compare it to a stored hash</i>, </li><li><i>decrypt a known value using the 
                    [<b>selection</b>: <i>submask</i>, <i>intermediate key</i>, <i>FEK</i>] as specified in FCS_COP.1<b>(1)</b> <b>(from <a href='#bibAppPP'>[AppPP]</a>)</b> and compare it against a stored known value</i></li></ul>]</i></li></ul>]. 
              
            
              
              
              
              
              
            
          </div></div>
          <div class='element'><div class='reqid' id='FCS_VAL_EXT.1.2'><a href='#FCS_VAL_EXT.1.2' class='abbr'>FCS_VAL_EXT.1.2</a></div><div class='reqdesc'>
            The TSF shall require validation of the [<i>user</i>] prior to [<i>decrypting any FEK</i>].
            
            
            <div class='appnote'><span class='note-header'>Application Note: </span><span class='note'>Two iterations of this SFR are also defined in PP-Module for File Encryption Enterprise Management. 
              If the TOE also claims this module, the ST author should iterate these SFRs by using "/FE" and "/EM" as unique identifiers for the iterations. This will allow the reader
              to easily determine which iteration applies to each TOE component.<br/><br/> 
            </span></div>          
            
            
          </div></div>
          
        </div>



      <h3 class='indexable' data-level='3' id='fdp'>5.2.2 User Data Protection (FDP)</h3>
        
        
        <div class='comp' id='FDP_PRT_EXT.1'><h4>FDP_PRT_EXT.1 Protection of Selected User Data</h4>
          
          
          
          
          
          
          
          
          <div class='element'><div class='reqid' id='FDP_PRT_EXT.1.1'><a href='#FDP_PRT_EXT.1.1' class='abbr'>FDP_PRT_EXT.1.1</a></div><div class='reqdesc'>
            The TSF shall perform encryption and decryption of the user-selected file (or set
              of files) in accordance with FCS_COP.1(1) <b>(from <a href='#bibAppPP'>[AppPP]</a>)</b>. 
            <div class='appnote'><span class='note-header'>Application Note: </span><span class='note'>This is the primary requirement for encrypting and decrypting
              the protected resources (files and sets of files). </span></div>
            
          </div></div>
          <div class='element'><div class='reqid' id='FDP_PRT_EXT.1.2'><a href='#FDP_PRT_EXT.1.2' class='abbr'>FDP_PRT_EXT.1.2</a></div><div class='reqdesc'>
             The TSF shall [<b>selection</b>: <i>invoke platform-provided functionality</i>, <i>implement functionality</i>] to ensure that all sensitive data created by the TOE when
              decrypting/encrypting the user-selected file (or set of files) are destroyed in
              volatile and non-volatile memory when the data is no longer needed according to FCS_CKM_EXT.4. 

            <div class='appnote'><span class='note-header'>Application Note: </span><span class='note'> The intent is that the TSF controls the use and clearing of any data
              that it manipulates that is not needed by the user (e.g. a temporary file created in non-volatile
              memory during the encryption/decryption process would be destroyed as soon as the process is completed).
              This should not prevent expected usage (e.g. the TOE may create a decrypted copy of a file as requested
              by the user). The TSF is also not responsible for temporary files that  non-TSF application creates 
              (for example, a text editor may create a "checkpoint" file when editing a file that is protected by the TOE;
              the TOE does not have to try to keep track of or clean up these "checkpoint" files). An optional
              requirement on cleaning up the temporary files created by non-TSF application when operating on
              files protected by the TOE is FDP_PRT_EXT.3.1.

            While these data sets are not keys, they can follow the same deletion procedures described in FCS_CKM_EXT.4.</span></div>

            
          </div></div>
        </div>
        <div class='comp' id='FDP_PRT_EXT.2'><h4>FDP_PRT_EXT.2 Destruction of Plaintext Data</h4>
          
          
          
          
          
          
          
          
        <div class='element'><div class='reqid' id='FDP_PRT_EXT.2.1'><a href='#FDP_PRT_EXT.2.1' class='abbr'>FDP_PRT_EXT.2.1</a></div><div class='reqdesc'>
          The TSF shall [<b>selection</b>: <i>invoke platform-provided functionality</i>, <i>implement functionality</i>] to ensure that all original plaintext data created when
            decrypting/encrypting the user-selected file (or set of files) are destroyed in volatile
            and non-volatile memory according to FCS_CKM_EXT.4 upon completion of the decryption/encryption operation.
          

          <div class='appnote'><span class='note-header'>Application Note: </span><span class='note'> This is the primary requirement for encrypting and decrypting
            the protected resources (file or set of files). <br/><br/>

            For FDP_PRT_EXT.2.1, the intent is that the TSF controls the use and clearing of any data that it manipulates. It
            needs to ensure that no plaintext data from encrypted resources
            remains after the TSF has finished operating on that resource. In the context of
            FDP_PRT_EXT.2.1, the TSF has completed the decryption operation after it has decrypted
            the file or set of files for use by an application, and completed the encryption
            operation after it has encrypted the file or set of files for storage in the file
            system. <br/><br/>

            While these data sets are not keys, they can follow the same deletion procedures described in FCS_CKM_EXT.4.
          </span></div>

          
        </div></div>


      </div>

       


      <h3 class='indexable' data-level='3' id='fia'>5.2.3 Identification and Authentication (FIA)</h3>
        
                
        <div class='comp' id='FIA_AUT_EXT.1'><h4>FIA_AUT_EXT.1 Subject Authorization</h4>
          
          
          
          
          
          
          
          
          <div class='element'><div class='reqid' id='FIA_AUT_EXT.1.1'><a href='#FIA_AUT_EXT.1.1' class='abbr'>FIA_AUT_EXT.1.1</a></div><div class='reqdesc'>
            The TSF shall 
              [<b>selection</b>: <i>implement platform-provided functionality to provide user
                  authorization</i>, <i>provide user authorization</i>] based on 
              [<b>selection</b>: <ul><li><i> a password authorization factor conditioned as defined in FCS_CKM_EXT.6</i>, </li><li><i>an external smart card factor that is at least the same bit-length as the FEK(s), and is protecting a submask that is 
                   [<b>selection</b>: <i>generated by the TOE (using the RBG as specified in FCS_RBG_EXT.1 <b>(from <a href='#bibAppPP'>[AppPP]</a>)</b>)</i>, <i>generated by the platform</i>] protected using RSA with key size 
                  [<b>selection</b>: <i>3072 bits</i>, <i>4096 bits</i>] with user presence proved by presentation of the smart card and 
                  [<b>selection</b>: <i>no PIN</i>, <i>an OE defined PIN</i>, <i>a configurable PIN</i>]
                </i>, </li><li><i>an external USB token factor that is at least the same security strength as the FEK(s),
                   and is providing a submask generated by the 
                   [<b>selection</b>: <i>TOE (using the RBG as specified in FCS_RBG_EXT.1 <b>(from <a href='#bibAppPP'>[AppPP]</a>)</b>)</i>, <i>platform</i>]
                </i></li></ul>].
            
            <div class='appnote'><span class='note-header'>Application Note: </span><span class='note'>
			  
			  If the ST author selects "provide user authorization", the selection-based requirement FCS_VAL_EXT.2 must also be claimed.<br/><br/>
              
              This requirement specifies what authorization factors the TOE accepts
             from the user. A password entered by the user is one authorization factor that the TOE must 
             be able to condition, as specified in FCS_CKM_EXT.6. Another option is a smart card
             authorization factor, with the differentiating feature being how the value is generated - either
             by the TOE's RBG or by the platform. An external USB token may also be used, with the
             submask value generated either by the TOE's RBG or by the platform.<br/><br/>
             The TOE may accept any number of authorization factors, and these are categorized as
             "submasks". The ST author selects the authorization factors they support, and there may be
             multiple methods for a selection.<br/><br/>
             Use of multiple authorization factors is preferable; if more than one authorization factor is
             used, the submasks produced must be combined using FCS_SMC_EXT.1. </span></div>


            
            
          </div></div>
        </div>

      <h3 class='indexable' data-level='3' id='fmt'>5.2.4 Security Management (FMT)</h3> 
        
        
	      
        <div class='comp' id='FMT_SMF.1(2)'><h4>FMT_SMF.1(2) Specification of File Encryption Management Functions</h4>
          
          <div class='element'><div class='reqid' id='FMT_SMF.1.1(2)'><a href='#FMT_SMF.1.1(2)' class='abbr'>FMT_SMF.1.1(2)</a></div><div class='reqdesc'>
            The TSF shall be capable of performing the following management functions: <b>
              [<b>selection</b>: <ul><li><i>configure cryptographic functionality</i>, </li><li><i>change authentication factors</i>, </li><li><i>perform a cryptographic erase of the data by the destruction of FEKs or KEKs protecting the FEKs as described in FCS_CKM_EXT.4.1</i>, </li><li><i>configure the number of failed validation attempts required to trigger corrective behavior  </i>, </li><li><i>configure the corrective behavior to issue in the event of an excessive number of failed validation attempts</i>, </li><li><i>[<b>assignment</b>: <span class='assignable-content'>other management functions provided by the TSF</span>]</i></li></ul>]</b>.
            
            <div class='appnote'><span class='note-header'>Application Note: </span><span class='note'>
              
              The intent of this requirement is to express the management
              capabilities that may be included in the TOE. Several common options are given:<br/>
              <ul>
                <li>If the TOE provides configurability of the cryptographic functions (for example,
                  key size of the FEK)-even if the configuration is the form of parameters that may
                  be passed to cryptographic functionality implement on the TOE platform--then
                  "configure cryptographic functionality" will be included, and the specifics of the
                  functionality offered can either be written in this requirement as bullet points,
                  or included in the TSS.</li>
                <li>If the TOE uses stored FEKS or KEKs(the FEK is not directly derived from a password)
                  , then "perform a cryptographic erase of the data by the destruction of FEKs or KEKs protecting the FEKs as described in FCS_CKM_EXT.4.1" will be included. 
                  This function should be able to be triggered by a user or admin and may be triggered by uninstallation.</li>
                <li>If "other management functions" are assigned, a validation authority must be
                  consulted to ensure the evaluation activities and other functionality requirements
                  that may be needed are appropriately specified so that the ST can claim
                  conformance to this PP-Module.</li>
              </ul>
              <br/>
              This list is in addition to the list of functions as specified in, FMT_SMF.1 in the AppPP.
            </span></div>
            
          </div></div>
        </div>

      <h3 class='indexable' data-level='3' id='fpt'>5.2.5 Protection of the TSF (FPT)</h3>

        
        <div class='comp' id='FPT_KYP_EXT.1'><h4>FPT_KYP_EXT.1 Protection of Keys and Key Material</h4>
          
          
          
          
          
          
          
          
          <div class='element'><div class='reqid' id='FPT_KYP_EXT.1.1'><a href='#FPT_KYP_EXT.1.1' class='abbr'>FPT_KYP_EXT.1.1</a></div><div class='reqdesc'>
            The TSF shall 
              [<b>selection</b>: <ul><li><i>not store keys in non-volatile memory</i>, </li><li><i>store keys in non-volatile memory only when
                  [<b>selection</b>: <ul><li><i>wrapped, as specified in FCS_COP.1(5)</i>, </li><li><i>encrypted, as specified in FCS_COP.1(7)</i>, </li><li><i>the plaintext key is stored in the underlying platform's keystore as specified by FCS_STO_EXT.1.1 <b>(from <a href='#bibAppPP'>[AppPP]</a>)</b></i>, </li><li><i>the plaintext key is not part of the key chain as specified in FCS_KYC_EXT.1.</i>, </li><li><i>the plaintext key will no longer provide access to the encrypted data after initial provisioning</i>, </li><li><i>the plaintext key is a key split that is combined as specified in FCS_SMC_EXT.1 and another contribution to the split is
                     [<b>selection</b>: <ul><li><i>wrapped as specified in FCS_COP.1(5)</i>, </li><li><i>encrypted as specified in FCS_COP.1(7)</i>, </li><li><i>derived as specified in FCS_KDF_EXT.1.1 and not stored in non-volatile memory</i>, </li><li><i>supplied by the enterprise management server</i></li></ul>]
                    </i>, </li><li><i>the plaintext key is stored on an external storage device for use as an authorization factor.</i>, </li><li><i>the plaintext key is used to encrypt a key as specified in FCS_COP.1(7) or wrap a key as specified in FCS_COP.1(5) 
                      that is already encrypted as specified in FCS_COP.1(7) or wrapped as specified in FCS_COP.1(5)</i></li></ul>]
                </i></li></ul>].
            
            <div class='appnote'><span class='note-header'>Application Note: </span><span class='note'>
              
              The plaintext key storage in non-volatile memory is allowed for
              several reasons. If the keys exist within protected memory that is not user accessible
              on the TOE or OE, the only methods that allow it to play a security relevant role for
              protecting the FEK is if it is a key split or providing additional layers of wrapping
              or encryption on keys that have already been protected. </span></div>
            
          </div></div>
        </div>
      <h1 class='indexable' data-level='1' id='mod-conrat'>6 Consistency Rationale</h1><h2 class='indexable' data-level='2' id='conrat-App'>6.1 Application Software Protection Profile
      </h2><h3 class='indexable' data-level='3' id='contoe-App'>6.1.1 
	Consistency of TOE Type
      </h3><h3 class='indexable' data-level='3' id='consecprob-App'>6.1.2 
	Consistency of Security Problem Definition
      </h3>
      The threats defined by this PP-Module (see section 3.1) supplement those defined in the
      App PP as follows:
      <table><tr><th>PP-Module Threat</th><th>Consistency Rationale</th></tr><tr><td>T.UNAUTHORIZED_DATA_ACCESS</td><td>This threat is a variation on T.PHYSICAL_ACCESS defined in the Base-PP.
        In this case, the "sensitive data at rest" is the data that the TOE is intended to protect.</td></tr><tr><td>T.MANAGEMENT_ACCESS</td><td>This threat is a variation on T.LOCAL_ATTACK defined in the Base-PP.
        The Base-PP does not define access-controlled management functions so this PP-Module goes beyond it by specifying misuse of the management interface, or
        inability to fully use the management interface, as threats to the TSF.</td></tr><tr><td>T.KEYING_MATERIAL_COMPROMISE</td><td>This threat is a specific example of T.PHYSICAL_ACCESS defined in the Base-PP. 
        Specifically, this PP-Module defines a method of maliciously gaining access to sensitive data at rest that is particular to the technology type of this PP-Module.</td></tr><tr><td>T.UNSAFE_AUTHFACTOR_VERIFICATION</td><td>This threat is a specific example of T.PHYSICAL_ACCESS defined in the Base-PP. 
        Specifically, this PP-Module defines a method of maliciously gaining access to sensitive data at rest that is particular to the technology type of this PP-Module.</td></tr><tr><td>T.KEYSPACE_EXHAUST</td><td>This threat is a specific example of T.PHYSICAL_ACCESS defined in the Base-PP. 
        Specifically, this PP-Module defines a method of maliciously gaining access to sensitive data at rest that is particular to the technology type of this PP-Module.</td></tr><tr><td>T.PLAINTEXT_COMPROMISE</td><td>This threat is a specific example of T.PHYSICAL_ACCESS defined in the Base-PP. 
        Specifically, this PP-Module defines a method of maliciously gaining access to sensitive data at rest that is particular to the technology type of this PP-Module.</td></tr></table><h3 class='indexable' data-level='3' id='conobj-App'>6.1.3 
	Consistency of Objectives
      </h3><p>
	  The objectives for the TOEs are consistent with the App PP based on the following rationale:
      <table><tr><th>PP-Module TOE Objective</th><th>Consistency Rationale</th></tr><tr><td>O.KEY_MATERIAL_PROTECTION</td><td>

            This objective is consistent with the Base-PP because the Base-PP includes the O.PROTECTED_STORAGE objective. 
            The protection and timely destruction of key materials is consistent with the intent of that objective.

          </td></tr><tr><td>O.FEK_SECURITY</td><td>
            This objective is consistent with the Base-PP because it is a method of supporting the Base-PP's O.PROTECTED_STORAGE objective that is specific to this technology type.
          </td></tr><tr><td>O.WIPE_MEMORY</td><td>
            This objective is consistent with the Base-PP because it is a method of supporting the Base-PP's O.PROTECTED_STORAGE objective that is specific to this technology type.
          </td></tr><tr><td>O.PROTECT_DATA</td><td>
            This objective is consistent with the Base-PP because it is a method of supporting the Base-PP's O.PROTECTED_STORAGE objective that is specific to this technology type.
          </td></tr><tr><td>O.SAFE_AUTHFACTOR_VERIFICATION</td><td>
            This objective is consistent with the Base-PP because it is a method of supporting the Base-PP's O.PROTECTED_STORAGE objective that is specific to this technology type.
          </td></tr><tr><td>O.MANAGE</td><td>
            The Base-PP does not define functionality for protected administrative access to the TSF so this objective relates solely to material beyond the scope of the Base-PP.
          </td></tr></table></p><p>
	  The objectives for the TOE's Operational Environment are consistent with the App PP based on the following rationale:
      <table><tr><th>PP-Module Operational Environment Objective</th><th>Consistency Rationale</th></tr><tr><td>OE.AUTHORIZATION_FACTOR_STRENGTH</td><td>
            This objective is consistent with the Base-PP because this functionality is beyond the scope of what the Base-PP defines. Therefore, the use and strength of 
            external authorization factors does not affect the ability of any Base-PP SFRs or objectives to be satisfied.
          </td></tr><tr><td>OE.POWER_SAVE</td><td>
            This objective is consistent with the Base-PP because it is an extension of the Base-PP's OE.PLATFORM objective that is specific to this technology type.
          </td></tr><tr><td>OE.STRONG_ENVIRONMENT_CRYPTO</td><td>
            This objective is consistent with the Base-PP because the Base-PP allows for the TOE to use platform-provided cryptography.
          </td></tr></table></p><h3 class='indexable' data-level='3' id='conreq-App'>6.1.4 
	Consistency of Requirements
      </h3>
      This PP-Module identifies several SFRs from the 
      App PP that are needed to support 
      File Encryption functionality.
      This is considered to be consistent because the functionality provided by the 
      App  is being used for its intended purpose.
      The PP-Module also identifies a number of modified SFRs from the 
      App PP
      as well as new SFRs that are used entirely to provide functionality for 
      File Encryption.
      The rationale for why this does not conflict with the claims 
      defined by the 
      App PP are as follows:
      <table><tr><th>PP-Module Requirement</th><th>Consistency Rationale</th></tr><tr><th colspan='2'> Modified SFRs</th></tr><tr><td colspan='2' style='text-align:center'>
	    This PP-Module does not modify any requirements when the 
	    App PP is the base.
	  </td></tr><tr><th colspan='2'> Mandatory SFRs</th><tr><td>FCS_CKM_EXT.2</td><td>This SFR describes behavior that is not in scope of the Base-PP. 
            It is consistent with the Base-PP because it may use the same random bit generation function defined in the Base-PP.
          </td></tr><tr><td>FCS_CKM_EXT.4</td><td>This SFR extends the cryptographic functionality defined in the Base-PP by specifying a method for key destruction. 
            It is consistent with the Base-PP because keys generated by the Base-PP portion of the TOE may also be destroyed in the manner specified by this SFR.
          </td></tr><tr><td>FCS_IV_EXT.1</td><td>This SFR defines how IVs for AES keys must be generated. This is consistent with the Base-PP because it supplements the key generation 
            methods specified by the Base-PP SFR FCS_CKM.1(2).
          </td></tr><tr><td>FCS_KYC_EXT.1</td><td>The Base-PP defines how stored keys are protected. This SFR extends that functionality by defining the logical hierarchy of how keys are logically
            protected by other keys or other secret data. 
          </td></tr><tr><td>FCS_VAL_EXT.1</td><td>This SFR goes beyond the functionality defined by the Base-PP by defining a method by which the TSF can validate the correctness of data input to it.
          </td></tr><tr><td>FDP_PRT_EXT.1</td><td>This SFR is consistent with the Base-PP because it is a specific application of the FCS_COP.1(1) function defined in the Base-PP.
          </td></tr><tr><td>FDP_PRT_EXT.2</td><td>This SFR relates to the destruction of key data, which is beyond the scope defined by the Base-PP and does not affect the ability of the Base-PP 
           SFRs to be enforced.
          </td></tr><tr><td>FIA_AUT_EXT.1</td><td>This SFR defines how user requests to access protected data are authorized. It uses FCS_RBG_EXT.1 from the Base-PP in a manner consistent with its 
            definition, but otherwise does not relate to functionality defined by the Base-PP.
          </td></tr><tr><td>FMT_SMF.1(2)</td><td>This SFR defines management functions for the TOE for functionality specific to this PP-Module. These functions are defined in addition to what 
            the Base-PP defines for its own operation.
          </td></tr><tr><td>FPT_KYP_EXT.1</td><td>The Base-PP defines an SFR for secure storage of sensitive data. This SFR expands on that definition by describing the supported logical methods 
            for storage of key data.
          </td></tr></tr><tr><th colspan='2'> Optional SFRs</th><tr><td>FCS_CKM_EXT.5</td><td>This SFR supports the PP-Module's data authentication function, which does not relate to any functionality defined in the Base-PP.
          </td></tr><tr><td>FCS_COP_EXT.1</td><td>This SFR defines usage of AES functionality not defined by the Base-PP. However, this functionality is only used in certain situations that are 
            specific to this PP-Module and do not affect the ability for any Base-PP SFRs to be enforced.
          </td></tr><tr><td>FDP_AUT_EXT.1</td><td>This SFR relates to data authentication, which does not relate to any functionality defined in the Base-PP.
           </td></tr><tr><td>FDP_AUT_EXT.2</td><td>This SFR relies on cryptographic functionality defined by the Base-PP. However, the function itself does not relate to any behavior 
             defined in the Base-PP.
           </td></tr><tr><td>FDP_AUT_EXT.3</td><td>This SFR relies on cryptographic functionality defined by the Base-PP. However, the function itself does not relate to any behavior 
             defined in the Base-PP.
           </td></tr><tr><td>FDP_PM_EXT.1</td><td>This SFR describes the behavior of the TSF when its host platform is in a locked or unpowered state, which does not relate to any functionality 
                 defined in the Base-PP.
               </td></tr><tr><td>FDP_PRT_EXT.3</td><td>This SFR relates to the PP-Module's file encryption capability. This goes beyond the sensitive data protection defined in the Base-PP but 
                 does not prevent the Base-PP functions from being enforced.
               </td></tr><tr><td>FIA_FCT_EXT.1</td><td>This SFR relates to the use of authorization factors, which does not relate to any behavior described in the Base-PP.
          </td></tr><tr><td>FIA_FCT_EXT.2</td><td>This SFR relates to key sharing, which does not relate to any behavior described in the Base-PP.
          </td></tr></tr><tr><th colspan='2'> Selection-based SFRs</th><tr><td>FCS_CKM_EXT.3</td><td>This SFR relates to how KEKs are made available to the TSF, which are used for functionality that does not relate to the Base-PP.
        </td></tr><tr><td>FCS_CKM_EXT.6</td><td>This SFR defines a key derivation method based on passphrase conditioning. It uses the FCS_RBG_EXT.1 SFR from the Base-PP in its intended manner 
            but otherwise does not relate to the Base-PP's functionality.
          </td></tr><tr><td>FCS_COP.1(5)</td><td>This SFR defines usage of AES functionality not defined by the Base-PP. However, this functionality is only used in certain situations that are 
            specific to this PP-Module and do not affect the ability of any Base-PP SFRs to be enforced.
          </td></tr><tr><td>FCS_COP.1(6)</td><td>This SFR defines key transport functionality that is outside the scope of the original cryptographic operations defined in the Base-PP.
          </td></tr><tr><td>FCS_COP.1(7)</td><td>This SFR defines key encryption functionality that is outside the scope of the original cryptographic operations defined in the Base-PP.
          </td></tr><tr><td>FCS_KDF_EXT.1</td><td>This SFR defines key transport functionality. It uses random bit generation and keyed-hash message authentication functionality from the Base-PP 
            as they are intended but is otherwise outside the scope of the original cryptographic operations defined in the Base-PP.
          </td></tr><tr><td>FCS_SMC_EXT.1</td><td>This SFR relates to submask combining as a method of generating intermediate keys. Key hierarchy functionality is outside the scope of the Base-PP.
          </td></tr><tr><td>FCS_VAL_EXT.2</td><td>This SFR goes beyond the functionality defined by the Base-PP by defining a method by which the TSF can take security-relevant action if some data input to it is invalid.
            </td></tr></tr><tr><th colspan='2'> Objective SFRs</th><tr><td colspan='2' style='text-align:center'>
	      This PP-Module does not define any objective requirements.
	    </td></tr></tr></table><h1 class='indexable' data-level='A' id='opt-sfrs'>Appendix A -  Optional SFRs</h1><div class='comp' id='FCS_CKM_EXT.5'><h4>FCS_CKM_EXT.5 File Authentication Key (FAK) Support</h4>
          
          
          
          
          
          
          
          
          <div class='element'><div class='reqid' id='FCS_CKM_EXT.5.1'><a href='#FCS_CKM_EXT.5.1' class='abbr'>FCS_CKM_EXT.5.1</a></div><div class='reqdesc'>
             The TSF shall use a FAK to authenticate sensitive data when a cryptographic, keyed
              hashing function is used for data authentication and shall be supported in the following
              manner: [<b>selection</b>: <ul><li><i>A FAK conditioned from a password/passphrase shall never be stored in
                  non-volatile memory</i>, </li><li><i>a FAK will be stored in non-volatile memory encrypted with a KEK as
                  specified in FCS_COP.1(5) using authorization factors as specified in FIA_AUT_EXT.1
                </i></li></ul>].
            
          </div></div>
          <div class='element'><div class='reqid' id='FCS_CKM_EXT.5.2'><a href='#FCS_CKM_EXT.5.2' class='abbr'>FCS_CKM_EXT.5.2</a></div><div class='reqdesc'>
            The TSF shall create a unique FAK for each file (or set of files) using the
              mechanism on the client as specified in FCS_RBG_EXT.1 <b>(from <a href='#bibAppPP'>[AppPP]</a>)</b>.
          </div></div>
          <div class='element'><div class='reqid' id='FCS_CKM_EXT.5.3'><a href='#FCS_CKM_EXT.5.3' class='abbr'>FCS_CKM_EXT.5.3</a></div><div class='reqdesc'>
            The FAKs must be generated by the TOE as specified in FDP_AUT_EXT.2.9.
          </div></div>
          <div class='element'><div class='reqid' id='FCS_CKM_EXT.5.4'><a href='#FCS_CKM_EXT.5.4' class='abbr'>FCS_CKM_EXT.5.4</a></div><div class='reqdesc'>
            The TSF will not write FAKs to non-volatile memory.
          </div></div>
          <div class='element'><div class='reqid' id='FCS_CKM_EXT.5.5'><a href='#FCS_CKM_EXT.5.5' class='abbr'>FCS_CKM_EXT.5.5</a></div><div class='reqdesc'>
            The FAK shall be protected in a manner conformant to FCS_COP_EXT.1.
            <div class='appnote'><span class='note-header'>Application Note: </span><span class='note'> The intent of this requirement is to describe the different
              methods that a FAK can be created and formed. <br/><br/>FCS_CKM_EXT.5.1 details how a FAK is stored. <br/><br/>
              FCS_CKM_EXT.5.2 requires that each resource to be encrypted
              has a unique FAK, and that this FAK is generated by the TSF. If the encrypted resource
              is a set of files encrypted under one FAK, additional requirements on the initialization
              vectors and cipher modes must be adhered to in Section 4.2. </span></div>
            
          </div></div>
        </div><div class='comp' id='FCS_COP_EXT.1'><h4>FCS_COP_EXT.1 FAK Encryption/Decryption Support</h4>
          
          
          
          
          
          
          
          
          <div class='element'><div class='reqid' id='FCS_COP_EXT.1.1'><a href='#FCS_COP_EXT.1.1' class='abbr'>FCS_COP_EXT.1.1</a></div><div class='reqdesc'>
            The FAK shall be protected in the same manner as the FEK, in accordance with
              FCS_COP.1(5).
            <div class='appnote'><span class='note-header'>Application Note: </span><span class='note'> The intent of this requirement is to clarify that, if a FAK is
              to be used, it should be treated as sensitive as the FEK, and thus, follow the same
              encryption and decryption practices. </span></div>
            
            
            
          </div></div>
          
        </div><div class='comp' id='FDP_AUT_EXT.1'><h4>FDP_AUT_EXT.1 Authentication of Selected User Data</h4>
           
           
           
           
           
           
           
           
           <div class='element'><div class='reqid' id='FDP_AUT_EXT.1.1'><a href='#FDP_AUT_EXT.1.1' class='abbr'>FDP_AUT_EXT.1.1</a></div><div class='reqdesc'>
             The TSF shall perform authentication of the user-selected file (or set of files)
               and provide notification to the user if modification had been detected. 
           </div></div>
           <div class='element'><div class='reqid' id='FDP_AUT_EXT.1.2'><a href='#FDP_AUT_EXT.1.2' class='abbr'>FDP_AUT_EXT.1.2</a></div><div class='reqdesc'>
              The TSF shall implement a data authentication method based on [<b>selection</b>: <i>cryptographic keyed hashing service and verification in accordance with
                 FDP_AUT_EXT.2</i>, <i>asymmetric signing and verification in accordance with
                 FDP_AUT_EXT.3</i>]. 
             <div class='appnote'><span class='note-header'>Application Note: </span><span class='note'>This is the primary requirement for authentication of the
               protected resources (files and sets of files). It is highly encouraged for vendors to
               utilize a keyed hashing service or asymmetric signing mechanism to ensure data
               authentication, as these are the only two implementations noted in this PP-Module that prevent
               decryption if authentication is unsuccessful. Using modes such as XTS or CBC will
               require additional data authentication measures to be added, such as a keyed hash
               function or asymmetric signing, because these modes do not come inherently packaged with
               data authentication or a way to signal to the user that data has been modified.<br/>
               
               Specific tests are performed in FDP_AUT_EXT.2 or FDP_AUT_EXT.3 depending on the selection made in FDP_AUT_EXT.1.2.
             </span></div>
             
           </div></div>
         </div><div class='comp' id='FDP_AUT_EXT.2'><h4>FDP_AUT_EXT.2 Data Authentication Using cryptographic Keyed-Hash Functions</h4>
           
           
           
           
           
           
           
           
           <div class='element'><div class='reqid' id='FDP_AUT_EXT.2.1'><a href='#FDP_AUT_EXT.2.1' class='abbr'>FDP_AUT_EXT.2.1</a></div><div class='reqdesc'>
             The TSF shall use a cryptographic, keyed hash function in accordance with
               FCS_COP.1(4) <b>(from <a href='#bibAppPP'>[AppPP]</a>)</b>.
           </div></div>
           <div class='element'><div class='reqid' id='FDP_AUT_EXT.2.2'><a href='#FDP_AUT_EXT.2.2' class='abbr'>FDP_AUT_EXT.2.2</a></div><div class='reqdesc'>
             The TSF shall use a File Authentication Key (FAK) in accordance with FCS_COP_EXT.1
               and FCS_CKM_EXT.5 as the secret key to the keyed hash function.
           </div></div>
           <div class='element'><div class='reqid' id='FDP_AUT_EXT.2.3'><a href='#FDP_AUT_EXT.2.3' class='abbr'>FDP_AUT_EXT.2.3</a></div><div class='reqdesc'>
             The TSF shall use the entirety of the ciphertext file as the message input to the
               keyed hash function.
           </div></div>
           <div class='element'><div class='reqid' id='FDP_AUT_EXT.2.4'><a href='#FDP_AUT_EXT.2.4' class='abbr'>FDP_AUT_EXT.2.4</a></div><div class='reqdesc'>
             The TSF shall concatenate the output of the keyed hash function, the Message
               Authentication Code (MAC).
           </div></div>
           <div class='element'><div class='reqid' id='FDP_AUT_EXT.2.5'><a href='#FDP_AUT_EXT.2.5' class='abbr'>FDP_AUT_EXT.2.5</a></div><div class='reqdesc'>
             The TSF shall authenticate the encrypted file prior to decryption.
           </div></div>
           <div class='element'><div class='reqid' id='FDP_AUT_EXT.2.6'><a href='#FDP_AUT_EXT.2.6' class='abbr'>FDP_AUT_EXT.2.6</a></div><div class='reqdesc'>
             The TSF shall authenticate the data by comparing the keyed hash output of the
               ciphertext against the stored MAC.
           </div></div>
           <div class='element'><div class='reqid' id='FDP_AUT_EXT.2.7'><a href='#FDP_AUT_EXT.2.7' class='abbr'>FDP_AUT_EXT.2.7</a></div><div class='reqdesc'>
             The TSF shall notify the user of an unsuccessful authentication and prevent
               decryption of the ciphertext.
           </div></div>
           <div class='element'><div class='reqid' id='FDP_AUT_EXT.2.8'><a href='#FDP_AUT_EXT.2.8' class='abbr'>FDP_AUT_EXT.2.8</a></div><div class='reqdesc'>
             During verification, the TSF shall verify the MAC is at the end of the ciphertext
               file.
           </div></div>
           <div class='element'><div class='reqid' id='FDP_AUT_EXT.2.9'><a href='#FDP_AUT_EXT.2.9' class='abbr'>FDP_AUT_EXT.2.9</a></div><div class='reqdesc'>
             The FAK will be generated using a RBG that meets FCS_RBG_EXT.1 <b>(from <a href='#bibAppPP'>[AppPP]</a>)</b>.
             <div class='appnote'><span class='note-header'>Application Note: </span><span class='note'>The intent of this requirement is to specify the correct way of
               using a keyed hash function to authenticate the data, and enable authentication of data. 
               FAKs are considered cryptographic keys and are subject to destruction per FCS_CKM_EXT.4.1.</span></div>
             
           </div></div>
         </div><div class='comp' id='FDP_AUT_EXT.3'><h4>FDP_AUT_EXT.3 Data Authentication Using Asymmetric Signing and Verification</h4>
           
           
           
           
           
           
           
           
           <div class='element'><div class='reqid' id='FDP_AUT_EXT.3.1'><a href='#FDP_AUT_EXT.3.1' class='abbr'>FDP_AUT_EXT.3.1</a></div><div class='reqdesc'>
             The TSF shall use a secure hash function in accordance with FCS_COP.1(2) <b>(from 
               <a href='#bibAppPP'>[AppPP]</a>)</b> with the entire ciphertext file as input to create a
               hash.
           </div></div>
           <div class='element'><div class='reqid' id='FDP_AUT_EXT.3.2'><a href='#FDP_AUT_EXT.3.2' class='abbr'>FDP_AUT_EXT.3.2</a></div><div class='reqdesc'>
             The TSF shall use a cryptographic signing function in accordance with FCS_COP.1(3)
               <b>(from <a href='#bibAppPP'>[AppPP]</a>)</b> and must use the hash generated in accordance with
               FDP_AUT_EXT.3.1 as input to the signing process. Additionally, use of ephemeral key for
               signing purposes is prohibited.
           </div></div>
           <div class='element'><div class='reqid' id='FDP_AUT_EXT.3.3'><a href='#FDP_AUT_EXT.3.3' class='abbr'>FDP_AUT_EXT.3.3</a></div><div class='reqdesc'>
             The TSF shall use a public and private key pair generated in accordance with
               FCS_CKM.1(1) <b>(from <a href='#bibAppPP'>[AppPP]</a>)</b> and must use this key pair as part of the cryptographic signing process in
               accordance with FDP_AUT_EXT.3.2.
           </div></div>
           <div class='element'><div class='reqid' id='FDP_AUT_EXT.3.4'><a href='#FDP_AUT_EXT.3.4' class='abbr'>FDP_AUT_EXT.3.4</a></div><div class='reqdesc'>
             The TSF shall authenticate the ciphertext data prior to decryption.
           </div></div>
           <div class='element'><div class='reqid' id='FDP_AUT_EXT.3.5'><a href='#FDP_AUT_EXT.3.5' class='abbr'>FDP_AUT_EXT.3.5</a></div><div class='reqdesc'>
             The TSF shall notify the user of an unsuccessful authentication and prevent
               decryption of the ciphertext if such an event were to occur.
           </div></div>
           <div class='element'><div class='reqid' id='FDP_AUT_EXT.3.6'><a href='#FDP_AUT_EXT.3.6' class='abbr'>FDP_AUT_EXT.3.6</a></div><div class='reqdesc'>
             The TSF shall append the signature to the end of the ciphertext file.
           </div></div>
           <div class='element'><div class='reqid' id='FDP_AUT_EXT.3.7'><a href='#FDP_AUT_EXT.3.7' class='abbr'>FDP_AUT_EXT.3.7</a></div><div class='reqdesc'>
             During verification, the TSF shall verify the signature is at the end of the
               ciphertext file.
             <div class='appnote'><span class='note-header'>Application Note: </span><span class='note'> The intent of this requirement is to specify the secure way of
               using a cryptographic signing and hashing function as part of the data authentication
               mechanism.</span></div>
             
           </div></div>
         </div><div class='comp' id='FDP_PM_EXT.1'><h4>FDP_PM_EXT.1 Protection of Data in Power Managed States</h4>
               
               
               
               
               
               
               
               
               <div class='element'><div class='reqid' id='FDP_PM_EXT.1.1'><a href='#FDP_PM_EXT.1.1' class='abbr'>FDP_PM_EXT.1.1</a></div><div class='reqdesc'>
                 The TSF shall protect all data selected for encryption during the transition to
                   the [<b>assignment</b>: <span class='assignable-content'>powered-down state(s) or locked system states for which this capability is provided</span>] state as
                   per FDP_PRT_EXT.1.1.
               </div></div>
               <div class='element'><div class='reqid' id='FDP_PM_EXT.1.2'><a href='#FDP_PM_EXT.1.2' class='abbr'>FDP_PM_EXT.1.2</a></div><div class='reqdesc'>
                 On the return to a powered-on state from the state(s) indicated in FDP_PM_EXT.1.1,
                   the TSF shall authorize the user in the manner specified in FIA_AUT_EXT.1.1 once before
                   any protected data are decrypted. 
               </div></div>
               <div class='element'><div class='reqid' id='FDP_PM_EXT.1.3'><a href='#FDP_PM_EXT.1.3' class='abbr'>FDP_PM_EXT.1.3</a></div><div class='reqdesc'>
                 The TSF shall destroy all key material and authentication factors stored in plaintext when transitioning to a
                   protected state as defined by FDP_PM_EXT.1.1.
                 <div class='appnote'><span class='note-header'>Application Note: </span><span class='note'> For the first assignment, the ST author fills in the state(s) using
                   the same name used in the Operational Guidance for the state that is appropriately
                   protected by the TOE. <br/> It should be noted that it is not sufficient to use
                   Operational Environment-based credentials to unlock the TOE from the indicated state;
                   the intent is that returning from the indicated state is equivalent (from an
                   authorization point of view) to returning from a completely powered-off state and
                   re-opening the resources that are protected. </span></div>
                 
               </div></div>
             </div><div class='comp' id='FDP_PRT_EXT.3'><h4>FDP_PRT_EXT.3 Protection of Third-Party Data</h4>
               
               
               
               
               
               
               
               
               <div class='element'><div class='reqid' id='FDP_PRT_EXT.3.1'><a href='#FDP_PRT_EXT.3.1' class='abbr'>FDP_PRT_EXT.3.1</a></div><div class='reqdesc'>
                 The TSF shall ensure that all temporary files created by 
                   [<b>selection</b>: <i>all applications</i>, <i>[<b>assignment</b>: <span class='assignable-content'>subset of applications that can integrate with the FE</span>]</i>]when decrypting/encrypting the
                   user-selected file (or set of files) are removed or encrypted upon completion of the
                   decryption/encryption operation.
                 
                 <div class='appnote'><span class='note-header'>Application Note: </span><span class='note'> This requirement is to cover the detection and encryption of temporary files created by third party applications.
                   If the FE provides a capability to allow specific applications to leverage it, the applications or method they would use to opt in may be included in the assignment.  
                 </span></div>
                 
                 
               </div></div>
             </div><div class='comp' id='FIA_FCT_EXT.1'><h4>FIA_FCT_EXT.1 Multi-User Authorization</h4>
          
          
          
          
          
          
          
          
          <div class='element'><div class='reqid' id='FIA_FCT_EXT.1.1'><a href='#FIA_FCT_EXT.1.1' class='abbr'>FIA_FCT_EXT.1.1</a></div><div class='reqdesc'>
            The TSF shall support the use of authorization factors from multiple users that result in unique KEKs.</div></div>
          
          <div class='element'><div class='reqid' id='FIA_FCT_EXT.1.2'><a href='#FIA_FCT_EXT.1.2' class='abbr'>FIA_FCT_EXT.1.2</a></div><div class='reqdesc'>
            The TSF shall support the ability of each user to have files protected by a key chain tied only to that user's credentials.
            
            
            
            <div class='appnote'><span class='note-header'>Application Note: </span><span class='note'> FIA_FCT_EXT.1.1 requires the TSF to support multiple
              authorization factors to produce multiple KEKs, the intent is that the TSF supports a
              system where multiple users have access to files on the underlying platform, and that
              each user has an authorization factor so that they can protect their own files from
              other users. This should be accomplished via the methods detailed in FIA_FCT_EXT.1.2. 
            </span></div>
            
            
          </div></div>
        </div><div class='comp' id='FIA_FCT_EXT.2'><h4>FIA_FCT_EXT.2 Authorized Key Sharing</h4>
          
          
          
          
          
          
          
          
          <div class='element'><div class='reqid' id='FIA_FCT_EXT.2.1'><a href='#FIA_FCT_EXT.2.1' class='abbr'>FIA_FCT_EXT.2.1</a></div><div class='reqdesc'>
            The TSF shall support
              [<b>selection</b>: <i>Authorized User Key sharing via key transport as specified in FCS_COP.1(6)</i>, <i>Distribution of a shared key from an enterprise management Server</i>].
            
            
            
            <div class='appnote'><span class='note-header'>Application Note: </span><span class='note'> While FIA_FCT_EXT.1 requires that
              each user has an authorization factor so that they can protect their own files from

              other users. FIA_FCT_EXT.2 created a mechanism to safely share files between users.

            </span></div>
            
            
          </div></div>
        </div><h1 class='indexable' data-level='A' id='sel-sfrs'>Appendix B -  Selection-based SFRs</h1><div class='comp' id='FCS_CKM_EXT.3'><h4>FCS_CKM_EXT.3 Key Encrypting Key (KEK) Support</h4><div class='statustag'><b><i>This is a selection-based component. Its inclusion depends upon selection from
          <b><i><a href='#FCS_KYC_EXT.1.1' class=''>FCS_KYC_EXT.1.1</a></i></b>.
          </i></b></div>
        
        
          
        
        
        
        
          
        <div class='element'><div class='reqid' id='FCS_CKM_EXT.3.1 '><a href='#FCS_CKM_EXT.3.1 ' class='abbr'>FCS_CKM_EXT.3.1 </a></div><div class='reqdesc'>
           The TSF shall 
            [<b>selection</b>: <ul><li><i>accept KEK from an enterprise management server</i>, </li><li><i> generate KEK cryptographic keys <br/>
                [<b>selection</b>: <ul><li><i> using a Random Bit Generator as specified in FCS_RBG_EXT.1 <b>(from <a href='#bibAppPP'>[AppPP]</a>)</b>
                    and with entropy corresponding to the security strength of AES key sizes of
                    [<b>selection</b>: <i>128 bit</i>, <i>256 bit</i>]</i>, </li><li><i> derived from a password/passphrase that is conditioned as defined in FCS_CKM_EXT.6 </i></li></ul>]
              </i></li></ul>].
          
          <div class='appnote'><span class='note-header'>Application Note: </span><span class='note'>This requirement must be included in STs in which KEKs originating from is chosen in FCS_KYC_EXT.1.1. </span></div>
          
        </div></div>
      </div><div class='comp' id='FCS_CKM_EXT.6'><h4>FCS_CKM_EXT.6 Cryptographic Password/Passphrase Conditioning</h4><div class='statustag'><b><i>This is a selection-based component. Its inclusion depends upon selection from
          <b><i><a href='#FIA_AUT_EXT.1.1' class=''>FIA_AUT_EXT.1.1</a>, </i></b><b><i><a href='#FCS_CKM_EXT.2.1' class=''>FCS_CKM_EXT.2.1</a>, </i></b><b><i><a href='#FCS_CKM_EXT.3.1' class=''>FCS_CKM_EXT.3.1</a></i></b>.
          </i></b></div> 
          
          
          
          
          
          
          
          
          
          
          
         
          
          <div class='element'><div class='reqid' id='FCS_CKM_EXT.6.1'><a href='#FCS_CKM_EXT.6.1' class='abbr'>FCS_CKM_EXT.6.1</a></div><div class='reqdesc'>
            
              The TSF shall support a password/passphrase of up to 
              [<b>selection</b>: <i>[<b>assignment</b>: <span class='assignable-content'>maximum value supported by the platform</span>]</i>, <i>[<b>assignment</b>: <span class='assignable-content'>maximum password size, positive integer of 64 or more</span>]</i>]
              characters used to generate a password authorization factor.
            
          </div></div>
          <div class='element'><div class='reqid' id='FCS_CKM_EXT.6.2'><a href='#FCS_CKM_EXT.6.2' class='abbr'>FCS_CKM_EXT.6.2</a></div><div class='reqdesc'>
            
              The TSF shall allow passwords to be composed of any combination of upper case characters,
              lower case characters, numbers, and the following special characters: "!", "@", "#", "$", "%", "^", "&amp;", "*", "(", and ")",
              and [<b>selection</b>: <i>[<b>assignment</b>: <span class='assignable-content'>other supported special characters</span>]</i>, <i>no other characters</i>].
          </div></div>
          <div class='element'><div class='reqid' id='FCS_CKM_EXT.6.3'><a href='#FCS_CKM_EXT.6.3' class='abbr'>FCS_CKM_EXT.6.3</a></div><div class='reqdesc'>
            
              The TSF shall perform Password-based Key Derivation
              Functions in accordance with a specified cryptographic algorithm HMAC-[<b>selection</b>: <i>SHA-256</i>, <i>SHA-384</i>, <i>SHA-512</i>], with 
              [<b>selection</b>: <i>[<b>assignment</b>: <span class='assignable-content'>positive integer of 4096 or more</span>] iterations</i>, <i>value supported by the platform, greater than 1000</i>], and
              output cryptographic key sizes [<b>selection</b>: <i>128</i>, <i>256</i>] that meet the following: [<i>NIST SP 800-132</i>]. 
            
          </div></div>
          <div class='element'><div class='reqid' id='FCS_CKM_EXT.6.4'><a href='#FCS_CKM_EXT.6.4' class='abbr'>FCS_CKM_EXT.6.4</a></div><div class='reqdesc'>
            
              The TSF shall not accept passwords less than 
              [<b>selection</b>: <i>a value settable by the administrator</i>, <i>[<b>assignment</b>: <span class='assignable-content'>minimum password length accepted by the TOE, must be &gt;= 1 </span>]</i>] and greater than the maximum password length 
              defined in FCS_CKM_EXT.6.1.
          </div></div>
          <div class='element'><div class='reqid' id='FCS_CKM_EXT.6.5'><a href='#FCS_CKM_EXT.6.5' class='abbr'>FCS_CKM_EXT.6.5</a></div><div class='reqdesc'>
            The TSF shall generate all salts using an RBG that meets FCS_RBG_EXT.1 <b>(from <a href='#bibAppPP'>[AppPP]</a>)</b> and with entropy 
              corresponding to the security strength selected for PBKDF in FCS_CKM_EXT.6.3.
            
            <div class='appnote'><span class='note-header'>Application Note: </span><span class='note'>
              
              
              The password/passphrase is represented on the host machine as a sequence of characters whose 
              encoding depends on the TOE and the underlying OS. This sequence must be conditioned into a string of bits that is to be used as a KEK that is the same size as the FEK.
              
              <br/><br/>For FCS_CKM_EXT.6.1, the ST author assigns the maximum size of the password/passphrase it supports; it must support at least 64 characters or a length defined by the platform. 
              The selection "maximum value supported by the platform" may only be selected if "implement platform-provided functionality to provide user authorization"
              was selected in FIA_AUT_EXT.1.
              
              <br/><br/>For FCS_CKM_EXT.6.2, the ST author assigns any other supported characters; if there are no other supported characters, 
              they should select "no other characters".
              
              <br/><br/>For FCS_CKM_EXT.6.3, the ST author selects the parameters based on the PBKDF used by the TSF. The key cryptographic
              key sizes in FCS_CKM_EXT.6.3 are made to correspond to the KEK key sizes selected in FCS_KYC_EXT.1.
              
              <br/><br/>The password/passphrase must be conditioned into a string of bits that forms the submask to be used as input into the
              KEK. Conditioning is performed using one of the identified hash functions in accordance with the process described in
              NIST SP 800-132. SP 800-132 requires the use of a pseudo-random function (PRF) consisting of HMAC with an approved hash function.
              
              <br/><br/>Appendix A of SP 800-132 recommends setting the iteration count in order to increase the computation needed to derive
              a key from a password and, therefore, increase the workload of performing a password recovery attack. However, for this PP-Module,
              a minimum iteration count of 4096 is required in order to ensure that twelve bits of security is added to the password/passphrase value.
              A significantly higher value is recommended to ensure optimal security. If the platform is leveraged for authentication the value may be a 
              minimum of 1000, this selection may only be selected if "implement platform-provided functionality to provide user authorization"
              was selected in FIA_AUT_EXT.1.
              
              <br/><br/>For FCS_CKM_EXT.6.4 If the minimum password length is settable, then ST author chooses "a value settable by the administrator
              for this component for FMT_SMF.1.2. If the minimum length
              is not settable, the ST author fills in the assignment with the minimum length the password must be (zero-length passwords are not allowed for compliant TOEs).  
              
              <br/><br/>This requirement is selection dependent on FIA_AUT_EXT.1.1.</span></div>
            
          </div></div>
        </div><div class='comp' id='FCS_COP.1(5)'><h4>FCS_COP.1(5) Cryptographic operation (Key Wrapping)</h4><div class='statustag'><b><i>This is a selection-based component. Its inclusion depends upon selection from
          <b><i><a href='#FCS_KYC_EXT.1.1' class=''>FCS_KYC_EXT.1.1</a></i></b>.
          </i></b></div>
          
          
          
          <div class='element'><div class='reqid' id='FCS_COP.1.1(5)'><a href='#FCS_COP.1.1(5)' class='abbr'>FCS_COP.1.1(5)</a></div><div class='reqdesc'>
            
              The TSF shall <b>
                [<b>selection</b>: <i>use platform-provided functionality to perform Key Wrapping</i>, <i>implement functionality to perform Key Wrapping</i>]</b> in accordance with a specified cryptographic algorithm [<i>AES</i>] <b>in the following modes
                  [<b>selection</b>: <ul><li><i>Key Wrap</i>, </li><li><i>Key Wrap with Padding</i>, </li><li><i>GCM mode</i>, </li><li><i>CCM mode</i></li></ul>]</b> and cryptographic key sizes <b> 
                    [<b>selection</b>: <i>128 bits (AES)</i>, <i>256 bits (AES)</i>]</b> that meet the following: <b>
                      [<b>selection</b>: <ul><li><i>"NIST SP 800-38C"</i>, </li><li><i>"NIST SP 800-38D"</i>, </li><li><i>"NIST SP 800-38F"</i></li></ul>] and no other standards</b>.
            
            <div class='appnote'><span class='note-header'>Application Note: </span><span class='note'>
              This requirement is used in the body of the ST if the ST author chooses to
              use key wrapping in the key chaining approach that is specified in FCS_KYC_EXT.1.</span></div>
            
          </div></div>
        </div><div class='comp' id='FCS_COP.1(6)'><h4>FCS_COP.1(6) Cryptographic operation (Key Transport)</h4><div class='statustag'><b><i>This is a selection-based component. Its inclusion depends upon selection from
          <b><i><a href='#FCS_KYC_EXT.1.1' class=''>FCS_KYC_EXT.1.1</a></i></b>.
          </i></b></div>
          
          
          <div class='element'><div class='reqid' id='FCS_COP.1.1(6)'><a href='#FCS_COP.1.1(6)' class='abbr'>FCS_COP.1.1(6)</a></div><div class='reqdesc'>
            
              The TSF shall perform [<i>key transport</i>] in accordance with a
              specified cryptographic algorithm [<i>RSA</i>] <b>in the following modes 
                [<b>selection</b>: <i>KTS-OAEP</i>, <i>KTS-KEM-KWS</i>]</b> and cryptographic key sizes 
              [<b>selection</b>: <i>3072</i>, <i>4096</i>] bits that meet the following: [<i>NIST SP 800-56B, Revision 1</i>].
            
            <div class='appnote'><span class='note-header'>Application Note: </span><span class='note'>
              
              This requirement is used in the body of the ST if the ST author chooses to
              use key transport in the key chaining approach that is specified in FCS_KYC_EXT.1.
            </span></div>
            
          </div></div>
        </div><div class='comp' id='FCS_COP.1(7)'><h4>FCS_COP.1(7) Cryptographic operation (Key Encryption)</h4><div class='statustag'><b><i>This is a selection-based component. Its inclusion depends upon selection from
          <b><i><a href='#FCS_KYC_EXT.1.1' class=''>FCS_KYC_EXT.1.1</a></i></b>.
          </i></b></div>
          
          
          <div class='element'><div class='reqid' id='FCS_COP.1.1(7)'><a href='#FCS_COP.1.1(7)' class='abbr'>FCS_COP.1.1(7)</a></div><div class='reqdesc'>
            
              The TSF shall <b>
              [<b>selection</b>: <i>use platform-provided functionality to perform Key Encryption</i>, <i>perform key encryption and decryption</i>]</b>
              in accordance with a specified cryptographic algorithm [<i>AES used in CBC mode</i>] and cryptographic key sizes <b> 
                  [<b>selection</b>: <ul><li><i>128</i>, </li><li><i>256</i></li></ul>] bits</b> that meet the following:
                  [<i>AES as specified in SP 800-38A</i>].
            
            <div class='appnote'><span class='note-header'>Application Note: </span><span class='note'>
              
              This requirement is used in the body of the ST if the ST author chooses to
                use AES encryption/decryption for protecting the keys as part of the key chaining approach
                that is specified in FCS_KYC_EXT.1.</span></div>
            
          </div></div>
        </div><div class='comp' id='FCS_KDF_EXT.1'><h4>FCS_KDF_EXT.1 Cryptographic Key Derivation Function</h4><div class='statustag'><b><i>This is a selection-based component. Its inclusion depends upon selection from
          <b><i><a href='#FCS_KYC_EXT.1.1' class=''>FCS_KYC_EXT.1.1</a></i></b>.
          </i></b></div>
          
          
          
          
          
          
          
          
          
          
          <div class='element'><div class='reqid' id='FCS_KDF_EXT.1.1'><a href='#FCS_KDF_EXT.1.1' class='abbr'>FCS_KDF_EXT.1.1</a></div><div class='reqdesc'>
            
                The TSF shall [<i>accept
                    [<b>selection</b>: <i>a submask generated by an RBG as specified in FCS_RBG_EXT.1 <b>(from <a href='#bibAppPP'>[AppPP]</a>)</b></i>, <i>a conditioned password</i>, <i>an imported submask</i>] to derive an intermediate key, as defined in
                    [<b>selection</b>: <ul><li><i>NIST SP 800-108 
                        [<b>selection</b>: <i>KDF in Counter Mode</i>, <i>KDF in Feedback Mode</i>, <i>KDF in Double-Pipeline Iteration Mode</i>]
                      </i>, </li><li><i>NIST SP 800-132</i></li></ul>] using the keyed-hash functions specified in FCS_COP.1<b>(4) (from <a href='#bibAppPP'>[AppPP]</a>)</b>, such that the output is at least of
                    equivalent security strength (in number of bits) to the [FEK]</i>].
            
            <div class='appnote'><span class='note-header'>Application Note: </span><span class='note'>
              
              This requirement is used in the body of the ST if the ST author chooses to
              use key derivation in the key chaining approach that is specified in FCS_KYC_EXT.1.
              This requirement establishes acceptable methods for generating a new random key or an
              existing submask to create a new key along the key chain.</span></div>
            
          </div></div>
          
          
          
        </div><div class='comp' id='FCS_SMC_EXT.1'><h4>FCS_SMC_EXT.1 Submask Combining</h4><div class='statustag'><b><i>This is a selection-based component. Its inclusion depends upon selection from
          <b><i><a href='#FCS_KYC_EXT.1.1' class=''>FCS_KYC_EXT.1.1</a></i></b>.
          </i></b></div>
          
          
          
          
          
          
          
          
          
          <div class='element'><div class='reqid' id='FCS_SMC_EXT.1.1 '><a href='#FCS_SMC_EXT.1.1 ' class='abbr'>FCS_SMC_EXT.1.1 </a></div><div class='reqdesc'>
            The TSF shall [<i>combine submasks using the following method [<b>selection</b>: <i>exclusive OR (XOR)</i>, <i>SHA-256</i>, <i>SHA-384</i>, <i>SHA-512</i>, <i>HMAC-SHA-256</i>, <i>HMAC-SHA-384</i>, <i>HMAC-SHA-512</i>] to generate an intermediate key</i>].
            <div class='appnote'><span class='note-header'>Application Note: </span><span class='note'>
              
              This requirement specifies the way that a product may combine the
              various submasks by using either an XOR or an approved SHA-hash. This requirement is selection dependent on FCS_KYC_EXT.1.1.</span></div>
            
          </div></div>
          
          
        </div><div class='comp' id='FCS_VAL_EXT.2'><h4>FCS_VAL_EXT.2 Validation Remediation</h4><div class='statustag'><b><i>This is a selection-based component. Its inclusion depends upon selection from
          <b><i><a href='#FIA_AUT_EXT.1.1' class=''>FIA_AUT_EXT.1.1</a></i></b>.
          </i></b></div>
            
            
            
            
            
            
            
           
            
            
            <div class='element'><div class='reqid' id='FCS_VAL_EXT.2.1'><a href='#FCS_VAL_EXT.2.1' class='abbr'>FCS_VAL_EXT.2.1</a></div><div class='reqdesc'>
              The TSF shall 
                [<b>selection</b>: <ul><li><i>[perform a key destruction of the FEK(s)] upon a configurable number of consecutive failed validation attempts</i>, </li><li><i>institute a delay such that only [<b>assignment</b>: <span class='assignable-content'>ST author specified number of attempts</span>] can be made within a 24 hour period</i>, </li><li><i>block validation after [<b>assignment</b>: <span class='assignable-content'>ST author specified number of attempts</span>] of consecutive failed validation attempts</i>, </li><li><i>require power cycle/reset the TOE after [<b>assignment</b>: <span class='assignable-content'>ST author specified number of attempts</span>] of consecutive failed validation attempts</i></li></ul>].
              
              <div class='appnote'><span class='note-header'>Application Note: </span><span class='note'>This SFR must be included if "provide user authorization" is selected in FIA_AUT_EXT.1.1.<br/><br/>
                
Two iterations of this SFR are also defined in PP-Module for File Encryption Enterprise Management. 
              If the TOE also claims this module, the ST author should iterate these SFRs by using "/FE" and "/EM" as unique identifiers for the iterations. This will allow the reader
              to easily determine which iteration applies to each TOE component.<br/><br/> 
                
                This requirement is used in the body of the ST if the ST author chooses "provide user authorization" in FIA_AUT_EXT.1.1.</span></div>          
              
              
            </div></div>
          
          
          
          
          
          
          
        </div><h1 class='indexable' data-level='A' id='obj-sfrs'>Appendix C -  Objective SFRs</h1>
    This section is reserved for requirements that are not currently prescribed by this PP-Module 
    but are expected to be included in future versions of the PP-Module.
    Vendors planning on having evaluations performed against future products are encouraged
    to plan for these objective requirements to be met. <br/><br/><p>
	  This PP-Module does not define any objective SFRs.
	</p><h1 class='indexable' data-level='A' id='ext-comp-defs'>Appendix D -  Extended Component Definitions</h1>
This appendix contains the definitions for the extended requirements that are used in the PP-Module
including those used in Appendices A through C.
 
 
    <h2 class='indexable' data-level='2' id='ext-comp-defs-bg'>D.1 Background and Scope</h2>
This Appendix provides a definition for all of the extended components introduced
in this PP-Module.
These components are identified in the following table:

<table><tr><th>Functional Class</th><th>Functional Components</th><tr><td>Cryptographic Support (FCS)</td><td>FCS_CKM_EXT Cryptographic Key Management<br/>FCS_IV_EXT Initialization Vector Generation<br/>FCS_KYC_EXT Key Chaining and Key Storage<br/>FCS_VAL_EXT Validation<br/></td></tr><tr><td>User Data Protection (FDP)</td><td>FDP_PRT_EXT Protection of Selected User Data<br/></td></tr><tr><td>Identification and Authentication (FIA)</td><td>FIA_AUT_EXT Authorization<br/></td></tr><tr><td>Protection of the TSF (FPT)</td><td>FPT_KYP_EXT Protection of Key and Key Material<br/></td></tr><tr><td>Cryptographic Support (FCS)</td><td>FCS_COP_EXT Cryptographic Operation<br/></td></tr><tr><td>User Data Protection (FDP)</td><td>FDP_AUT_EXT User Data Authentication<br/>FDP_PM_EXT Protection of Data in Power Managed States<br/></td></tr><tr><td>Identification and Authentication (FIA)</td><td>FIA_FCT_EXT Authorization Factors<br/></td></tr><tr><td>Cryptographic Support (FCS)</td><td>FCS_KDF_EXT Cryptographic Key Derivation Function<br/>FCS_SMC_EXT Submask Combining<br/>FCS_VAL_EXT Validation Remediation<br/></td></tr></tr></table><h2 class='indexable' data-level='2' id='ext-comp-defs-bg'>D.2 Extended Component Definitions</h2><h3>FCS_CKM_EXT Cryptographic Key Management</h3>Components in this family define requirements for key management activities that are beyond the scope of what is defined in the FCS_CKM family in CC Part 2. 
          <h3>Component Leveling</h3><p>FCS_CKM_EXT.2,
             File Encryption Key (FEK) Generation,
              describes the method by which the TSF acquires or generates file encryption keys.</p><h3>Management: FCS_CKM_EXT.2</h3><p>There are no specific management functions identified.</p><h3>Audit: FCS_CKM_EXT.2</h3><p>There are no auditable events foreseen.</p><h3>FCS_CKM_EXT.2 File Encryption Key (FEK) Generation</h3><p>Hierarchical to: No other components.</p><p>Dependencies to: FCS_RBG_EXT.1 Random Bit Generation Services</p><h3>FCS_CKM_EXT.2.1</h3><br/> The TSF shall 
              [<b>selection</b>: <ul><li><i> accept FEK from an enterprise management server</i>, </li><li><i> generate FEK cryptographic keys <br/>
                  [<b>selection</b>: <ul><li><i> using a Random Bit Generator as specified in FCS_RBG_EXT.1 <b>(from <a href='#bibAppPP'>[AppPP]</a>)</b> and with entropy corresponding to the security strength of AES key sizes of
                      [<b>selection</b>: <i>128 bit</i>, <i>256 bit</i>]</i>, </li><li><i> derived from a password/passphrase that is conditioned as defined in FCS_CKM_EXT.6 </i></li></ul>]
                </i></li></ul>].
            <h3>FCS_CKM_EXT.2.2</h3><br/>The TSF shall use a unique FEK for each file (or set of files) using the
              mechanism on the client as specified in FCS_CKM_EXT.2.1.<h3>Component Leveling</h3><p>FCS_CKM_EXT.4,
             Cryptographic Key Destruction,
              describes supported methods for key destruction.</p><h3>Management: FCS_CKM_EXT.4</h3><p>The following actions could be considered for the management functions in FMT: <ul>
            <li>Manually perform cryptographic erasure.</li>
          </ul>
          </p><h3>Audit: FCS_CKM_EXT.4</h3><p>The following actions should be auditable if FAU_GEN Security audit data
            generation is included in the PP/ST:<ul>
              <li>Basic: Manual erasure of cryptographic data. </li>
            </ul>
          </p><h3>FCS_CKM_EXT.4 Cryptographic Key Destruction</h3><p>Hierarchical to: No other components.</p><p>Dependencies to: No dependencies.</p><h3>FCS_CKM_EXT.4.1</h3><br/>The TSF shall destroy cryptographic keys in accordance with a specified cryptographic key destruction method 
              [<b>selection</b>: <ul><li><i> For volatile memory, the destruction shall be executed by a
                  [<b>selection</b>: <ul><li><i>single overwrite consisting of 
                      [<b>selection</b>: <i>a pseudo-random pattern using the TSF's RBG</i>, <i>zeroes</i>, <i>ones</i>, <i>new value of a key</i>, <i>[<b>assignment</b>: <span class='assignable-content'>any value that does not contain any CSP</span>]</i>]
                    </i>, </li><li><i>removal of power to the memory</i>, </li><li><i>destruction of reference to the key directly followed by a request for garbage collection</i></li></ul>]
                </i>, </li><li><i> For non-volatile memory, the destruction shall be executed by
                  [<b>selection</b>: <ul><li><i>destruction of all KEKs protecting the target key,
                      where none of the KEKs protecting the target key are derived
                    </i>, </li><li><i> the invocation of an interface provided by the underlying platform that
                  [<b>selection</b>: <ul><li><i>logically addresses the storage location of the key and performs a
                      [<b>selection</b>: <i>single</i>, <i>[<b>assignment</b>: <span class='assignable-content'>ST author defined multi-pass</span>]</i>]
                      overwrite consisting of 
                      [<b>selection</b>: <i>a pseudo-random pattern using the TSF's RBG</i>, <i>zeroes</i>, <i>ones</i>, <i>new value of a key</i>, <i>[<b>assignment</b>: <span class='assignable-content'>any value that does not contain any CSP</span>]</i>]
                    </i>, </li><li><i>instructs the underlying platform to destroy the abstraction that represents the key</i></li></ul>]
                    </i></li></ul>]


                </i></li></ul>].
            <h3>FCS_CKM_EXT.4.2</h3><br/>The TSF shall destroy all keys and key material when no longer needed.<h3>Component Leveling</h3><p>FCS_CKM_EXT.5,
             File Authentication Key (FAK) Support,
              describes the secure storage of file encryption keys.</p><h3>Management: FCS_CKM_EXT.5</h3><p>There are no specific management functions identified.
          </p><h3>Audit: FCS_CKM_EXT.5</h3><p>There are no auditable events foreseen.
          </p><h3>FCS_CKM_EXT.5 File Authentication Key (FAK) Support</h3><p>Hierarchical to: No other components.</p><p>Dependencies to: FCS_COP_EXT.1 FAK Encryption/Decryption Support<br/>
            FCS_RBG_EXT.1 Random Bit Generation Services<br/>
            FDP_AUT_EXT.2 Data Authentication Using Cryptographic Keyed-Hash Functions
          </p><h3>FCS_CKM_EXT.5.1</h3><br/> The TSF shall use a FAK to authenticate sensitive data when a cryptographic, keyed
              hashing function is used for data authentication and shall be supported in the following
              manner: [<b>selection</b>: <ul><li><i>A FAK conditioned from a password/passphrase shall never be stored in
                  non-volatile memory</i>, </li><li><i>a FAK will be stored in non-volatile memory encrypted with a KEK as
                  specified in FCS_COP.1(5) using authorization factors as specified in FIA_AUT_EXT.1
                </i></li></ul>].
            <h3>FCS_CKM_EXT.5.2</h3><br/>The TSF shall create a unique FAK for each file (or set of files) using the
              mechanism on the client as specified in FCS_RBG_EXT.1 <b>(from <a href='#bibAppPP'>[AppPP]</a>)</b>.<h3>FCS_CKM_EXT.5.3</h3><br/>The FAKs must be generated by the TOE as specified in FDP_AUT_EXT.2.9.<h3>FCS_CKM_EXT.5.4</h3><br/>The TSF will not write FAKs to non-volatile memory.<h3>FCS_CKM_EXT.5.5</h3><br/>The FAK shall be protected in a manner conformant to FCS_COP_EXT.1.<h3>Component Leveling</h3><p>FCS_CKM_EXT.3,
             Key Encrypting Key (KEK) Support,
              describes the method by which the TSF acquires or generates key encryption keys.</p><h3>Management: FCS_CKM_EXT.3</h3><p>There are no specific management functions identified.</p><h3>Audit: FCS_CKM_EXT.3</h3><p>There are no auditable events foreseen.</p><h3>FCS_CKM_EXT.3 Key Encrypting Key (KEK) Support</h3><p>Hierarchical to: No other components.</p><p>Dependencies to: FCS_RBG_EXT.1 Random Bit Generation Services</p><h3>FCS_CKM_EXT.3.1 </h3><br/> The TSF shall 
            [<b>selection</b>: <ul><li><i>accept KEK from an enterprise management server</i>, </li><li><i> generate KEK cryptographic keys <br/>
                [<b>selection</b>: <ul><li><i> using a Random Bit Generator as specified in FCS_RBG_EXT.1 <b>(from <a href='#bibAppPP'>[AppPP]</a>)</b>
                    and with entropy corresponding to the security strength of AES key sizes of
                    [<b>selection</b>: <i>128 bit</i>, <i>256 bit</i>]</i>, </li><li><i> derived from a password/passphrase that is conditioned as defined in FCS_CKM_EXT.6 </i></li></ul>]
              </i></li></ul>].
          <h3>Component Leveling</h3><p>FCS_CKM_EXT.6,
             Cryptographic Password/Passphrase Conditioning,
              requires the TSF to implement password/passphrase conditioning using a specified algorithm and with specific constraints on the password/passphrase composition.</p><h3>Management: FCS_CKM_EXT.6</h3><p>There are no specific management functions identified.</p><h3>Audit: FCS_CKM_EXT.6</h3><p>There are no auditable events foreseen.</p><h3>FCS_CKM_EXT.6 Cryptographic Password/Passphrase Conditioning</h3><p>Hierarchical to: No other components.</p><p>Dependencies to: FCS_COP.1 Cryptographic Operation<br/>
            FCS_RBG_EXT.1 Random Bit Generation Services</p><h3>FCS_CKM_EXT.6.1</h3><br/>
              The TSF shall support a password/passphrase of up to 
              [<b>selection</b>: <i>[<b>assignment</b>: <span class='assignable-content'>maximum value supported by the platform</span>]</i>, <i>[<b>assignment</b>: <span class='assignable-content'>maximum password size, positive integer of 64 or more</span>]</i>]
              characters used to generate a password authorization factor.
            <h3>FCS_CKM_EXT.6.2</h3><br/>
              The TSF shall allow passwords to be composed of any combination of upper case characters,
              lower case characters, numbers, and the following special characters: "!", "@", "#", "$", "%", "^", "&amp;", "*", "(", and ")",
              and [<b>selection</b>: <i>[<b>assignment</b>: <span class='assignable-content'>other supported special characters</span>]</i>, <i>no other characters</i>].<h3>FCS_CKM_EXT.6.3</h3><br/>
              The TSF shall perform Password-based Key Derivation
              Functions in accordance with a specified cryptographic algorithm HMAC-[<b>selection</b>: <i>SHA-256</i>, <i>SHA-384</i>, <i>SHA-512</i>], with 
              [<b>selection</b>: <i>[<b>assignment</b>: <span class='assignable-content'>positive integer of 4096 or more</span>] iterations</i>, <i>value supported by the platform, greater than 1000</i>], and
              output cryptographic key sizes [<b>selection</b>: <i>128</i>, <i>256</i>] that meet the following: [<i>NIST SP 800-132</i>]. 
            <h3>FCS_CKM_EXT.6.4</h3><br/>
              The TSF shall not accept passwords less than 
              [<b>selection</b>: <i>a value settable by the administrator</i>, <i>[<b>assignment</b>: <span class='assignable-content'>minimum password length accepted by the TOE, must be &gt;= 1 </span>]</i>] and greater than the maximum password length 
              defined in FCS_CKM_EXT.6.1.<h3>FCS_CKM_EXT.6.5</h3><br/>The TSF shall generate all salts using an RBG that meets FCS_RBG_EXT.1 <b>(from <a href='#bibAppPP'>[AppPP]</a>)</b> and with entropy 
              corresponding to the security strength selected for PBKDF in FCS_CKM_EXT.6.3.<h3>FCS_IV_EXT Initialization Vector Generation</h3>Components in this family define requirements for initialization vector generation.
          <h3>Component Leveling</h3><p>FCS_IV_EXT.1,
             Initialization Vector Generation,
              specifies the required initialization vector generation methods used by the TSF for various cryptographic algorithms.</p><h3>Management: FCS_IV_EXT.1</h3><p>There are no specific management functions identified.
          </p><h3>Audit: FCS_IV_EXT.1</h3><p>There are no auditable events foreseen.
          </p><h3>FCS_IV_EXT.1 Initialization Vector Generation</h3><p>Hierarchical to: No other components.</p><p>Dependencies to: FCS_COP.1 Cryptographic Operation</p><h3>FCS_IV_EXT.1.1 </h3><br/>The TSF shall [<b>selection</b>: <ul><li><i>invoke platform-provided functionality to generate IVs</i>, </li><li><i>generate IVs with the following properties
                [<b>selection</b>: <ul><li><i>CBC: IVs shall be non-repeating and unpredictable</i>, </li><li><i>CCM: Nonce shall be non-repeating and unpredictable</i>, </li><li><i>XTS: No IV. Tweak values shall be non-negative integers, assigned consecutively,
                  and starting at an arbitrary non-negative integer</i>, </li><li><i>GCM: IV shall be non-repeating. The number of invocations of GCM shall not exceed
                  2^32 for a given secret key</i></li></ul>]</i></li></ul>].<h3>FCS_KYC_EXT Key Chaining and Key Storage</h3>Components in this family define requirements for the secure storage of keys through the use of a logical key chain.
          <h3>Component Leveling</h3><p>FCS_KYC_EXT.1,
             Key Chaining and Key Storage,
              requires the TSF to specify how it implements key chaining.</p><h3>Management: FCS_KYC_EXT.1</h3><p>The following actions could be considered for the management functions in FMT: <ul>
            <li>Configuration of the cryptographic functionality.</li>
          </ul>
          </p><h3>Audit: FCS_KYC_EXT.1</h3><p>There are no auditable events foreseen.
          </p><h3>FCS_KYC_EXT.1 Key Chaining and Key Storage</h3><p>Hierarchical to: No other components.</p><p>Dependencies to: FCS_COP.1 Cryptographic Operation<br/>
          FCS_KDF_EXT.1 Cryptographic Key Derivation Function<br/>
          FCS_SMC_EXT.1 Submask Combining</p><h3>FCS_KYC_EXT.1.1</h3><br/> The TSF shall maintain a key chain of: 
              [<b>selection</b>: <ul><li><i>a conditioned password as the [<i>FEK</i>]</i>, </li><li><i>[<i>KEKs</i>] originating from <b> 
                  [<b>selection</b>: <i>one or more authorization factors(s)</i>, <i>a file encryption enterprise management server</i>] </b> to <b> 
                  [<b>selection</b>: <i>the FEK(s)</i>, <i>a file encryption enterprise management server</i>] </b>
                  using the following method(s): 
                  [<b>selection</b>: <ul><li><i>utilization of the platform key storage</i>, </li><li><i>utilization of platform key storage that performs key wrap with a
                      TSF provided key</i>, </li><li><i>implementation of key wrapping as specified in FCS_COP.1<b>(5)</b></i>, </li><li><i>implementation of key combining as specified in FCS_SMC_EXT.1</i>, </li><li><i>implementation of key encryption as specified in FCS_COP.1<b>(7)</b></i>, </li><li><i>implementation of key transport as specified in FCS_COP.1<b>(6)</b></i>, </li><li><i>implementation of key derivation as specified in FCS_KDF_EXT.1</i></li></ul>] while maintaining an effective strength of 
                    [<b>selection</b>: <ul><li><i>
                        [<b>selection</b>: <i>128 bits</i>, <i>256 bits</i>] for symmetric keys
                      </i>, </li><li><i>
                        [<b>selection</b>: <i>128 bits</i>, <i>192 bits</i>, <i>256 bits</i>] for asymmetric keys
                      </i></li></ul>] commensurate with the strength of the FEK
                </i></li></ul>] 
              and 
              [<b>selection</b>: <ul><li><i> no supplemental key chains</i>, </li><li><i> other supplemental key chains that protect a key or keys in the primary key chain using the following method(s):
                  [<b>selection</b>: <ul><li><i>utilization of the platform key storage</i>, </li><li><i>utilization of platform key storage that performs key wrap with a
                      TSF provided key</i>, </li><li><i>implementation of key wrapping as specified in FCS_COP.1<b>(5)</b></i>, </li><li><i>implementation of key combining as specified in FCS_SMC_EXT.1</i>, </li><li><i>implementation of key encryption as specified in FCS_COP.1<b>(7)</b></i>, </li><li><i>implementation of key transport as specified in FCS_COP.1<b>(6)</b></i>, </li><li><i>implementation of key derivation as specified in FCS_KDF_EXT.1</i></li></ul>]</i></li></ul>].
            <h3>FCS_VAL_EXT Validation</h3>Components in this family define requirements for validation of data supplied to the TOE and any consequences resulting from failed validation attempts. 
          <h3>Component Leveling</h3><p>FCS_VAL_EXT.1,
             Validation,
              requires the TSF to specify what data is being validated and how the validation is performed.</p><h3>Management: FCS_VAL_EXT.1</h3><p>There are no specific management functions identified.
          </p><h3>Audit: FCS_VAL_EXT.1</h3><p>The following actions should be auditable if FAU_GEN Security audit data
            generation is included in the PP/ST:<ul>
              <li>Minimal: Change to configuration of validation function behavior.</li>
            </ul>
          </p><h3>FCS_VAL_EXT.1 Validation</h3><p>Hierarchical to: No other components.</p><p>Dependencies to: FCS_COP.1 Cryptographic Operation</p><h3>FCS_VAL_EXT.1.1 </h3><br/>The TSF shall perform validation of the [<i>user</i>] by 
              [<b>selection</b>: <ul><li><i>receiving assertion of the subject's validity from [<b>assignment</b>: <span class='assignable-content'>Operational Environment component responsible for authentication</span>]</i>, </li><li><i>validating the [<b>selection</b>: <i>submask</i>, <i>intermediate key</i>] using the following methods: [<b>selection</b>: <ul><li><i>key wrap as specified in FCS_COP.1<b>(5)</b></i>, </li><li><i>hash the 
                    [<b>selection</b>: <i>submask</i>, <i>intermediate key</i>, <i>FEK</i>] as specified in FCS_COP.1<b>(2)</b> <b>(from <a href='#bibAppPP'>[AppPP]</a>)</b> and compare it to a stored hash</i>, </li><li><i>decrypt a known value using the 
                    [<b>selection</b>: <i>submask</i>, <i>intermediate key</i>, <i>FEK</i>] as specified in FCS_COP.1<b>(1)</b> <b>(from <a href='#bibAppPP'>[AppPP]</a>)</b> and compare it against a stored known value</i></li></ul>]</i></li></ul>]. 
              
            <h3>FCS_VAL_EXT.1.2</h3><br/>The TSF shall require validation of the [<i>user</i>] prior to [<i>decrypting any FEK</i>].<h3>Component Leveling</h3><p>FCS_VAL_EXT.2,
             Validation Remediation,
              requires the TSF to specify what the TOE’s response is in the event of a data validation failure.</p><h3>Management: FCS_VAL_EXT.2</h3><p>The following actions could be considered for the management functions in FMT: <ul>
			  <li>Configuration of the number of failed validation attempts required to trigger corrective behavior.</li>
              <li>Configuration of the corrective behavior to issue in the event of an excessive number of failed validation attempts.</li>
            </ul>
            </p><h3>Audit: FCS_VAL_EXT.2</h3><p>The following actions should be auditable if FAU_GEN Security audit data
              generation is included in the PP/ST:<ul>
                <li>Minimal: Triggering of excessive validation failure response behavior.</li>
              </ul>
            </p><h3>FCS_VAL_EXT.2 Validation Remediation</h3><p>Hierarchical to: No other components.</p><p>Dependencies to: FCS_VAL_EXT.1 Validation</p><h3>FCS_VAL_EXT.2.1</h3><br/>The TSF shall 
                [<b>selection</b>: <ul><li><i>[perform a key destruction of the FEK(s)] upon a configurable number of consecutive failed validation attempts</i>, </li><li><i>institute a delay such that only [<b>assignment</b>: <span class='assignable-content'>ST author specified number of attempts</span>] can be made within a 24 hour period</i>, </li><li><i>block validation after [<b>assignment</b>: <span class='assignable-content'>ST author specified number of attempts</span>] of consecutive failed validation attempts</i>, </li><li><i>require power cycle/reset the TOE after [<b>assignment</b>: <span class='assignable-content'>ST author specified number of attempts</span>] of consecutive failed validation attempts</i></li></ul>].
              <h3>FDP_PRT_EXT Protection of Selected User Data</h3>Components in this family define requirements for the TOE's ability to protect sensitive data at rest.
          <h3>Component Leveling</h3><p>FDP_PRT_EXT.1,
             Protection of Selected User Data,
              requires the TOE to encrypt and decrypt sensitive data using a specified cryptographic algorithm.</p><h3>Management: FDP_PRT_EXT.1</h3><p>There are no specific management functions identified.
          </p><h3>Audit: FDP_PRT_EXT.1</h3><p>There are no auditable events foreseen.
          </p><h3>FDP_PRT_EXT.1 Protection of Selected User Data</h3><p>Hierarchical to: No other components.</p><p>Dependencies to: FCS_CKM_EXT.4 Cryptographic Key Destruction<br/>
          FCS_COP.1 Cryptographic Operation</p><h3>FDP_PRT_EXT.1.1</h3><br/>The TSF shall perform encryption and decryption of the user-selected file (or set
              of files) in accordance with FCS_COP.1(1) <b>(from <a href='#bibAppPP'>[AppPP]</a>)</b>. <h3>FDP_PRT_EXT.1.2</h3><br/> The TSF shall [<b>selection</b>: <i>invoke platform-provided functionality</i>, <i>implement functionality</i>] to ensure that all sensitive data created by the TOE when
              decrypting/encrypting the user-selected file (or set of files) are destroyed in
              volatile and non-volatile memory when the data is no longer needed according to FCS_CKM_EXT.4. <h3>Component Leveling</h3><p>FDP_PRT_EXT.2,
             Destruction of Plaintext Data,
              requires the TOE to destroy any plaintext data that is created as a result of the encryption/decryption process for sensitive data.</p><h3>Management: FDP_PRT_EXT.2</h3><p>There are no specific management functions identified.
          </p><h3>Audit: FDP_PRT_EXT.2</h3><p>There are no auditable events foreseen.
          </p><h3>FDP_PRT_EXT.2 Destruction of Plaintext Data</h3><p>Hierarchical to: No other components.</p><p>Dependencies to: FCS_CKM_EXT.4 Cryptographic Key Destruction<br/>
          FDP_PRT_EXT.1 Protection of Selected User Data</p><h3>FDP_PRT_EXT.2.1</h3><br/>The TSF shall [<b>selection</b>: <i>invoke platform-provided functionality</i>, <i>implement functionality</i>] to ensure that all original plaintext data created when
            decrypting/encrypting the user-selected file (or set of files) are destroyed in volatile
            and non-volatile memory according to FCS_CKM_EXT.4 upon completion of the decryption/encryption operation.
          <h3>Component Leveling</h3><p>FDP_PRT_EXT.3,
             Protection of Third-Party Data,
              requires the TOE to destroy temporary files that may be created during the encryption or decryption process to prevent the inadvertent disclosure of sensitive data.</p><h3>Management: FDP_PRT_EXT.3</h3><p>There are no specific management functions identified.
               </p><h3>Audit: FDP_PRT_EXT.3</h3><p>There are no auditable events foreseen.
               </p><h3>FDP_PRT_EXT.3 Protection of Third-Party Data</h3><p>Hierarchical to: No other components.</p><p>Dependencies to: FDP_PRT_EXT.1 Protection of Selected User Data</p><h3>FDP_PRT_EXT.3.1</h3><br/>The TSF shall ensure that all temporary files created by 
                   [<b>selection</b>: <i>all applications</i>, <i>[<b>assignment</b>: <span class='assignable-content'>subset of applications that can integrate with the FE</span>]</i>]when decrypting/encrypting the
                   user-selected file (or set of files) are removed or encrypted upon completion of the
                   decryption/encryption operation.<h3>FIA_AUT_EXT Authorization</h3>Components in this family define requirements for how subject authorization is performed. 
            Where FIA_UAU in CC Part 2 defines circumstances where authentication is required, this family describes the specific computational methods 
            used to determine whether a subject’s presented authentication data is valid.
          <h3>Component Leveling</h3><p>FIA_AUT_EXT.1,
             Subject Authorization,
              specifies the manner in which the TSF performs user authorization.</p><h3>Management: FIA_AUT_EXT.1</h3><p>The following actions could be considered for the management functions in FMT: <ul>
            <li>Configuration of authentication factors.</li>
          </ul>
          </p><h3>Audit: FIA_AUT_EXT.1</h3><p>The following actions should be auditable if FAU_GEN Security audit data
            generation is included in the PP/ST:<ul>
              <li>Minimal: Failure of authorization function.</li>
              <li>Basic: All use of authorization function.</li>
            </ul>
          </p><h3>FIA_AUT_EXT.1 Subject Authorization</h3><p>Hierarchical to: No other components.</p><p>Dependencies to: FCS_CKM_EXT.6 Cryptographic Password/Passphrase Conditioning<br/>
            FCS_RBG_EXT.1 Random Bit Generation Services</p><h3>FIA_AUT_EXT.1.1</h3><br/>The TSF shall 
              [<b>selection</b>: <i>implement platform-provided functionality to provide user
                  authorization</i>, <i>provide user authorization</i>] based on 
              [<b>selection</b>: <ul><li><i> a password authorization factor conditioned as defined in FCS_CKM_EXT.6</i>, </li><li><i>an external smart card factor that is at least the same bit-length as the FEK(s), and is protecting a submask that is 
                   [<b>selection</b>: <i>generated by the TOE (using the RBG as specified in FCS_RBG_EXT.1 <b>(from <a href='#bibAppPP'>[AppPP]</a>)</b>)</i>, <i>generated by the platform</i>] protected using RSA with key size 
                  [<b>selection</b>: <i>3072 bits</i>, <i>4096 bits</i>] with user presence proved by presentation of the smart card and 
                  [<b>selection</b>: <i>no PIN</i>, <i>an OE defined PIN</i>, <i>a configurable PIN</i>]
                </i>, </li><li><i>an external USB token factor that is at least the same security strength as the FEK(s),
                   and is providing a submask generated by the 
                   [<b>selection</b>: <i>TOE (using the RBG as specified in FCS_RBG_EXT.1 <b>(from <a href='#bibAppPP'>[AppPP]</a>)</b>)</i>, <i>platform</i>]
                </i></li></ul>].
            <h3>FPT_KYP_EXT Protection of Key and Key Material</h3>Components in this family define requirements for secure storage of keys.
          <h3>Component Leveling</h3><p>FPT_KYP_EXT.1,
             Protection of Keys and Key Material,
              requires the TSF to protect stored key data in a specified manner.</p><h3>Management: FPT_KYP_EXT.1</h3><p>The following actions could be considered for the management functions in FMT: <ul>
            <li>Configuration of the cryptographic functionality.</li>
          </ul>
          </p><h3>Audit: FPT_KYP_EXT.1</h3><p>There are no auditable events foreseen.
          </p><h3>FPT_KYP_EXT.1 Protection of Keys and Key Material</h3><p>Hierarchical to: No other components.</p><p>Dependencies to: FCS_COP.1 Cryptographic Operation<br/>
          FCS_KDF_EXT.1 Cryptographic Key Derivation Function<br/>
          FCS_KYC_EXT.1 Key Chaining and Key Storage<br/>
          FCS_SMC_EXT.1 Submask Combining<br/>
          FCS_STO_EXT.1 Storage of Credentials</p><h3>FPT_KYP_EXT.1.1</h3><br/>The TSF shall 
              [<b>selection</b>: <ul><li><i>not store keys in non-volatile memory</i>, </li><li><i>store keys in non-volatile memory only when
                  [<b>selection</b>: <ul><li><i>wrapped, as specified in FCS_COP.1(5)</i>, </li><li><i>encrypted, as specified in FCS_COP.1(7)</i>, </li><li><i>the plaintext key is stored in the underlying platform's keystore as specified by FCS_STO_EXT.1.1 <b>(from <a href='#bibAppPP'>[AppPP]</a>)</b></i>, </li><li><i>the plaintext key is not part of the key chain as specified in FCS_KYC_EXT.1.</i>, </li><li><i>the plaintext key will no longer provide access to the encrypted data after initial provisioning</i>, </li><li><i>the plaintext key is a key split that is combined as specified in FCS_SMC_EXT.1 and another contribution to the split is
                     [<b>selection</b>: <ul><li><i>wrapped as specified in FCS_COP.1(5)</i>, </li><li><i>encrypted as specified in FCS_COP.1(7)</i>, </li><li><i>derived as specified in FCS_KDF_EXT.1.1 and not stored in non-volatile memory</i>, </li><li><i>supplied by the enterprise management server</i></li></ul>]
                    </i>, </li><li><i>the plaintext key is stored on an external storage device for use as an authorization factor.</i>, </li><li><i>the plaintext key is used to encrypt a key as specified in FCS_COP.1(7) or wrap a key as specified in FCS_COP.1(5) 
                      that is already encrypted as specified in FCS_COP.1(7) or wrapped as specified in FCS_COP.1(5)</i></li></ul>]
                </i></li></ul>].
            <h3>FCS_COP_EXT Cryptographic Operation</h3>Components in this family define requirements for cryptographic operations specific to file encryption. 
          <h3>Component Leveling</h3><p>FCS_COP_EXT.1,
             FAK Encryption/Decryption Support,
              defines requirements for how to protect a file encryption key.</p><h3>Management: FCS_COP_EXT.1</h3><p>The following actions could be considered for the management functions in FMT: <ul>
            <li>Configuration of the cryptographic functionality.</li>
          </ul>
          </p><h3>Audit: FCS_COP_EXT.1</h3><p>There are no auditable events foreseen.
          </p><h3>FCS_COP_EXT.1 FAK Encryption/Decryption Support</h3><p>Hierarchical to: No other components.</p><p>Dependencies to: FCS_COP.1 Cryptographic Operation</p><h3>FCS_COP_EXT.1.1</h3><br/>The FAK shall be protected in the same manner as the FEK, in accordance with
              FCS_COP.1(5).<h3>FDP_AUT_EXT User Data Authentication</h3>Components in this family define requirements for authentication of protected user data.
               <h3>Component Leveling</h3><p>FDP_AUT_EXT.1,
             Authentication of Selected User Data,
              requires the TSF to support data authentication and to specify the particular data authentication method that is supported.</p><h3>Management: FDP_AUT_EXT.1</h3><p>There are no specific management functions identified.
           </p><h3>Audit: FDP_AUT_EXT.1</h3><p>The following actions should be auditable if FAU_GEN Security audit data
             generation is included in the PP/ST:<ul>
               <li>Minimal: Failed authentication attempts.</li>
               <li>Basic: All authentication attempts.</li>
             </ul>
           </p><h3>FDP_AUT_EXT.1 Authentication of Selected User Data</h3><p>Hierarchical to: No other components.</p><p>Dependencies to: FDP_AUT_EXT.2 Data Authentication Using Cryptographic Keyed-Hash Functions<br/>
           FDP_AUT_EXT.3 Data Authentication Using Asymmetric Signing and Verification 
           </p><h3>FDP_AUT_EXT.1.1</h3><br/>The TSF shall perform authentication of the user-selected file (or set of files)
               and provide notification to the user if modification had been detected. <h3>FDP_AUT_EXT.1.2</h3><br/> The TSF shall implement a data authentication method based on [<b>selection</b>: <i>cryptographic keyed hashing service and verification in accordance with
                 FDP_AUT_EXT.2</i>, <i>asymmetric signing and verification in accordance with
                 FDP_AUT_EXT.3</i>]. <h3>Component Leveling</h3><p>FDP_AUT_EXT.2,
             Data Authentication Using cryptographic Keyed-Hash Functions,
              requires the TOE to implement data authentication using a keyed hash function with a FAK as its key.</p><h3>Management: FDP_AUT_EXT.2</h3><p>There are no specific management functions identified.
           </p><h3>Audit: FDP_AUT_EXT.2</h3><p>There are no auditable events foreseen.
           </p><h3>FDP_AUT_EXT.2 Data Authentication Using cryptographic Keyed-Hash Functions</h3><p>Hierarchical to: No other components.</p><p>Dependencies to: FCS_CKM_EXT.5 File Authentication Key (FAK) Support<br/>
             FCS_COP.1 Cryptographic Operation<br/>
             FCS_COP_EXT.1 FAK Encryption/Decryption Support<br/>
             FCS_RBG_EXT.1 Random Bit Generation Services<br/>
           </p><h3>FDP_AUT_EXT.2.1</h3><br/>The TSF shall use a cryptographic, keyed hash function in accordance with
               FCS_COP.1(4) <b>(from <a href='#bibAppPP'>[AppPP]</a>)</b>.<h3>FDP_AUT_EXT.2.2</h3><br/>The TSF shall use a File Authentication Key (FAK) in accordance with FCS_COP_EXT.1
               and FCS_CKM_EXT.5 as the secret key to the keyed hash function.<h3>FDP_AUT_EXT.2.3</h3><br/>The TSF shall use the entirety of the ciphertext file as the message input to the
               keyed hash function.<h3>FDP_AUT_EXT.2.4</h3><br/>The TSF shall concatenate the output of the keyed hash function, the Message
               Authentication Code (MAC).<h3>FDP_AUT_EXT.2.5</h3><br/>The TSF shall authenticate the encrypted file prior to decryption.<h3>FDP_AUT_EXT.2.6</h3><br/>The TSF shall authenticate the data by comparing the keyed hash output of the
               ciphertext against the stored MAC.<h3>FDP_AUT_EXT.2.7</h3><br/>The TSF shall notify the user of an unsuccessful authentication and prevent
               decryption of the ciphertext.<h3>FDP_AUT_EXT.2.8</h3><br/>During verification, the TSF shall verify the MAC is at the end of the ciphertext
               file.<h3>FDP_AUT_EXT.2.9</h3><br/>The FAK will be generated using a RBG that meets FCS_RBG_EXT.1 <b>(from <a href='#bibAppPP'>[AppPP]</a>)</b>.<h3>Component Leveling</h3><p>FDP_AUT_EXT.3,
             Data Authentication Using Asymmetric Signing and Verification,
              requires the TOE to implement data authentication using a cryptographic signature and hash.</p><h3>Management: FDP_AUT_EXT.3</h3><p>There are no specific management functions identified.
           </p><h3>Audit: FDP_AUT_EXT.3</h3><p>There are no auditable events foreseen.
           </p><h3>FDP_AUT_EXT.3 Data Authentication Using Asymmetric Signing and Verification</h3><p>Hierarchical to: No other components.</p><p>Dependencies to: FCS_CKM.1 Cryptographic Key Generation<br/>
             FCS_COP.1 Cryptographic Operation
           </p><h3>FDP_AUT_EXT.3.1</h3><br/>The TSF shall use a secure hash function in accordance with FCS_COP.1(2) <b>(from 
               <a href='#bibAppPP'>[AppPP]</a>)</b> with the entire ciphertext file as input to create a
               hash.<h3>FDP_AUT_EXT.3.2</h3><br/>The TSF shall use a cryptographic signing function in accordance with FCS_COP.1(3)
               <b>(from <a href='#bibAppPP'>[AppPP]</a>)</b> and must use the hash generated in accordance with
               FDP_AUT_EXT.3.1 as input to the signing process. Additionally, use of ephemeral key for
               signing purposes is prohibited.<h3>FDP_AUT_EXT.3.3</h3><br/>The TSF shall use a public and private key pair generated in accordance with
               FCS_CKM.1(1) <b>(from <a href='#bibAppPP'>[AppPP]</a>)</b> and must use this key pair as part of the cryptographic signing process in
               accordance with FDP_AUT_EXT.3.2.<h3>FDP_AUT_EXT.3.4</h3><br/>The TSF shall authenticate the ciphertext data prior to decryption.<h3>FDP_AUT_EXT.3.5</h3><br/>The TSF shall notify the user of an unsuccessful authentication and prevent
               decryption of the ciphertext if such an event were to occur.<h3>FDP_AUT_EXT.3.6</h3><br/>The TSF shall append the signature to the end of the ciphertext file.<h3>FDP_AUT_EXT.3.7</h3><br/>During verification, the TSF shall verify the signature is at the end of the
               ciphertext file.<h3>FDP_PM_EXT Protection of Data in Power Managed States</h3>Components in this family define requirements for the protection of data in cases where the host platform becomes locked or unpowered.
               <h3>Component Leveling</h3><p>FDP_PM_EXT.1,
             Protection of Data in Power Managed States,
              requires the TOE to ensure that TSF-protected data does not lose its protections if the host platform is placed in a locked or unpowered state.</p><h3>Management: FDP_PM_EXT.1</h3><p>There are no specific management functions identified.
               </p><h3>Audit: FDP_PM_EXT.1</h3><p>There are no auditable events foreseen.
               </p><h3>FDP_PM_EXT.1 Protection of Data in Power Managed States</h3><p>Hierarchical to: No other components.</p><p>Dependencies to: FDP_PRT_EXT.1 Protection of Selected User Data<br/>
                 FIA_AUT_EXT.1 User Authorization
               </p><h3>FDP_PM_EXT.1.1</h3><br/>The TSF shall protect all data selected for encryption during the transition to
                   the [<b>assignment</b>: <span class='assignable-content'>powered-down state(s) or locked system states for which this capability is provided</span>] state as
                   per FDP_PRT_EXT.1.1.<h3>FDP_PM_EXT.1.2</h3><br/>On the return to a powered-on state from the state(s) indicated in FDP_PM_EXT.1.1,
                   the TSF shall authorize the user in the manner specified in FIA_AUT_EXT.1.1 once before
                   any protected data are decrypted. <h3>FDP_PM_EXT.1.3</h3><br/>The TSF shall destroy all key material and authentication factors stored in plaintext when transitioning to a
                   protected state as defined by FDP_PM_EXT.1.1.<h3>FIA_FCT_EXT Authorization Factors</h3>Components in this family define requirements for the use of alternative authorization factors for users to access protected data.
          <h3>Component Leveling</h3><p>FIA_FCT_EXT.1,
             Multi-User Authorization,
              requires the TSF to maintain differing authorization factors for multiple users.</p><h3>Management: FIA_FCT_EXT.1</h3><p>There are no specific management functions identified.
          </p><h3>Audit: FIA_FCT_EXT.1</h3><p>There are no auditable events foreseen.
          </p><h3>FIA_FCT_EXT.1 Multi-User Authorization</h3><p>Hierarchical to: No other components.</p><p>Dependencies to: FIA_AUT_EXT.1 User Authorization</p><h3>FIA_FCT_EXT.1.1</h3><br/>The TSF shall support the use of authorization factors from multiple users that result in unique KEKs.<h3>FIA_FCT_EXT.1.2</h3><br/>The TSF shall support the ability of each user to have files protected by a key chain tied only to that user's credentials.
            <h3>Component Leveling</h3><p>FIA_FCT_EXT.2,
             Authorized Key Sharing,
              requires the TSF to support some mechanism to share a valid authorization factor between different users.</p><h3>Management: FIA_FCT_EXT.2</h3><p>There are no specific management functions identified.
          </p><h3>Audit: FIA_FCT_EXT.2</h3><p>There are no auditable events foreseen.
          </p><h3>FIA_FCT_EXT.2 Authorized Key Sharing</h3><p>Hierarchical to: No other components.</p><p>Dependencies to: FCS_COP.1 Cryptographic Operation</p><h3>FIA_FCT_EXT.2.1</h3><br/>The TSF shall support
              [<b>selection</b>: <i>Authorized User Key sharing via key transport as specified in FCS_COP.1(6)</i>, <i>Distribution of a shared key from an enterprise management Server</i>].
            <h3>FCS_KDF_EXT Cryptographic Key Derivation Function</h3>Components in this family define requirements for the implementation of cryptographic key derivation functions
          <h3>Component Leveling</h3><p>FCS_KDF_EXT.1,
             Cryptographic Key Derivation Function,
              requires the TSF to specify how it performs key derivation.</p><h3>Management: FCS_KDF_EXT.1</h3><p>The following actions could be considered for the management functions in FMT: <ul>
            <li>Configuration of the cryptographic functionality.</li>
          </ul>
          </p><h3>Audit: FCS_KDF_EXT.1</h3><p>There are no auditable events foreseen.
          </p><h3>FCS_KDF_EXT.1 Cryptographic Key Derivation Function</h3><p>Hierarchical to: No other components.</p><p>Dependencies to: FCS_COP.1 Cryptographic Operation <br/>
            FCS_RBG_EXT.1 Random Bit Generation Services</p><h3>FCS_KDF_EXT.1.1</h3><br/>
                The TSF shall [<i>accept
                    [<b>selection</b>: <i>a submask generated by an RBG as specified in FCS_RBG_EXT.1 <b>(from <a href='#bibAppPP'>[AppPP]</a>)</b></i>, <i>a conditioned password</i>, <i>an imported submask</i>] to derive an intermediate key, as defined in
                    [<b>selection</b>: <ul><li><i>NIST SP 800-108 
                        [<b>selection</b>: <i>KDF in Counter Mode</i>, <i>KDF in Feedback Mode</i>, <i>KDF in Double-Pipeline Iteration Mode</i>]
                      </i>, </li><li><i>NIST SP 800-132</i></li></ul>] using the keyed-hash functions specified in FCS_COP.1<b>(4) (from <a href='#bibAppPP'>[AppPP]</a>)</b>, such that the output is at least of
                    equivalent security strength (in number of bits) to the [FEK]</i>].
            <h3>FCS_SMC_EXT Submask Combining</h3>Components in this family define requirements for generation of intermediate keys via submask combining.
          <h3>Component Leveling</h3><p>FCS_SMC_EXT.1,
             Submask Combining,
              requires the TSF to implement submask combining in a specific manner to support the generation of intermediate keys.</p><h3>Management: FCS_SMC_EXT.1</h3><p>The following actions could be considered for the management functions in FMT: <ul>
            <li>Configuration of the cryptographic functionality.</li>
          </ul>
          </p><h3>Audit: FCS_SMC_EXT.1</h3><p>There are no auditable events foreseen.
          </p><h3>FCS_SMC_EXT.1 Submask Combining</h3><p>Hierarchical to: No other components.</p><p>Dependencies to: FCS_COP.1 Cryptographic Operation</p><h3>FCS_SMC_EXT.1.1 </h3><br/>The TSF shall [<i>combine submasks using the following method [<b>selection</b>: <i>exclusive OR (XOR)</i>, <i>SHA-256</i>, <i>SHA-384</i>, <i>SHA-512</i>, <i>HMAC-SHA-256</i>, <i>HMAC-SHA-384</i>, <i>HMAC-SHA-512</i>] to generate an intermediate key</i>].<h3>FCS_VAL_EXT Validation Remediation</h3>Components in this family define requirements for validation of data supplied to the TOE and any consequences resulting from failed validation attempts. 
            <h3>Component Leveling</h3><p>FCS_VAL_EXT.1,
             Validation,
              requires the TSF to specify what data is being validated and how the validation is performed.</p><h3>Management: FCS_VAL_EXT.1</h3><p>There are no specific management functions identified.
          </p><h3>Audit: FCS_VAL_EXT.1</h3><p>The following actions should be auditable if FAU_GEN Security audit data
            generation is included in the PP/ST:<ul>
              <li>Minimal: Change to configuration of validation function behavior.</li>
            </ul>
          </p><h3>FCS_VAL_EXT.1 Validation</h3><p>Hierarchical to: No other components.</p><p>Dependencies to: FCS_COP.1 Cryptographic Operation</p><h3>FCS_VAL_EXT.1.1 </h3><br/>The TSF shall perform validation of the [<i>user</i>] by 
              [<b>selection</b>: <ul><li><i>receiving assertion of the subject's validity from [<b>assignment</b>: <span class='assignable-content'>Operational Environment component responsible for authentication</span>]</i>, </li><li><i>validating the [<b>selection</b>: <i>submask</i>, <i>intermediate key</i>] using the following methods: [<b>selection</b>: <ul><li><i>key wrap as specified in FCS_COP.1<b>(5)</b></i>, </li><li><i>hash the 
                    [<b>selection</b>: <i>submask</i>, <i>intermediate key</i>, <i>FEK</i>] as specified in FCS_COP.1<b>(2)</b> <b>(from <a href='#bibAppPP'>[AppPP]</a>)</b> and compare it to a stored hash</i>, </li><li><i>decrypt a known value using the 
                    [<b>selection</b>: <i>submask</i>, <i>intermediate key</i>, <i>FEK</i>] as specified in FCS_COP.1<b>(1)</b> <b>(from <a href='#bibAppPP'>[AppPP]</a>)</b> and compare it against a stored known value</i></li></ul>]</i></li></ul>]. 
              
            <h3>FCS_VAL_EXT.1.2</h3><br/>The TSF shall require validation of the [<i>user</i>] prior to [<i>decrypting any FEK</i>].<h3>Component Leveling</h3><p>FCS_VAL_EXT.2,
             Validation Remediation,
              requires the TSF to specify what the TOE’s response is in the event of a data validation failure.</p><h3>Management: FCS_VAL_EXT.2</h3><p>The following actions could be considered for the management functions in FMT: <ul>
			  <li>Configuration of the number of failed validation attempts required to trigger corrective behavior.</li>
              <li>Configuration of the corrective behavior to issue in the event of an excessive number of failed validation attempts.</li>
            </ul>
            </p><h3>Audit: FCS_VAL_EXT.2</h3><p>The following actions should be auditable if FAU_GEN Security audit data
              generation is included in the PP/ST:<ul>
                <li>Minimal: Triggering of excessive validation failure response behavior.</li>
              </ul>
            </p><h3>FCS_VAL_EXT.2 Validation Remediation</h3><p>Hierarchical to: No other components.</p><p>Dependencies to: FCS_VAL_EXT.1 Validation</p><h3>FCS_VAL_EXT.2.1</h3><br/>The TSF shall 
                [<b>selection</b>: <ul><li><i>[perform a key destruction of the FEK(s)] upon a configurable number of consecutive failed validation attempts</i>, </li><li><i>institute a delay such that only [<b>assignment</b>: <span class='assignable-content'>ST author specified number of attempts</span>] can be made within a 24 hour period</i>, </li><li><i>block validation after [<b>assignment</b>: <span class='assignable-content'>ST author specified number of attempts</span>] of consecutive failed validation attempts</i>, </li><li><i>require power cycle/reset the TOE after [<b>assignment</b>: <span class='assignable-content'>ST author specified number of attempts</span>] of consecutive failed validation attempts</i></li></ul>].
              <h1 class='indexable' data-level='A' id='KMD'>Appendix E -  Key Management Description</h1> 
        

      The documentation of the product’s encryption key management should be detailed enough
      that, after reading, the evaluator will thoroughly understand the product’s key management and
      how it meets the requirements to ensure the keys are adequately protected. This documentation
      should include an essay and diagram(s). This documentation is not required to be part of the
      TSS - it can be submitted as a separate document and marked as developer proprietary.
      <br/><br/>
      Essay:
      <br/><br/>
      The essay will provide the following information for all keys in the key chain:
      <br/><br/>
      <li>The purpose of the key</li>
      <li>If the key is stored in non-volatile memory</li>
      <li>How and when the key is protected</li>
      <li>How and when the key is derived</li>
      <li>The strength of the key</li>
      <li>When or if the key would be no longer needed, along with a justification</li>
      <li>How and when the key may be shared</li>
      
      <br/><br/>
      The essay will also describe the following topics:
      <br/><br/>
      
      <li>A description of all authorization factors that are supported by the product and how
      each factor is handled, including any conditioning and combining performed.</li>
      
      <li>If validation is implemented, the process for validation shall be described, noting what
      value is used for validation and the process used to perform the validation. It shall
      describe how this process ensures no keys in the key chain are weakened or exposed
      by this process.</li>
      
      <li>The authorization process that leads to the decryption of the FEK(s). This section
      shall detail the key chain used by the product. It shall describe which keys are used in
      the protection of the FEK(s) and how they meet the encryption or derivation requirements including the direct chain from the initial
      authorization to the FEK(s). It shall also include any values that add into that key chain
      or interact with the key chain and the protections that ensure those values do not
      weaken or expose the overall strength of the key chain.</li>
      
      <li>The diagram and essay will clearly illustrate the key hierarchy to ensure that at no
      point the chain could be broken without a cryptographic exhaust or all of the initial
      authorization values and the effective strength of the FEK(s) is maintained throughout
      the key chain.</li>
      
      <li>A description of the data encryption engine, its components, and details about its
      implementation (e.g. initialization of the product, drivers, libraries (if
      applicable), logical interfaces for encryption/decryption, and how resources to be encrypted are identified.
      The description should also include the data flow from the device’s host interface to the device’s persistent media storing the data,
      information on those conditions in which the data bypasses the data encryption engine. The
      description should be detailed enough to verify all platforms ensure that when the
      user enables encryption, the product encrypts all selected resources.</li>
      
      <li>The process for destroying keys when they are no longer needed by describing the
      storage location of all keys and the protection of all keys stored in non-volatile
      memory.</li>
      
      <br/><br/>
      Diagram:
      
      <br/><br/>

      <li>The diagram will include all keys from the initial authorization factor(s) to the FEK(s)
      and any keys or values that contribute into the chain. It must list the cryptographic
      strength of each key and indicate how each key along the chain is protected with
      either options from key chaining requirement. The diagram
      should indicate the input used to derive or decrypt each key in the chain.</li>
      
      <li>A functional (block) diagram showing the main components (such as memories and
      processors) the initial steps needed
      for the activities the TOE performs to ensure it encrypts the targeted resources
      when a user or administrator first provisions the product.</li>
    
  <h1 class='indexable' data-level='A' id='bibliography'>Appendix F -  Bibliography</h1><table><tr class='header'><th>Identifier</th><th>Title</th></tr><tr><td><span id='bibCC'> [CC] </span></td><td>Common Criteria for Information Technology Security Evaluation - <ul>
          <li><a href='http://www.commoncriteriaportal.org/files/ccfiles/CCPART1V3.1R4.pdf'>Part
                1: Introduction and General Model</a>, CCMB-2017-04-001, Version 3.1 Revision 5,
              April 2017.</li>
          <li><a href='http://www.commoncriteriaportal.org/files/ccfiles/CCPART2V3.1R4.pdf'>Part
                2: Security Functional Components</a>, CCMB-2017-04-002, Version 3.1 Revision 5,
              April 2017.</li>
          <li><a href='http://www.commoncriteriaportal.org/files/ccfiles/CCPART3V3.1R4.pdf'>Part
                3: Security Assurance Components</a>, CCMB-2017-04-003, Version 3.1 Revision 5,
              April 2017.</li>
          </ul></td></tr><tr><td><span id='bibAppPP'> [AppPP] </span></td><td>
          <a href='https://www.niap-ccevs.org/pp/'>Protection Profile for Application Software, Version 1.3</a>
        </td></tr><tr><td><span id='FIPS140-2'> [FIPS140-2] </span></td><td> Federal Information Processing Standard Publication (FIPS-PUB) 140-2, Security
          Requirements for Cryptographic Modules, National Institute of Standards and Technology,
          March 19, 2007 </td></tr><tr><td><span id='FIPS180-4'> [FIPS180-4] </span></td><td> Federal Information Processing Standards Publication (FIPS-PUB) 180-4, Secure
          Hash Standard, March, 2012 </td></tr><tr><td><span id='FIPS186-4'> [FIPS186-4] </span></td><td> Federal Information Processing Standard Publication (FIPS-PUB) 186-4, Digital
          Signature Standard (DSS), National Institute of Standards and Technology, July 2013
        </td></tr><tr><td><span id='FIPS197'> [FIPS197] </span></td><td>Federal Information Processing Standards Publication (FIPS-PUB) 197,
          Specification for the Advanced Encryption Standard (AES), November 26, 2001 </td></tr><tr><td><span id='FIPS198-1'> [FIPS198-1] </span></td><td>Federal Information Processing Standards Publication (FIPS-PUB) 198-1, The
          Keyed-Hash Message Authentication Code (HMAC), July 2008 </td></tr><tr><td><span id='SP800-38A'> [NIST800-38A] </span></td><td>NIST Special Publication 800-38A, Recommendation for Block Cipher Modes of
          Operation: Methods and Techniques, 2001 Edition </td></tr><tr><td><span id='SP800-56A'> [NIST800-56A] </span></td><td>NIST Special Publication 800-56A, Recommendation for Pair-Wise Key
          Establishment Schemes Using Discrete Logarithm Cryptography (Revised), March 2007
        </td></tr><tr><td><span id='SP800-56B'> [NIST800-56B] </span></td><td>NIST Special Publication 800-56B, Recommendation for Pair-Wise Key
          Establishment Schemes Using Integer Factorization Cryptography, August 2009 </td></tr><tr><td><span id='SP800-90'> [NIST800-90] </span></td><td>NIST Special Publication 800-90, Recommendation for Random Number Generation
          Using Deterministic Random Bit Generators (Revised), March 2007 </td></tr><tr><td><span id='SP800-132'> [NIST800-132] </span></td><td>NIST Special Publication 800-132, Recommendation for Password-Based Key
          Derivation, December 2010 </td></tr><tr><td><span id='SP800-38F'> [NIST800-38F] </span></td><td>NIST Special Publication 800-38F,Recommendation for Block Cipher Modes of
          Operation: Methods for Key Wrapping, December 2012 </td></tr></table>
<h1 class='indexable' data-level='A' id='acronyms'>Appendix G -  Acronyms</h1><table><tr class='header'><th>Acronym</th><th>Meaning</th></tr><tr><td>AES</td><td>Advanced Encryption Standard</td></tr><tr><td>CC</td><td>Common Criteria</td></tr><tr><td>FAK</td><td>File Authentication Key</td></tr><tr><td>FEK</td><td>File Encryption Key</td></tr><tr><td>DRBG</td><td>Deterministic Random Bit Generator</td></tr><tr><td>EAL</td><td>Evaluation Assurance Level</td></tr><tr><td>ECC</td><td>Elliptic Curve Cryptography</td></tr><tr><td>ECC CDH</td><td>Elliptic Curve Cryptography Cofactor Diffie-Hellman (see NIST SP 800-56A rev 2,
          section 6.2.2.2)</td></tr><tr><td>FIPS</td><td>Federal Information Processing Standards</td></tr><tr><td>ISSE</td><td>Information System Security Engineers</td></tr><tr><td>IT</td><td>Information Technology</td></tr><tr><td>KDF</td><td>Key Derivation Function</td></tr><tr><td>KEK</td><td>Key Encryption Key</td></tr><tr><td>PBKDF</td><td>Password-Based Key Derivation Function</td></tr><tr><td>PIN</td><td>Personnel Identification Number</td></tr><tr><td>PKI</td><td>Public Key Infrastructure</td></tr><tr><td>PP</td><td>Protection Profile</td></tr><tr><td>PUB</td><td>Publication</td></tr><tr><td>RBG</td><td>Random Bit Generator </td></tr><tr><td>SAR</td><td>Security Assurance Requirement</td></tr><tr><td>SF</td><td>Security Function</td></tr><tr><td>SFR</td><td>Security Functional Requirement</td></tr><tr><td>ST</td><td>Security Target</td></tr><tr><td>TOE</td><td>Target of Evaluation</td></tr><tr><td>TSF</td><td>TOE Security Functionality</td></tr><tr><td>TSFI</td><td>TSF Interface</td></tr><tr><td>TSS</td><td>TOE Summary Specification </td></tr></table></body></html>