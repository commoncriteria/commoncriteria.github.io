<html><head><title>Functional Package for Transport Layer Security (TLS)</title><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><script type="text/x-mathjax-config">
            MathJax.Hub.Config({
            extensions: ["tex2jax.js"],
            jax: ["input/TeX", "output/HTML-CSS"],
            showMathMenu: false,
            tex2jax: {
              inlineMath: [ ['$','$'], ["\\(","\\)"] ],
              displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
              processEscapes: true
            },
            styles: {

                ".MathJax_Display": {
                "text-align": "left !important",
                margin:       "0em 0em !important"
            }}
            });
        </script><script type="text/javascript">// 

// Called on page load to parse URL parameters and perform actions on them.
function init(){
    if(getQueryVariable("expand") == "on"){
      expand();
    }
    fixAbbrs();
}


function fixAbbrs(){
    var aa;
    var brk_els = document.getElementsByClassName("dyn-abbr");
    //
    for(aa=0; aa!=brk_els.length; aa++){
        var abbr = brk_els[aa].firstElementChild.getAttribute("href").substring(1);
        var el = document.getElementById("long_"+abbr)
        if (el==null) {
             console.log("Could not find 'long_abbr_'"+abbr);
             continue;
        }
        var abbr_def = el.textContent;
        brk_els[aa].setAttribute("title", abbr_def);
    }
}
// // 
const AMPERSAND=String.fromCharCode(38);

// Pass a URL variable to this function and it will return its value
function getQueryVariable(variable)
{
    var query = window.location.search.substring(1);
    var vars = query.split(AMPERSAND);
    for (var i=0;i!=vars.length;i++) {
        var pair = vars[i].split("=");
        if(pair[0] == variable){return pair[1];}
    }
    return(false);
}


//    Expands all evaluation activities
function expand(){
    var ap = document.getElementsByClassName('activity_pane');
    for (var ii = 0; ii!=ap.length; ii++) {
        ap[ii].classList.remove('hide');
    }
}

// Function to expand and contract a given div
function toggle(descendent) {
    var cl = descendent.parentNode.parentNode.classList;
    if (cl.contains('hide')){
      cl.remove('hide');
    }
    else{
      cl.add('hide');
    }
}

// Expands targets if they are hidden
function showTarget(id){
    var element = document.getElementById(id);
    while (element != document.body.rootNode ){
	element.classList.remove("hide");
	element = element.parentElement;
    }
}


// </script><style type="text/css">
    #toc a{
        display: block;
    }

    svg{
      width: 100%;
    }

    a[id^="ajq_"]{
        color:black;
    }

    
    body{
       max-width: 900px;
       margin: auto;
    }
    #toc span{
       margin-left: 20px;
    }
    .assignable-content{
      font-style: italic;
    }
    .refinement{
      font-weight: bold;
    }
    div.eacategory{
      font-style: italic;
      font-weight: bold;
    }
    .activity_pane .toggler::after, .activity_pane .toggler{
       display: inline-block;
       height: auto;
       content: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8A\
       AAAPCAYAAAA71pVKAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAQOFAAEDhQGl\
       VDz+AAAAB3RJTUUH4gIXFDM7fhmr1wAAAfRJREFUKM+dkk9I02EYxz/P+25uurWR\
       tTkzI4NGl4jQgkq71K1DhnTQIDolRAQFQYSHTtGhU4e6eujQofBSFLOg0C4RUSjh\
       FnmqTTdKpj/mfv/eX4cUpmRYn9vz8v3w8D7PA/AWGADCbI4QcAb4AnAF8IBJEdX+\
       N0tEda40C4AHADviW1LFvpOX6+FwtAacVzqkGiWtwxo4F21OuPu7+yvxRNoDEhpY\
       cpzavkQyc7D76FCk+vN7j7VU6RdR4xAsikjGGP9FKrN3sPfEpajv2i2zhckR4JUG\
       UCr0erFavLkn2ytd2WPxcFOsZb74+SIQA0YPHBqIdB8Z6tChJv1m/N4P33OGAUsD\
       BIFxPNcOkq07jyeSbbo1tTu2q6vHEqU7D/ddSKcz2ZQJjBSmx925b9NjwEMAafha\
       eyQa/3Dq7O0243sCIEoRGAOA59nm5dM7OHVruzH+AkDjYEp23RrLT+U8Ub+fV0UR\
       oVyaMfVa9fqquF5GKX3ja2FCuc6yWbMipYNP755UgEdr8o2FMf5ivVYdKRfzRkRW\
       RfJTOc+2rWdAcUN5hdGP7x8viGgAXLvGbGFCKxW6tj74J3nOqVvP89M5V6kQ86UZ\
       f7lWvWWMt7Sp41VKb21uSfqnB++6kWi8BLTzL4ioq7H4tgC4z3/QAZSBxEaBXygN\
       v+jeFnAPAAAAAElFTkSuQmCC');
       max-width: 15px;
    }


    a {
      text-decoration: none;
      word-wrap: break-word;
    }
    a.abbr:link{
      color:black;
      text-decoration:none;
    }
    a.abbr:visited{
      color:black;
      text-decoration:none;
    }
    a.abbr:hover{
      color:blue;
      text-decoration:none;
    }
    a.abbr:hover:visited{
      color:purple;
      text-decoration:none;
    }
    a.abbr:active{
      color:red;
      text-decoration:none;
    }
    .note-header{
      font-weight: bold;
    }
    .note p:first-child{
      display: inline;
    }

    .indent{ margin-left:2em; }

    /* Tooltip container */
    .tooltipped {
       position: relative;
       display: inline-block;
       border-bottom: 1px dotted black; /* If you want dots under the hoverable text */
    }

    /* Tooltip text */
    .tooltiptext {
       visibility: hidden;
       width: 120px;
       background-color: black;
       color: #fff;
       text-align: center;
       padding: 5px 0;
       border-radius: 6px;

       /* Position the tooltip text - see examples below! */
       position: absolute;
       z-index: 1;
   }

   /* Show the tooltip text when you mouse over the tooltip container */
   .tooltipped:hover .tooltiptext {
       visibility: visible;
   }
   tr.major-row{
       border-top-style: double;
   }
   tr.major-row td:first-child{
       border-right-style: ridge;
       background-color: white;
   } 
   table.mfs td{
       text-align: center;
   }
   table.mfs td:first-child{
       text-align: left;
   }
  .table-caption, caption{
       text-align: center;
       font-weight: bold;
   }
   table{
       margin:auto;
       margin-top:1em;
       border-collapse:collapse; /*border: 1px solid black;*/
   }
   td{
       text-align:left;
       padding:8px 8px;
   }
   th{
       padding:8px 8px;
   }
   thead tr td{
       text-align: center;
       font-style: oblique;
       font-weight: bold;
   }
   tr.header{
       border-bottom:3px solid gray;
       padding:8px 8px;
       text-align:left;
       font-weight:bold; /*font-size: 90%; font-family: verdana, arial, helvetica, sans-serif; */
   }
   table tr:nth-child(2n+2){
       background-color:#F4F4F4;
   }

   .dependent{
       border: 1px solid gray;
       border-radius: 1px
   }
   .dependent-content{
       margin-left: 25px;
       font-style: italic;
   }

   .uc_table_or td, .uc_table_or tr {
       vertical-align: middle;
       border: 1px solid black;
       background-color: white;
   }

   .uc_not, .uc_mf, .uc_sel, .uc_guide{
       text-indent: 10px;
   }
   .uc_sel > a{ 
       font-style: italic;
   }

   .uc_not_sel, .uc_sel.uc_mf, uc_assign.uc_mf{
       text-indent: 20px;
   }


   .uc_table_or tr td.or_cell{
      white-space: nowrap;
      border-radius: 0.6em 0 0 0.6em;
      background-color: black;
      color: white;
   }

   .uc_table_and, .uc_table_or {
       width: 100%;
       background-color: white;
   }
   .uc_guidance{
       display: table;
       background-color: gray;
   }  

   .evidence, .test-obj { font-style: normal; font-size: 90%;}
   
   
	table.classic {
    	width: 100%;
    	background-color: white;
    	border-collapse: collapse;
    	border-width: 2px;
  		border-color: gray;
  		border-style: solid;
  		color: black;
		font-size: small;
	}
    table.classic th {
  		background-color: lightgray;   
	}
    table.classic th:empty{
	    background-color: white;
		border-top: none;
		border-left: none;
	}
	table.classic td, table.classic th {
  		border-width: 2px;
  		border-color: gray;
  		border-style: solid;
  		padding: 5px;
	}

   
   
   
          .figure{
              font-weight:bold;
          }
          h1{
              page-break-before:always;
              text-align:left;
              font-size:200%;
              margin-top:2em;
              margin-bottom:2em;
              font-family:verdana, arial, helvetica, sans-serif;
              margin-bottom:1.0em;
          }
          h1.title{
              text-align:center;
          }
          h2{
              font-size:125%;
              border-bottom:solid 1px gray;
              margin-bottom:1.0em;
              margin-top:2em;
              margin-bottom:0.75em;
              font-family:verdana, arial, helvetica, sans-serif;
          }
          h3{
              font-size:110%;
              margin-bottom:0.25em;
              font-family:verdana, arial, helvetica, sans-serif;
          }
          h4{
              margin-left:0%;
              font-size:100%;
              margin-bottom:0.75em;
              font-family:verdana, arial, helvetica, sans-serif;
          }
          h5,
          h6{
              margin-left:6%;
              font-size:90%;
              margin-bottom:0.5em;
              font-family:verdana, arial, helvetica, sans-serif;
          }
          p{
              margin-bottom:0.6em;
              margin-top:0.2em;
          }
          pre{
              margin-bottom:0.5em;
              margin-top:0.25em;
              margin-left:3%;
              font-family:monospace;
              font-size:90%;
          }
          ul{
              margin-bottom:0.5em;
              margin-top:0.25em;
          }
          td{
              vertical-align:top;
          }
          dl{
              margin-bottom:0.5em;
              margin-top:0.25em;
          }
          dt{
              margin-top:0.7em;
              font-weight:bold;
              font-family:verdana, arial, helvetica, sans-serif;
          }

          a.linkref{
              font-family:verdana, arial, helvetica, sans-serif;
              font-size:90%;
          }

          *.simpleText{
              margin-left:10%;
          }
          *.propertyText{
              margin-left:10%;
              margin-top:0.2em;
              margin-bottom:0.2em
          }
          *.toc{
              background:#FFFFFF;
          }
          *.toc2{
              background:#FFFFFF;
          }
          div.comp{
              margin-left:8%;
              margin-top:1em;
              margin-bottom:1em;
          }
          div.element{
              margin-bottom:1em;
          }
          div.appnote{
              margin-left:0%;
              margin-top:1em;
          }
          .comment-aa{
              background-color:beige;
              color:green;
          }

          div.subaact{
              margin-left:0%;
              margin-top:1em;
          }
          .subaact-header{
              font-weight: bold;
          }

          div.activity_pane_body{
              font-style:italic;
              margin-left:0%;
              margin-top:1em;
              margin-bottom:1em;
              padding:1em;
              border:2px solid #888888;
              border-radius:3px;
              display:block;
              margin-left:0%;
              margin-top:1em;
              margin-bottom:1em;
              box-shadow:0 2px 2px 0 rgba(0,0,0,.14),0 3px 1px -2px rgba(0,0,0,.2),0 1px 5px 0 rgba(0,0,0,.12);
          }
          div.optional-appendicies{
              display:none;
          }

          div.statustag{
              margin-left:0%;
              margin-top:1em;
              margin-bottom:1em;
              padding: 0.6em;
              border:2px solid #888888;
              border-radius:3px;
          }

          div.toc{
              margin-left:8%;
              margin-bottom:4em;
              padding-bottom:0.75em;
              padding-top:1em;
              padding-left:2em;
              padding-right:2em;
          }
          span.SOlist{
              font-size:90%;
              font-family:verdana, arial, helvetica, sans-serif;
          }
          h2.toc{
              border-bottom:none;
              margin-left:0%;
              margin-top:0em;
          }
          p.toc{
              margin-left:2em;
              margin-bottom:0.2em;
              margin-top:0.5em;
          }
          p.toc2{
              margin-left:5em;
              margin-bottom:0.1em;
              margin-top:0.1em;
          }
          div.center{
              display:block;
              margin-left:auto;
              margin-right:auto;
              text-align:center;
          }
          div.figure{
              display:block;
              margin-left:auto;
              margin-right:auto;
              text-align:center;
              margin-top:1em;
          }
          div.activity_pane_header{
              display:table-cell;
              vertical-align:middle;
              padding-top:10px
          }
          span.activity_pane_label{
              vertical-align:middle;
              color:black;
              text-decoration:none;
              font-size:100%;
              font-weight:bold; /*font-family: verdana, arial, helvetica, sans-serif; */
          }
          .dyn-abbr a, .dyn-abbr a:active, .dyn-abbr a:visited{
              background-color: inherit;
              color: inherit;
              text-decoration: inherit;;
          }

          @media screen{
              *.reqid{
                  float:left;
                  font-size:90%;
                  font-family:verdana, arial, helvetica, sans-serif;
                  margin-right:1em;
              }
              *.req{
                  margin-left:0%;
                  margin-top:1em;
                  margin-bottom:1em;
              }
              *.reqdesc{
                  margin-left:20%;
              }

              .activity_pane.hide .toggler::after, .activity_pane.hide .toggler{
	          content: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8A\
		  AAAPCAYAAAA71pVKAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAQOFAAEDhQGl\
		  VDz+AAAAB3RJTUUH4gIXFC4BR3keeQAAAfZJREFUKM+d0k1PE1EUBuB37h2nQ+30\
		  w5YObR0FhIppqBgWuDCaSBQjiQZNTIxLfoAkBHXh2vg7xID+ABPXBl3UdAMaN1CR\
		  j5ZijZ22DKW9d44LP1KMROvZnMU5z+KcvBzAAgADwCdV1RzXlYQ26tYhrYM6u/qX\
		  ATwCcKodrAOYv3z9IV28OuP6/NHPAGYZ45G/QQ5AAFjNbyzdTA2NewcGx7xeI5wu\
		  FZenQOQQuasHncN/9IJo1sn+unkpbqVFIJhgydQo13VjDKCJSnnLBJAHUPoTBoA3\
		  uzvlfiNgDhn+KMiVCB6xYCZSoaPHz5wrba/cbuztpBWFvQLI+R2DSGZqleKNuJX2\
		  cVVjAIExDo/uV7pPjGhSNntrleI9+n7Ox33Y549Wq/ZWTyh8rNcfjPlaZ4xzZvUM\
		  ezrNvnJ+fXFCiL2k2rpQq2wnAqH4tYjZFyZq/Y8CKZoim51z1nIZQ4jGNIC5fZhz\
		  7fHA4JVuj26AyIWiMDSbdTi1L/T29RO7ahdfKgqbInJLANCKZ6Kx5J24dVowztW6\
		  Y+8WNt91FNYXc4WN988BzAL4QOT+Aj/x8GFf+MHI+UlI2cBS9kVlLZfxSFdMS9GY\
		  V1WtKETDPShhz85emLRHx++TETBLAJ4qCov8c7ajsZMr/5PtBQB3AXSpqsbagd8A\
		  O+HMRUtPNsQAAAAASUVORK5CYII=');
              }

              .activity_pane.hide .activity_pane_body{
                  display:none;
              }
              div.statustag{
                  box-shadow:4px 4px 3px #888888;
              }
          }


          @media print{
              *.reqid{
                  font-size:90%;
                  font-family:verdana, arial, helvetica, sans-serif;
              }
              *.req{
                  margin-left:0%;
                  margin-top:1em;
                  margin-bottom:1em;
              }
              *.reqdesc{
                  margin-left:20%;
              }
              div.activity_pane_body{
                  padding:1em;
                  border:2px solid #888888;
                  border-radius:3px;
                  display:block;
              }

	            img[src="images/collapsed.png"] { display:none;}

          }
    </style></head><body onLoad="init()"><h1 class="title" style="page-break-before:auto;">Functional Package for Transport Layer Security (TLS)</h1><noscript><h1 style="text-align:center; border-style: dashed; border-width: medium; border-color: red;">This page is best viewed with JavaScript enabled!</h1></noscript><div class="center"><img src="images/niaplogo.png" alt="NIAP Logo"><br>
      Version: 1.1<br>2019-03-01<br><b>National Information Assurance Partnership</b><br></div><h2 style="page-break-before:always;">Revision History</h2><table><tr class="header"><th>Version</th><th>Date</th><th>Comment</th></tr><tr><td>1.0</td><td>2018-12-17</td><td>First publication</td></tr><tr><td>1.1</td><td>2019-03-01</td><td>Clarifications regarding override for invalid certificates,
      renegotation_info extension, DTLS versions, and named Diffie-Hellman groups in DTLS
      contexts</td></tr></table><h2>Contents</h2><div class="toc" id="toc"><a href="#opt-app" style="text-indent:0px">Appendix A - <span>Optional Requirements</span></a><a href="#optional-reqs" style="text-indent:0px">Appendix B - <span>Strictly Optional  Requirements
    </span></a><a href="#objective-reqs" style="text-indent:0px">Appendix C - <span>Objective  Requirements
    </span></a><a href="#fcs-obj" style="text-indent:10px">C.1<span>Cryptographic Support (FCS)</span></a><a href="#feat-based-reqs" style="text-indent:0px">Appendix D - <span>Implementation-Based  Requirements
    </span></a><a href="#sel-based-reqs" style="text-indent:0px">Appendix E - <span>Selection-Based  Requirements
    </span></a><a href="#fcs-obj" style="text-indent:0px">Appendix F - <span>Cryptographic Support (FCS)</span></a><a href="#acronyms" style="text-indent:0px">Appendix G - <span>Acronyms</span></a><a href="#acronyms" style="text-indent:0px">Appendix H - <span>Acronyms</span></a><a href="#appendix-bibliography" style="text-indent:0px">Appendix I - <span>Bibliography</span></a></div><h1 id="opt-app" class="indexable" data-level="A">Appendix A -  Optional Requirements</h1>
    As indicated in the introduction to this Package, the baseline requirements (those that must be
	  performed by the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr>) are contained in the body of this Package<a id="period_0" href="#period_0">. </a>    This appendix contains three other types of optional requirements that may be included in the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr>, but are not required in order
	  to conform to this Package<a id="period_1" href="#period_1">. </a>    However, applied modules, packages and/or use cases may refine specific requirements as mandatory<a id="period_2" href="#period_2">. </a><br><br>

   The first type (<a href="#optional-reqs" class="dynref"> Appendix B -  Strictly Optional  Requirements
    </a>) are strictly optional requirements that are independent of the
	  <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> implementing any function<a id="period_3" href="#period_3">. </a>   If the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> fulfills any of these requirements or supports a certain functionality, the vendor is encouraged to include the SFRs
	  in the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr>, but are not required in order to conform to this Package<a id="period_4" href="#period_4">. </a><br><br>

  The second type (<a href="#objective-reqs" class="dynref"> Appendix C -  Objective  Requirements
    </a>) are objective requirements that describe security functionality not yet 
	  widely available in commercial technology<a id="period_5" href="#period_5">. </a>   The requirements are not currently mandated in the body of this Package, but will be included in
	  the baseline requirements in future versions of this Package<a id="period_6" href="#period_6">. </a>Adoption by vendors is
	  encouraged and expected as soon as possible<a id="period_7" href="#period_7">. </a><br><br>

  The third type (<a href="#feat-based-reqs" class="dynref"> Appendix D -  Implementation-Based  Requirements
    </a>) 
are dependent on the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> implementing a particular function<a id="period_8" href="#period_8">. </a>If the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> fulfills any of these requirements, the vendor must either add the related <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> or disable the functionality for the
	  evaluated configuration<a id="period_9" href="#period_9">. </a>
  <h2 id="optional-reqs" class="indexable" data-level="2">Appendix B -  Strictly Optional  Requirements
    </h2><p>This Package does not define any 
            Strictly Optional requirements<a id="period_10" href="#period_10">. </a></p><h2 id="objective-reqs" class="indexable" data-level="2">Appendix C -  Objective  Requirements
    </h2><h3 id="fcs-obj" class="indexable" data-level="3">C.1 Cryptographic Support (FCS)</h3><div class="comp" id=""><h4> TLS Client Support for Signature Algorithms Extension</h4>
          <div class="element"><div class="reqid" id=".1"><a href="#.1" class="abbr">.1</a></div><div class="reqdesc"> The product shall present the signature_algorithms extension in the Client Hello with
              the supported_signature_algorithms value containing the following hash algorithms: [<b>selection</b>: <i id="_s_27">SHA256</i>, <i id="_s_28">SHA384</i>, <i id="_s_29">SHA512</i>] and no other hash algorithms<a id="period_11" href="#period_11">. </a><div class="appnote"><span class="note-header">Application Note: </span><span class="note"> This requirement limits the hashing algorithms supported for
              the purpose of digital signature verification by the client and limits the server to
              the supported hashes for the purpose of digital signature generation by the server<a id="period_12" href="#period_12">. </a>              The signature_algorithms extension is only supported by TLS 1.2<a id="period_13" href="#period_13">. </a></span></div></div></div>  
        <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"></div>
              
              The evaluator shall verify that <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes the signature_algorithm extension and whether the
              required behavior is performed by default or may be configured<a id="period_14" href="#period_14">. </a>
              
              If the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> indicates that the
              signature_algorithm extension must be configured to meet the requirement, the
              evaluator shall verify that AGD guidance includes configuration of the
              signature_algorithm extension<a id="period_15" href="#period_15">. </a><br> 
              
              The evaluator shall also perform the following
              tests:
              <ul>
                <li><b>Test 1: </b>
                  The evaluator shall configure the server to send a
                  certificate in the TLS connection that is not
                  supported according to the Client's HashAlgorithm
                  enumeration within the signature_algorithms
                  extension (for example, send a certificate with a
                  SHA-1 signature)<a id="period_16" href="#period_16">. </a>The evaluator shall verify that
                  the product disconnects after receiving the server's
                  Certificate handshake message<a id="period_17" href="#period_17">. </a>                </li>
                <li><b>Test 2: </b>
                  [conditional] If the client supports a DHE or ECDHE
                  cipher suite, the evaluator shall configure the
                  server to send a Key Exchange handshake message
                  including a signature not supported according to the
                  client's HashAlgorithm enumeration (for example, the
                  server signed the Key Exchange parameters using a
                  SHA-1 signature)<a id="period_18" href="#period_18">. </a>The evaluator shall verify that
                  the product disconnects after receiving the server's
                  Key Exchange handshake message<a id="period_19" href="#period_19">. </a>                </li>
              </ul>
            <div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div><div class="eacategory">Guidance</div><div class="eacategory">Tests</div></div></div></div><div class="comp" id=""><h4> TLS Server Support for Signature Algorithms Extension</h4>
          <div class="element"><div class="reqid" id=".1"><a href="#.1" class="abbr">.1</a></div><div class="reqdesc">The product shall present the HashAlgorithm
            enumeration in supported_signature_algorithms in the
            Certificate Request with the following hash algorithms:
	    [<b>selection</b>: <i id="_s_84">SHA256</i>, <i id="_s_85">SHA384</i>, <i id="_s_86">SHA512</i>] and no other hash algorithms<a id="period_20" href="#period_20">. </a>            <div class="appnote"><span class="note-header">Application Note: </span><span class="note">
              This requirement limits the hashing algorithms supported
              for the purpose of digital signature verification by the
              server and limits the client to the supported hashes for
              the purpose of digital signature generation by the
              client<a id="period_21" href="#period_21">. </a>The supported_signature_algorithms is only
              supported by TLS 1.2<a id="period_22" href="#period_22">. </a>	    </span></div></div></div>
	<div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"></div>
        
	      The evaluator shall verify that <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes the
	      supported_signature_algorithms field of the Certificate
	      Request and whether the required behavior is performed
	      by default or may be configured<a id="period_23" href="#period_23">. </a>        
        If the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> indicates
	      that the supported_signature_algorithms field must be
	      configured to meet the requirement, the evaluator shall
	      verify that AGD guidance includes configuration of the
	      supported_signature_algorithms field<a id="period_24" href="#period_24">. </a>	      
	      The evaluator shall also perform the following test:
	      <br>
	      The evaluator shall configure the server to send the
	      signature_algorithms extension in the Certificate
	      Request message indicating that the hash algorithm used
	      by the client&#8217;s certificate is not supported<a id="period_25" href="#period_25">. </a> The
	      evaluator shall attempt a connection using that client
	      certificate and verify that the server denies the
	      client&#8217;s connection<a id="period_26" href="#period_26">. </a>	    <div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div><div class="eacategory">Guidance</div><div class="eacategory">Tests</div></div></div></div><h2 id="feat-based-reqs" class="indexable" data-level="2">Appendix D -  Implementation-Based  Requirements
    </h2><p>This Package does not define any 
            Implementation-Based requirements<a id="period_27" href="#period_27">. </a></p><h1 id="sel-based-reqs" class="indexable" data-level="A">Appendix E -  Selection-Based  Requirements
    </h1>
	<p>As indicated in the introduction to this Package,
        the baseline requirements
        (those that must be performed by the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> or its underlying platform)
        are contained in the body of this Package<a id="period_28" href="#period_28">. </a>        There are additional requirements based on selections in the body of 
        the Package:
        if certain selections are made, then additional requirements below must be included<a id="period_29" href="#period_29">. </a> 	</p>
		 <h2 id="fcs-obj" class="indexable" data-level="2">Appendix F -  Cryptographic Support (FCS)</h2><div class="comp" id=""><h4> TLS Client Protocol</h4><div class="statustag"><b><i>The inclusion of this selection-based component depends upon selection in
           <a id="period_30" href="#period_30">. </a>           </i></b></div>
          
          <div class="element"><div class="reqid" id=".1"><a href="#.1" class="abbr">.1</a></div><div class="reqdesc"> The product shall implement TLS 1.2 (RFC 5246) and
              [<b>selection</b>: <i id="_s_5">TLS 1.1 (RFC 4346)</i>, <i id="_s_6">no earlier TLS versions</i>] as a client that supports the cipher suites
          [<b>selection</b>: <ul><li style=""><i id="_s_7">TLS_RSA_WITH_AES_128_CBC_SHA as defined in RFC 5246</i>, </li><li style=""><i id="_s_8">TLS_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</i>, </li><li style=""><i id="_s_9">TLS_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</i>, </li><li style=""><i id="_s_10">TLS_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5288</i>, </li><li style=""><i id="_s_11">TLS_DHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</i>, </li><li style=""><i id="_s_12">TLS_DHE_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</i>, </li><li style=""><i id="_s_13">TLS_DHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5288</i>, </li><li style=""><i id="tecdhe1">TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</i>, </li><li style=""><i id="tecdhe2">TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</i>, </li><li style=""><i id="tecdhe3">TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384 as defined in RFC 5289</i>, </li><li style=""><i id="tecdhe4">TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5289</i>, </li><li style=""><i id="tecdhe5">TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</i>, </li><li style=""><i id="tecdhe6">TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</i>, </li><li style=""><i id="tecdhe7">TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 as defined in RFC 5289</i>, </li><li style=""><i id="tecdhe8">TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5289</i></li></ul>]
          and also supports functionality for 
          [<b>selection</b>: <ul><li style=""><i id="tlsc_mutual_auth">mutual authentication</i>, </li><li style=""><i id="tlsc_reneg">session renegotiation</i>, </li><li style=""><i id="_s_24">none</i></li></ul>]<a id="period_31" href="#period_31">. </a>          <div class="appnote"><span class="note-header">Application Note: </span><span class="note">
        The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr>
       author should select the cipher suites that are supported,
      and must select at least one cipher suite<a id="period_32" href="#period_32">. </a>	      The cipher suites to be tested in the evaluated
	      configuration are limited by this requirement<a id="period_33" href="#period_33">. </a>However,
	      this requirement does not restrict the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr>'s ability to
	      propose additional cipher suites beyond the ones listed
	      in this requirement in its Client Hello message<a id="period_34" href="#period_34">. </a> That
	      is, the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> may propose any cipher suite but the
	      evaluation will only test cipher suites from the above
	      list<a id="period_35" href="#period_35">. </a>	      It is necessary to limit the cipher suites that can be
	      used in an evaluated configuration administratively on
	      the server in the test environment<a id="period_36" href="#period_36">. </a>	      GCM cipher suites are preferred over CBC cipher suites,
	      ECDHE preferred over RSA and DHE, and SHA256 or SHA384
	      over SHA<a id="period_37" href="#period_37">. </a>        <br><br>
        TLS_RSA_WITH_AES_128_CBC_SHA is not required despite being mandated by RFC 5246<a id="period_38" href="#period_38">. </a>	      <br><br>
	      These requirements will be revisited as new TLS versions are
	      standardized by the IETF<a id="period_39" href="#period_39">. </a>	      <br><br>
        If any ECDHE or DHE cipher suites are selected, then
	       is required<a id="period_40" href="#period_40">. </a>        <br><br>
        If <i>mutual authentication</i> is selected, then the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> must additionally include 
        the requirements from <a id="period_41" href="#period_41">. </a>If the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> implements
        mutual authentication, this selection must be made<a id="period_42" href="#period_42">. </a>        <br><br>
        If <i>session renegotiation</i> is selected, then the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> must additionally include 
        the requirements from <a id="period_43" href="#period_43">. </a>If the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> implements
        session renegotiation, this selection must be made<a id="period_44" href="#period_44">. </a>	    </span></div></div></div>
          <div class="element"><div class="reqid" id=".2"><a href="#.2" class="abbr">.2</a></div><div class="reqdesc"> The product shall verify that the presented identifier matches the reference
              identifier according to RFC 6125<a id="period_45" href="#period_45">. </a><div class="appnote"><span class="note-header">Application Note: </span><span class="note"> The rules for verification of identity are described in
              Section 6 of RFC 6125<a id="period_46" href="#period_46">. </a>The reference identifier is established by the user (e.g<a id="period_47" href="#period_47">. </a>              entering a URL into a web browser or clicking a link), by configuration (e.g<a id="period_48" href="#period_48">. </a>              configuring the name of a mail server or authentication server), or by an application
              (e.g<a id="period_49" href="#period_49">. </a>a parameter of an API) depending on the product service<a id="period_50" href="#period_50">. </a>Based on a singular
              reference identifier&#8217;s source domain and application service type (e.g<a id="period_51" href="#period_51">. </a>HTTP, SIP,
              LDAP), the client establishes all reference identifiers which are acceptable, such as
              a Common Name for the Subject Name field of the certificate and a (case-insensitive)
              DNS name, URI name, and Service Name for the Subject Alternative Name field<a id="period_52" href="#period_52">. </a>The
              client then compares this list of all acceptable reference identifiers to the
              presented identifiers in the TLS
              server&#8217;s certificate<a id="period_53" href="#period_53">. </a>
              <br>
              The preferred method for verification is the Subject
              Alternative Name using DNS names, URI names, or Service Names<a id="period_54" href="#period_54">. </a>Verification using the
              Common Name for the purposes of backwards compatibility is optional<a id="period_55" href="#period_55">. </a>Additionally,
              support for use of IP addresses in the Subject Name or Subject Alternative name is
              discouraged, as against best practices, but may be implemented<a id="period_56" href="#period_56">. </a>Finally, the client
              should avoid constructing reference identifiers using wildcards<a id="period_57" href="#period_57">. </a>However, if the
              presented identifiers include wildcards, the client must follow the best practices
              regarding matching; these best practices are captured in the evaluation activity<a id="period_58" href="#period_58">. </a>            </span></div></div></div>
          <div class="element"><div class="reqid" id=".3"><a href="#.3" class="abbr">.3</a></div><div class="reqdesc">The product shall not establish a trusted channel if the
              server certificate is invalid
              [<b>selection</b>: <ul><li style=""><i id="_s_25">with no exceptions</i>, </li><li style=""><i id="_s_26">except when override is authorized</i></li></ul>]<a id="period_59" href="#period_59">. </a>            <div class="appnote"><span class="note-header">Application Note: </span><span class="note">Validity is determined by the identifier verification,
              certificate path, the expiration date, and the revocation status in accordance with
              RFC 5280<a id="period_60" href="#period_60">. </a>Certificate validity shall be tested in accordance with testing performed
              for  as defined in any <abbr class="dyn-abbr"><a href="#abbr_PP">PP</a></abbr> or <abbr class="dyn-abbr"><a href="#abbr_PP-Module">PP-Module</a></abbr> which
              instantiates this Package<a id="period_61" href="#period_61">. </a>              <br><br>
              The selection that permits override for invalid certificates should be interpreted
              as follows:
              <ul>
                <li>explicit administrator or user action is needed to authorize the override,
                on a per-certificate basis</li>
                <li>override may be sought or granted at any time, though this typically occurs when an
                invalid certificate is presented during connection setup</li>
                <li>override decisions may be stored and then consulted
                later, to permit connections using these otherwise-invalid certificates to
                establish trusted channels without user or administrator action</li>
              </ul>
              As indicated in , note that a <abbr class="dyn-abbr"><a href="#abbr_PP">PP</a></abbr> author may
              instantiate this <abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr> using only the first selection, preventing the ability to
              allow overrides<a id="period_62" href="#period_62">. </a>            </span></div></div></div>       
        <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"></div>
              
              The evaluator shall check the description of the implementation of this
              protocol in the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> to
              ensure that the cipher suites supported are specified<a id="period_63" href="#period_63">. </a>The evaluator shall check the
                <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> to ensure that the
              cipher suites specified include those listed for this component<a id="period_64" href="#period_64">. </a>
              
              The evaluator shall
              also check the operational guidance to ensure that it contains instructions on
              configuring the product so that
              TLS conforms to the description in the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr><a id="period_65" href="#period_65">. </a>
              
              The evaluator shall also perform the following tests:
              <ul>
                <li><b>Test 1: </b>
                  The evaluator shall establish a TLS connection
                  using each of the cipher suites specified by the
                  requirement<a id="period_66" href="#period_66">. </a>This connection may be established as part of the establishment of a
                  higher-level protocol, e.g., as part of an EAP session<a id="period_67" href="#period_67">. </a>It is sufficient to
                  observe the successful negotiation of a cipher suite to satisfy the intent of the
                  test; it is not necessary to examine the characteristics of the encrypted traffic
                  in an attempt to discern the cipher suite being used (for example, that the
                  cryptographic algorithm is 128-bit AES and not 256-bit AES)<a id="period_68" href="#period_68">. </a>                </li>
                <li><b>Test 2: </b>
                  The goal of the following test is to verify that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> accepts only certificates
                  with appropriate values in the extendedKeyUsage extension, and implicitly that the
                  <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> correctly parses the extendedKeyUsage extension as part of X.509v3 server
                  certificate validation<a id="period_69" href="#period_69">. </a>                  <br><br>
                  The evaluator shall attempt to establish the connection using a server with a
                  server certificate that contains the Server Authentication purpose in the
                  extendedKeyUsage extension and verify that a connection is established<a id="period_70" href="#period_70">. </a>The
                  evaluator shall repeat this test using a different, but otherwise valid and
                  trusted, certificate that lacks the Server Authentication purpose in the
                  extendedKeyUsage extension and ensure that a connection is not established<a id="period_71" href="#period_71">. </a>                  Ideally, the two certificates should be similar in structure, the types of
                  identifiers used, and the chain of trust<a id="period_72" href="#period_72">. </a>                </li>
                <li><b>Test 3: </b>
                  The evaluator shall send a server certificate in the TLS connection
                  that does not match the server-selected cipher suite (for example, send a ECDSA certificate while using the
                  TLS_RSA_WITH_AES_128_CBC_SHA cipher suite or send a RSA certificate while using one
                  of the ECDSA cipher suites.) The evaluator shall verify that the product disconnects after
                  receiving the server&#8217;s Certificate handshake message<a id="period_73" href="#period_73">. </a>                </li>
                <li><b>Test 4: </b>
                  The evaluator shall configure the server to select the
                  TLS_NULL_WITH_NULL_NULL cipher suite and verify that the client denies the
                  connection<a id="period_74" href="#period_74">. </a>                </li>
                <li><b>Test 5: </b>
                  The evaluator shall perform the following modifications to the traffic:
                  <ul>
                    <li><b>Test 5.1: </b>
                      Change the TLS version
                      selected by the server in the Server Hello to an undefined TLS version (for example 1.5
                      represented by the two bytes 03 06) and verify that the client rejects the
                      connection<a id="period_75" href="#period_75">. </a>                    </li>
                    <li><b>Test 5.2: </b>
                      Change the TLS version
                      selected by the server in the Server Hello to the most recent unsupported TLS version (for example 1.1
                      represented by the two bytes 03 02) and verify that the client rejects the
                      connection<a id="period_76" href="#period_76">. </a>                    </li>
                    <li><b>Test 5.3: </b>
                      [conditional] If DHE or ECDHE cipher suites are supported, modify at least one byte in the
                      server&#8217;s nonce in the Server Hello handshake message, and verify that the client does not complete
                      the handshake and no application data flows<a id="period_77" href="#period_77">. </a>                    </li>
                    <li><b>Test 5.4: </b>
                      Modify the server&#8217;s selected cipher suite in the Server Hello handshake
                      message to be a cipher suite not presented in the Client Hello handshake
                      message<a id="period_78" href="#period_78">. </a>The evaluator shall verify that the client does not complete the handshake
                      and no application data flows<a id="period_79" href="#period_79">. </a>                    </li>
                    <li><b>Test 5.5: </b>
                      [conditional] If DHE or ECDHE cipher suites are supported, modify the signature block in the
                      server&#8217;s Key Exchange handshake message, and verify that the client does not complete the handshake
                      and no application data flows<a id="period_80" href="#period_80">. </a>This test does not apply to cipher suites using RSA key exchange<a id="period_81" href="#period_81">. </a>                      If a <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> only supports RSA key exchange in conjunction with TLS, then this test shall be omitted<a id="period_82" href="#period_82">. </a>                    </li>
                    <li><b>Test 5.6: </b>
                      Modify a byte in the Server Finished handshake message, and verify that the
                      client does not complete the handshake and no application data flows<a id="period_83" href="#period_83">. </a>                    </li>
                    <li><b>Test 5.7: </b>
                      Send a message consisting of random bytes from the server after the server has issued the
                      Change Cipher Spec message and verify that the client does not complete the handshake
                      and no application data flows<a id="period_84" href="#period_84">. </a>The message must still have a valid 5-byte record
                      header in order to ensure the message will be parsed as TLS<a id="period_85" href="#period_85">. </a>                    </li>
                  </ul>
                </li>
              </ul>
            
              
              The evaluator shall ensure that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes the client&#8217;s method of establishing all reference
              identifiers from the application-configured reference identifier, including which
              types of reference identifiers are supported (e.g<a id="period_86" href="#period_86">. </a>Common Name, DNS Name, URI Name,
              Service Name, or other application-specific Subject Alternative Names) and whether IP
              addresses and wildcards are supported<a id="period_87" href="#period_87">. </a>The evaluator shall ensure that this
              description identifies whether and the manner in which certificate pinning is
              supported or used by the product<a id="period_88" href="#period_88">. </a>              <br> 
              
              The evaluator shall verify that the AGD guidance includes instructions for
              setting the reference identifier to be used for the purposes of certificate validation
              in TLS<a id="period_89" href="#period_89">. </a><br>
              
              The evaluator shall
              configure the reference identifier according to the AGD guidance and perform the
              following tests during a TLS connection:
              <ul>
                <li><b>Test 1: </b> 
                  The evaluator shall present a server certificate that contains
                  a CN that does not match the reference identifier and does not
                  contain the SAN extension<a id="period_90" href="#period_90">. </a>The evaluator shall verify that the
                  connection fails<a id="period_91" href="#period_91">. </a>
                  <p></p>Note that some systems might require the presence of the SAN extension<a id="period_92" href="#period_92">. </a>                  In this case the connection would still fail but for the
                  reason of the missing SAN extension instead of the mismatch of
                  CN and reference identifier<a id="period_93" href="#period_93">. </a>Both reasons are acceptable to
                  pass Test 1<a id="period_94" href="#period_94">. </a>                </li>
                <li><b>Test 2: </b>
                  The evaluator shall present a server certificate that contains a CN that
                  matches the reference identifier, contains the SAN extension, but does not contain
                  an identifier in the SAN that matches the reference identifier<a id="period_95" href="#period_95">. </a>The evaluator
                  shall verify that the connection fails<a id="period_96" href="#period_96">. </a>The evaluator shall repeat this test for
                  each supported SAN type<a id="period_97" href="#period_97">. </a>                </li>
                <li><b>Test 3: </b>
                  [conditional] If the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> does not mandate the presence of the SAN extension,
                  the evaluator shall present a server certificate that contains
                  a CN that matches the reference identifier and does not
                  contain the SAN extension<a id="period_98" href="#period_98">. </a>The evaluator shall verify that the
                  connection succeeds<a id="period_99" href="#period_99">. </a>If the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> does mandate the presence of
                  the SAN extension, this Test shall be omitted<a id="period_100" href="#period_100">. </a> 
                </li>
                <li><b>Test 4: </b>
                  The evaluator shall present a server certificate that contains a CN that does
                  not match the reference identifier but does contain an identifier in the SAN that
                  matches<a id="period_101" href="#period_101">. </a>The evaluator shall verify that the connection succeeds<a id="period_102" href="#period_102">. </a>                </li>
                <li><b>Test 5: </b>
                  The evaluator shall perform the following wildcard tests with each supported type of reference
                  identifier<a id="period_103" href="#period_103">. </a>The support for wildcards is intended to be optional<a id="period_104" href="#period_104">. </a>If wildcards are supported, the
                  first, second, and third tests below shall be executed<a id="period_105" href="#period_105">. </a>If wildcards are not supported, then the
                  fourth test below shall be executed<a id="period_106" href="#period_106">. </a>                  <ul>
                    <li><b>Test 5.1: </b>
                      [conditional]: If wildcards are supported, the evaluator shall present a server certificate
                      containing a wildcard that is not in the left-most label of the presented identifier (e.g<a id="period_107" href="#period_107">. </a>                      foo.*.example.com) and verify that the connection fails<a id="period_108" href="#period_108">. </a>                    </li>
                    <li><b>Test 5.2: </b>
                      [conditional]: If wildcards are supported, the evaluator shall present a server certificate
                      containing a wildcard in the left-most label but not preceding the public
                      suffix (e.g<a id="period_109" href="#period_109">. </a>*.example.com)<a id="period_110" href="#period_110">. </a>The evaluator shall configure
                      the reference identifier with a single left-most label (e.g<a id="period_111" href="#period_111">. </a>foo.example.com) and verify that the
                      connection succeeds<a id="period_112" href="#period_112">. </a>The evaluator shall configure the reference identifier without a left-most
                      label as in the certificate (e.g<a id="period_113" href="#period_113">. </a>example.com) and verify that the connection fails<a id="period_114" href="#period_114">. </a>The evaluator
                      shall configure the reference identifier with two left-most labels (e.g<a id="period_115" href="#period_115">. </a>bar.foo.example.come) and
                      verify that the connection fails<a id="period_116" href="#period_116">. </a>                    </li>
                    <li><b>Test 5.3: </b>
                      [conditional]: If wildcards are supported, the evaluator shall present a server certificate
                      containing a wildcard in the left-most label immediately preceding the public suffix (e.g<a id="period_117" href="#period_117">. </a>*.com)<a id="period_118" href="#period_118">. </a>                      The evaluator shall configure the reference identifier with a single left-most label (e.g<a id="period_119" href="#period_119">. </a>                      foo.com) and verify that the connection fails<a id="period_120" href="#period_120">. </a>The evaluator shall configure the reference
                      identifier with two left-most labels (e.g<a id="period_121" href="#period_121">. </a>bar.foo.com) and verify that the connection fails<a id="period_122" href="#period_122">. </a>                    </li>
                    <li><b>Test 5.4: </b>
                      [conditional]: If wildcards are not supported, the evaluator shall present a server certificate
                      containing a wildcard in the left-most label (e.g<a id="period_123" href="#period_123">. </a>*.example.com)<a id="period_124" href="#period_124">. </a>The evaluator shall configure
                      the reference identifier with a single left-most label (e.g<a id="period_125" href="#period_125">. </a>foo.example.com) and verify that the
                      connection fails<a id="period_126" href="#period_126">. </a>                    </li>
                  </ul>
                </li>
                <li><b>Test 6: </b>
                  [conditional] If URI or Service name reference identifiers are supported, the
                  evaluator shall configure the DNS name and
                  the service identifier<a id="period_127" href="#period_127">. </a>The evaluator shall present a server certificate
                  containing the correct DNS name and
                  service identifier in the URIName or SRVName fields of the SAN and verify that the
                  connection succeeds<a id="period_128" href="#period_128">. </a>The evaluator shall repeat this test with the wrong service
                  identifier (but correct DNS name) and
                  verify that the connection fails<a id="period_129" href="#period_129">. </a>                </li>
                <li><b>Test 7: </b>
                  [conditional] If pinned certificates are supported the evaluator shall
                  present a certificate that does not match the pinned certificate and verify that
                  the connection fails<a id="period_130" href="#period_130">. </a>                </li>
              </ul>
            
              
              If the selection for authorizing override of invalid certificates is made, then
              the evaluator shall ensure that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> includes a description of how and when user or administrator
                authorization is obtained<a id="period_131" href="#period_131">. </a> The evaluator shall also ensure that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes
                any mechanism for storing such authorizations, such that future presentation
                of such otherwise-invalid certificates permits establishment of a trusted channel
                without user or administrator action<a id="period_132" href="#period_132">. </a>              
              The evaluator shall demonstrate that using an invalid certificate (unless excepted)
              results in the function failing as follows, unless excepted:
              <ul>
                <li><b>Test 1: </b>The evaluator shall demonstrate that a server using a certificate without a
                  valid certification path results in an authentication failure<a id="period_133" href="#period_133">. </a>Using the
                  administrative guidance, the evaluator shall then load the trusted CA
                  certificate(s) needed to validate the server's certificate, and demonstrate that the
                  connection succeeds<a id="period_134" href="#period_134">. </a>The evaluator then shall delete one of the CA certificates,
                  and show that the connection fails<a id="period_135" href="#period_135">. </a></li>
                <li><b>Test 2: </b> The evaluator shall demonstrate that a server using a certificate which has
                  been revoked results in an authentication failure<a id="period_136" href="#period_136">. </a></li>
                <li><b>Test 3: </b> The evaluator shall demonstrate that a server using a certificate which has
                  passed its expiration date results in an authentication failure<a id="period_137" href="#period_137">. </a></li>
                <li><b>Test 4: </b> The evaluator shall demonstrate that a server using a certificate which does
                  not have a valid identifier results in an authentication failure<a id="period_138" href="#period_138">. </a></li>
              </ul>
              
            <div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div><div class="eacategory">Guidance</div><div class="eacategory">Tests</div></div></div></div><div class="comp" id=""><h4> TLS Client Support for Mutual Authentication</h4><div class="statustag"><b><i>The inclusion of this selection-based component depends upon selection in
           <a id="period_139" href="#period_139">. </a>           </i></b></div>
          
          <div class="element"><div class="reqid" id=".1"><a href="#.1" class="abbr">.1</a></div><div class="reqdesc">The product shall support mutual authentication using X.509v3 certificates<a id="period_140" href="#period_140">. </a><div class="appnote"><span class="note-header">Application Note: </span><span class="note"> The use of X.509v3 certificates for TLS is addressed in <a id="period_141" href="#period_141">. </a>This requirement adds that a client must be capable of
              presenting a certificate to a TLS server
              for TLS mutual authentication<a id="period_142" href="#period_142">. </a>              Presenting a certificate is not mandatory in all circumstances: it may depend on the
              configuration of the client or other factors<a id="period_143" href="#period_143">. </a>            </span></div></div></div>
        <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"></div>
              
                The evaluator shall ensure that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> description required per  includes the use of client-side certificates for TLS
              mutual authentication<a id="period_144" href="#period_144">. </a> The evaluator shall also ensure that the 
              <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes
              any factors beyond configuration that are necessary in order for the client to engage in mutual
              authentication using X.509v3 certificates<a id="period_145" href="#period_145">. </a>              <br>
              
              The evaluator shall ensure that the AGD guidance includes any instructions necessary
              to configure the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> to perform mutual authentication<a id="period_146" href="#period_146">. </a>              The evaluator also shall verify that the AGD guidance required
              per  includes instructions for configuring the
              client-side certificates for TLS mutual
              authentication<a id="period_147" href="#period_147">. </a><br>
              
              The evaluator shall also perform the following tests:
              
	      <ul>
          <li><b>Test 1: </b>The evaluator shall establish a connection to a server that is not
configured for mutual authentication (i.e<a id="period_148" href="#period_148">. </a>does not send Server&#8217;s Certificate
Request (type 13) message)<a id="period_149" href="#period_149">. </a>The evaluator observes negotiation of a TLS channel
and confirms that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> did not send Client&#8217;s Certificate message (type 11)
during handshake<a id="period_150" href="#period_150">. </a>
		</li>
		<li><b>Test 2: </b>The evaluator shall establish a connection to a server with a
		shared trusted root that is configured for mutual authentication (i.e<a id="period_151" href="#period_151">. </a>it
		sends Server&#8217;s Certificate Request (type 13) message)<a id="period_152" href="#period_152">. </a>The evaluator
		observes negotiation of a TLS channel and confirms that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> responds
		with a non-empty Client&#8217;s Certificate message (type 11) and Certificate
		Verify (type 15) message<a id="period_153" href="#period_153">. </a>		</li>
	      </ul>
            <div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div><div class="eacategory">Guidance</div><div class="eacategory">Tests</div></div></div></div><div class="comp" id=""><h4> TLS Client Support for Renegotiation</h4><div class="statustag"><b><i>The inclusion of this selection-based component depends upon selection in
           <a id="period_154" href="#period_154">. </a>           </i></b></div>
          
          <div class="element"><div class="reqid" id=".1"><a href="#.1" class="abbr">.1</a></div><div class="reqdesc"> The product shall support secure renegotiation through use
              of the &#8220;renegotiation_info&#8221; TLS extension in accordance with RFC 5746<a id="period_155" href="#period_155">. </a><div class="appnote"><span class="note-header">Application Note: </span><span class="note">
            RFC 5746 defines an extension to TLS that binds
            renegotiation handshakes to the cryptography in the original handshake<a id="period_156" href="#period_156">. </a>            <br><br>
            Per RFC 5746, the client may present either the
            "renegotiation_info" extension or the signaling cipher suite value
            TLS_EMPTY_RENEGOTIATION_INFO_SCSV in the initial ClientHello message to indicate
            support for renegotiation<a id="period_157" href="#period_157">. </a>(A signaling cipher suite value (SCSV) is presented 
            as a cipher suite, but its only purpose is to provide other information and not
            to advertise support for a cipher suite.)  The
            TLS_EMPTY_RENEGOTIATION_INFO_SCSV signaling cipher suite value exists as an alternative
            to presenting the "renegotation_info" extension so that
            TLS server implementations that immediately terminate the connection when they encounter
            any extension they do not understand can still proceed with a connection<a id="period_158" href="#period_158">. </a> The client may still choose to
            reject the connection later, if it insists upon renegotiation support and the server does not
            support it<a id="period_159" href="#period_159">. </a>In any case, RFC 5746 states that during any renegotiation the "renegotiation_info" extension
            must be presented by the peer initiating renegotiation, and so the client
            must support use of this extension<a id="period_160" href="#period_160">. </a>            </span></div></div></div>
        <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"></div>
              
              The evaluator shall perform the following tests:
              <ul>
                <li><b>Test 1: </b>The evaluator shall use a network packet analyzer/sniffer to capture the traffic between the two
                  TLS endpoints<a id="period_161" href="#period_161">. </a> The evaluator shall verify that either the &#8220;renegotiation_info&#8221; field or the SCSV
                  cipher suite is included in the ClientHello message during the initial handshake<a id="period_162" href="#period_162">. </a></li>
                <li><b>Test 2: </b>The evaluator shall verify the Client&#8217;s handling of ServerHello messages received during
                  the initial handshake that include the &#8220;renegotiation_info&#8221; extension<a id="period_163" href="#period_163">. </a> The evaluator shall modify
                  the length portion of this field in the ServerHello message to be non-zero and verify that the client
                  sends a failure and terminates the connection<a id="period_164" href="#period_164">. </a> The evaluator shall verify that a properly formatted
                  field results in a successful TLS connection<a id="period_165" href="#period_165">. </a></li>
                <li><b>Test 3: </b>The evaluator shall verify that ServerHello messages received during secure renegotiation contain
                  the &#8220;renegotiation_info&#8221; extension<a id="period_166" href="#period_166">. </a> The evaluator shall modify either the &#8220;client_verify_data&#8221; or
                  &#8220;server_verify_data&#8221; value and verify that the client terminates the connection<a id="period_167" href="#period_167">. </a></li>
              </ul>
            <div class="eacategory">Tests</div></div></div></div><div class="comp" id=""><h4> TLS Client Support for Supported Groups Extension</h4><div class="statustag"><b><i>The inclusion of this selection-based component depends upon selection in
           <a id="period_168" href="#period_168">. </a>           </i></b></div>
          
          
          <div class="element"><div class="reqid" id=".1"><a href="#.1" class="abbr">.1</a></div><div class="reqdesc"> The product shall present the Supported Groups Extension in the Client Hello
              with the supported groups [<b>selection</b>: <ul><li style=""><i id="_s_30">secp256r1</i>, </li><li style=""><i id="_s_31">secp384r1</i>, </li><li style=""><i id="_s_32">secp521r1</i>, </li><li style=""><i id="_s_33">ffdhe2048(256)</i>, </li><li style=""><i id="_s_34">ffdhe3072(257)</i>, </li><li style=""><i id="_s_35">ffdhe4096(258)</i>, </li><li style=""><i id="_s_36">ffdhe6144(259)</i>, </li><li style=""><i id="_s_37">ffdhe8192(260)</i></li></ul>]<a id="period_169" href="#period_169">. </a>            <div class="appnote"><span class="note-header">Application Note: </span><span class="note">
              If an elliptic curve or Diffie-Hellman ciphersuite is selected in 
              or ,
              then  shall be included in the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr><a id="period_170" href="#period_170">. </a>This requirement does not limit the
              elliptic curves the client may propose for authentication and key agreement<a id="period_171" href="#period_171">. </a>              The Supported Groups Extension was previously referred to as the
              Supported Elliptic Curves Extension and is described in RFC 7919<a id="period_172" href="#period_172">. </a></span></div></div></div>  
        <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"></div>
              
              The evaluator shall verify that <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes the Supported Groups Extension<a id="period_173" href="#period_173">. </a>              
              The evaluator shall also perform the following test:
              <br>
              <ul>
              <li><b>Test 1: </b>
              The evaluator shall configure a server to perform key exchange using each of the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr>&#8217;s supported
              curves and/or groups<a id="period_174" href="#period_174">. </a>The evaluator shall verify that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> successfully connects to the server<a id="period_175" href="#period_175">. </a>              </li>
              </ul>
            <div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div><div class="eacategory">Tests</div></div></div></div><div class="comp" id=""><h4> TLS Server Protocol</h4><div class="statustag"><b><i>The inclusion of this selection-based component depends upon selection in
           <a id="period_176" href="#period_176">. </a>           </i></b></div>
          
          <div class="element"><div class="reqid" id=".1"><a href="#.1" class="abbr">.1</a></div><div class="reqdesc"> The product shall implement TLS 1.2 (RFC 5246) and
            [<b>selection</b>: <i id="_s_38">TLS 1.1 (RFC 4346)</i>, <i id="_s_39">no earlier TLS versions</i>]
              as a server that supports the cipher suites
              [<b>selection</b>: <ul><li style=""><i id="_s_40">TLS_RSA_WITH_AES_128_CBC_SHA as defined in RFC 5246</i>, </li><li style=""><i id="_s_41">TLS_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</i>, </li><li style=""><i id="_s_42">TLS_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</i>, </li><li style=""><i id="_s_43">TLS_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5288</i>, </li><li style=""><i id="_s_44">TLS_DHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</i>, </li><li style=""><i id="_s_45">TLS_DHE_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</i>, </li><li style=""><i id="_s_46">TLS_DHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5288</i>, </li><li style=""><i id="_s_47">TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</i>, </li><li style=""><i id="_s_48">TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</i>, </li><li style=""><i id="_s_49">TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384 as defined in RFC 5289</i>, </li><li style=""><i id="_s_50">TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5289</i>, </li><li style=""><i id="_s_51">TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</i>, </li><li style=""><i id="_s_52">TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</i>, </li><li style=""><i id="_s_53">TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 as defined in RFC 5289</i>, </li><li style=""><i id="_s_54">TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5289</i></li></ul>] and no other cipher suites,
              and also supports functionality for
              [<b>selection</b>: <ul><li style=""><i id="tlss_mutual_auth">mutual authentication</i>, </li><li style=""><i id="tlss_reneg">session renegotiation</i>, </li><li style=""><i id="_s_57">none</i></li></ul>]<a id="period_177" href="#period_177">. </a>            <div class="appnote"><span class="note-header">Application Note: </span><span class="note">

        The <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr>
        author should select the cipher suites that are supported,
       and must select at least one cipher suite<a id="period_178" href="#period_178">. </a>              It is necessary to limit the cipher suites that can be
              used in an evaluated configuration administratively on
              the server in the test environment<a id="period_179" href="#period_179">. </a> If administrative
              steps need to be taken so that the cipher suites
              negotiated by the implementation are limited to those in
              this requirement, then the appropriate instructions need
              to be contained in the guidance<a id="period_180" href="#period_180">. </a>	      GCM cipher suites are preferred over CBC cipher suites,
	      ECDHE preferred over RSA and DHE, and SHA256 or SHA384
	      over SHA<a id="period_181" href="#period_181">. </a>        <br><br>
        TLS_RSA_WITH_AES_128_CBC_SHA is not required 
	      despite being mandated by RFC 5246<a id="period_182" href="#period_182">. </a>
        <br><br>
        These requirements will be revisited as new
	      TLS
	      versions are standardized by the IETF<a id="period_183" href="#period_183">. </a>        <br><br>
        If <i>mutual authentication</i> is selected, then the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> must additionally include
        the requirements from <a id="period_184" href="#period_184">. </a> If the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> implements
        mutual authentication, this selection must be made<a id="period_185" href="#period_185">. </a>        <br><br>
        If <i>session renegotiation</i> is selected, then the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> must additionally include
        the requirements from <a id="period_186" href="#period_186">. </a>If the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> implements
        session renegotiation, this selection must be made<a id="period_187" href="#period_187">. </a>            </span></div></div></div>
          <div class="element"><div class="reqid" id=".2"><a href="#.2" class="abbr">.2</a></div><div class="reqdesc">The product shall deny connections from clients requesting
            SSL 2.0, SSL 3.0, TLS 1.0 and
              [<b>selection</b>: <i id="_s_58">TLS 1.1</i>, <i id="_s_59">none</i>]<a id="period_188" href="#period_188">. </a>            <div class="appnote"><span class="note-header">Application Note: </span><span class="note">All SSL versions are denied<a id="period_189" href="#period_189">. </a>Any TLS version
              not selected in  should be selected here<a id="period_190" href="#period_190">. </a>            </span></div></div></div>
          <div class="element"><div class="reqid" id=".3"><a href="#.3" class="abbr">.3</a></div><div class="reqdesc">The product shall perform key establishment for TLS using
              [<b>selection</b>: <ul><li style=""><i id="_s_60">RSA with size
                  [<b>selection</b>: <i id="_s_61">2048 bits</i>, <i id="_s_62">3072 bits</i>, <i id="_s_63">4096 bits</i>, <i id="_s_64">no other sizes</i>]
                </i>, </li><li style=""><i id="_s_65">Diffie-Hellman parameters with size
                  [<b>selection</b>: <i id="_s_66">2048 bits</i>, <i id="_s_67">3072 bits</i>, <i id="_s_68">4096 bits</i>, <i id="_s_69">6144 bits</i>, <i id="_s_70">8192 bits</i>, <i id="_s_71">no other sizes</i>]
                </i>, </li><li style=""><i id="_s_72">Diffie-Hellman groups
                  [<b>selection</b>: <i id="_s_73">ffdhe2048</i>, <i id="_s_74">ffdhe3072</i>, <i id="_s_75">ffdhe4096</i>, <i id="_s_76">ffdhe6144</i>, <i id="_s_77">ffdhe8192</i>, <i id="_s_78">no other groups</i>]
              </i>, </li><li style=""><i id="_s_79">ECDHE parameters using elliptic curves
                [<b>selection</b>: <i id="_s_80">secp256r1</i>, <i id="_s_81">secp384r1</i>, <i id="_s_82">secp521r1</i>] and no other curves
              </i>, </li><li style=""><i id="_s_83">no other key establishment methods</i></li></ul>]<a id="period_191" href="#period_191">. </a>            <div class="appnote"><span class="note-header">Application Note: </span><span class="note">
              If the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> lists an RSA cipher suite in , the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> must include the
              RSA selection in the requirement<a id="period_192" href="#period_192">. </a>              <br><br>
              If the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> lists a DHE cipher suite in , the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> must include either
              the Diffie-Hellman selection for parameters of a certain size,
              or for particular Diffie-Hellman groups<a id="period_193" href="#period_193">. </a>              The selection for "Diffie-Hellman parameters" refers to the method defined by RFC 5246 (and RFC 4346)
              Section 7.4.3 where the server provides Diffie-Hellman parameters to the client<a id="period_194" href="#period_194">. </a>The Supported Groups
              extension defined in RFC 7919 identifies particular Diffie-Hellman groups, which are listed in the
              following selection<a id="period_195" href="#period_195">. </a>Regarding this distinction, it is acceptable to use Diffie-Hellman group 14 with
              TLS (there is currently no ability to negotiate group 14 using the Supported Groups extension, but it
              could be used with the "Diffie-Hellman parameters" selection)<a id="period_196" href="#period_196">. </a> As in RFC 7919, the terms "DHE" and
              "FFDHE" are both used to refer to the finite-field-based Diffie-Hellman ephemeral key exchange mechanism,
              distinct from elliptic-curve-based Diffie Hellman ephemeral key exchange (ECDHE)<a id="period_197" href="#period_197">. </a>              <br><br>
              If the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> lists an ECDHE cipher suite in , the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> must include the
              selection for ECDHE using elliptic curves in the requirement<a id="period_198" href="#period_198">. </a>            </span></div></div></div>
        <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"></div>
              
              The evaluator shall check the description of the implementation of this protocol in
              the <abbr title="TOE Summary Specification" linkend="TSS">TSS</abbr> to ensure that
              the cipher suites supported are specified<a id="period_199" href="#period_199">. </a>The evaluator shall check the
              <abbr title="TOE Summary Specification" linkend="TSS">TSS</abbr> to ensure that the
              cipher suites specified include those listed for this component<a id="period_200" href="#period_200">. </a>
              
              The evaluator shall
              also check the operational guidance to ensure that it contains instructions on
              configuring the <abbr title="Target of Evaluation" linkend="TOE">TOE</abbr> so that
              TLS conforms to the description in the
              <abbr title="TOE Summary Specification" linkend="TSS">TSS</abbr><a id="period_201" href="#period_201">. </a>              
              The evaluator shall
              also perform the following tests:
              <ul>
                <li><b>Test 1: </b>
                  The evaluator shall establish a
                  <abbr title="Transport Layer Security">TLS</abbr> connection using each of the
                  cipher suites specified by the requirement<a id="period_202" href="#period_202">. </a>This connection may be established as
                  part of the establishment of a higher-level protocol, e.g., as part of an EAP
                  session<a id="period_203" href="#period_203">. </a>It is sufficient to observe the successful negotiation of a cipher suite
                  to satisfy the intent of the test; it is not necessary to examine the
                  characteristics of the encrypted traffic in an attempt to discern the cipher suite
                  being used (for example, that the cryptographic algorithm is 128-bit AES and not
                  256-bit AES)<a id="period_204" href="#period_204">. </a>                </li>
                <li><b>Test 2: </b>
                  The evaluator shall send a Client Hello to the server with a list of
                  cipher suites that does not contain any of the cipher suites in the server&#8217;s <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr>
                  and verify that the server denies the connection<a id="period_205" href="#period_205">. </a>Additionally, the evaluator
                  shall send a Client Hello to the server containing only the
                  TLS_NULL_WITH_NULL_NULL cipher suite and verify that the server
                  denies the connection<a id="period_206" href="#period_206">. </a>                </li>
                <li><b>Test 3: </b>
		  If RSA key exchange is used in one of the selected ciphersuites, the evaluator shall use a client to send a properly
		  constructed Key Exchange message with a modified
		  EncryptedPreMasterSecret field during the TLS
		  handshake<a id="period_207" href="#period_207">. </a>The evaluator shall verify that the
		  handshake is not completed successfully and no
		  application data flows<a id="period_208" href="#period_208">. </a>                </li>
                <li><b>Test 4: </b>
                  The evaluator shall perform the following modifications to the traffic:
                  <ul>
                    <li><b>Test 4.1: </b>
                      Change the <abbr title="Transport Layer Security">TLS</abbr> version proposed
                      by the client in the Client Hello to a non-supported
                      <abbr title="Transport Layer Security">TLS</abbr> version (for example 1.3
                      represented by the two bytes 03 04) and verify that the server rejects the
                      connection<a id="period_209" href="#period_209">. </a>                    </li>
                    <li><b>Test 4.2: </b>
                      Modify a byte in the data of the client's Finished handshake message, and verify that the
                      server rejects the connection and does not send any application data<a id="period_210" href="#period_210">. </a>                    </li>
                    <li><b>Test 4.3: </b>
		      Demonstrate that the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> will not resume a
		      session for which the client failed to complete
		      the handshake (independent of <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> support for
		      session resumption): Generate a Fatal Alert by
		      sending a Finished message from the client
		      before the client sends a ChangeCipherSpec
		      message, and then send a Client Hello with the
		      session identifier from the previous incomplete
		      session, and verify that the server does not
		      resume the session<a id="period_211" href="#period_211">. </a>                    </li>
                    <li><b>Test 4.4: </b>
                      Send a message consisting of random bytes from
                      the client after the client has issued the
                      ChangeCipherSpec message and verify that the
                      server denies the connection<a id="period_212" href="#period_212">. </a>                    </li>
                  </ul>
                </li>
              </ul>
            
              
              The evaluator shall verify that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> contains a
              description of the denial of old SSL and TLS versions
              consistent relative to selections in <a id="period_213" href="#period_213">. </a>              
              The evaluator shall verify that the AGD guidance includes any configuration
              necessary to meet this requirement<a id="period_214" href="#period_214">. </a>              
              <ul>
                <li><b>Test 1: </b>
                  The evaluator shall send a Client Hello requesting a
                  connection with version SSL 2.0 and verify that the
                  server denies the connection<a id="period_215" href="#period_215">. </a>The evaluator shall
                  repeat this test with SSL 3.0 and TLS 1.0,
                  and TLS 1.1 if it is selected<a id="period_216" href="#period_216">. </a>                </li>
              </ul>
            
              
              The evaluator shall verify that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes the key agreement parameters
              of the server's Key Exchange message<a id="period_217" href="#period_217">. </a>              
              The evaluator shall verify that any configuration guidance necessary to meet
              the requirement must be contained in the AGD guidance<a id="period_218" href="#period_218">. </a>              
              <ul>
                The evaluator shall conduct the following tests<a id="period_219" href="#period_219">. </a> The testing can be carried out
                manually with a packet analyzer or with an automated framework
                that similarly captures such empirical evidence<a id="period_220" href="#period_220">. </a> Note that this testing can be accomplished in
                conjunction with other testing activities<a id="period_221" href="#period_221">. </a> For each of the following tests, determining that
                the size matches the expected size is sufficient<a id="period_222" href="#period_222">. </a>                <li><b>Test 1: </b>
                  [conditional] If RSA-based key establishment is selected, the evaluator shall configure the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> with a
                  certificate containing a supported RSA size and attempt a connection<a id="period_223" href="#period_223">. </a>The evaluator shall verify that
                  the size used matches that which is configured and that the connection is successfully established<a id="period_224" href="#period_224">. </a>                  The evaluator shall repeat this test for each supported size of RSA-based key establishment<a id="period_225" href="#period_225">. </a>
                </li>
                <li><b>Test 2: </b>
                  [conditional] If finite-field (i.e<a id="period_226" href="#period_226">. </a>non-EC) Diffie-Hellman ciphers are selected, the evaluator shall attempt a
                  connection using a Diffie-Hellman key exchange with a supported
                  parameter size or supported group<a id="period_227" href="#period_227">. </a>The evaluator shall verify that the key agreement parameters in the Key
                  Exchange message are the ones configured<a id="period_228" href="#period_228">. </a>The evaluator shall repeat this test for each supported
                  parameter size or group<a id="period_229" href="#period_229">. </a>                </li>
                <li><b>Test 3: </b>
                  [conditional] If ECDHE ciphers are selected, the evaluator shall attempt a connection
                  using an ECDHE ciphersuite with a
                  supported curve<a id="period_230" href="#period_230">. </a>The evaluator shall verify that the key agreement parameters in the Key
                  Exchange message are the ones configured<a id="period_231" href="#period_231">. </a>The evaluator shall repeat this test for each supported
                  elliptic curve<a id="period_232" href="#period_232">. </a>                </li>
              </ul>
            <div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div><div class="eacategory">Guidance</div><div class="eacategory">Tests</div></div></div></div><div class="comp" id=""><h4> TLS Server Support for Mutual Authentication</h4><div class="statustag"><b><i>The inclusion of this selection-based component depends upon selection in
           <a id="period_233" href="#period_233">. </a>           </i></b></div>
         
          <div class="element"><div class="reqid" id=".1"><a href="#.1" class="abbr">.1</a></div><div class="reqdesc">The product shall support authentication of
              TLS clients using X.509v3 certificates<a id="period_234" href="#period_234">. </a>            </div></div>
          <div class="element"><div class="reqid" id=".2"><a href="#.2" class="abbr">.2</a></div><div class="reqdesc">The product shall not establish a trusted channel
              if the client certificate is invalid<a id="period_235" href="#period_235">. </a>            <div class="appnote"><span class="note-header">Application Note: </span><span class="note">
              The use of X.509v3 certificates for TLS is addressed in
              
              This requirement adds that this use must include support for client-side
              certificates for TLS mutual authentication<a id="period_236" href="#period_236">. </a>Validity is determined by the
              certificate path, the expiration date, and the revocation status in
              accordance with RFC 5280<a id="period_237" href="#period_237">. </a>Certificate validity shall be tested in accordance
              with testing performed for <a id="period_238" href="#period_238">. </a>            </span></div></div></div>
          <div class="element"><div class="reqid" id=".3"><a href="#.3" class="abbr">.3</a></div><div class="reqdesc">The product shall not establish a trusted channel if
              the Distinguished Name (DN) or Subject Alternative Name (SAN)
              contained in a certificate does not match one of the expected identifiers
              for the client<a id="period_239" href="#period_239">. </a>            <div class="appnote"><span class="note-header">Application Note: </span><span class="note">
              The client identifier may be in the Subject field or the Subject
              Alternative Name extension of the certificate<a id="period_240" href="#period_240">. </a>The expected
              identifier may either be configured, may be compared to the
              domain name, IP address, username, or email address used by
              the client, or may be passed to a directory server for comparison<a id="period_241" href="#period_241">. </a>              In the latter case, the matching itself may be performed outside the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr><a id="period_242" href="#period_242">. </a>            </span></div></div></div>
        <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"></div>
              
              The evaluator shall ensure that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> description required per 
              includes the use of client-side certificates for TLS mutual authentication<a id="period_243" href="#period_243">. </a>              
              The evaluator shall verify that the AGD guidance required per 
              includes instructions for configuring the client-side certificates for TLS mutual
              authentication<a id="period_244" href="#period_244">. </a> The evaluator shall ensure that the AGD guidance
              includes instructions for configuring the server to require
              mutual authentication of clients using these certificates<a id="period_245" href="#period_245">. </a>        
	      The evaluator shall use TLS as a function to verify that the validation rules in
	       are adhered to and shall perform the following tests<a id="period_246" href="#period_246">. </a>        The evaluator shall apply the AGD guidance to configure the server
        to require TLS mutual authentication of clients for the following tests,
        unless overridden by instructions in the test activity:
              <ul>
                <li><b>Test 1: </b>
                  The evaluator shall configure the server to send a certificate request
                  to the client<a id="period_247" href="#period_247">. </a> 
                  The client shall send a certificate_list structure which has a length of zero<a id="period_248" href="#period_248">. </a>The evaluator
                  shall verify that the handshake is not finished successfully and no application data flows<a id="period_249" href="#period_249">. </a>                </li>
                <li><b>Test 2: </b>
                  The evaluator shall configure the server to send a certificate request
                  to the client<a id="period_250" href="#period_250">. </a> 
                  The client shall send no client certificate message, and instead send a client key exchange
                  message in an attempt to continue the handshake<a id="period_251" href="#period_251">. </a>The evaluator shall verify that the handshake is
                  not finished successfully and no application data flows<a id="period_252" href="#period_252">. </a>                </li>
                <li><b>Test 3: </b>
                  The evaluator shall configure the server to send a certificate request
                  to the client without the supported_signature_algorithm used by the client&#8217;s
                  certificate<a id="period_253" href="#period_253">. </a>The evaluator shall attempt a connection using the client
                  certificate and verify that the handshake is not finished successfully
                  and no application data flows<a id="period_254" href="#period_254">. </a>                </li>
                <li><b>Test 4: </b>
                  The evaluator shall demonstrate that using a certificate without a
                  valid certification path results in the function failing<a id="period_255" href="#period_255">. </a>Using the
                  administrative guidance, the evaluator shall then load a certificate or
                  certificates needed to validate the certificate to be used in the function, and
                  demonstrate that the function succeeds<a id="period_256" href="#period_256">. </a>The evaluator then shall delete one
                  of the certificates, and show that the function fails<a id="period_257" href="#period_257">. </a>                </li>
                <li><b>Test 5: </b>
                  The aim of this test is to check the response of the server
                  when it receives a client identity  certificate that is signed
                  by an impostor CA (either Root CA or intermediate CA)<a id="period_258" href="#period_258">. </a>To
                  carry out this test the  evaluator shall configure the client
                  to send a client identity certificate with an issuer field
                  that identifies a  CA recognised by the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> as a trusted CA,
                  but where the key used for the signature on the client
                  certificate  does not in fact correspond to the CA certificate
                  trusted by the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> (meaning that the client certificate is
                  invalid  because  its  certification  path  does  not  in
                  fact  terminate  in  the  claimed  CA  certificate)<a id="period_259" href="#period_259">. </a> The
                  evaluator shall verify that the attempted connection is
                  denied<a id="period_260" href="#period_260">. </a>                </li>
                <li><b>Test 6: </b>
                  The evaluator shall configure the client to send a certificate with the
                  Client Authentication purpose in the extendedKeyUsage field and verify that
                  the server accepts the attempted connection<a id="period_261" href="#period_261">. </a>The evaluator shall repeat this
                  test without the Client Authentication purpose and shall verify that the server
                  denies the connection<a id="period_262" href="#period_262">. </a>Ideally, the two certificates should be identical except
                  for the Client Authentication purpose<a id="period_263" href="#period_263">. </a>                </li>
                <li><b>Test 7: </b>
                  The evaluator shall perform the following modifications to the traffic:
                  a) Configure the server to require mutual authentication and then
                  modify a byte in the client&#8217;s certificate<a id="period_264" href="#period_264">. </a>The evaluator shall verify
                  that the server rejects the connection<a id="period_265" href="#period_265">. </a>                  b) Configure the server to require mutual authentication and then
                  modify a byte in the signature block of the client&#8217;s Certificate Verify handshake message<a id="period_266" href="#period_266">. </a>                  The evaluator shall verify that the server rejects the connection<a id="period_267" href="#period_267">. </a>                </li>
              </ul>
            
              
              If the product implements mutual authentication, the evaluator shall
              verify that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes how the DN and SAN in the certificate
              is compared to the expected identifier<a id="period_268" href="#period_268">. </a>              
              If the DN is not compared automatically to the domain name,
              IP address, username, or email address, the evaluator shall
              ensure that the AGD guidance includes configuration of the
              expected identifier or the directory server for the connection<a id="period_269" href="#period_269">. </a>              
              <ul>
                <li><b>Test 1: </b>
                  The evaluator shall send a client certificate with an identifier that does not match any of the
                  expected identifiers and verify that the server denies the connection<a id="period_270" href="#period_270">. </a>The matching itself
                  might be performed outside the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> (e.g<a id="period_271" href="#period_271">. </a>when passing the certificate on to a directory server
                  for comparison)<a id="period_272" href="#period_272">. </a>                </li>
              </ul>
            <div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div><div class="eacategory">Guidance</div><div class="eacategory">Tests</div></div></div></div><div class="comp" id=""><h4> TLS Server Support for Renegotiation</h4><div class="statustag"><b><i>The inclusion of this selection-based component depends upon selection in
           <a id="period_273" href="#period_273">. </a>           </i></b></div>
    
          <div class="element"><div class="reqid" id=".1"><a href="#.1" class="abbr">.1</a></div><div class="reqdesc">The product shall support the "renegotiation_info" TLS extension
              in accordance with RFC 5746<a id="period_274" href="#period_274">. </a>            </div></div>
          <div class="element"><div class="reqid" id=".2"><a href="#.2" class="abbr">.2</a></div><div class="reqdesc">The product shall include the renegotiation_info extension in
              ServerHello messages<a id="period_275" href="#period_275">. </a>            <div class="appnote"><span class="note-header">Application Note: </span><span class="note">
              RFC 5746 defines an extension to TLS that binds renegotiation
              handshakes to the cryptography in the original handshake<a id="period_276" href="#period_276">. </a>	    </span></div></div></div>
	<div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"></div>
        
	      The following tests require connection with a client that supports secure
        renegotiation and the "renegotiation_info" extension<a id="period_277" href="#period_277">. </a>	      <ul>
		<li><b>Test 1: </b>The evaluator shall use a network packet analyzer/sniffer to capture
      the traffic between the two TLS endpoints<a id="period_278" href="#period_278">. </a> The evaluator shall verify that
      the &#8220;renegotiation_info&#8221; field is included in the ServerHello message<a id="period_279" href="#period_279">. </a>
		</li>
		<li><b>Test 2: </b>The evaluator shall modify the length portion of the field in the
      ClientHello message in the initial handshake to be non-zero and verify that
      the server sends a failure and terminates the connection<a id="period_280" href="#period_280">. </a> The evaluator
      shall verify that a properly formatted field results in a successful TLS connection<a id="period_281" href="#period_281">. </a>		</li>
		<li><b>Test 3: </b>The evaluator shall modify the "client_verify_data" or "server_verify_data"
      value in the ClientHello message received during secure renegotiation and
      verify that the server terminates the connection<a id="period_282" href="#period_282">. </a>		</li>
	      </ul>
	    <div class="eacategory">Tests</div></div></div></div><div class="comp" id=""><h4> DTLS Client Protocol</h4><div class="statustag"><b><i>The inclusion of this selection-based component depends upon selection in
           <a id="period_283" href="#period_283">. </a>           </i></b></div>
    
    <div class="element"><div class="reqid" id=".1"><a href="#.1" class="abbr">.1</a></div><div class="reqdesc">The product shall implement DTLS 1.2 (RFC 6347) and
      [<b>selection</b>: <i id="_s_87">DTLS 1.0 (RFC 4347)</i>, <i id="_s_88">no earlier DTLS versions</i>] as a client that supports the cipher suites
    [<b>selection</b>: <ul><li style=""><i id="_s_89">TLS_RSA_WITH_AES_128_CBC_SHA as defined in RFC 5246</i>, </li><li style=""><i id="_s_90">TLS_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</i>, </li><li style=""><i id="_s_91">TLS_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</i>, </li><li style=""><i id="_s_92">TLS_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5288</i>, </li><li style=""><i id="_s_93">TLS_DHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</i>, </li><li style=""><i id="_s_94">TLS_DHE_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</i>, </li><li style=""><i id="_s_95">TLS_DHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5288</i>, </li><li style=""><i id="decdhe1">TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</i>, </li><li style=""><i id="decdhe2">TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</i>, </li><li style=""><i id="decdhe3">TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384 as defined in RFC 5289</i>, </li><li style=""><i id="decdhe4">TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5289</i>, </li><li style=""><i id="decdhe5">TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</i>, </li><li style=""><i id="decdhe6">TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</i>, </li><li style=""><i id="decdhe7">TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 as defined in RFC 5289</i>, </li><li style=""><i id="decdhe8">TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5289</i></li></ul>]
      and also supports functionality for 
      [<b>selection</b>: <ul><li style=""><i id="dtlsc_mutual_auth">mutual authentication</i>, </li><li style=""><i id="_s_105">none</i></li></ul>]<a id="period_284" href="#period_284">. </a>      <div class="appnote"><span class="note-header">Application Note: </span><span class="note">
      If any ECDHE or DHE cipher suites are selected, then
       is required<a id="period_285" href="#period_285">. </a>      <br><br>
      If <i>mutual authentication</i> is selected, then the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> must additionally include 
      the requirements from <a id="period_286" href="#period_286">. </a>If the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> implements
      mutual authentication, this selection must be made<a id="period_287" href="#period_287">. </a>      <br><br>
      Differences between DTLS 1.2 and TLS 1.2 are outlined in RFC 6347; otherwise the
      protocols are the same<a id="period_288" href="#period_288">. </a>      All application notes listed for  that are relevant
      to DTLS apply to this requirement<a id="period_289" href="#period_289">. </a>    </span></div></div></div>

    <div class="element"><div class="reqid" id=".2"><a href="#.2" class="abbr">.2</a></div><div class="reqdesc"> The product shall verify that the presented identifier matches the reference
        identifier according to RFC 6125<a id="period_290" href="#period_290">. </a><div class="appnote"><span class="note-header">Application Note: </span><span class="note">
          All application notes listed for  that are relevant
          to DTLS apply to this requirement<a id="period_291" href="#period_291">. </a>        </span></div></div></div>

    <div class="element"><div class="reqid" id=".3"><a href="#.3" class="abbr">.3</a></div><div class="reqdesc">The product shall not establish a trusted channel if the
        server certificate is invalid
        [<b>selection</b>: <i id="_s_106">with no exceptions</i>, <i id="_s_107">except when override is authorized</i>]<a id="period_292" href="#period_292">. </a>      <div class="appnote"><span class="note-header">Application Note: </span><span class="note">
        All application notes listed for  that are relevant
        to DTLS apply to this requirement<a id="period_293" href="#period_293">. </a>      </span></div></div></div>
    <div class="element"><div class="reqid" id=".4"><a href="#.4" class="abbr">.4</a></div><div class="reqdesc">The product shall
    [<b>selection</b>: <i id="_s_108">terminate the DTLS session</i>, <i id="_s_109">silently discard the record</i>]
    if a message received contains an invalid MAC or if decryption fails in the case of GCM and other
    AEAD ciphersuites<a id="period_294" href="#period_294">. </a>    </div></div>
  <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"></div>
	
        The evaluator shall perform the evaluation activities listed for ,
        but ensuring that DTLS (and not TLS) is used in each evaluation activity<a id="period_295" href="#period_295">. </a>        <br><br>
        For tests which involve version numbers, note that in DTLS the on-the-wire representation
        is the 1's complement of the corresponding textual DTLS version numbers<a id="period_296" href="#period_296">. </a>This is described in
        Section 4.1 of RFC 6347 and RFC 4347<a id="period_297" href="#period_297">. </a> For example, DTLS 1.0 is represented by the bytes 0xfe 0xff,
        while the undefined DTLS 1.4 would be represented by the bytes 0xfe 0xfb<a id="period_298" href="#period_298">. </a>      
      
      The evaluator shall perform the evaluation activities listed for <a id="period_299" href="#period_299">. </a>      
        
        The evaluator shall perform the evaluation activities listed for <a id="period_300" href="#period_300">. </a>      
      
      The evaluator shall verify that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes the actions that take place if a message
      received from the DTLS Server fails the MAC integrity check<a id="period_301" href="#period_301">. </a>      
      The evaluator shall establish a connection using a server<a id="period_302" href="#period_302">. </a>The evaluator will then modify
      at least one byte in a record message, and verify that the client discards the record or
      terminates the DTLS session<a id="period_303" href="#period_303">. </a>    <div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div><div class="eacategory">Tests</div></div></div></div><div class="comp" id=""><h4> DTLS Client Support for Mutual Authentication</h4><div class="statustag"><b><i>The inclusion of this selection-based component depends upon selection in
           <a id="period_304" href="#period_304">. </a>           </i></b></div>
    
          <div class="element"><div class="reqid" id=".1"><a href="#.1" class="abbr">.1</a></div><div class="reqdesc">
              The product shall support mutual authentication using X.509v3 certificates<a id="period_305" href="#period_305">. </a>            <div class="appnote"><span class="note-header">Application Note: </span><span class="note">
              All application notes listed for  that are relevant
              to DTLS apply to this requirement<a id="period_306" href="#period_306">. </a>      </span></div></div></div>
  <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"></div>
	
        The evaluator shall perform the evaluation activities listed for <a id="period_307" href="#period_307">. </a>      <div class="eacategory">Tests</div></div></div></div><div class="comp" id=""><h4> DTLS Server Protocol</h4><div class="statustag"><b><i>The inclusion of this selection-based component depends upon selection in
           <a id="period_308" href="#period_308">. </a>           </i></b></div>
    
    <div class="element"><div class="reqid" id=".1"><a href="#.1" class="abbr">.1</a></div><div class="reqdesc">The product shall implement DTLS 1.2 (RFC 6347) and
      [<b>selection</b>: <i id="_s_110">DTLS 1.0 (RFC 4347)</i>, <i id="_s_111">no earlier DTLS versions</i>]
        as a server that supports the ciphersuites
        [<b>selection</b>: <ul><li style=""><i id="_s_112">TLS_RSA_WITH_AES_128_CBC_SHA as defined in RFC 5246</i>, </li><li style=""><i id="_s_113">TLS_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</i>, </li><li style=""><i id="_s_114">TLS_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</i>, </li><li style=""><i id="_s_115">TLS_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5288</i>, </li><li style=""><i id="_s_116">TLS_DHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</i>, </li><li style=""><i id="_s_117">TLS_DHE_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</i>, </li><li style=""><i id="_s_118">TLS_DHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5288</i>, </li><li style=""><i id="_s_119">TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</i>, </li><li style=""><i id="_s_120">TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</i>, </li><li style=""><i id="_s_121">TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384 as defined in RFC 5289</i>, </li><li style=""><i id="_s_122">TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5289</i>, </li><li style=""><i id="_s_123">TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</i>, </li><li style=""><i id="_s_124">TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</i>, </li><li style=""><i id="_s_125">TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 as defined in RFC 5289</i>, </li><li style=""><i id="_s_126">TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5289</i></li></ul>] and no other cipher suites,
        and also supports functionality for
        [<b>selection</b>: <ul><li style=""><i id="dtlss_mutual_auth">mutual authentication</i>, </li><li style=""><i id="_s_128">none</i></li></ul>]<a id="period_309" href="#period_309">. </a>      <div class="appnote"><span class="note-header">Application Note: </span><span class="note">
      If <i>mutual authentication</i> is selected, then the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> must additionally include
      the requirements from <a id="period_310" href="#period_310">. </a> If the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> implements
      mutual authentication, this selection must be made<a id="period_311" href="#period_311">. </a>      <br><br>
      All application notes listed for  that are relevant
      to DTLS apply to this requirement<a id="period_312" href="#period_312">. </a>      </span></div></div></div>
    <div class="element"><div class="reqid" id=".2"><a href="#.2" class="abbr">.2</a></div><div class="reqdesc">The product shall deny connections from clients requesting
        [<b>assignment</b>: 
     <span class="assignable-content">list of DTLS protocol versions</span>]<a id="period_313" href="#period_313">. </a>      <div class="appnote"><span class="note-header">Application Note: </span><span class="note">Any specific DTLS version
        not selected in  should be assigned here<a id="period_314" href="#period_314">. </a>        This version of the <abbr class="dyn-abbr"><a href="#abbr_PP">PP</a></abbr> does not require the server to deny DTLS 1.0, and if the <abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr>
        supports DTLS 1.0 then "none" can be assigned<a id="period_315" href="#period_315">. </a>In a future version of this <abbr class="dyn-abbr"><a href="#abbr_PP">PP</a></abbr>,
        DTLS 1.0 will be required to be denied<a id="period_316" href="#period_316">. </a>      </span></div></div></div>

    <div class="element"><div class="reqid" id=".3"><a href="#.3" class="abbr">.3</a></div><div class="reqdesc">
        The product shall not proceed with a connection handshake attempt if the DTLS Client fails validation<a id="period_317" href="#period_317">. </a>      <div class="appnote"><span class="note-header">Application Note: </span><span class="note">
        The process to validate the IP address of a DTLS client is specified in section 4.2.1 of RFC 6347 (DTLS 1.2) and
        RFC 4347 (DTLS 1.0)<a id="period_318" href="#period_318">. </a>The server validates the DTLS client during Connection Establishment (Handshaking) and prior
        to sending a Server Hello message<a id="period_319" href="#period_319">. </a>After receiving a ClientHello, the DTLS Server sends a
        HelloVerifyRequest along with a cookie<a id="period_320" href="#period_320">. </a>The cookie is a signed message using a keyed hash function<a id="period_321" href="#period_321">. </a>The DTLS
        Client then sends another ClientHello with the cookie attached<a id="period_322" href="#period_322">. </a>If the DTLS
        server successfully verifies the signed cookie, the Client is not using a spoofed IP address<a id="period_323" href="#period_323">. </a>      </span></div></div></div>
    <div class="element"><div class="reqid" id=".4"><a href="#.4" class="abbr">.4</a></div><div class="reqdesc">The product shall perform key establishment for DTLS using
        [<b>selection</b>: <ul><li style=""><i id="_s_129">RSA with size
            [<b>selection</b>: <i id="_s_130">2048 bits</i>, <i id="_s_131">3072 bits</i>, <i id="_s_132">4096 bits</i>, <i id="_s_133">no other sizes</i>]
          </i>, </li><li style=""><i id="_s_134">Diffie-Hellman parameters with size
            [<b>selection</b>: <i id="_s_135">2048 bits</i>, <i id="_s_136">3072 bits</i>, <i id="_s_137">4096 bits</i>, <i id="_s_138">6144 bits</i>, <i id="_s_139">8192 bits</i>, <i id="_s_140">no other size</i>]
          </i>, </li><li style=""><i id="_s_141">Diffie-Hellman groups
            [<b>selection</b>: <i id="_s_142">ffdhe2048</i>, <i id="_s_143">ffdhe3072</i>, <i id="_s_144">ffdhe4096</i>, <i id="_s_145">ffdhe6144</i>, <i id="_s_146">ffdhe8192</i>, <i id="_s_147">no other groups</i>]
          </i>, </li><li style=""><i id="_s_148">ECDHE parameters using elliptic curves
            [<b>selection</b>: <i id="_s_149">secp256r1</i>, <i id="_s_150">secp384r1</i>, <i id="_s_151">secp521r1</i>] and no other curves</i>, </li><li style=""><i id="_s_152">no other key establishment methods</i></li></ul>]<a id="period_324" href="#period_324">. </a>      <div class="appnote"><span class="note-header">Application Note: </span><span class="note">
        If the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> lists an RSA cipher suite in , the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> must include the
        RSA selection in the requirement<a id="period_325" href="#period_325">. </a>        <br>
        If the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> lists a DHE cipher suite in , the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> must include either
        the Diffie-Hellman selection for parameters of a certain size,
        or for particular Diffie-Hellman groups<a id="period_326" href="#period_326">. </a>        <br>
        If the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> lists an ECDHE cipher suite in , the <abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr> must include the
        NIST curves selection in the requirement<a id="period_327" href="#period_327">. </a>      </span></div></div></div>
    <div class="element"><div class="reqid" id=".5"><a href="#.5" class="abbr">.5</a></div><div class="reqdesc">The product shall
      [<b>selection</b>: <i id="_s_153">terminate the DTLS session</i>, <i id="_s_154">silently discard the record</i>]
      if a message received contains an invalid MAC or if decryption fails in the case of GCM and other
      AEAD ciphersuites<a id="period_328" href="#period_328">. </a>      </div></div>
  <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"></div>
	
        The evaluator shall perform the evaluation activities listed for ,
        but ensuring that DTLS (and not TLS) is used in each stage of the evaluation activities<a id="period_329" href="#period_329">. </a>        <br><br>
        For tests which involve version numbers, note that in DTLS the on-the-wire representation
        is the 1's complement of the corresponding textual DTLS version numbers<a id="period_330" href="#period_330">. </a>This is described in
        Section 4.1 of RFC 6347 and RFC 4347<a id="period_331" href="#period_331">. </a> For example, DTLS 1.0 is represented by the bytes 0xfe 0xff,
        while the undefined DTLS 1.4 would be represented by the bytes 0xfe 0xfb<a id="period_332" href="#period_332">. </a>      
        The following evaluation activities shall be conducted unless "none" is assigned<a id="period_333" href="#period_333">. </a>        <br><br>
        
        The evaluator shall verify that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> contains a
        description of the denial of old DTLS versions
        consistent relative to selections in <a id="period_334" href="#period_334">. </a>        
        The evaluator shall verify that the AGD guidance includes any configuration
        necessary to meet this requirement<a id="period_335" href="#period_335">. </a>        
        <ul>
          <li><b>Test 1: </b>
            The evaluator shall send a Client Hello requesting a
            connection with each version of DTLS specified in the selection
            and verify that the server denies the connection<a id="period_336" href="#period_336">. </a>          </li>
        </ul>
      
        
        The evaluator shall verify that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes how the DTLS Client IP address is validated prior to
        issuing a ServerHello message<a id="period_337" href="#period_337">. </a>        
        Modify at least one byte in the cookie from the Server's HelloVerifyRequest message, and verify that the
        Server rejects the Client's handshake message<a id="period_338" href="#period_338">. </a>      
      
        The evaluator shall perform the evaluation activities listed for <a id="period_339" href="#period_339">. </a>      
        
        The evaluator shall verify that the <abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr> describes the actions that take place if a message
        received from the DTLS client fails the MAC integrity check<a id="period_340" href="#period_340">. </a>        
        The evaluator shall establish a connection using a client<a id="period_341" href="#period_341">. </a>The evaluator will then modify
        at least one byte in a record message, and verify that the server discards the record or
        terminates the DTLS session<a id="period_342" href="#period_342">. </a>      <div class="eacategory"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></div><div class="eacategory">Guidance</div><div class="eacategory">Tests</div></div></div></div><div class="comp" id=""><h4> DTLS Server Support for Mutual Authentication</h4><div class="statustag"><b><i>The inclusion of this selection-based component depends upon selection in
           <a id="period_343" href="#period_343">. </a>           </i></b></div>
    
          <div class="element"><div class="reqid" id=".1"><a href="#.1" class="abbr">.1</a></div><div class="reqdesc">
              The product shall support mutual authentication of DTLS clients using X.509v3 certificates<a id="period_344" href="#period_344">. </a>            <div class="appnote"><span class="note-header">Application Note: </span><span class="note">
              All application notes listed for  that are relevant
              to DTLS apply to this requirement<a id="period_345" href="#period_345">. </a>      </span></div></div></div>
    <div class="element"><div class="reqid" id=".2"><a href="#.2" class="abbr">.2</a></div><div class="reqdesc">The product shall not establish a trusted channel
        if the client certificate is invalid<a id="period_346" href="#period_346">. </a>      <div class="appnote"><span class="note-header">Application Note: </span><span class="note">
        All application notes listed for  that are relevant
        to DTLS apply to this requirement<a id="period_347" href="#period_347">. </a>      </span></div></div></div>
    <div class="element"><div class="reqid" id=".3"><a href="#.3" class="abbr">.3</a></div><div class="reqdesc">The product shall not establish a trusted channel if
        the Distinguished Name (DN) or Subject Alternative Name (SAN)
        contained in a certificate does not match one of the expected identifiers
        for the client<a id="period_348" href="#period_348">. </a>      <div class="appnote"><span class="note-header">Application Note: </span><span class="note">
        All application notes listed for  that are relevant
        to DTLS apply to this requirement<a id="period_349" href="#period_349">. </a>      </span></div></div></div>
      <div class="activity_pane hide"><div class="activity_pane_header"><a onclick="toggle(this);return false;" href="#"><span class="activity_pane_label"> Evaluation Activities </span><span class="toggler"></span></a></div><div class="activity_pane_body"><div class="component-activity-header"></div>
	
          The evaluator shall perform the evaluation activities listed for <a id="period_350" href="#period_350">. </a>      
	
        The evaluator shall perform the evaluation activities listed for <a id="period_351" href="#period_351">. </a>
      
        
        The evaluator shall perform the evaluation activities listed for <a id="period_352" href="#period_352">. </a>      <div class="eacategory">Tests</div></div></div></div><h1 id="acronyms" class="indexable" data-level="A">Appendix G -  Acronyms</h1>
    

        AES
        Advanced Encryption Standard
      
      
        CA
        Certificate Authority
            
      
        CBC
        Cipher Block Chaining
      
      
        CN
        Common Name
       
      
        DHE
        Diffie-Hellman Ephemeral
      
      
        DN
        Distinguished Name
      
      
        DNS
        Domain Name Server
      
      
        DTLS
        Datagram Transport Layer Security
      
      
        EAP
        Extensible Authentication Protocol
      
      
        ECDHE
        Elliptic Curve Diffie-Hellman Ephemeral
             
      
        ECDSA
        Elliptic Curve Digital Signature Algorithm
      
      
        GCM
        Galois/Counter Mode
      
      
        HTTP
        Hypertext Transfer Protocol
             
      
        IETF
        Internet Engineering Task Force
      
      
        IP
        Internet Protocol
      
      
        LDAP
        Lightweight Directory Access Protocol
             
      
        NIST
        National Institute of Standards and Technology
      
      
        RFC
        Request for Comment (IETF)
      
      
        RSA
        Rivest Shamir Adelman
      
      
        SAN
        Subject Alternative Name
       
      
        SCSV
        Signaling Cipher Suite Value
      
      
        SHA
        Secure Hash Algorithm
             
      
        SIP
        Session Initiation Protocol
      
      
        TCP
        Transmission Control Protocol
       
      
        TLS
        Transport Layer Security
       
      
        UDP
        User Datagram Protocol
      
      
        URI
        Uniform Resource Identifier
             
      
        URL
        Uniform Resource Locator
             
    
  <h1 id="acronyms" class="indexable" data-level="A">Appendix H -  Acronyms</h1><table><tr class="header"><th>Acronym</th><th>Meaning</th></tr><tr><td><span class="term" id="abbr_Base-PP"><abbr class="dyn-abbr"><a href="#abbr_Base-PP">Base-PP</a></abbr></span></td><td><span id="long_abbr_Base-PP">Base Protection Profile</span></td></tr><tr><td><span class="term" id="abbr_CC"><abbr class="dyn-abbr"><a href="#abbr_CC">CC</a></abbr></span></td><td><span id="long_abbr_CC">Common Criteria</span></td></tr><tr><td><span class="term" id="abbr_CEM"><abbr class="dyn-abbr"><a href="#abbr_CEM">CEM</a></abbr></span></td><td><span id="long_abbr_CEM">Common Evaluation Methodology</span></td></tr><tr><td><span class="term" id="abbr_OE"><abbr class="dyn-abbr"><a href="#abbr_OE">OE</a></abbr></span></td><td><span id="long_abbr_OE">Operational Environment</span></td></tr><tr><td><span class="term" id="abbr_PP"><abbr class="dyn-abbr"><a href="#abbr_PP">PP</a></abbr></span></td><td><span id="long_abbr_PP">Protection Profile</span></td></tr><tr><td><span class="term" id="abbr_PP-Configuration"><abbr class="dyn-abbr"><a href="#abbr_PP-Configuration">PP-Configuration</a></abbr></span></td><td><span id="long_abbr_PP-Configuration">Protection Profile Configuration</span></td></tr><tr><td><span class="term" id="abbr_PP-Module"><abbr class="dyn-abbr"><a href="#abbr_PP-Module">PP-Module</a></abbr></span></td><td><span id="long_abbr_PP-Module">Protection Profile Module</span></td></tr><tr><td><span class="term" id="abbr_SAR"><abbr class="dyn-abbr"><a href="#abbr_SAR">SAR</a></abbr></span></td><td><span id="long_abbr_SAR">Security Assurance Requirement</span></td></tr><tr><td><span class="term" id="abbr_SFR"><abbr class="dyn-abbr"><a href="#abbr_SFR">SFR</a></abbr></span></td><td><span id="long_abbr_SFR">Security Functional Requirement</span></td></tr><tr><td><span class="term" id="abbr_ST"><abbr class="dyn-abbr"><a href="#abbr_ST">ST</a></abbr></span></td><td><span id="long_abbr_ST">Security Target</span></td></tr><tr><td><span class="term" id="abbr_TOE"><abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr></span></td><td><span id="long_abbr_TOE">Target of Evaluation</span></td></tr><tr><td><span class="term" id="abbr_TSF"><abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr></span></td><td><span id="long_abbr_TSF"><abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> Security Functionality</span></td></tr><tr><td><span class="term" id="abbr_TSFI" data-plural="TSFIs"><abbr class="dyn-abbr"><a href="#abbr_TSFI">TSFI</a></abbr></span></td><td><span id="long_abbr_TSFI"><abbr class="dyn-abbr"><a href="#abbr_TSF">TSF</a></abbr> Interface</span></td></tr><tr><td><span class="term" id="abbr_TSS"><abbr class="dyn-abbr"><a href="#abbr_TSS">TSS</a></abbr></span></td><td><span id="long_abbr_TSS"><abbr class="dyn-abbr"><a href="#abbr_TOE">TOE</a></abbr> Summary Specification</span></td></tr></table><h1 id="appendix-bibliography" class="indexable" data-level="A">Appendix I -  Bibliography</h1><table><tr class="header"><th>Identifier</th><th>Title</th></tr><tr><td><span id="bibCC">[<abbr class="dyn-abbr"><a href="#abbr_CC">CC</a></abbr>]</span></td><td>Common Criteria for Information Technology Security Evaluation -
          <ul>
            <li>
              <a href="http://www.commoncriteriaportal.org/cc">Part 1:
                Introduction and General Model</a>, CCMB-2017-04-001, Version 3.1 Revision 5, April 2017<a id="period_353" href="#period_353">. </a>			</li>
            <li>
              <a href="http://www.commoncriteriaportal.org/cc">Part 2:
                Security Functional Components</a>, CCMB-2017-04-002, Version 3.1 Revision 5, April 2017<a id="period_354" href="#period_354">. </a>			</li>
            <li>
              <a href="http://www.commoncriteriaportal.org/cc">Part 3:
                Security Assurance Components</a>, CCMB-2017-04-003, Version 3.1 Revision 5, April 2017<a id="period_355" href="#period_355">. </a>              </li>
          </ul></td></tr><tr><td><span id="bibCC">[<abbr class="dyn-abbr"><a href="#abbr_CC">CC</a></abbr>]</span></td><td>Common Criteria for Information Technology Security Evaluation - <ul>
            <li><a href="http://www.commoncriteriaportal.org/files/ccfiles/CCPART1V3.1R5.pdf">Part
                1: Introduction and General Model</a>, CCMB-2017-04-001, Version 3.1 Revision 5,
              April 2017<a id="period_356" href="#period_356">. </a></li>
            <li><a href="http://www.commoncriteriaportal.org/files/ccfiles/CCPART2V3.1R5.pdf">Part
                2: Security Functional Components</a>, CCMB-2017-04-002, Version 3.1 Revision 5,
              April 2017<a id="period_357" href="#period_357">. </a></li>
            <li><a href="http://www.commoncriteriaportal.org/files/ccfiles/CCPART3V3.1R5.pdf">Part
                3: Security Assurance Components</a>, CCMB-2017-04-003, Version 3.1 Revision 5,
              April 2017<a id="period_358" href="#period_358">. </a></li>
          </ul></td></tr></table></body></html>