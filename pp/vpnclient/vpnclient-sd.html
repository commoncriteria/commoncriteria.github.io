<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html><head><title>Supporting Document - PP-Module for Virtual Private Network (VPN) Clients Products</title><style type="text/css">
    #toc a{
        display: block;
    }

    svg{
      width: 100%;
    }

    a[id^="ajq_"]{
        color:black;
    }

    
    body{
       max-width: 900px;
       margin: auto;
    }
    #toc span{
       margin-left: 20px;
    }
    .assignable-content{
      font-style: italic;
    }
    .refinement{
      font-weight: bold;
    }
    div.eacategory{
      font-style: italic;
      font-weight: bold;
    }
    .activity_pane .toggler::after, .activity_pane .toggler{
       display: inline-block;
       height: auto;
       content: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8A\
       AAAPCAYAAAA71pVKAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAQOFAAEDhQGl\
       VDz+AAAAB3RJTUUH4gIXFDM7fhmr1wAAAfRJREFUKM+dkk9I02EYxz/P+25uurWR\
       tTkzI4NGl4jQgkq71K1DhnTQIDolRAQFQYSHTtGhU4e6eujQofBSFLOg0C4RUSjh\
       FnmqTTdKpj/mfv/eX4cUpmRYn9vz8v3w8D7PA/AWGADCbI4QcAb4AnAF8IBJEdX+\
       N0tEda40C4AHADviW1LFvpOX6+FwtAacVzqkGiWtwxo4F21OuPu7+yvxRNoDEhpY\
       cpzavkQyc7D76FCk+vN7j7VU6RdR4xAsikjGGP9FKrN3sPfEpajv2i2zhckR4JUG\
       UCr0erFavLkn2ytd2WPxcFOsZb74+SIQA0YPHBqIdB8Z6tChJv1m/N4P33OGAUsD\
       BIFxPNcOkq07jyeSbbo1tTu2q6vHEqU7D/ddSKcz2ZQJjBSmx925b9NjwEMAafha\
       eyQa/3Dq7O0243sCIEoRGAOA59nm5dM7OHVruzH+AkDjYEp23RrLT+U8Ub+fV0UR\
       oVyaMfVa9fqquF5GKX3ja2FCuc6yWbMipYNP755UgEdr8o2FMf5ivVYdKRfzRkRW\
       RfJTOc+2rWdAcUN5hdGP7x8viGgAXLvGbGFCKxW6tj74J3nOqVvP89M5V6kQ86UZ\
       f7lWvWWMt7Sp41VKb21uSfqnB++6kWi8BLTzL4ioq7H4tgC4z3/QAZSBxEaBXygN\
       v+jeFnAPAAAAAElFTkSuQmCC');
       max-width: 15px;
    }


    a {
      text-decoration: none;
      word-wrap: break-word;
    }
    a.abbr:link{
      color:black;
      text-decoration:none;
    }
    a.abbr:visited{
      color:black;
      text-decoration:none;
    }
    a.abbr:hover{
      color:blue;
      text-decoration:none;
    }
    a.abbr:hover:visited{
      color:purple;
      text-decoration:none;
    }
    a.abbr:active{
      color:red;
      text-decoration:none;
    }
    .note-header{
      font-weight: bold;
    }
    .note p:first-child{
      display: inline;
    }

    .indent{ margin-left:2em; }

    /* Tooltip container */
    .tooltipped {
       position: relative;
       display: inline-block;
       border-bottom: 1px dotted black; /* If you want dots under the hoverable text */
    }

    /* Tooltip text */
    .tooltiptext {
       visibility: hidden;
       width: 120px;
       background-color: black;
       color: #fff;
       text-align: center;
       padding: 5px 0;
       border-radius: 6px;

       /* Position the tooltip text - see examples below! */
       position: absolute;
       z-index: 1;
   }

   /* Show the tooltip text when you mouse over the tooltip container */
   .tooltipped:hover .tooltiptext {
       visibility: visible;
   }
   tr.major-row{
       border-top-style: double;
   }
   tr.major-row td:first-child{
       border-right-style: ridge;
       background-color: white;
   } 
   table.mfs td{
       text-align: center;
   }
   table.mfs td:first-child{
       text-align: left;
   }
  .table-caption{
       text-align: center;
       font-weight: bold;
   }
   table{
       margin:auto;
       margin-top:1em;
       border-collapse:collapse; /*border: 1px solid black;*/
   }
   td{
       text-align:left;
       padding:8px 8px;
   }
   th{
       padding:8px 8px;
   }
   thead tr td{
       text-align: center;
       font-style: oblique;
       font-weight: bold;
   }
   tr.header{
       border-bottom:3px solid gray;
       padding:8px 8px;
       text-align:left;
       font-weight:bold; /*font-size: 90%; font-family: verdana, arial, helvetica, sans-serif; */
   }
   table tr:nth-child(2n+2){
       background-color:#F4F4F4;
   }

   .dependent{
       border: 1px solid gray;
       border-radius: 1px
   }
   .dependent-content{
       margin-left: 25px;
       font-style: italic;
   }

   .uc_table_or td, .uc_table_or tr {
       vertical-align: middle;
       border: 1px solid black;
       background-color: white;
   }

   .uc_not, .uc_mf, .uc_sel, .uc_guide{
       text-indent: 10px;
   }
   .uc_not_sel, .uc_sel.uc_mf, uc_assign.uc_mf{
       text-indent: 20px;
   }


   .uc_table_or tr td.or_cell{
      white-space: nowrap;
      border-radius: 0.6em 0 0 0.6em;
      background-color: black;
      color: white;
   }

   .uc_table_and, .uc_table_or {
       width: 100%;
       background-color: white;
   }
   .uc_guidance{
       display: table;
       background-color: gray;
   }  

   .evidence, .test-obj { font-style: normal; font-size: 90%;}
   </style></head><body><div style="text-align: center; margin-left: auto; margin-right: auto;"><h1 class="title" style="page-break-before:auto;">Supporting Document<br/>
        Mandatory Technical Document</h1><img alt="NIAP" src="images/niaplogo.png"></img><hr width="50%"></hr><noscript><h1 style="text-align:center; border-style: dashed; border-width: medium; border-color: red;">This page is best viewed with JavaScript enabled!</h1></noscript><br/>PP-Module for Virtual Private Network (VPN) Clients<p></p>Version: 2.2<p></p>2021-01-05<p></p><b>National Information Assurance Partnership</b></div><div class="foreword"><h1 style="text-align: center">Foreword</h1><p>This is a Supporting Document (SD), intended to complement the Common Criteria version 3
      and the associated Common Evaluation Methodology for
      Information Technology Security Evaluation.</p><p>SDs may be “Guidance Documents”, that highlight specific approaches 
      and application of the standard to areas where no mutual recognition of
      its application is required, and as such, are not of normative nature, 
      or “Mandatory Technical Documents”, whose application is mandatory for evaluations 
      whose scope is covered by that of the SD.
      The usage of the latter class is not only mandatory, but certificates
      issued as a result of their application are recognized under the CCRA.</p><p><b>Technical Editor:</b><br/>
      National Information Assurance Partnership (NIAP)
      </p><p><b style="page-break-before:always;">Document history:</b><table><tr class="header"><th>Version</th><th>Date</th><th style="align:left;">Comment</th></tr><tr><td>2.1</td><td>2019-11-14</td><td>Initial Release</td></tr></table></p><p><b>General Purpose:</b><br/>
      The purpose of this SD is to define evaluation methods for the functional behavior of 
      Virtual Private Network (VPN) Clients  products.
      </p><p><b>Acknowledgements:</b><br/>
      This SD was developed with support from NIAP Virtual Private Network (VPN) Clients Technical Community members, with representatives from industry, government 
      agencies, Common Criteria Test Laboratories, and members of academia.
      </p></div><h1>Table of Contents</h1><div id="toc"><a style="text-indent:0px" href="#introduction">1<span>Introduction</span></a><a style="text-indent:10px" href="#scope">1.1<span>Technology Area and Scope of Supporting Document</span></a><a style="text-indent:10px" href="#structure">1.2<span>Structure of the Document</span></a><a style="text-indent:10px" href="#glossary">1.3<span>Terms</span></a><a style="text-indent:20px" href="#cc-terms">1.3.1<span>Common Criteria Terms</span></a><a style="text-indent:20px" href="#tech-terms">1.3.2<span>Technical Terms</span></a><a style="text-indent:0px" href="#sfr">2<span>Evaluation Activities for SFRs</span></a><a style="text-indent:10px" href="#aa-$OS">2.1<span>
    Protection Profile for General Purpose Operating Systems</span></a><a style="text-indent:20px" href="#qq-sfrs-OS-Modified">2.1.1<span>Modified SFRs
        </span></a><a style="text-indent:30px" href="#os-m-fcs">2.1.1.1<span>Cryptographic Support (FCS)</span></a><a style="text-indent:20px" href="#qq-sfrs-OS-Additional">2.1.2<span>Additional SFRs
        </span></a><a style="text-indent:30px" href="#os-a-fcs">2.1.2.1<span>Cryptographic Support (FCS)</span></a><a style="text-indent:30px" href="#os-a-fia">2.1.2.2<span>Identification and Authentication (FIA)</span></a><a style="text-indent:30px" href="#os-a-ftp">2.1.2.3<span>Trusted Path/Channels (FTP)</span></a><a style="text-indent:10px" href="#aa-$MD">2.2<span>
    Protection Profile for Mobile Device Fundamentalss</span></a><a style="text-indent:20px" href="#qq-sfrs-MD-Modified">2.2.1<span>Modified SFRs
        </span></a><a style="text-indent:30px" href="#md-m-fcs">2.2.1.1<span>Cryptographic Support (FCS)</span></a><a style="text-indent:30px" href="#md-m-fia">2.2.1.2<span>Identification and Authentication (FIA)</span></a><a style="text-indent:30px" href="#md-m-ftp">2.2.1.3<span>Trusted Path/Channels (FTP)</span></a><a style="text-indent:10px" href="#aa-$App">2.3<span>
    Protection Profile for Application Softwares</span></a><a style="text-indent:20px" href="#qq-sfrs-App-Modified">2.3.1<span>Modified SFRs
        </span></a><a style="text-indent:30px" href="#ap-m-fcs">2.3.1.1<span>Cryptographic Support (FCS)</span></a><a style="text-indent:30px" href="#ap-m-fia">2.3.1.2<span>Identification and Authentication (FIA)</span></a><a style="text-indent:30px" href="#ap-m-ftp">2.3.1.3<span>Trusted Path/Channels (FTP)</span></a><a style="text-indent:20px" href="#qq-sfrs-App-Additional">2.3.2<span>Additional SFRs
        </span></a><a style="text-indent:30px" href="#md-a-fcs">2.3.2.1<span>Cryptographic Support (FCS)</span></a><a style="text-indent:10px" href="#aa-$MD">2.4<span>
    Protection Profile for Mobile Device Fundamentalss</span></a><a style="text-indent:20px" href="#qq-sfrs-MD-Modified">2.4.1<span>Modified SFRs
        </span></a><a style="text-indent:30px" href="#dm-m-fcs">2.4.1.1<span>Cryptographic Support (FCS)</span></a><a style="text-indent:30px" href="#dm-m-fia">2.4.1.2<span>Identification and Authentication (FIA)</span></a><a style="text-indent:30px" href="#dm-m-ftp">2.4.1.3<span>Trusted Path/Channels (FTP)</span></a><a style="text-indent:10px" href="#man-sfrs">2.5<span>TOE SFR Evaluation Activities</span></a><a style="text-indent:20px" href="#m-fcs">2.5.1<span>Cryptographic Support (FCS)</span></a><a style="text-indent:20px" href="#m-fdp">2.5.2<span>User Data Protection (FDP)</span></a><a style="text-indent:20px" href="#m-fmt">2.5.3<span>Security Management (FMT)</span></a><a style="text-indent:20px" href="#m-fpt">2.5.4<span>Protection of the TSF (FPT)</span></a><a style="text-indent:10px" href="#opt-sfrs">2.6<span>Evaluation Activities for Optional SFRs</span></a><a style="text-indent:10px" href="#sel-sfrs">2.7<span>Evaluation Activities for Selection-Based SFRs</span></a><a style="text-indent:20px" href="#s-fia">2.7.1<span>Identification and Authentication (FIA)</span></a><a style="text-indent:10px" href="#obj-sfrs">2.8<span>Evaluation Activities for Objective SFRs</span></a><a style="text-indent:20px" href="#ob-fau">2.8.1<span>Security Audit (FAU)</span></a><a style="text-indent:20px" href="#ob-fdp">2.8.2<span>User Data Protection (FDP)</span></a><a style="text-indent:0px" href="#sar_aas">3<span>Evaluation Activities for SARs</span></a><a style="text-indent:0px" href="#sup-info">4<span>Required Supplementary Information</span></a><a style="text-indent:0px" href="#biblio">Appendix A - <span>References</span></a></div><h1 id="introduction" data-level="0" class="indexable">1 Introduction</h1><h2 id="scope" data-level="1" class="indexable">1.1 Technology Area and Scope of Supporting Document</h2><p>The scope of the Virtual Private Network (VPN) Clients PP-Module is
    to describe the security functionality of 
      Virtual Private Network (VPN) Clients products in terms of 
    [CC] and to define functional and assurance requirements for them.
    The PP-Module is intended for use with the following Base-PPs:
        <ul><li><a href="https://www.niap-ccevs.org/Profile/Info.cfm?PPID=442">
    Protection Profile for General Purpose Operating Systems, Version 4.2.1</a></li><li><a href="https://www.niap-ccevs.org/Profile/Info.cfm?PPID=417">
    Protection Profile for Mobile Device Fundamentalss, Version 3.1</a></li><li><a href="https://www.niap-ccevs.org/Profile/Info.cfm?PPID=429">
    Protection Profile for Application Softwares, Version 3.1</a></li><li><a href="https://www.niap-ccevs.org/Profile/Info.cfm?PPID=417">
    Protection Profile for Mobile Device Fundamentalss, Version 3.1</a></li></ul></p><p>This SD is mandatory for evaluations of TOEs that claim conformance to a PP-Configuration that includes the PP-Module for :
    <ul><li>Virtual Private Network (VPN) Clients, Version 2.2</li></ul>
    As such it defines Evaluation Activities for the functionality described in the PP-Module as well as any impacts to the Evaluation Activites to the Base-PP(s) it modifies.
   </p><p> 
Although Evaluation Activities are defined mainly for the evaluators to follow, in general they also help developers to prepare for evaluation by identifying specific requirements for their TOE.
    The specific requirements in Evaluation Activities may in some cases clarify the meaning of Security
    Functional Requirements (SFR), and may identify particular requirements for the content of Security
    Targets (ST) (especially the TOE Summary Specification), user guidance documentation, and possibly
    supplementary information (e.g. for entropy analysis or cryptographic key management architecture).</p><h2 id="structure" data-level="1" class="indexable">1.2 Structure of the Document</h2><p>Evaluation Activities can be defined for both SFRs and Security Assurance Requirements (SAR),
    which are themselves defined in separate sections of the SD.</p><p>If any Evaluation Activity cannot be successfully completed in an evaluation, then
    the overall verdict for the evaluation is a 'fail'.
    In rare cases there may be acceptable reasons why an Evaluation Activity
    may be modified or deemed not applicable for a particular TOE, 
    but this must be approved by the Certification Body for the evaluation.</p><p>In general, if all Evaluation Activities (for both SFRs and SARs) are successfully
    completed in an evaluation then it would be expected that the overall verdict for 
    the evaluation is a ‘pass’.
    To reach a ‘fail’ verdict when the Evaluation Activities have been successfully 
    completed would require a specific justification from the evaluator as to why the 
    Evaluation Activities were not sufficient for that TOE.
    </p><p>Similarly, at the more granular level of assurance components, if the Evaluation 
    Activities for an assurance component and all of its related SFR Evaluation 
    Activities are successfully completed in an evaluation then it would be expected 
    that the verdict for the assurance component is a ‘pass’.
    To reach a ‘fail’ verdict for the assurance component when these Evaluation 
    Activities have been successfully completed would require a specific justification 
    from the evaluator as to why the Evaluation Activities were not sufficient for that TOE. 
    </p><h2 id="glossary" data-level="1" class="indexable">1.3 Terms</h2>
The following sections list Common Criteria and technology terms used in this document.
    <h3 id="cc-terms" data-level="2" class="indexable">1.3.1 Common Criteria Terms</h3><table><tr><td><div id="Assurance">Assurance</div></td><td>Grounds for confidence that a TOE meets the SFRs <a href="#bibCC">[CC]</a>.</td></tr><tr><td><div id="Base_Protection_Profile">Base Protection Profile (Base-PP)</div></td><td>Protection Profile used as a basis to build a PP-Configuration.</td></tr><tr><td><div id="Common_Criteria">Common Criteria (CC)</div></td><td>Common Criteria for Information Technology Security Evaluation (International Standard ISO/IEC 15408).</td></tr><tr><td><div id="Common_Criteria_Testing_Laboratory">Common Criteria Testing Laboratory</div></td><td>
      Within the context of the Common Criteria Evaluation and Validation Scheme (CCEVS), an IT security evaluation facility, accredited by the National Voluntary Laboratory Accreditation Program (NVLAP) and approved by the NIAP Validation Body to conduct Common Criteria-based evaluations.
    </td></tr><tr><td><div id="Common_Evaluation_Methodology">Common Evaluation Methodology (CEM)</div></td><td>Common Evaluation Methodology for Information Technology Security Evaluation.</td></tr><tr><td><div id="Distributed_TOE">Distributed TOE</div></td><td>A TOE composed of multiple components operating as a logical whole.</td></tr><tr><td><div id="Operational_Environment">Operational Environment (OE)</div></td><td>Hardware and software that are outside the TOE boundary that support the TOE functionality and security policy.</td></tr><tr><td><div id="Protection_Profile">Protection Profile (PP)</div></td><td>An implementation-independent set of security requirements for a category of products.</td></tr><tr><td><div id="Protection_Profile_Configuration">Protection Profile Configuration (PP-Configuration)</div></td><td>A comprehensive set of security requirements for a product type that consists of at least one Base-PP and at least one PP-Module.</td></tr><tr><td><div id="Protection_Profile_Module">Protection Profile Module (PP-Module)</div></td><td>An implementation-independent statement of security needs for a TOE type complementary to one or more Base Protection Profiles.</td></tr><tr><td><div id="Security_Assurance_Requirement">Security Assurance Requirement (SAR)</div></td><td>A requirement to assure the security of the TOE.</td></tr><tr><td><div id="Security_Functional_Requirement">Security Functional Requirement (SFR)</div></td><td>A requirement for security enforcement by the TOE.</td></tr><tr><td><div id="Security_Target">Security Target (ST)</div></td><td>A set of implementation-dependent security requirements for a specific product.</td></tr><tr><td><div id="TOE_Security_Functionality">TOE Security Functionality (TSF)</div></td><td>The security functionality of the product under evaluation.</td></tr><tr><td><div id="TOE_Summary_Specification">TOE Summary Specification (TSS)</div></td><td>A description of how a TOE satisfies the SFRs in an ST.</td></tr><tr><td><div id="Target_of_Evaluation">Target of Evaluation (TOE)</div></td><td>The product under evaluation. </td></tr></table><h3 id="tech-terms" data-level="2" class="indexable">1.3.2 Technical Terms</h3><table><tr><td><div id="Administrator">Administrator</div></td><td>
        A user that has administrative privilege to configure the TOE in privileged
        mode. </td></tr><tr><td><div id="Authorized">Authorized</div></td><td>
        An entity granted access privileges to an object, system or system entity.
      </td></tr><tr><td><div id="Critical_Security_Parameter">Critical Security Parameter (CSP)</div></td><td>
        Security related information, e.g. secret and private cryptographic keys, and
        authentication data such as passwords and PINs, whose disclosure or
        modification can compromise the security of a cryptographic module. </td></tr><tr><td><div id="Entropy_Source">Entropy Source</div></td><td>
        This cryptographic function provides a seed for a random number generator
        by accumulating the outputs from one or more noise sources. The
        functionality includes a measure of the minimum work required to guess a
        given output and tests to ensure that the noise sources are operating
        properly.
      </td></tr><tr><td><div id="IT_Environment">IT Environment</div></td><td>
        Hardware and software that are outside the TOE boundary that support the
        TOE functionality and security policy. </td></tr><tr><td><div id="Operational_Environment">Operational Environment</div></td><td>
        The environment in which the TOE is operated.</td></tr><tr><td><div id="Private_Network">Private Network</div></td><td>
        A network that is protected from access by unauthorized users or entities.
      </td></tr><tr><td><div id="Privileged_Mode">Privileged Mode</div></td><td>
        A TOE operational mode that allows a user to perform functions that require
        IT Environment administrator privileges.
      </td></tr><tr><td><div id="Public_Network">Public Network</div></td><td>
        A network that is visible to all users and entities and does not protect against
        unauthorized access (e.g. internet).
      </td></tr><tr><td><div id="Threat_Agent">Threat Agent</div></td><td>
        An entity that tries to harm an information system through destruction,
        disclosure, modification of data, and/or denial of service.</td></tr><tr><td><div id="Unauthorized_User">Unauthorized User</div></td><td>
        An entity (device or user) who has not been authorized by an authorized
        administrator to access the TOE or private network.
      </td></tr><tr><td><div id="Unprivileged_Mode">Unprivileged Mode</div></td><td>
        A TOE operational mode that only provides VPN client functions for the VPN
        Client user. </td></tr><tr><td><div id="VPN_Client">VPN Client</div></td><td>
        The TOE; allows remote users to use client computers to establish an
        encrypted IPsec tunnel across an unprotected public network to a private
        network.
      </td></tr><tr><td><div id="VPN_Client_User">VPN Client User</div></td><td>
        A user operating the TOE in unprivileged mode.</td></tr><tr><td><div id="VPN_Gateway">VPN Gateway</div></td><td>
        A component that performs encryption and decryption of IP packets as they
        cross the boundary between a private network and a public network. </td></tr></table><h1 id="sfr" data-level="0" class="indexable">2 Evaluation Activities for SFRs</h1><p>The EAs presented in this section capture the actions the evaluator performs 
    to address technology specific aspects covering specific SARs (e.g. ASE_TSS.1, 
    ADV_FSP.1, AGD_OPE.1, and ATE_IND.1) – this is in addition to the CEM work units 
    that are performed in Section <a class="dynref" href="#sar_aas"> 3 Evaluation Activities for SARs</a>.</p><p>Regarding design descriptions (designated by the subsections labelled TSS, as 
    well as any required supplementary material that may be treated as proprietary), 
    the evaluator must ensure there is specific information that satisfies the EA. 
    For findings regarding the TSS section, the evaluator’s verdicts will be 
    associated with the CEM work unit ASE_TSS.1-1.
    Evaluator verdicts associated with the supplementary evidence will also be 
    associated with ASE_TSS.1-1, 
    since the requirement to provide such evidence is specified in ASE in the PP.</p><p>For ensuring the guidance documentation provides sufficient information for 
    the administrators/users as it pertains to SFRs, the evaluator’s verdicts will 
    be associated with CEM work units ADV_FSP.1-7, AGD_OPE.1-4, and AGD_OPE.1-5.</p><p>Finally, the subsection labelled Tests is where the authors have determined 
    that testing of the product in the context of the associated SFR is necessary.
    While the evaluator is expected to develop tests, there may be instances where 
    it is more practical for the developer to construct tests, or where the 
    developer may have existing tests. 
    Therefore, it is acceptable for the evaluator to witness developer-generated 
    tests in lieu of executing the tests. 
    In this case, the evaluator must ensure the developer’s tests are executing both 
    in the manner declared by the developer and as mandated by the EA. 
    The CEM work units that are associated with the EAs specified in this section 
    are: ATE_IND.1-3, ATE_IND.1-4, ATE_IND.1-5, ATE_IND.1-6, and ATE_IND.1-7.</p><h2 data-level="1" id="aa-$OS" class="indexable">2.1 
    Protection Profile for General Purpose Operating Systems</h2>
      The EAs defined in this section are only applicable in cases where the TOE claims conformance
      to a PP-Configuration that includes the OS PP.
     <h3 data-level="2" id="qq-sfrs-OS-Modified" class="indexable">2.1.1 Modified SFRs
        </h3>
        
        The SFRs listed in this section are defined in the GPOS PP and relevant to the secure operation of the
        VPN client. It is necessary for the ST author to complete selections and/or assignments for these SFRs in
        a specific manner in order to ensure that the functionality provided by the OS is consistent with the
        functionality required by the VPN client in order for it to conform to this PP-Module. 
        
        <h3 id="os-m-fcs" data-level="3" class="indexable,h3">2.1.1.1 Cryptographic Support (FCS)</h3><div id="OS-FCS-CKM-1" class="comp"><h4>FCS_CKM.1 Cryptographic Key Generation</h4></div><div id="OS-FCS-CKM-2" class="comp"><h4>FCS_CKM.2 Cryptographic Key Establishment</h4></div><div id="OS-FCS-COP-1-1" class="comp"><h4>FCS_COP.1/1 Cryptographic Operation (Encryption and Decryption)</h4></div>
      <h3 data-level="2" id="qq-sfrs-OS-Additional" class="indexable">2.1.2 Additional SFRs
        </h3>
        This section lists additional SFRs that must be added to the TOE boundary in order to implement the
        functionality in any PP-Configuration where the GPOS PP is claimed as the Base-PP.

        <h3 id="os-a-fcs" data-level="3" class="indexable,h3">2.1.2.1 Cryptographic Support (FCS)</h3><div id="OS-FCS-CKM-EXT-2" class="comp"><h4>FCS_CKM_EXT.2 Cryptographic Key Storage</h4></div>

        <h3 id="os-a-fia" data-level="3" class="indexable,h3">2.1.2.2 Identification and Authentication (FIA)</h3><div id="OS-FIA-X509-EXT-3" class="comp"><h4>FIA_X509_EXT.3 X.509 Certificate Use and Management</h4></div>

        <h3 id="os-a-ftp" data-level="3" class="indexable,h3">2.1.2.3 Trusted Path/Channels (FTP)</h3><div id="OS-FTP-ITC-1" class="comp"><h4>FTP_ITC.1 Inter-TSF Trusted Channel</h4></div>
      <h2 data-level="1" id="aa-$MD" class="indexable">2.2 
    Protection Profile for Mobile Device Fundamentalss</h2>
      The EAs defined in this section are only applicable in cases where the TOE claims conformance
      to a PP-Configuration that includes the MD PP.
     <h3 data-level="2" id="qq-sfrs-MD-Modified" class="indexable">2.2.1 Modified SFRs
        </h3>
        <h3 id="md-m-fcs" data-level="3" class="indexable,h3">2.2.1.1 Cryptographic Support (FCS)</h3><div id="MD-FCS-CKM-1" class="comp"><h4>FCS_CKM.1 Cryptographic Key Generation</h4></div><div id="MD-FCS-CKM-2-1" class="comp"><h4>FCS_CKM.2/1 Cryptographic Key Establishment</h4></div><div id="MD-FCS-COP-1-1" class="comp"><h4>FCS_COP.1/1 Cryptographic Operation</h4></div>
        
        <h3 id="md-m-fia" data-level="3" class="indexable,h3">2.2.1.2 Identification and Authentication (FIA)</h3><div id="MD-FIA-X509-EXT-2" class="comp"><h4>FIA_X509_EXT.2 X.509 Certificate Authentication</h4></div>
        
        <h3 id="md-m-ftp" data-level="3" class="indexable,h3">2.2.1.3 Trusted Path/Channels (FTP)</h3><div id="MD-FTP-ITC-EXT-1" class="comp"><h4>FTP_ITC_EXT.1 Trusted Channel Communication</h4></div>
      <h2 data-level="1" id="aa-$App" class="indexable">2.3 
    Protection Profile for Application Softwares</h2>
      The EAs defined in this section are only applicable in cases where the TOE claims conformance
      to a PP-Configuration that includes the App PP.
     <h3 data-level="2" id="qq-sfrs-App-Modified" class="indexable">2.3.1 Modified SFRs
        </h3>
        The SFRs listed in this section are defined in the App PP and relevant to the secure operation of the VPN
        client. It is necessary for the ST author to complete selections and/or assignments for these SFRs in a
        specific manner in order to ensure that the functionality provided by the application is consistent with
        the functionality required by the VPN client in order for it to conform to this PP-Module.
        
        <h3 id="ap-m-fcs" data-level="3" class="indexable,h3">2.3.1.1 Cryptographic Support (FCS)</h3><div id="AP-FCS-CKM-1-1" class="comp"><h4>FCS_CKM.1/1 Cryptographic Asymmetric Key Generation</h4></div><div id="AP-FCS-CKM-2" class="comp"><h4>FCS_CKM.2 Cryptographic Key Establishment</h4></div><div id="AP-FCS-CKM-EXT-1" class="comp"><h4>FCS_CKM_EXT.1 Cryptographic Key Generation Services</h4></div><div id="AP-FCS-COP-1-1" class="comp"><h4>FCS_COP.1/1 Cryptographic Operation</h4></div>
        
          <h3 id="ap-m-fia" data-level="3" class="indexable,h3">2.3.1.2 Identification and Authentication (FIA)</h3><div id="AP-FIA-X509-EXT-2" class="comp"><h4>FIA_X509_EXT.2 X.509 Certificate Authentication</h4></div>
        
          <h3 id="ap-m-ftp" data-level="3" class="indexable,h3">2.3.1.3 Trusted Path/Channels (FTP)</h3><div id="AP-FTP-DIT-EXT-1" class="comp"><h4>FTP_DIT_EXT.1 Protection of Data in Transit</h4></div>
      <h3 data-level="2" id="qq-sfrs-App-Additional" class="indexable">2.3.2 Additional SFRs
        </h3>
        This section lists additional SFRs that must be added to the TOE boundary in order to implement the
        functionality in any PP-Configuration where the App PP is claimed as the Base-PP.

        <h3 id="md-a-fcs" data-level="3" class="indexable,h3">2.3.2.1 Cryptographic Support (FCS)</h3><div id="AP-FCS-CKM-EXT-2" class="comp"><h4>FCS_CKM_EXT.2 Cryptographic Key Storage</h4></div><div id="AP-FCS-CKM-EXT-4" class="comp"><h4>FCS_CKM_EXT.4 Cryptographic Key Destruction</h4></div>
      <h2 data-level="1" id="aa-$MD" class="indexable">2.4 
    Protection Profile for Mobile Device Fundamentalss</h2>
      The EAs defined in this section are only applicable in cases where the TOE claims conformance
      to a PP-Configuration that includes the MD PP.
     <h3 data-level="2" id="qq-sfrs-MD-Modified" class="indexable">2.4.1 Modified SFRs
        </h3>
        The SFRs listed in this section are defined in the MDM PP and relevant to the secure operation of the
        VPN client. It is necessary for the ST author to complete selections and/or assignments for these SFRs in
        a specific manner in order to ensure that the functionality provided by the application is consistent with
        the functionality required by the VPN client in order for it to conform to this PP-Module.
        
        <h3 id="dm-m-fcs" data-level="3" class="indexable,h3">2.4.1.1 Cryptographic Support (FCS)</h3><div id="DM-FCS-CKM-1" class="comp"><h4>FCS_CKM.1 Cryptographic Key Generation</h4></div><div id="DM-FCS-CKM-2" class="comp"><h4>FCS_CKM.2 Cryptographic Key Establishment</h4></div><div id="DM-FCS-COP-1-1" class="comp"><h4>FCS_COP.1/1 Cryptographic Operation</h4></div>
        
        <h3 id="dm-m-fia" data-level="3" class="indexable,h3">2.4.1.2 Identification and Authentication (FIA)</h3><div id="DM-FIA-X509-EXT-2" class="comp"><h4>FIA_X509_EXT.2 X.509 Certificate Authentication</h4></div>
        
        <h3 id="dm-m-ftp" data-level="3" class="indexable,h3">2.4.1.3 Trusted Path/Channels (FTP)</h3><div id="DM-FTP-ITT-1-1" class="comp"><h4>FTP_ITT.1/1 Basic Internal TSF Data Transfer Protection</h4></div><div id="DM-FTP-ITC-1-1" class="comp"><h4>FTP_ITC.1/1  Inter-TSF Trusted Channel (Authorized IT Entities)</h4></div><div id="DM-FTP-TRP-1-1" class="comp"><h4>FTP_TRP.1/1 Trusted Path (for Remote Administration)</h4></div>
      <h2 data-level="1" id="man-sfrs" class="indexable">2.5 TOE SFR Evaluation Activities</h2><h2 id="m-fcs" data-level="2" class="indexable,h2">2.5.1 Cryptographic Support (FCS)</h2><div id="FCS-CKM-1-VPN" class="comp"><h4>FCS_CKM.1/1 VPN Cryptographic Key Generation (IKE)</h4></div><div id="FCS-IPSEC-EXT-1" class="comp"><h4>FCS_IPSEC_EXT.1 IPsec</h4>
		
		
		
			
			<div class="eacategory">TSS</div>
			In addition to the TSS EAs for the individual FCS_IPSEC_EXT.1 elements below, the evaluator shall perform
			the following:<p></p>
			If the TOE boundary includes a general-purpose operating system or mobile device, the evaluator shall
			examine the TSS to ensure that it describes whether the VPN client capability is architecturally integrated
			with the platform itself or whether it is a separate executable that is bundled with the platform.<p></p>
		<div class="eacategory">Guidance</div>
			In addition to the Operational Guidance EAs for the individual FCS_IPSEC_EXT.1 elements below, the
			evaluator shall perform the following:<p></p>
			If the configuration of the IPsec behavior is from an environmental source, most notably a VPN gateway
			(e.g through receipt of required connection parameters from a VPN gateway), the evaluator shall ensure
			that the operational guidance contains any appropriate information for ensuring that this configuration
			can be properly applied.<p></p>
			Note in this case that the implementation of the IPsec protocol must be enforced entirely within the TOE
			boundary; i.e. it is not permissible for a software application TOE to be a graphical front-end for IPsec
			functionality implemented totally or in part by the underlying OS platform. The behavior referenced here
			is for the possibility that the configuration of the IPsec connection is initiated from outside the TOE, which
			is permissible so long as the TSF is solely responsible for enforcing the configured behavior. However, it is
			allowable for the TSF to rely on low-level platform-provided networking functions to implement the SPD
			from the client (e.g., enforcement of packet routing decisions).<p></p>
		<div class="eacategory">Tests</div>
			As a prerequisite for performing the Test EAs for the individual FCS_IPSEC_EXT.1 elements below, the
			evaluator shall do the following:<p></p>
			The evaluator shall minimally create a test environment equivalent to the test environment illustrated
			below. It is expected that the traffic generator is used to construct network packets and will provide the
			evaluator with the ability manipulate fields in the ICMP, IPv4, IPv6, UDP, and TCP packet headers. The
			evaluator shall provide justification for any differences in the test environment.<p></p>

   			


   			Note that the evaluator shall perform all tests using the VPN client and a representative sample of
			platforms listed in the ST (for TOEs that claim to support multiple platforms).
		<h4>Element: FCS_IPSEC_EXT.1.1</h4> 
                  
              
              
            <div class="eacategory">TSS</div>The evaluator shall examine the TSS and determine that it describes how the IPsec capabilities are
				implemented.<p></p>

                If the TOE is a standalone software application, the evaluator shall ensure that the TSS asserts that all
				IPsec functionality is implemented by the TSF. The evaluator shall also ensure that the TSS identifies what
				platform functionality the TSF relies upon to support its IPsec implementation, if any (e.g. does it invoke
				cryptographic primitive functions from the platform’s cryptographic library, enforcement of packet
				routing decisions by low-level network drivers).<p></p>

                If the TOE is part of a general-purpose desktop or mobile operating system, the evaluator shall ensure
				that the TSS describes at a high level the architectural relationship between the VPN client portion of the
				TOE and the rest of the TOE (e.g. is the VPN client an integrated part of the OS or is it a standalone
				executable that is bundled into the OS package). If the SPD is implemented by the underlying platform in
				this case, then the TSS describes how the client interacts with the platform to establish and populate the
				SPD, including the identification of the platform's interfaces that are used by the client.<p></p>
		    
				In all cases, the evaluator shall also ensure that the TSS describes how the client interacts with the network
				stack of the platform(s) on which it can run (e.g., does the client insert itself within the stack via kernel
				mods, does the client simply invoke APIs to gain access to network services).<p></p>
		      
				The evaluator shall ensure that the TSS describes how the SPD is implemented and the rules for processing
				both inbound and outbound packets in terms of the IPsec policy. The TSS describes the rules that are
				available and the resulting actions available after matching a rule. The TSS describes how the available
				rules and actions form the SPD using terms defined in RFC 4301 such as BYPASS (e.g., no encryption),
				DISCARD (e.g., drop the packet), and PROTECT (e.g., encrypt the packet) actions defined in RFC 4301.
			  
				As noted in section 4.4.1 of RFC 4301, the processing of entries in the SPD is non-trivial and the evaluator
				shall determine that the description in the TSS is sufficient to determine which rules will be applied given
				the rule structure implemented by the TOE. For example, if the TOE allows specification of ranges,
				conditional rules, etc., the evaluator shall determine that the description of rule processing (for both
				inbound and outbound packets) is sufficient to determine the action that will be applied, especially in the
				case where two different rules may apply. This description shall cover both the initial packets (that is, no
				SA is established on the interface or for that particular packet) as well as packets that are part of an
				established SA. <p></p>
			<div class="eacategory">Guidance</div>
                The evaluator shall examine the operational guidance to verify it describes how the SPD is created and
		configured. If there is an administrative interface to the client, then the guidance describes how the
		administrator specifies rules for processing a packet. The description includes all three cases - a rule that
		ensures packets are encrypted/decrypted, dropped, and allowing a packet to flow in plaintext. The
		evaluator shall determine that the description in the operational guidance is consistent with the
		description in the TSS, and that the level of detail in the operational guidance is sufficient to allow the
		administrator to set up the SPD in an unambiguous fashion. This includes a discussion of how ordering of
		rules impacts the processing of an IP packet.<p></p>

                If the client is configured by an external application, such as the VPN gateway, then the operational
		guidance should indicate this and provide a description of how the client is configured by the external
		application. The description should contain information as to how the SPD is established and set up in an
		unambiguous fashion. The description should also include what is configurable via the external
		application, how ordering of entries may be expressed, as well as the impacts that ordering of entries may
		have on the packet processing.<p></p>

               	In either case, the evaluator ensures the description provided In the TSS is consistent with the capabilities
		and description provided in the operational guidance.<p></p>
              <div class="eacategory">Tests</div>
                Depending on the implementation, the evaluator may be required to use a VPN gateway or some form of
		application to configure the client. For Test 2, the evaluator is required to choose an application that
		allows for the configuration of the full set of capabilities of the VPN client (in conjunction with the
		platform). For example, if the client provides a robust interface that allows for specification of wildcards,
		subnets, etc., it is unacceptable for the evaluator to choose a VPN Gateway that only allows for specifying
		a single fully qualified IP addresses in the rule.<p></p>

                The evaluator shall perform the following tests:
                <ul>
                  <li><b>Test 1: </b>: The evaluator shall configure an SPD on the client that is capable of the following: dropping a
			packet, encrypting a packet, and allowing a packet to flow in plaintext. The selectors used in the
			construction of the rule shall be different such that the evaluator can generate a packet and send packets
			to the client with the appropriate fields (fields that are used by the rule - e.g., the IP addresses, TCP/UDP
			ports) in the packet header. The evaluator performs both positive and negative test cases for each type
			of rule. The evaluator observes via the audit trail, and packet captures that the TOE exhibited the expected
			behavior: appropriate packets were dropped, allowed through without modification, was encrypted by
			the IPsec implementation.</li>
                  <li><b>Test 2: </b>The evaluator shall devise several tests that cover a variety of scenarios for packet processing.
			These scenarios must exercise the range of possibilities for SPD entries and processing modes as outlined
			in the TSS and operational guidance. Potential areas to cover include rules with overlapping ranges and
			conflicting entries, inbound and outbound packets, and packets that establish SAs as well as packets that
			belong to established SAs. The evaluator shall verify, via the audit trail and packet captures, for each
			scenario that the expected behavior is exhibited, and is consistent with both the TSS and the operational
			guidance.
                  </li>
                </ul>
              <h4>Element: FCS_IPSEC_EXT.1.2</h4>
              
              
              
            <div class="eacategory">TSS</div>The evaluator shall check the TSS to ensure it states that the VPN can be established to operate in tunnel
			mode and/or transport mode (as selected). <p></p><div class="eacategory">Guidance</div>The evaluator shall confirm that the operational guidance contains instructions on how to configure the
			connection in each mode selected.<p></p>
		      If both transport mode and tunnel mode are implemented, the evaluator shall review the operational
			guidance to determine how the use of a given mode is specified.<p></p>
              <div class="eacategory">Tests</div>The evaluator shall perform the following test(s) based on the selections chosen:
              <ul>
                <li><b>Test 1: </b> [conditional]: If tunnel mode is selected, the evaluator uses the operational guidance to configure
			the TOE to operate in tunnel mode and also configures a VPN gateway to operate in tunnel mode. The
			evaluator configures the TOE and the VPN gateway to use any of the allowable cryptographic algorithms, 
			authentication methods, etc. to ensure an allowable SA can be negotiated. The evaluator shall then
			initiate a connection from the client to connect to the VPN GW peer. The evaluator observes (for example,
			in the audit trail and the captured packets) that a successful connection was established using the tunnel
			mode.</li>
                <li><b>Test 2: </b>[conditional]: If transport mode is selected, the evaluator uses the operational guidance to
			configure the TOE to operate in transport mode and also configures an IPsec peer to accept IPsec
			connections using transport mode. The evaluator configures the TOE and the endpoint device to use any
			of the allowed cryptographic algorithms, authentication methods, etc. to ensure an allowable SA can be
			negotiated. The evaluator then initiates a connection from the TOE to connect to the remote endpoint.
			The evaluator observes (for example, in the audit trail and the captured packets) that a successful
			connection was established using the transport mode.
		</li>
                <li><b>Test 3: </b> [conditional]: If both tunnel mode and transport mode are selected, the evaluator shall perform
			both Test 1 and Test 2 above, demonstrating that the TOE can be configured to support both modes.</li>
                <li><b>Test 4: </b> [conditional]: If both tunnel mode and transport mode are selected, the evaluator shall modify the
			testing for FCS_IPSEC_EXT.1 to include the supported mode for SPD PROTECT entries to show that they
			only apply to traffic that is transmitted or received using the indicated mode.
                </li>
              </ul>
              <h4>Element: FCS_IPSEC_EXT.1.3</h4>
              
              
              
            <div class="eacategory">TSS</div>The evaluator shall examine the TSS to verify that the TSS provides a description of how a packet is
		processed against the SPD and that if no “rules” are found to match, that a final rule exists, either implicitly
		or explicitly, that causes the network packet to be discarded.<p></p>
              <div class="eacategory">Guidance</div>The evaluator shall check that the operational guidance provides instructions on how to construct or
		acquire the SPD and uses the guidance to configure the TOE for the following test.<p></p><div class="eacategory">Tests</div>The evaluator shall perform the following test:<p></p>
		      <ul>
			      <li><b>Test 1: </b>
		     		The evaluator shall configure the SPD such that it has entries that contain operations that DISCARD,
				PROTECT, and (if applicable) BYPASS network packets. The evaluator may use the SPD that was created
				for verification of FCS_IPSEC_EXT.1.1. The evaluator shall construct a network packet that matches a
				BYPASS entry and send that packet. The evaluator should observe that the network packet is passed to
				the proper destination interface with no modification. The evaluator shall then modify a field in the packet
				header; such that it no longer matches the evaluator-created entries (there may be a “TOE-created” final
				entry that discards packets that do not match any previous entries). The evaluator sends the packet, and
				observes that the packet was not permitted to flow to any of the TOE’s interfaces.
			      </li>
		      </ul>
	     <h4>Element: FCS_IPSEC_EXT.1.4</h4>
              
              
              
            <div class="eacategory">TSS</div>The evaluator shall examine the TSS to verify that the algorithms AES-GCM-128 and AES-GCM-256 are
		implemented. If the ST author has selected either AES-CBC-128 or AES-CBC-256 in the requirement, then
		the evaluator verifies the TSS describes these as well. In addition, the evaluator ensures that the SHA-
		based HMAC algorithm conforms to the algorithms specified in the relevant iteration of FCS_COP.1 from
		the Base-PP that applies to keyed-hash message authentication.<p></p><div class="eacategory">Guidance</div>The evaluator checks the operational guidance to ensure it provides instructions on how the TOE is
		configured to use the algorithms selected in this component and whether this is performed through direct
		configuration, defined during initial installation, or defined by acquiring configuration settings from an
		environmental component.<p></p>
              <div class="eacategory">Tests</div>
		      <ul>
			      <li><b>Test 1: </b>
				      The evaluator shall configure the TOE as indicated in the operational guidance configuring the TOE
					to using each of the AES-GCM-128, and AES-GCM-256 algorithms, and attempt to establish a connection
					using ESP. If the ST Author has selected either AES-CBC-128 or AES-CBC-256, the TOE is configured to use
					those algorithms and the evaluator attempts to establish a connection using ESP for those algorithms
					selected.
			      </li>
		      </ul>
              <h4>Element: FCS_IPSEC_EXT.1.5</h4>
              
              
              
            <div class="eacategory">TSS</div>The evaluator shall examine the TSS to verify that IKEv1 and/or IKEv2 are implemented. If IKEv1 is
		implemented, the evaluator shall verify that the TSS indicates whether or not XAUTH is supported, and
		that aggressive mode is not used for IKEv1 Phase 1 exchanges (i.e. only main mode is used). It may be that
		these are configurable options.<p></p>
              <div class="eacategory">Guidance</div>The evaluator shall check the operational guidance to ensure it instructs the administrator how to
		configure the TOE to use IKEv1 and/or IKEv2 (as selected), and uses the guidance to configure the TOE to
		perform NAT traversal for the test below. If XAUTH is implemented, the evaluator shall verify that the
		operational guidance provides instructions on how it is enabled or disabled. <p></p>
                If the TOE supports IKEv1, the evaluator shall verify that the operational guidance either asserts that only
		main mode is used for Phase 1 exchanges, or provides instructions for disabling aggressive mode.<p></p>
		<div class="eacategory">Tests</div>
                <ul>
                  <li><b>Test 1: </b>The evaluator shall configure the TOE so that it will perform NAT traversal processing as described
			in the TSS and RFC 7296, section 2.23. The evaluator shall initiate an IPsec connection and determine that
			the NAT is successfully traversed. If the TOE supports IKEv1 with or without XAUTH, the evaluator shall
			verify that this test can be successfully repeated with XAUTH enabled and disabled in the manner specified
			by the operational guidance. If the TOE only supports IKEv1 with XAUTH, the evaluator shall verify that
			connections not using XAUTH are unsuccessful. If the TOE only supports IKEv1 without XAUTH, the
			evaluator shall verify that connections using XAUTH are unsuccessful.</li>
                  <li><b>Test 2: </b> [conditional]: If the TOE supports IKEv1, the evaluator shall perform any applicable operational
			guidance steps to disable the use of aggressive mode and then attempt to establish a connection using an
			IKEv1 Phase 1 connection in aggressive mode. This attempt should fail. The evaluator shall show that the
			TOE will reject a VPN gateway from initiating an IKEv1 Phase 1 connection in aggressive mode. The
			evaluator should then show that main mode exchanges are supported.</li>
                </ul>
              <h4>Element: FCS_IPSEC_EXT.1.6</h4>
              
              
              
            <div class="eacategory">TSS</div>The evaluator shall ensure the TSS identifies the algorithms used for encrypting the IKEv1 and/or IKEv2
		payload, and that the algorithms AES-CBC-128, AES-CBC-256 are specified, and if others are chosen in the
		selection of the requirement, those are included in the TSS discussion.<p></p><div class="eacategory">Guidance</div>The evaluator checks the operational guidance to ensure it provides instructions on how the TOE is
		configured to use the algorithms selected in this component and whether this is performed through direct
		configuration, defined during initial installation, or defined by acquiring configuration settings from an
		environmental component.  <p></p>
              <div class="eacategory">Tests</div>The evaluator shall use the operational guidance to configure the TOE (or to configure the Operational
		Environment to have the TOE receive configuration) to perform the following test for each ciphersuite
		selected:<p></p>
		<ul>
			<li><b>Test 1: </b>
               			The evaluator shall configure the TOE to use the ciphersuite under test to encrypt the IKEv1 and/or
				IKEv2 payload and establish a connection with a peer device, which is configured to only accept the
				payload encrypted using the indicated ciphersuite. The evaluator will confirm the algorithm was that used
				in the negotiation. The evaluator will confirm that the connection is successful by confirming that data
				can be passed through the connection once it is established. For example, the evaluator may connect to
				a webpage on the remote network and verify that it can be reached.
			</li>
	         </ul>
              <h4>Element: FCS_IPSEC_EXT.1.7</h4>
              
              
              
            <div class="eacategory">TSS</div>There are no TSS EAs for this requirement.<p></p><div class="eacategory">Guidance</div>The evaluator shall check the operational guidance to ensure it provides instructions on how the TOE
		configures the values for SA lifetimes. In addition, the evaluator shall check that the guidance has the
		option for either the Administrator or VPN Gateway to configure Phase 1 SAs if time-based limits are
		supported. Currently there are no values mandated for the number of packets or number of bytes, the
		evaluator shall simply check the operational guidance to ensure that this can be configured if selected in
		the requirement.<p></p><div class="eacategory">Tests</div>When testing this functionality, the evaluator needs to ensure that both sides are configured
		appropriately. From the RFC “A difference between IKEv1 and IKEv2 is that in IKEv1 SA lifetimes were
		negotiated. In IKEv2, each end of the SA is responsible for enforcing its own lifetime policy on the SA and
		rekeying the SA when necessary. If the two ends have different lifetime policies, the end with the shorter
		lifetime will end up always being the one to request the rekeying. If the two ends have the same lifetime
		policies, it is possible that both will initiate a rekeying at the same time (which will result in redundant
		SAs). To reduce the probability of this happening, the timing of rekeying requests SHOULD be jittered.”<p></p>
		Each of the following tests shall be performed for each version of IKE selected in the FCS_IPSEC_EXT.1.5
		protocol selection:<p></p>
                Each of the following tests shall be performed for each version of IKE selected in the
                FCS_IPSEC_EXT.1.5 protocol selection:
              <ul>
                <li><b>Test 1: </b> [conditional]: The evaluator shall configure a maximum lifetime in terms of the # of packets (or
			bytes) allowed following the operational guidance. The evaluator shall establish an SA and determine that
			once the allowed # of packets (or bytes) through this SA is exceeded, the connection is closed.</li>
                <li><b>Test 2: </b> [conditional]: The evaluator shall construct a test where a Phase 1 SA is established and attempted
			to be maintained for more than 24 hours before it is renegotiated. The evaluator shall observe that this
			SA is closed or renegotiated in 24 hours or less. If such an action requires that the TOE be configured in a
			specific way, the evaluator shall implement tests demonstrating that the configuration capability of the
			TOE works as documented in the operational guidance.</li>
                <li><b>Test 3: </b> [conditional]: The evaluator shall perform a test similar to Test 2 for Phase 2 SAs, except that the
			lifetime will be 8 hours or less instead of 24 hours or less.</li>
                <li><b>Test 4: </b> [conditional]: If a fixed limit for IKEv1 SAs is supported, the evaluator shall establish an SA and
			observe that the connection is closed after the fixed traffic and/or time value is reached.</li>
              </ul>
              <h4>Element: FCS_IPSEC_EXT.1.8</h4>
              
              
              
            <div class="eacategory">TSS</div>The evaluator shall check to ensure that the DH groups specified in the requirement are listed as being
		supported in the TSS. If there is more than one DH group supported, the evaluator checks to ensure the
		TSS describes how a particular DH group is specified/negotiated with a peer.<p></p><div class="eacategory">Guidance</div>There are no AGD EAs for this requirement.<p></p><div class="eacategory">Tests</div>The evaluator shall perform the following test: 
		      <ul>
			      <li><b>Test 1: </b>For each supported DH group, the evaluator shall test to ensure that all supported IKE 
				      protocols can be successfully completed using that particular DH group.
			      </li>
		      </ul>
		<h4>Element: FCS_IPSEC_EXT.1.9</h4>
              
              
              
            <div class="eacategory">TSS</div>The evaluator shall check to ensure that, for each DH group supported, the TSS describes the process for
		generating "x" (as defined in FCS_IPSEC_EXT.1.9) and each nonce. The evaluator shall verify that the TSS
		indicates that the random number generated that meets the requirements in this EP is used, and that the
		length of "x" and the nonces meet the stipulations in the requirement.<p></p><div class="eacategory">Guidance</div>There are no AGD EAs for this requirement.<p></p><div class="eacategory">Tests</div>There are no test EAs for this requirement.<h4>Element: FCS_IPSEC_EXT.1.10</h4>
              EAs for this element are tested through EAs for FCS_IPSEC_EXT.1.9.
              
            <i></i><h4>Element: FCS_IPSEC_EXT.1.11</h4>
              
              
              
            <div class="eacategory">TSS</div>The evaluator ensures that the TSS identifies RSA and/or ECDSA as being used to perform peer
		authentication.<p></p>
                If pre-shared keys are chosen in the selection, the evaluator shall check to ensure that the TSS describes
		how pre-shared keys are established and used in authentication of IPsec connections. The description in
		the TSS shall also indicate how pre-shared key establishment is accomplished depending on whether the
		TSF can generate a pre-shared key, accept a pre-shared key, or both.<p></p>
                The evaluator shall ensure that the TSS describes how the TOE compares the peer’s presented identifier
		to the reference identifier. This description shall include whether the certificate presented identifier is
		compared to the ID payload presented identifier, which field(s) of the certificate are used as the presented
		identifier (DN, Common Name, or SAN) and, if multiple fields are supported, the logical order comparison.
		If the ST author assigned an additional identifier type, the TSS description shall also include a description
		of that type and the method by which that type is compared to the peer’s presented certificate.<p></p><div class="eacategory">Guidance</div>The evaluator shall check that the operational guidance describes how pre-shared keys are to be
		generated and established. <p></p>
                The evaluator ensures the operational guidance describes how to set up the TOE to use the cryptographic
		algorithms RSA and/or ECDSA.<p></p>
               In order to construct the environment and configure the TOE for the following tests, the evaluator will
		ensure that the operational guidance also describes how to configure the TOE to connect to a trusted CA,
		and ensure a valid certificate for that CA is loaded into the TOE as a trusted CA.<p></p>
		The evaluator shall also ensure that the operational guidance includes the configuration of the reference
		identifier(s) for the peer.<p></p><div class="eacategory">Tests</div>For efficiency’s sake, the testing that is performed here has been combined with the testing for
		      <b>FIA_X509_EXT.2</b> and <b>FIA_X509_EXT.3</b> (for IPsec connections and depending on the Base-PP),
		      <b>FCS_IPSEC_EXT.1.12</b>, and <b>FCS_IPSEC_EXT.1.13</b>. The following tests shall be repeated for each peer
		      authentication protocol selected in the <b>FCS_IPSEC_EXT.1.11</b> selection above:
              <ul>
                <li><b>Test 1: </b>The evaluator shall have the TOE generate a public-private key pair, and submit a CSR (Certificate
			Signing Request) to a CA (trusted by both the TOE and the peer VPN used to establish a connection) for
			its signature. The values for the DN (Common Name, Organization, Organizational Unit, and Country) will
			also be passed in the request. Alternatively, the evaluator may import to the TOE a previously generated
			private key and corresponding certificate.
                </li>
                <li><b>Test 2: </b>The evaluator shall configure the TOE to use a private key and associated certificate signed by a
			trusted CA and shall establish an IPsec connection with the peer.                
		</li>
                <li><b>Test 3: </b>: The evaluator shall test that the TOE can properly handle revoked certificates – conditional on
			whether CRL or OCSP is selected; if both are selected, and then a test is performed for each method. For
			this current version of the PP-Module, the evaluator has to only test one up in the trust chain (future
			drafts may require to ensure the validation is done up the entire chain). The evaluator shall ensure that a
			valid certificate is used, and that the SA is established. The evaluator then attempts the test with a
			certificate that will be revoked (for each method chosen in the selection) to ensure when the certificate
			is no longer valid that the TOE will not establish an SA
                </li>
                <li><b>Test 4: </b> [conditional]: The evaluator shall generate a pre-shared key and use it, as indicated in the
			operational guidance, to establish an IPsec connection with the VPN GW peer. If the generation of the
			pre-shared key is supported, the evaluator shall ensure that establishment of the key is carried out for an
			instance of the TOE generating the key as well as an instance of the TOE merely taking in and using the
			key.</li>
                For each supported identifier type (excluding DNs), the evaluator shall repeat the following tests:
                <li><b>Test 5: </b> For each field of the certificate supported for comparison, the evaluator shall configure the peer’s
			reference identifier on the TOE (per the administrative guidance) to match the field in the peer’s
			presented certificate and shall verify that the IKE authentication succeeds.</li>
                <li><b>Test 6: </b>For each field of the certificate support for comparison, the evaluator shall configure the peer’s
			reference identifier on the TOE (per the administrative guidance) to not match the field in the peer’s
			presented certificate and shall verify that the IKE authentication fails.</li>
                The following tests are conditional:
                <li><b>Test 7: </b> [conditional]: If, according to the TSS, the TOE supports both Common Name and SAN certificate
			fields and uses the preferred logic outlined in the Application Note, the tests above with the Common
			Name field shall be performed using peer certificates with no SAN extension. Additionally, the evaluator
			shall configure the peer’s reference identifier on the TOE to not match the SAN in the peer’s presented
			certificate but to match the Common Name in the peer’s presented certificate, and verify that the IKE
			authentication fails.
		</li>
                <li><b>Test 8: </b> [conditional]: If the TOE supports DN identifier types, the evaluator shall configure the peer's
			reference identifier on the TOE (per the administrative guidance) to match the subject DN in the peer's
			presented certificate and shall verify that the IKE authentication succeeds. To demonstrate a bit-wise
			comparison of the DN, the evaluator shall change a single bit in the DN (preferably, in an Object Identifier
			(OID) in the DN) and verify that the IKE authentication fails. <b>To demonstrate a comparison of DN values,
			the evaluator shall change any one of the four DN values and verify that the IKE authentication fails.</b>
                </li>
                <li><b>Test 9: </b> [conditional]: If the TOE supports both IPv4 and IPv6 and supports IP address identifier types, the
			evaluator must repeat test 1 and 2 with both IPv4 address identifiers and IPv6 identifiers. Additionally,
			the evaluator shall verify that the TOE verifies that the IP header matches the identifiers by setting the
			presented identifiers and the reference identifier with the same IP address that differs from the actual IP
			address of the peer in the IP headers and verifying that the IKE authentication fails.
		</li>
                <li><b>Test 10: </b>[conditional]: If, according to the TSS, the TOE performs comparisons between the peer’s ID
			payload and the peer’s certificate, the evaluator shall repeat the following test for each combination of
			supported identifier types and supported certificate fields (as above). The evaluator shall configure the
			peer to present a different ID payload than the field in the peer’s presented certificate and verify that the
			TOE fails to authenticate the IKE peer.</li>
              </ul>
		<h4>Element: FCS_IPSEC_EXT.1.12</h4>
              EAs for this element are tested through EAs for FCS_IPSEC_EXT.1.11.
              
            <i></i><h4>Element: FCS_IPSEC_EXT.1.13</h4>
              EAs for this element are tested through EAs for FCS_IPSEC_EXT.1.11.
              
            <i></i><h4>Element: FCS_IPSEC_EXT.1.14</h4>
              
              
              
            <div class="eacategory">TSS</div>The evaluator shall check that the TSS describes the potential strengths (in terms of the number of bits in
		the symmetric key) of the algorithms that are allowed for the IKE and ESP exchanges. The TSS shall also
		describe the checks that are done when negotiating IKEv1 Phase 2 and/or IKEv2 CHILD_SA suites to ensure
		that the strength (in terms of the number of bits of key in the symmetric algorithm) of the negotiated
		algorithm is less than or equal to that of the IKE SA this is protecting the negotiation.
		<p></p><div class="eacategory">Guidance</div>There are no AGD EAs for this requirement.<p></p><div class="eacategory">Tests</div>The evaluator follows the guidance to configure the TOE to perform the following tests:
              <ul>
                <li><b>Test 1: </b>This test shall be performed for each version of IKE supported. The evaluator shall successfully
		negotiate an IPsec connection using each of the supported algorithms and hash functions identified in the
		requirements.</li>
                <li><b>Test 2: </b> [conditional]: This test shall be performed for each version of IKE supported. The evaluator shall
			attempt to establish an SA for ESP that selects an encryption algorithm with more strength than that being
			used for the IKE SA (i.e., symmetric algorithm with a key size larger than that being used for the IKE SA).
			Such attempts should fail.</li>
                <li><b>Test 3: </b>This test shall be performed for each version of IKE supported. The evaluator shall attempt to
			establish an IKE SA using an algorithm that is not one of the supported algorithms and hash functions
			identified in the requirements. Such an attempt should fail.
                </li>
                <li><b>Test 4: </b> This test shall be performed for each version of IKE supported. The evaluator shall attempt to
			establish an SA for ESP (assumes the proper parameters where used to establish the IKE SA) that selects
			an encryption algorithm that is not identified in FCS_IPSEC_EXT.1.4. Such an attempt should fail.
                </li>
              </ul>
		</div><h2 id="m-fdp" data-level="2" class="indexable,h2">2.5.2 User Data Protection (FDP)</h2><div id="FDP-RIP-2" class="comp"><h4>FDP_RIP.2 Full Residual Information Protection</h4></div><h2 id="m-fmt" data-level="2" class="indexable,h2">2.5.3 Security Management (FMT)</h2><div id="FMT-SMF-1-VPN" class="comp"><h4>FMT_SMF.1/VPN Specification of Management Functions (VPN)</h4></div><h2 id="m-fpt" data-level="2" class="indexable,h2">2.5.4 Protection of the TSF (FPT)</h2><div id="FPT-TST-EXT-1-VPN" class="comp"><h4>FPT_TST_EXT.1/VPN TSF Self-Test</h4></div><h1 data-level="1" id="opt-sfrs" class="indexable">2.6 Evaluation Activities for Optional SFRs</h1>The PP-Module does not define any optional requirements.<h1 data-level="1" id="sel-sfrs" class="indexable">2.7 Evaluation Activities for Selection-Based SFRs</h1><h2 id="s-fia" data-level="2" class="indexable,h2">2.7.1 Identification and Authentication (FIA)</h2><div id="FIA-PSK-EXT-1" class="comp"><h4>FIA_PSK_EXT.1 Pre-Shared Key Composition</h4></div><h1 data-level="1" id="obj-sfrs" class="indexable">2.8 Evaluation Activities for Objective SFRs</h1><h2 id="ob-fau" data-level="2" class="indexable,h2">2.8.1 Security Audit (FAU)</h2><div id="FAU-GEN-1-VPN" class="comp"><h4>FAU_GEN.1/VPN Audit Data Generation</h4></div><div id="FAU-SEL-1-VPN" class="comp"><h4>FAU_SEL.1/VPN Selective Audit</h4></div><h2 id="ob-fdp" data-level="2" class="indexable,h2">2.8.2 User Data Protection (FDP)</h2><div id="FDP-IFC-EXT-1" class="comp"><h4>FDP_IFC_EXT.1 Subset Information Flow Control</h4></div><h1 id="sar_aas" data-level="0" class="indexable">3 Evaluation Activities for SARs</h1><p>The PP-Module does not define any SARs beyond those defined within the
    
	base-PP to which it must claim conformance.
	It is important to note that a TOE that is evaluated against the PP-Module is
	inherently evaluated against the Base-PP as well.

	The Base-PP includes a number of Evaluation Activities associated with both SFRs and SARs.
	Additionally, the PP-Module includes a number of SFR-based Evaluation Activities 
	that similarly refine the SARs of the Base-PPs.
	The evaluation laboratory will evaluate the TOE against the chosen Base-PP
      
    and supplement that evaluation with the necessary SFRs that are taken from the PP-Module.
    </p><h1 id="sup-info" data-level="0" class="indexable">4 Required Supplementary Information</h1><p>This Supporting Document has no required supplementary information beyond the ST, operational
guidance, and testing.</p><h1 id="biblio" data-level="A" class="indexable">Appendix A -  References</h1><table><tr class="header"><th>Identifier</th><th>Title</th></tr>
    <tr><td><span id="bibCC"> [CC] </span></td><td>Common Criteria for Information Technology Security Evaluation - <ul><li><a href="http://www.commoncriteriaportal.org/files/ccfiles/CCPART1V3.1R5.pdf">Part
                1: Introduction and General Model</a>, CCMB-2017-04-001, Version 3.1 Revision 5,
              April 2017.</li><li><a href="http://www.commoncriteriaportal.org/files/ccfiles/CCPART2V3.1R5.pdf">Part
                2: Security Functional Components</a>, CCMB-2017-04-002, Version 3.1 Revision 5,
              April 2017.</li><li><a href="http://www.commoncriteriaportal.org/files/ccfiles/CCPART3V3.1R5.pdf">Part
                3: Security Assurance Components</a>, CCMB-2017-04-003, Version 3.1 Revision 5,
              April 2017.</li></ul></td></tr>
    <tr><td><span id="bibOSPP"></span>[OS PP]</td><td>
        <a href="https://www.niap-ccevs.org/Profile/Info.cfm?PPID=442&amp;id=442/">
			Protection Profile for General Purpose Operating Systems</a>, Version 4.2.1, April 2019
      </td></tr>

    <tr><td><span id="bibMDPP"></span>[MD PP]</td><td>
        <a href="https://www.niap-ccevs.org/Profile/Info.cfm?PPID=417&amp;id=417">
			Protection Profile for Mobile Device Fundamentals</a>, Version 3.1, June 2017
      </td></tr>

    <tr><td><span id="bibMDMPP"></span>[MDM PP]</td><td>
        <a href="https://www.niap-ccevs.org/Profile/Info.cfm?PPID=417&amp;id=417">
			Protection Profile for Mobile Device Management (This needs to be updated) </a>, Version 3.1, June 2017
      </td></tr>

    <tr><td><span id="bibAppPP"></span>[App PP]</td><td>
        <a href="https://www.niap-ccevs.org/Profile/Info.cfm?PPID=429&amp;id=429/">
			Protection Profile for Application Software</a>, Version 1.3, March 2019
      </td></tr>

    <tr><td><span id="bibSD"></span>[SD]</td><td>
        Supporting Document Mandatory Technical Document, PP-Module for Virtual Private Network (VPN) Clients, 
			Version 2.1, November 2019
      </td></tr>

	</table></body></html>