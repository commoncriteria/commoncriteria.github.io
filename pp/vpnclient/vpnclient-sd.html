<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html><head><title>Supporting Document - 
    PP-Module for Virtual Private Network (VPN) Clients</title><style type="text/css">
    #toc a{
        display: block;
    }

    svg{
      width: 100%;
    }

    a[id^="ajq_"]{
        color:black;
    }

    
    body{
       max-width: 900px;
       margin: auto;
    }
    #toc span{
       margin-left: 20px;
    }
    .assignable-content{
      font-style: italic;
    }
    .refinement{
      font-weight: bold;
    }
    div.eacategory{
      font-style: italic;
      font-weight: bold;
    }
    .activity_pane .toggler::after, .activity_pane .toggler{
       display: inline-block;
       height: auto;
       content: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8A\
       AAAPCAYAAAA71pVKAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAQOFAAEDhQGl\
       VDz+AAAAB3RJTUUH4gIXFDM7fhmr1wAAAfRJREFUKM+dkk9I02EYxz/P+25uurWR\
       tTkzI4NGl4jQgkq71K1DhnTQIDolRAQFQYSHTtGhU4e6eujQofBSFLOg0C4RUSjh\
       FnmqTTdKpj/mfv/eX4cUpmRYn9vz8v3w8D7PA/AWGADCbI4QcAb4AnAF8IBJEdX+\
       N0tEda40C4AHADviW1LFvpOX6+FwtAacVzqkGiWtwxo4F21OuPu7+yvxRNoDEhpY\
       cpzavkQyc7D76FCk+vN7j7VU6RdR4xAsikjGGP9FKrN3sPfEpajv2i2zhckR4JUG\
       UCr0erFavLkn2ytd2WPxcFOsZb74+SIQA0YPHBqIdB8Z6tChJv1m/N4P33OGAUsD\
       BIFxPNcOkq07jyeSbbo1tTu2q6vHEqU7D/ddSKcz2ZQJjBSmx925b9NjwEMAafha\
       eyQa/3Dq7O0243sCIEoRGAOA59nm5dM7OHVruzH+AkDjYEp23RrLT+U8Ub+fV0UR\
       oVyaMfVa9fqquF5GKX3ja2FCuc6yWbMipYNP755UgEdr8o2FMf5ivVYdKRfzRkRW\
       RfJTOc+2rWdAcUN5hdGP7x8viGgAXLvGbGFCKxW6tj74J3nOqVvP89M5V6kQ86UZ\
       f7lWvWWMt7Sp41VKb21uSfqnB++6kWi8BLTzL4ioq7H4tgC4z3/QAZSBxEaBXygN\
       v+jeFnAPAAAAAElFTkSuQmCC');
       max-width: 15px;
    }


    a {
      text-decoration: none;
      word-wrap: break-word;
    }
    a.abbr:link{
      color:black;
      text-decoration:none;
    }
    a.abbr:visited{
      color:black;
      text-decoration:none;
    }
    a.abbr:hover{
      color:blue;
      text-decoration:none;
    }
    a.abbr:hover:visited{
      color:purple;
      text-decoration:none;
    }
    a.abbr:active{
      color:red;
      text-decoration:none;
    }
    .note-header{
      font-weight: bold;
    }
    .note p:first-child{
      display: inline;
    }

    .indent{ margin-left:2em; }

    /* Tooltip container */
    .tooltipped {
       position: relative;
       display: inline-block;
       border-bottom: 1px dotted black; /* If you want dots under the hoverable text */
    }

    /* Tooltip text */
    .tooltiptext {
       visibility: hidden;
       width: 120px;
       background-color: black;
       color: #fff;
       text-align: center;
       padding: 5px 0;
       border-radius: 6px;

       /* Position the tooltip text - see examples below! */
       position: absolute;
       z-index: 1;
   }

   /* Show the tooltip text when you mouse over the tooltip container */
   .tooltipped:hover .tooltiptext {
       visibility: visible;
   }
   tr.major-row{
       border-top-style: double;
   }
   tr.major-row td:first-child{
       border-right-style: ridge;
       background-color: white;
   } 
   table.mfs td{
       text-align: center;
   }
   table.mfs td:first-child{
       text-align: left;
   }
  .table-caption, caption{
       text-align: center;
       font-weight: bold;
   }
   table{
       margin:auto;
       margin-top:1em;
       border-collapse:collapse; /*border: 1px solid black;*/
   }
   td{
       text-align:left;
       padding:8px 8px;
   }
   th{
       padding:8px 8px;
   }
   thead tr td{
       text-align: center;
       font-style: oblique;
       font-weight: bold;
   }
   tr.header{
       border-bottom:3px solid gray;
       padding:8px 8px;
       text-align:left;
       font-weight:bold; /*font-size: 90%; font-family: verdana, arial, helvetica, sans-serif; */
   }
   table tr:nth-child(2n+2){
       background-color:#F4F4F4;
   }

   .dependent{
       border: 1px solid gray;
       border-radius: 1px
   }
   .dependent-content{
       margin-left: 25px;
       font-style: italic;
   }

   .uc_table_or td, .uc_table_or tr {
       vertical-align: middle;
       border: 1px solid black;
       background-color: white;
   }

   .uc_not, .uc_mf, .uc_sel, .uc_guide{
       text-indent: 10px;
   }
   .uc_sel &gt; a{ 
       font-style: italic;
   }

   .uc_not_sel, .uc_sel.uc_mf, uc_assign.uc_mf{
       text-indent: 20px;
   }


   .uc_table_or tr td.or_cell{
      white-space: nowrap;
      border-radius: 0.6em 0 0 0.6em;
      background-color: black;
      color: white;
   }

   .uc_table_and, .uc_table_or {
       width: 100%;
       background-color: white;
   }
   .uc_guidance{
       display: table;
       background-color: gray;
   }  

   .evidence, .test-obj { font-style: normal; font-size: 90%;}
   
   
	table.classic {
    	width: 100%;
    	background-color: white;
    	border-collapse: collapse;
    	border-width: 2px;
  		border-color: gray;
  		border-style: solid;
  		color: black;
		font-size: small;
	}
    table.classic th {
  		background-color: lightgray;   
	}
    table.classic th:empty{
	    background-color: white;
		border-top: none;
		border-left: none;
	}
	table.classic td, table.classic th {
  		border-width: 2px;
  		border-color: gray;
  		border-style: solid;
  		padding: 5px;
	}

   
   
   </style></head><body><div style="text-align: center; margin-left: auto; margin-right: auto;"><h1 class="title" style="page-break-before:auto;">Supporting Document<br/>
        Mandatory Technical Document</h1><img src="images/niaplogo.png" alt="NIAP"></img><hr width="50%"></hr><noscript><h1 style="text-align:center; border-style: dashed; border-width: medium; border-color: red;">This page is best viewed with JavaScript enabled!</h1></noscript><br/>
    PP-Module for Virtual Private Network (VPN) Clients<br/>
      Version: 2.3<br/>2021-08-10<br/><b>National Information Assurance Partnership</b></div><div class="foreword"><h1 style="text-align: center">Foreword</h1><p>This is a Supporting Document (SD), intended to complement the Common Criteria version 3
      and the associated Common Evaluation Methodology for
      Information Technology Security Evaluation.</p><p>SDs may be “Guidance Documents”, that highlight specific approaches 
      and application of the standard to areas where no mutual recognition of
      its application is required, and as such, are not of normative nature, 
      or “Mandatory Technical Documents”, whose application is mandatory for evaluations 
      whose scope is covered by that of the SD.
      The usage of the latter class is not only mandatory, but certificates
      issued as a result of their application are recognized under the CCRA.</p><p><b>Technical Editor:</b><br/>
      National Information Assurance Partnership (NIAP)
      </p><p><b style="page-break-before:always;">Document history:</b><table><tr class="header"><th>Version</th><th>Date</th><th style="align:left;">Comment</th></tr><tr><td>2.3</td><td>2021-08-10</td><td>Support for MDF, Bluetooth updates</td></tr><tr><td>2.2</td><td>2021-01-05</td><td>Update release</td></tr><tr><td>2.1</td><td>2019-11-14</td><td>Initial Release</td></tr></table></p><p><b>General Purpose:</b><br/>
      The purpose of this SD is to define evaluation methods for the functional behavior of 
      Virtual Private Network (VPN) Clients  products.
      </p><p><b>Acknowledgements:</b><br/>
      This SD was developed with support from NIAP 
      Virtual Private Network (VPN) Clients Technical Community members, with representatives from industry, government 
      agencies, Common Criteria Test Laboratories, and members of academia.
      </p></div><h1>Table of Contents</h1><div id="toc"><a href="#introduction" style="text-indent:0px">1<span>Introduction</span></a><a href="#scope" style="text-indent:10px">1.1<span>Technology Area and Scope of Supporting Document</span></a><a href="#structure" style="text-indent:10px">1.2<span>Structure of the Document</span></a><a href="#glossary" style="text-indent:10px">1.3<span>Terms</span></a><a href="#cc-terms" style="text-indent:20px">1.3.1<span>Common Criteria Terms</span></a><a href="#tech-terms" style="text-indent:20px">1.3.2<span>Technical Terms</span></a><a href="#sfr" style="text-indent:0px">2<span>Evaluation Activities for SFRs</span></a><a href="#aa-bpp-gpos" style="text-indent:10px">2.1<span>
    Protection Profile for General Purpose Operating Systems</span></a><a href="#qq-sfrs-bpp-gpos-Modified" style="text-indent:20px">2.1.1<span>Modified SFRs
        </span></a><a href="#os-m-fcs" style="text-indent:30px">2.1.1.1<span>Cryptographic Support (FCS)</span></a><a href="#qq-sfrs-bpp-gpos-Additional" style="text-indent:20px">2.1.2<span>Additional SFRs
        </span></a><a href="#os-a-fcs" style="text-indent:30px">2.1.2.1<span>Cryptographic Support (FCS)</span></a><a href="#os-a-fia" style="text-indent:30px">2.1.2.2<span>Identification and Authentication (FIA)</span></a><a href="#os-a-ftp" style="text-indent:30px">2.1.2.3<span>Trusted Path/Channels (FTP)</span></a><a href="#aa-bpp-mdf" style="text-indent:10px">2.2<span>
    Protection Profile for Mobile Devices</span></a><a href="#qq-sfrs-bpp-mdf-Modified" style="text-indent:20px">2.2.1<span>Modified SFRs
        </span></a><a href="#md-m-fcs" style="text-indent:30px">2.2.1.1<span>Cryptographic Support (FCS)</span></a><a href="#md-m-fdp" style="text-indent:30px">2.2.1.2<span>User Data Protection (FDP)</span></a><a href="#md-m-fia" style="text-indent:30px">2.2.1.3<span>Identification and Authentication (FIA)</span></a><a href="#md-m-fmt" style="text-indent:30px">2.2.1.4<span>Security Management (FMT)</span></a><a href="#md-m-ftp" style="text-indent:30px">2.2.1.5<span>Trusted Path/Channels (FTP)</span></a><a href="#aa-bpp-app" style="text-indent:10px">2.3<span>
    Protection Profile for Application Software</span></a><a href="#qq-sfrs-bpp-app-Modified" style="text-indent:20px">2.3.1<span>Modified SFRs
        </span></a><a href="#ap-m-fcs" style="text-indent:30px">2.3.1.1<span>Cryptographic Support (FCS)</span></a><a href="#ap-m-fia" style="text-indent:30px">2.3.1.2<span>Identification and Authentication (FIA)</span></a><a href="#ap-m-ftp" style="text-indent:30px">2.3.1.3<span>Trusted Path/Channels (FTP)</span></a><a href="#qq-sfrs-bpp-app-Additional" style="text-indent:20px">2.3.2<span>Additional SFRs
        </span></a><a href="#ap-a-fcs" style="text-indent:30px">2.3.2.1<span>Cryptographic Support (FCS)</span></a><a href="#aa-bpp-mdm" style="text-indent:10px">2.4<span>
    Protection Profile for MDMs</span></a><a href="#qq-sfrs-bpp-mdm-Modified" style="text-indent:20px">2.4.1<span>Modified SFRs
        </span></a><a href="#dm-m-fcs" style="text-indent:30px">2.4.1.1<span>Cryptographic Support (FCS)</span></a><a href="#dm-m-fia" style="text-indent:30px">2.4.1.2<span>Identification and Authentication (FIA)</span></a><a href="#dm-m-ftp" style="text-indent:30px">2.4.1.3<span>Trusted Path/Channels (FTP)</span></a><a href="#man-sfrs" style="text-indent:10px">2.5<span>TOE SFR Evaluation Activities</span></a><a href="#m-fcs" style="text-indent:20px">2.5.1<span>Cryptographic Support (FCS)</span></a><a href="#m-fdp" style="text-indent:20px">2.5.2<span>User Data Protection (FDP)</span></a><a href="#m-fmt" style="text-indent:20px">2.5.3<span>Security Management (FMT)</span></a><a href="#m-fpt" style="text-indent:20px">2.5.4<span>Protection of the TSF (FPT)</span></a><a href="#opt-sfrs" style="text-indent:10px">2.6<span>Evaluation Activities for Optional SFRs</span></a><a href="#sel-sfrs" style="text-indent:10px">2.7<span>Evaluation Activities for Selection-Based SFRs</span></a><a href="#s-fia" style="text-indent:20px">2.7.1<span>Identification and Authentication (FIA)</span></a><a href="#obj-sfrs" style="text-indent:10px">2.8<span>Evaluation Activities for Objective SFRs</span></a><a href="#ob-fau" style="text-indent:20px">2.8.1<span>Security Audit (FAU)</span></a><a href="#ob-fdp" style="text-indent:20px">2.8.2<span>User Data Protection (FDP)</span></a><a href="#sar_aas" style="text-indent:0px">3<span>Evaluation Activities for SARs</span></a><a href="#sup-info" style="text-indent:0px">4<span>Required Supplementary Information</span></a><a href="#biblio" style="text-indent:0px">Appendix A - <span>References</span></a></div><h1 id="introduction" class="indexable" data-level="0">1 Introduction</h1><h2 id="scope" class="indexable" data-level="1">1.1 Technology Area and Scope of Supporting Document</h2><p>The scope of the 
    PP-Module for Virtual Private Network (VPN) Clients is
    to describe the security functionality of 
      Virtual Private Network (VPN) Clients products in terms of 
    [CC] and to define functional and assurance requirements for them.

    
    The PP-Module is intended for use with the following Base-PPs:
        <ul><li><a href="">
    Protection Profile for General Purpose Operating Systems, Version </a></li><li><a href="">
    Protection Profile for Mobile Devices, Version </a></li><li><a href="">
    Protection Profile for Application Software, Version </a></li><li><a href="">
    Protection Profile for MDMs, Version </a></li></ul><br/>
    This SD is mandatory for evaluations of TOEs that claim conformance to a PP-Configuration that includes the PP-Module for :
    <ul><li>Virtual Private Network (VPN) Clients, Version 2.3</li></ul>
    As such it defines Evaluation Activities for the functionality described in the PP-Module as well as any impacts to the Evaluation Activites to the Base-PP(s) it modifies.
    </p><p> 
Although Evaluation Activities are defined mainly for the evaluators to follow, in general they also help developers to prepare for evaluation by identifying specific requirements for their TOE.
    The specific requirements in Evaluation Activities may in some cases clarify the meaning of Security
    Functional Requirements (SFR), and may identify particular requirements for the content of Security
    Targets (ST) (especially the TOE Summary Specification), user guidance documentation, and possibly
    supplementary information (e.g. for entropy analysis or cryptographic key management architecture).</p><h2 id="structure" class="indexable" data-level="1">1.2 Structure of the Document</h2><p>Evaluation Activities can be defined for both SFRs and Security Assurance Requirements (SAR),
    which are themselves defined in separate sections of the SD.</p><p>If any Evaluation Activity cannot be successfully completed in an evaluation, then
    the overall verdict for the evaluation is a 'fail'.
    In rare cases there may be acceptable reasons why an Evaluation Activity
    may be modified or deemed not applicable for a particular TOE, 
    but this must be approved by the Certification Body for the evaluation.</p><p>In general, if all Evaluation Activities (for both SFRs and SARs) are successfully
    completed in an evaluation then it would be expected that the overall verdict for 
    the evaluation is a ‘pass’.
    To reach a ‘fail’ verdict when the Evaluation Activities have been successfully 
    completed would require a specific justification from the evaluator as to why the 
    Evaluation Activities were not sufficient for that TOE.
    </p><p>Similarly, at the more granular level of assurance components, if the Evaluation 
    Activities for an assurance component and all of its related SFR Evaluation 
    Activities are successfully completed in an evaluation then it would be expected 
    that the verdict for the assurance component is a ‘pass’.
    To reach a ‘fail’ verdict for the assurance component when these Evaluation 
    Activities have been successfully completed would require a specific justification 
    from the evaluator as to why the Evaluation Activities were not sufficient for that TOE. 
    </p><h2 id="glossary" class="indexable" data-level="1">1.3 Terms</h2>
The following sections list Common Criteria and technology terms used in this document.
    <h3 id="cc-terms" class="indexable" data-level="2">1.3.1 Common Criteria Terms</h3><table><tr><td><div id="Assurance">Assurance</div></td><td>Grounds for confidence that a TOE meets the SFRs <a href="#bibCC">[CC]</a>.</td></tr><tr><td><div id="Base_Protection_Profile">Base Protection Profile (Base-PP)</div></td><td>Protection Profile used as a basis to build a PP-Configuration.</td></tr><tr><td><div id="Common_Criteria">Common Criteria (CC)</div></td><td>Common Criteria for Information Technology Security Evaluation (International Standard ISO/IEC 15408).</td></tr><tr><td><div id="Common_Criteria_Testing_Laboratory">Common Criteria Testing Laboratory</div></td><td>
      Within the context of the Common Criteria Evaluation and Validation Scheme (CCEVS), an IT security evaluation facility, accredited by the National Voluntary Laboratory Accreditation Program (NVLAP) and approved by the NIAP Validation Body to conduct Common Criteria-based evaluations.
    </td></tr><tr><td><div id="Common_Evaluation_Methodology">Common Evaluation Methodology (CEM)</div></td><td>Common Evaluation Methodology for Information Technology Security Evaluation.</td></tr><tr><td><div id="Distributed_TOE">Distributed TOE</div></td><td>A TOE composed of multiple components operating as a logical whole.</td></tr><tr><td><div id="Operational_Environment">Operational Environment (OE)</div></td><td>Hardware and software that are outside the TOE boundary that support the TOE functionality and security policy.</td></tr><tr><td><div id="Protection_Profile">Protection Profile (PP)</div></td><td>An implementation-independent set of security requirements for a category of products.</td></tr><tr><td><div id="Protection_Profile_Configuration">Protection Profile Configuration (PP-Configuration)</div></td><td>A comprehensive set of security requirements for a product type that consists of at least one Base-PP and at least one PP-Module.</td></tr><tr><td><div id="Protection_Profile_Module">Protection Profile Module (PP-Module)</div></td><td>An implementation-independent statement of security needs for a TOE type complementary to one or more Base Protection Profiles.</td></tr><tr><td><div id="Security_Assurance_Requirement">Security Assurance Requirement (SAR)</div></td><td>A requirement to assure the security of the TOE.</td></tr><tr><td><div id="Security_Functional_Requirement">Security Functional Requirement (SFR)</div></td><td>A requirement for security enforcement by the TOE.</td></tr><tr><td><div id="Security_Target">Security Target (ST)</div></td><td>A set of implementation-dependent security requirements for a specific product.</td></tr><tr><td><div id="TOE_Security_Functionality">TOE Security Functionality (TSF)</div></td><td>The security functionality of the product under evaluation.</td></tr><tr><td><div id="TOE_Summary_Specification">TOE Summary Specification (TSS)</div></td><td>A description of how a TOE satisfies the SFRs in an ST.</td></tr><tr><td><div id="Target_of_Evaluation">Target of Evaluation (TOE)</div></td><td>The product under evaluation. </td></tr></table><h3 id="tech-terms" class="indexable" data-level="2">1.3.2 Technical Terms</h3><table style="width: 100%"><tr><td><div id="Administrator">Administrator</div></td><td>
        A user that has administrative privilege to configure the TOE in privileged
        mode. </td></tr><tr><td><div id="Authorized">Authorized</div></td><td>
        An entity granted access privileges to an object, system or system entity.
      </td></tr><tr><td><div id="Critical_Security_Parameter">Critical Security Parameter (CSP)</div></td><td>
        Security related information, e.g. secret and private cryptographic keys, and
        authentication data such as passwords and PINs, whose disclosure or
        modification can compromise the security of a cryptographic module. </td></tr><tr><td><div id="Entropy_Source">Entropy Source</div></td><td>
        This cryptographic function provides a seed for a random number generator
        by accumulating the outputs from one or more noise sources. The
        functionality includes a measure of the minimum work required to guess a
        given output and tests to ensure that the noise sources are operating
        properly.
      </td></tr><tr><td><div id="IT_Environment">IT Environment</div></td><td>
        Hardware and software that are outside the TOE boundary that support the
        TOE functionality and security policy. </td></tr><tr><td><div id="Operational_Environment">Operational Environment</div></td><td>
        The environment in which the TOE is operated.</td></tr><tr><td><div id="Private_Network">Private Network</div></td><td>
        A network that is protected from access by unauthorized users or entities.
      </td></tr><tr><td><div id="Privileged_Mode">Privileged Mode</div></td><td>
        A TOE operational mode that allows a user to perform functions that require
        IT Environment administrator privileges.
      </td></tr><tr><td><div id="Public_Network">Public Network</div></td><td>
        A network that is visible to all users and entities and does not protect against
        unauthorized access (e.g. internet).
      </td></tr><tr><td><div id="Threat_Agent">Threat Agent</div></td><td>
        An entity that tries to harm an information system through destruction,
        disclosure, modification of data, and/or denial of service.</td></tr><tr><td><div id="Unauthorized_User">Unauthorized User</div></td><td>
        An entity (device or user) who has not been authorized by an authorized
        administrator to access the TOE or private network.
      </td></tr><tr><td><div id="Unprivileged_Mode">Unprivileged Mode</div></td><td>
        A TOE operational mode that only provides VPN client functions for the VPN
        Client user. </td></tr><tr><td><div id="VPN_Client">VPN Client</div></td><td>
        The TOE; allows remote users to use client computers to establish an
        encrypted IPsec tunnel across an unprotected public network to a private
        network.
      </td></tr><tr><td><div id="VPN_Client_User">VPN Client User</div></td><td>
        A user operating the TOE in unprivileged mode.</td></tr><tr><td><div id="VPN_Gateway">VPN Gateway</div></td><td>
        A component that performs encryption and decryption of IP packets as they
        cross the boundary between a private network and a public network. </td></tr></table><h1 id="sfr" class="indexable" data-level="0">2 Evaluation Activities for SFRs</h1><p>The EAs presented in this section capture the actions the evaluator performs 
    to address technology specific aspects covering specific SARs (e.g. ASE_TSS.1, 
    ADV_FSP.1, AGD_OPE.1, and ATE_IND.1) – this is in addition to the CEM workunits 
    that are performed in Section <a href="#sar_aas" class="dynref"> 3 Evaluation Activities for SARs</a>.</p><p>Regarding design descriptions (designated by the subsections labelled TSS, as 
    well as any required supplementary material that may be treated as proprietary), 
    the evaluator must ensure there is specific information that satisfies the EA. 
    For findings regarding the TSS section, the evaluator’s verdicts will be 
    associated with the CEM workunit ASE_TSS.1-1.
    Evaluator verdicts associated with the supplementary evidence will also be 
    associated with ASE_TSS.1-1, 
    since the requirement to provide such evidence is specified in ASE in the PP.</p><p>For ensuring the guidance documentation provides sufficient information for 
    the administrators/users as it pertains to SFRs, the evaluator’s verdicts will 
    be associated with CEM workunits ADV_FSP.1-7, AGD_OPE.1-4, and AGD_OPE.1-5.</p><p>Finally, the subsection labelled Tests is where the authors have determined 
    that testing of the product in the context of the associated SFR is necessary.
    While the evaluator is expected to develop tests, there may be instances where 
    it is more practical for the developer to construct tests, or where the 
    developer may have existing tests. 
    Therefore, it is acceptable for the evaluator to witness developer-generated 
    tests in lieu of executing the tests. 
    In this case, the evaluator must ensure the developer’s tests are executing both 
    in the manner declared by the developer and as mandated by the EA. 
    The CEM workunits that are associated with the EAs specified in this section 
    are: ATE_IND.1-3, ATE_IND.1-4, ATE_IND.1-5, ATE_IND.1-6, and ATE_IND.1-7.</p><h2 class="indexable" data-level="1" id="aa-bpp-gpos">2.1 
    Protection Profile for General Purpose Operating Systems</h2>
      The EAs defined in this section are only applicable in cases where the TOE claims conformance
      to a PP-Configuration that includes the General Purpose Operating Systems PP.
     <h3 class="indexable" data-level="2" id="qq-sfrs-bpp-gpos-Modified">2.1.1 Modified SFRs
        </h3>
        
        <h3 class="indexable" data-level="3" id="os-m-fcs">2.1.1.1 Cryptographic Support (FCS)</h3>
          
          
          
            The ST author is instructed to make specific selections at minimum to
              address VPN client requirements; the SFR behavior itself is
              unmodified.
            
              The OS shall generate asymmetric cryptographic keys in accordance with a specified
                cryptographic key generation algorithm: 
                
                  ECC schemes using “NIST curves” P-256, P-384, and 
                    P-521
                    no other curves
                  
                    that meet the following: FIPS PUB 186-4, “Digital Signature
                    Standard (DSS),” Appendix B.4, and,
                  
                
                
                  RSA schemes using cryptographic key sizes of 2048-bit or greater that meet
                    the following: FIPS PUB 186-4, “Digital Signature Standard (DSS),”
                    Appendix B.3,
                  FFC schemes using cryptographic key sizes of 2048-bit or greater that meet
                    the following: FIPS PUB 186-4, “Digital Signature Standard (DSS),”
                    Appendix B.1, 
                  FFC Schemes using Diffie-Hellman group 14 that meet the following: RFC
                    3526,
                  FFC Schemes using safe primes that meet the following: ‘NIST Special
                    Publication 800-56A Revision 3, “Recommendation for Pair-Wise Key
                    Establishment Schemes,
                  No other key generation methods
                
                and specified cryptographic key sizes [assignment: cryptographic key sizes] that
                  meet the following: [assignment: list of standards].
                
              
                This SFR is functionally identical to what is defined in the GPOS PP except that
                ECC key generation with support for P-256 and P-384 has been made mandatory
                in support of IPsec due to the mandated support for DH groups 19 and 20 in
                FCS_IPSEC_EXT.1.8. The ST author must select all key generation schemes used
                for key establishment and entity authentication. When key generation is used for
                key establishment, the schemes in FCS_CKM.2 and selected cryptographic
                protocols must match the selection. When key generation is used for entity
                authentication, the public key is expected to be associated with an X.509v3
                certificate.
                If the OS acts only as a receiver in the RSA key establishment scheme, the OS
                does not need to implement RSA key generation.
              
              
                Refer to the evaluation activity for FCS_CKM.1 in the GPOS PP for evaluating this SFR.
                
              
            
            
          

          
          
            The ST author is instructed to make specific selections at minimum to
              address VPN client requirements; the SFR behavior itself is
              unmodified.
            
              The OS shall implement functionality to perform cryptographic key
                establishment in accordance with a specified key establishment method:
                
                  Elliptic curve-based key establishment schemes that meets the following:
                    NIST Special Publication 800-56A Revision 3, “Recommendation for Pair-Wise Key
                    Establishment Schemes Using Discrete Logarithm Cryptography,” and
                  
                
                
                  RSA-based key establishment schemes that meets the following: RSAESPKCS1-v1_5 as specified in Section 7.2 of RFC 8017, “Public-Key
                    Cryptography Standards (PKCS) #1: RSA Cryptography Specifications
                    Version 2.2,
                  Finite field-based key establishment schemes that meets the following: NIST
                    Special Publication 800-56A Revision 3, “Recommendation for Pair-Wise Key
                    Establishment Schemes Using Discrete Logarithm Cryptography”
                  
                  Key establishment scheme using Diffie-Hellman group 14 that meets the
                    following: RFC 3526,
                  No other key establishment schemes
                
                  that meets the following [assignment: list of standards].
              
              
                The ST author must select all key establishment schemes used for the selected
                cryptographic protocols.
                The elliptic curves used for the key establishment scheme must correlate with
                the curves specified in FCS_CKM.1.1. The domain parameters used for the finite
                field-based key establishment scheme are specified by the key generation
                according to FCS_CKM.1.1.
              
               
	  	Refer to the Assurance Activity for FCS_CKM.2.1 in the GPOS PP for evaluating this SFR. Note that
		because a TOE that conforms to this PP-Module must implement IPsec, the tested protocols shall
		include IPsec at minimum.    
                
              
            
            
          

          
          
            The SFR is refined to list an additional AES mode that must be
              supported to address VPN client requirements; the use of this mode
              for VPN connectivity does not impact the ability of the OS to satisfy
              any of its other security requirements.
            
              The OS shall perform encryption/decryption services for data in accordance with
                a specified cryptographic algorithm
                
                  AES-CBC (as defined in NIST SP 800-38A),
                  AES-GCM (as defined in NIST SP 800-38D), and
                
                
                  AES-XTS (as defined in NIST SP 800-38E),
                  AES-CCMP (as defined in FIPS PUB 197, NIST SP 800-38C and IEEE
                    802.11-2012)
                  AES Key Wrap (KW) (as defined in NIST SP 800-38F)
                  AES Key Wrap with Padding (KWP) (as defined in NIST SP 800-38F)
                  AES-CCM (as defined in NIST SP 800-38C)
                  AES-CCMP-256 (as defined in NIST SP800-38C and IEEE 802.11ac-2013)
                  AES-GCMP-256 (as defined in NIST SP800-38D and IEEE 802.11ac-2013)
                  No other modes
                
                and cryptographic key sizes 
                
                  128-bit
                  256-bit
                .
              
              
                This SFR is identical to what is defined in the GPOS PP except that support for
                CBC and GCM mode is mandatory in order to address the requirements for
                FCS_IPSEC_EXT.1. In addition, both 128-bit and 256-bit for key sizes must be
                selected in order to meet the requirements for FCS_IPSEC_EXT.1.
              
              
                Refer to the EA for FCS_COP.1(1) in the GPOS PP for evaluating this SFR.
                
              
            
            
          
        
          
          
          <div class="comp" id="OS-FCS-CKM-1"><h4>FCS_CKM.1 Cryptographic Key Generation</h4><div class="component-activity-header">FCS_CKM.1</div>
                Refer to the evaluation activity for <span class="no-link">FCS_CKM.1</span> in the GPOS PP for evaluating this SFR.
                
              </div>

          
          <div class="comp" id="OS-FCS-CKM-2"><h4>FCS_CKM.2 Cryptographic Key Establishment</h4><div class="component-activity-header">FCS_CKM.2</div> 
	  	Refer to the Assurance Activity for <span class="no-link">FCS_CKM.2.1</span> in the GPOS PP for evaluating this SFR. Note that
		because a TOE that conforms to this PP-Module must implement IPsec, the tested protocols shall
		include IPsec at minimum.    
                
              </div>

          
          <div class="comp" id="OS-FCS-COP-1-1"><h4>FCS_COP.1/1 Cryptographic Operation (Encryption and Decryption)</h4><div class="component-activity-header">FCS_COP.1/1</div>
                Refer to the EA for <span class="no-link">FCS_COP.1(1)</span> in the GPOS PP for evaluating this SFR.
                
              </div>
        
      <h3 class="indexable" data-level="2" id="qq-sfrs-bpp-gpos-Additional">2.1.2 Additional SFRs
        </h3>

        <h3 class="indexable" data-level="3" id="os-a-fcs">2.1.2.1 Cryptographic Support (FCS)</h3>
          
            Components in this family describe requirements for key management functionality such as key
		storage and destruction.
          
          
          
          
            Storage of key data related to VPN functionality can be accomplished
              using the same mechanism defined by FCS_STO_EXT.1 in the OS PP.
            requires the TSF to securely store key data when not in use
            No specific management functions are identified.
            There are no auditable events foreseen.
	    No dependencies.
            
              The 
                VPN client
                OS
               shall store persistent secrets and private keys
                when not in use in OS-provided key storage.
              
              
                This requirement ensures that persistent secrets (credentials, secret keys) and
                private keys are stored securely when not in use. If some secrets/keys are
                manipulated by the VPN client and others are manipulated by the OS, then both
                of the selections can be specified by the ST author.
              
              
                Regardless of whether this requirement is met by the VPN client or the OS, the evaluator will check the
			TSS to ensure that it lists each persistent secret (credential, secret key) and private key needed to meet
			the requirements in the ST. For each of these items, the evaluator will confirm that the TSS lists for what
			purpose it is used, and how it is stored. 
                  	The evaluator shall review the TSS for to determine that it makes a case that, for each item listed as being
			manipulated by the VPN client, it is not written unencrypted to persistent memory, and that the item is
			stored by the OS.
                
                There are no AGD EAs for this requirement.
                There are no test EAs for this component.
              
            
            
          
        
          
          
          
          <div class="comp" id="OS-FCS-CKM-EXT-2"><h4>FCS_CKM_EXT.2 Cryptographic Key Storage</h4><div class="component-activity-header">FCS_CKM_EXT.2</div>
                
                
                
              <div class="eacategory">TSS</div>Regardless of whether this requirement is met by the VPN client or the OS, the evaluator will check the
			TSS to ensure that it lists each persistent secret (credential, secret key) and private key needed to meet
			the requirements in the ST. For each of these items, the evaluator will confirm that the TSS lists for what
			purpose it is used, and how it is stored. <p></p>
                  	The evaluator shall review the TSS for to determine that it makes a case that, for each item listed as being
			manipulated by the VPN client, it is not written unencrypted to persistent memory, and that the item is
			stored by the OS.<p></p>
                <div class="eacategory">Guidance</div>There are no AGD EAs for this requirement.<p></p><div class="eacategory">Tests</div>There are no test EAs for this component.</div>
        

        <h3 class="indexable" data-level="3" id="os-a-fia">2.1.2.2 Identification and Authentication (FIA)</h3>
          
            Components in this family describe the requirements that pertain to IP traffic and information flow
              through the VPN client.
          
          
          
          
            This SFR defines additional uses for X.509 certificate functionality that
              do not conflict with those defined in the OS PP.
            requires the TOE to perform X.509 certificate
              authentication and describes the behavior that is followed if is the status of the certificate is unknown or
              invalid.
            No specific management functions are identified.
            There are no auditable events foreseen.
            FIA_X509_EXT.1 X.509 Certificate Validation
              FPT_TST_EXT.1 TSF Self-Test
            FPT_TUD_EXT.1 Trusted Update
            
              The TSF shall use X.509v3 certificates as defined by RFC 5280 to support
              authentication for IPsec exchanges, and 
                digital signatures for FPT_TUD_EXT.1
                integrity checks for FPT_TST_EXT.1
                no additional uses
              .
              
            
            
                
                  When a connection to determine the validity of a certificate cannot be
                  established, the 
                    VPN client
                    OS
                   shall 
                    allow the administrator to choose whether to accept the certificate in these cases
                    accept the certificate
                    not accept the certificate
                  .
                
                
                    Oftentimes a connection must be established to perform a verification of the
                    revocation status of a certificate - either to download a CRL or to perform OCSP.
                    The selection is used to describe the behavior in the event that such a connection
                    cannot be established (for example, due to a network error). The behavior of the
                    TOE in these cases is described by the second selection. If the TOE has
                    determined the certificate is valid according to all other rules in FIA_X509_EXT.1,
                    the behavior indicated in the second selection will determine the validity. The
                    TOE must not accept the certificate if it fails any of the other validation rules in
                    FIA_X509_EXT.1. If the administrator-configured option is selected by the ST
                    Author, the ST author must also make the appropriate selection in
                    FMT_SMF.1/VPN.
                
            
            
              
                The 
                  VPN client
                  OS
                 shall not establish an SA if a certificate or
                certificate path is deemed invalid.
              
              
                The EAs below apply to FIA_X509_EXT.3.2. FIA_X509_EXT.3.1 is evaluated as part of FCS_IPSEC_EXT.1 (and
		conditionally as part of FPT_TUD_EXT.1 and/or FPT_TST_EXT.1) and FIA_X509_EXT.3.3 is evaluated as part
		of FCS_IPSEC_EXT.1.11.
                The evaluator shall check the TSS to ensure that it describes whether the VPN client or the OS implements
			the certificate validation functionality, how the VPN client/OS chooses which certificates to use, and any
			necessary instructions in the administrative guidance for configuring the OS so that desired certificates
			can be used.
                  	The evaluator shall examine the TSS to confirm that it describes the behavior of the client/OS when a
			connection cannot be established during the validity check of a certificate used in establishing a trusted
			channel.
                
                If the requirement indicates that the administrator is able to specify the default action, then the evaluator
			shall ensure that the operational guidance contains instructions on how this configuration action is
			performed.
		
                
                 	The evaluator shall perform the following test regardless of whether the certificate validation functionality
			is implemented by the VPN client or by the OS:
                  
                  	The evaluator shall demonstrate that using a valid certificate that requires certificate validation
				checking to be performed in at least some part by communicating with a non-TOE IT entity. The evaluator
				shall then manipulate the environment so that the TOE is unable to verify the validity of the certificate,
				and observe that the action selected in FIA_X509_EXT.3.2 is performed. If the selected action is
				administrator-configurable, then the evaluator shall follow the operational guidance to determine that all
				supported administrator-configurable options behave in their documented manner.
			  
                  
                
              
            
            
          
        
          
          
          
          <div class="comp" id="OS-FIA-X509-EXT-3"><h4>FIA_X509_EXT.3 X.509 Certificate Use and Management</h4><div class="component-activity-header">FIA_X509_EXT.3</div>
                The EAs below apply to FIA_X509_EXT.3.2. FIA_X509_EXT.3.1 is evaluated as part of FCS_IPSEC_EXT.1 (and
		conditionally as part of FPT_TUD_EXT.1 and/or FPT_TST_EXT.1) and FIA_X509_EXT.3.3 is evaluated as part
		of FCS_IPSEC_EXT.1.11.<p></p>
                
                
                
              <div class="eacategory">TSS</div>The evaluator shall check the TSS to ensure that it describes whether the VPN client or the OS implements
			the certificate validation functionality, how the VPN client/OS chooses which certificates to use, and any
			necessary instructions in the administrative guidance for configuring the OS so that desired certificates
			can be used.<p></p>
                  	The evaluator shall examine the TSS to confirm that it describes the behavior of the client/OS when a
			connection cannot be established during the validity check of a certificate used in establishing a trusted
			channel.<p></p>
                <div class="eacategory">Guidance</div>If the requirement indicates that the administrator is able to specify the default action, then the evaluator
			shall ensure that the operational guidance contains instructions on how this configuration action is
			performed.<p></p>
		<div class="eacategory">Tests</div>
                 	The evaluator shall perform the following test regardless of whether the certificate validation functionality
			is implemented by the VPN client or by the OS:
                  <ul>
                  	<li><b>Test 1: </b>The evaluator shall demonstrate that using a valid certificate that requires certificate validation
				checking to be performed in at least some part by communicating with a non-TOE IT entity. The evaluator
				shall then manipulate the environment so that the TOE is unable to verify the validity of the certificate,
				and observe that the action selected in FIA_X509_EXT.3.2 is performed. If the selected action is
				administrator-configurable, then the evaluator shall follow the operational guidance to determine that all
				supported administrator-configurable options behave in their documented manner.
			  </li>
                  </ul>
                </div>
        

        <h3 class="indexable" data-level="3" id="os-a-ftp">2.1.2.3 Trusted Path/Channels (FTP)</h3>
          
          
          
            This SFR defines a trusted channel for IPsec, which is added
              functionality that does not prevent the existing OS functions from
              being performed.
            
            
              
                The 
                  VPN client
                  OS
                
                shall use IPsec to provide a trusted
                communication channel between itself and 
                
                  a remote VPN gateway
                  a remote VPN client
                  a remote IPsec-capable network device
                 that is logically
                distinct from other communication channels and provides assured identification
                of its end points and protection of the channel data from disclosure and
                detection of modification of the channel data.
              
            
            
              
                The 
                
                  VPN client
                  OS
                 shall permit [the TSF] to initiate communication with the trusted channel.
              
            
            
              
                The 
                
                  VPN client
                  OS
                 shall initiate communication via the trusted
                channel [for all traffic traversing that connection].
              
              
                The intent of the above requirement is to demonstrate that IPsec can be used to
                establish remote communications in transport and/or tunnel mode.
                The requirement implies that not only are communications protected when they
                are initially established, but also on resumption after an outage. It may be the
                case that some part of the TOE setup involves manually setting up tunnels to
                protect other communication, and if after an outage the TOE attempts to reestablish 
                the communication automatically with (the necessary) manual
                intervention, there may be a window created where an attacker might be able to
                gain critical information or compromise a connection.
              
              
                The evaluator shall examine the TSS to determine that it describes the details of the TOE connecting to a
			VPN gateway and/or VPN client and/or IPsec-capable network device in terms of the cryptographic
			protocols specified in the requirement, along with TOE-specific options or procedures that might not be
			reflected in the specification. The evaluator shall also confirm that all protocols listed in the TSS are
			specified and included in the requirements in the ST.
                
                The evaluator shall confirm that the operational guidance contains instructions for establishing the
			connection to a VPN gateway and/or VPN client and/or IPsec-capable network device, and that it contains
			recovery instructions should a connection be unintentionally broken.
                
                
                  The evaluator shall perform the following tests:
                  
                    The evaluators shall ensure that the TOE is able to initiate communications with a VPN gateway
			and/or VPN client and/or IPsec-capable network device using the protocols specified in the requirement,
			setting up the connections as described in the operational guidance and ensuring that communication is
			successful.
                    The evaluator shall ensure, for each communication channel with an IPsec peer, the channel data
			is not sent in plaintext.
                    
                    The evaluator shall ensure, for each communication channel with an IPsec peer, modification of
			the channel data is detected by the TOE.
                    The evaluators shall physically interrupt the connection from the TOE to the IPsec peer. The
			evaluators shall ensure that subsequent communications are appropriately protected, at a minimum in
			the case of any attempts to automatically resume the connection or connect to a new access point.
                  
		  Further EAs are associated with requirements for FCS_IPSEC_EXT.1.
                
              
            
            
          
        
          
          
          <div class="comp" id="OS-FTP-ITC-1"><h4>FTP_ITC.1 Inter-TSF Trusted Channel</h4><div class="component-activity-header">FTP_ITC.1</div>
                
                
                
              <div class="eacategory">TSS</div>The evaluator shall examine the TSS to determine that it describes the details of the TOE connecting to a
			VPN gateway and/or VPN client and/or IPsec-capable network device in terms of the cryptographic
			protocols specified in the requirement, along with TOE-specific options or procedures that might not be
			reflected in the specification. The evaluator shall also confirm that all protocols listed in the TSS are
			specified and included in the requirements in the ST.<p></p>
                <div class="eacategory">Guidance</div>The evaluator shall confirm that the operational guidance contains instructions for establishing the
			connection to a VPN gateway and/or VPN client and/or IPsec-capable network device, and that it contains
			recovery instructions should a connection be unintentionally broken.<p></p>
                <div class="eacategory">Tests</div>
                  The evaluator shall perform the following tests:
                  <ul>
                    <li><b>Test 1: </b>The evaluators shall ensure that the TOE is able to initiate communications with a VPN gateway
			and/or VPN client and/or IPsec-capable network device using the protocols specified in the requirement,
			setting up the connections as described in the operational guidance and ensuring that communication is
			successful.</li>
                    <li><b>Test 2: </b>The evaluator shall ensure, for each communication channel with an IPsec peer, the channel data
			is not sent in plaintext.
                    </li>
                    <li><b>Test 3: </b>The evaluator shall ensure, for each communication channel with an IPsec peer, modification of
			the channel data is detected by the TOE.</li>
                    <li><b>Test 4: </b>The evaluators shall physically interrupt the connection from the TOE to the IPsec peer. The
			evaluators shall ensure that subsequent communications are appropriately protected, at a minimum in
			the case of any attempts to automatically resume the connection or connect to a new access point.</li>
                  </ul>
		  Further EAs are associated with requirements for FCS_IPSEC_EXT.1.
                </div>
        
      <h2 class="indexable" data-level="1" id="aa-bpp-mdf">2.2 
    Protection Profile for Mobile Devices</h2>
      The EAs defined in this section are only applicable in cases where the TOE claims conformance
      to a PP-Configuration that includes the Mobile Devices PP.
     <h3 class="indexable" data-level="2" id="qq-sfrs-bpp-mdf-Modified">2.2.1 Modified SFRs
        </h3>

	      
	      
        <h3 class="indexable" data-level="3" id="md-m-fcs">2.2.1.1 Cryptographic Support (FCS)</h3>
          
          
          
            The ST author is instructed to make specific selections at minimum to
              address VPN client requirements; the SFR behavior itself is
              unmodified.
            
              The TSF shall generate asymmetric cryptographic keys in accordance with a specified cryptographic key
                generation algorithm: 
                
					ECC schemes using “NIST curves” 
						
							P-256
							P-384
						 and
						
							P-521
							no other curves
                         
                        that meet the following: FIPS PUB 186-4, “Digital Signature Standard (DSS),” Appendix B.4;
					
                
                
                  FFC schemes using
                    
                      cryptographic key sizes of 2048-bit or greater that meet
                        the following: FIPS PUB 186-4, “Digital Signature Standard (DSS),”
                        Appendix B.1
                      Diffie-Hellman group 14 that meet the following: RFC 3526
                      “safe-prime” groups that meet the following: ‘NIST Special Publication 800-56A Revision 3,
                        “Recommendation for Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography
                    , and
                  
                 
                    RSA schemes using cryptographic key sizes of 2048-bit or greater
                    that meet FIPS PUB 186-4, “Digital Signature Standard (DSS),”
                    Appendix B.3,
				 ECC schemes using Curve25519 schemes that meet the following: RFC 7748
                  No other key generation methods
                .
              
              
                This SFR is functionally identical to what is defined in the MDF PP except that
				ECC key generation with support for at least one of P-256 and P-384 has been
				made mandatory in support of IPsec due to the mandated support for at least
				one of DH groups 19 and 20 in FCS_IPSEC_EXT.1.8. Support for “safe-prime”
				groups has also been added as a selectable option for DH groups that use finite
				field algorithms. Curve25519 schemes remain selectable for their potential use in
				satisfying FDP_DAR_EXT.2.2 in the MDF PP; these schemes are not used in
				support of IPsec. RSA and ECC support for P-521 remain present as selections
				since they may be used by parts of the TOE that are not specifically related to
				VPN client functionality.
				
              
               Refer to the EAs for FCS_CKM.1 in the MDF PP. The only change to this SFR is that some selections are
		mandated, therefore the corresponding testing is mandatory. The actual testing for those selections is not
		changed.
                
              
            
            
          

          
          
            The ST author is instructed to make specific selections at minimum to
              address VPN client requirements; the SFR behavior itself is
              unmodified.
            
              The TSF shall perform cryptographic key
                establishment in accordance with a specified key establishment method:
                
                  Elliptic curve-based key establishment schemes that meets the following:
                    NIST Special Publication 800-56A Revision 3, “Recommendation for Pair-Wise Key
                    Establishment Schemes Using Discrete Logarithm Cryptography,”
                  
                
                
                  Finite field-based key establishment schemes that meets the following: NIST
                    Special Publication 800-56A Revision 3, “Recommendation for Pair-Wise Key
                    Establishment Schemes Using Discrete Logarithm Cryptography”
                  Key establishment scheme using Diffie-Hellman group 14 that meets the
                    following: RFC 3526, Section 3
                  RSA-based key establishment schemes that meet the following: 
                    
                      NIST Special Publication 800-56B, “Recommendation for Pair-Wise Key
                        Establishment Schemes using Integer Factorization Cryptography,”
                      RSAES-PKCS1-v1_5 as specified in Section 7.2 of RFC 8017,
                        “Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.2
                    
                  
                  no other key establishment schemes
                .
              
              
                This SFR differs from its definition in the MDF PP by moving elliptic curve-based
				key establishment schemes from selectable to mandatory (due to the mandated
				support for DH groups 19 and 20 in FCS_IPSEC_EXT.1.8). Finite field and Group
				14 selections remain present if groups 14, 15, or 24 are selected in
				FCS_IPSEC_EXT.1.8. This PP-Module does not require the use of RSA for any
				function but it is present in the selection in case other MDF PP functions require
				its use.
              
               
                Refer to the EAs for FCS_CKM.2/UNLOCKED in the MDF PP. The only change to this SFR is that some
		selections are mandated, therefore the corresponding testing is mandatory. The actual testing for those
		selections is not changed.
                
              
            
            
          

          
          
            The ST author is instructed to make specific selections at minimum to
              address VPN client requirements; the SFR behavior itself is
              unmodified.
            
              The TSF shall perform encryption/decryption in accordance with
                a specified cryptographic algorithm
                
                  AES-CBC (as defined in FIPS PUB 197, NIST SP 800-38A),
                  AES-CCMP (as defined in FIPS PUB 197, NIST SP 800-38C and IEEE 802.11-2012),
                  AES-GCM (as defined in NIST SP 800-38D),
                 and
                
                  AES Key Wrap (KW) (as defined in NIST SP 800-38F)
                  AES Key Wrap with Padding (KWP) (as defined in NIST SP 800-38F)
                  AES-CCM (as defined in NIST SP 800-38C)
                  AES-XTS (as defined in NIST SP 800-38E)
                  AES-CCMP-256 (as defined in NIST SP800-38C and IEEE 802.11ac-2013)
                  AES-GCMP-256 (as defined in NIST SP800-38D and IEEE 802.11ac-2013)
                  no other modes
                
                and cryptographic key sizes 128-bit key sizes and [256-bit key sizes].
              
              
                This SFR is identical to what is defined in the MDF PP except that support for
                GCM mode and support for 256-bit key sizes are both mandatory in order to
                address the requirements for FCS_IPSEC_EXT.1.
              
              
                Refer to the EAs for FCS_COP.1/ENCRYPT in the MDF PP. The only change to this SFR is that some
		selections are mandated, therefore the corresponding testing is mandatory. The actual testing for those
		selections is not changed.
                
              
            
            
          
        
          
          
          <div class="comp" id="MD-FCS-CKM-1"><h4>FCS_CKM.1 Cryptographic Key Generation</h4><div class="component-activity-header">FCS_CKM.1</div>
               Refer to the EAs for FCS_CKM.1 in the MDF PP. The only change to this SFR is that some selections are
		mandated, therefore the corresponding testing is mandatory. The actual testing for those selections is not
		changed.
                
              </div>

          
          <div class="comp" id="MD-FCS-CKM-2-1"><h4>FCS_CKM.2/UNLOCKED Cryptographic Key Establishment</h4><div class="component-activity-header">FCS_CKM.2/UNLOCKED</div> 
                Refer to the EAs for FCS_CKM.2/UNLOCKED in the MDF PP. The only change to this SFR is that some
		selections are mandated, therefore the corresponding testing is mandatory. The actual testing for those
		selections is not changed.
                
              </div>

          
          <div class="comp" id="MD-FCS-COP-1-1"><h4>FCS_COP.1/ENCRYPT Cryptographic Operation</h4><div class="component-activity-header">FCS_COP.1/ENCRYPT</div>
                Refer to the EAs for FCS_COP.1/ENCRYPT in the MDF PP. The only change to this SFR is that some
		selections are mandated, therefore the corresponding testing is mandatory. The actual testing for those
		selections is not changed.
                
              </div>
           

        <h3 class="indexable" data-level="3" id="md-m-fdp">2.2.1.2 User Data Protection (FDP)</h3>
		
          
          
            TODO: The ST author is instructed to make specific selections at minimum to
              address VPN client requirements; the SFR behavior itself is
              unmodified.
            
              The TSF shall [
					provide a VPN client which can protect all IP traffic using IPsec as
						defined in the PP-Module for VPN Client
					] with the exception of IP traffic required to establish the VPN connection.
              
              
                This SFR is identical to its definition in the Base-PP except that the selection item
				that requires the TOE to implement its own VPN client is always selected when
				the TOE’s conformance claim includes this PP-Module
			  
              
                Refer to the EAs for FDP_IFC_EXT.1 in the MDF PP. The only change to this SFR is that some selections are
		mandated, therefore the corresponding testing is mandatory. The actual testing for those selections is not
		changed.
                
              
            
            
          
        
		
          
          <div class="comp" id="MD-FDP-IFC-EXT-1-1"><h4>FDP_IFC_EXT.1 Subset Information Flow Control</h4><div class="component-activity-header">FDP_IFC_EXT.1</div>
                Refer to the EAs for FDP_IFC_EXT.1 in the MDF PP. The only change to this SFR is that some selections are
		mandated, therefore the corresponding testing is mandatory. The actual testing for those selections is not
		changed.
                
              </div>
           
		
		
        <h3 class="indexable" data-level="3" id="md-m-fia">2.2.1.3 Identification and Authentication (FIA)</h3>
          
          
          
            This PP-Module adds IPsec as a new trusted protocol where x.509
              certificate authentication is used.
            
              The TSF shall use X.509v3 certificates as defined by RFC 5280 to support
                authentication for mutually authenticated TLS as defined in the Package for
				Transport Layer Security, HTTPS, IPsec in accordance with the PP-Module for
				VPN Client, 
					
						 mutually authenticated DTLS as defined in the Package
							for Transport Layer Security
						no other protocols
					, and
					
                  code signing for system software updates
                  code signing for mobile applications
                  code signing for integrity verification
                  other uses
                  no additional uses
                .
              
            
            
              When the TSF cannot establish a connection to determine the validity of a
                certificate, the TSF shall 
                
                  allow the administrator to choose whether to accept the certificate in these cases
                  allow the user to choose whether to accept the certificate in these cases
                  accept the certificate
                  not accept the certificate
                .
              
              
                This SFR is identical to what is defined in the MDF PP except that support for
				IPsec is mandated. The selection of “no other protocols” is added to address the
				case where the TOE only claims support for the protocols that are mandated by
				the SFR.
              
               
                Refer to the EAs for FIA_X509_EXT.2 in the MDF PP. The only change to this SFR is that some selections
		are mandated, therefore the corresponding testing is mandatory. The actual testing for those selections
		is not changed.
                
              
            
            
          
        
          
          
          <div class="comp" id="MD-FIA-X509-EXT-2"><h4>FIA_X509_EXT.2 X.509 Certificate Authentication</h4><div class="component-activity-header">FIA_X509_EXT.2</div> 
                Refer to the EAs for FIA_X509_EXT.2 in the MDF PP. The only change to this SFR is that some selections
		are mandated, therefore the corresponding testing is mandatory. The actual testing for those selections
		is not changed.
                
              </div>
           
        
	<h3 class="indexable" data-level="3" id="md-m-fmt">2.2.1.4 Security Management (FMT)</h3>
	      
         
	 
	      This PP-Module modifies management function 45 regarding Always-on VPN protection. 
		
		 
			This SFR is not reproduced in its entirety for size purposes. The only change to this SFR is the following
			change to management function 45:
			
				
				
					45. enable/disable the Always On VPN protection:
						a. across device
						[
					d. no other method
						]
					
					M
					O
					O
					O
				
			 
		 
                
                Refer to the EAs for FMT_SMF_EXT.1 in the MDF PP. The only change to this SFR is that some selections
		are mandated, therefore the corresponding testing is mandatory. The actual testing for those selections
		is not changed.
                
              
	
	
	
		
	
	      
         
	 <div class="comp" id="MD-FMT-SMF-EXT-1"><h4>FMT_SMF_EXT.1 Specification of Management Functions</h4><div class="component-activity-header">FMT_SMF_EXT.1</div> 
                Refer to the EAs for FMT_SMF_EXT.1 in the MDF PP. The only change to this SFR is that some selections
		are mandated, therefore the corresponding testing is mandatory. The actual testing for those selections
		is not changed.
                
              </div>
		
	  
	      
		
        <h3 class="indexable" data-level="3" id="md-m-ftp">2.2.1.5 Trusted Path/Channels (FTP)</h3>
          
          
          
            This PP-Module adds IPsec as a new protocol that is used to
              implement trusted channels.
            
              The TSF shall use
		      802.11-2012 in accordance with the Extended Package for WLAN Clients,
		      802.1X in accordance with the Extended Package for WLAN Clients,
		      EAP-TLS in accordance with the Extended Package for WLAN Clients,
		      mutually authenticated TLS as defined in the Package for Transport Layer
			      Security,
		      IPsec in accordance with the PP-Module for VPN Client,
		      and
                
                  mutually authenticated DTLS as defined in the Package for Transport
			Layer Security
                  HTTPS
                  no other
                
                protocols to provide a communication channel between itself
                and another trusted IT product that is logically distinct from other
                communication channels, provides assured identification of its end points,
                protects channel data from disclosure, and detects modification of the channel
                data.
                
            
            
              The TSF shall permit the TSF to initiate communication via the trusted channel.
              
            
            
              
                The TSF shall initiate communication via the trusted channel for wireless access
                point connections, administrative communication, configured enterprise
                connections, and 
                
                  OTA updates
                  no other connections
                .
              
              
                This SFR is identical to what is defined in the Base-PP except that support for
		IPsec is mandated. Additionally, since the Base-PP requires ‘at least one of’ the
		selected protocols which previously included IPsec, ‘no other protocols’ is now
		available as an option in the selection.
              
               
                Refer to the EAs for FTP_ITC_EXT.1 in the MDF PP. The only change to this SFR is that some selections are
		mandated, therefore the corresponding testing is mandatory. The actual testing for those selections is not
		changed.
                
              
            
            
          
        
          
          
          <div class="comp" id="MD-FTP-ITC-EXT-1"><h4>FTP_ITC_EXT.1 Trusted Channel Communication</h4><div class="component-activity-header">FTP_ITC_EXT.1</div> 
                Refer to the EAs for FTP_ITC_EXT.1 in the MDF PP. The only change to this SFR is that some selections are
		mandated, therefore the corresponding testing is mandatory. The actual testing for those selections is not
		changed.
                
              </div>
        
      <h2 class="indexable" data-level="1" id="aa-bpp-app">2.3 
    Protection Profile for Application Software</h2>
      The EAs defined in this section are only applicable in cases where the TOE claims conformance
      to a PP-Configuration that includes the Application Software PP.
     <h3 class="indexable" data-level="2" id="qq-sfrs-bpp-app-Modified">2.3.1 Modified SFRs
        </h3>
        
        <h3 class="indexable" data-level="3" id="ap-m-fcs">2.3.1.1 Cryptographic Support (FCS)</h3>
            
          
          
            The ST author is instructed to make specific selections at minimum to
              address VPN client requirements; the SFR behavior itself is
              unmodified. Additionally, this behavior is selection-based in the App
              PP but is made mandatory since it is required for VPN client
              functionality.
            
              The application shall 
                
                  invoke platform-provided functionality
                  implement functionality
                 to generate asymmetric cryptographic keys in accordance with a specified
                cryptographic key generation algorithm
                  
                    [ECC schemes] using [“NIST curves” P-256, P-384, and 
                      
                          P-521
                          no other curves
                      ] that meet the following: [FIPS PUB 186-4, “Digital Signature
                    Standard (DSS),” Appendix B.4], and,
                    
                   
                  
                    [FFC schemes] using cryptographic key sizes of [2048-bit or greater] that meet
                      the following: FIPS PUB 186-4, “Digital Signature Standard (DSS),” Appendix B.1
                    [FFC schemes] using Diffie-Hellman group 14 that meet the following: RFC 3526, Section 3,
                    [FFC Schemes using “safe-prime” groups] that meet the following: ‘NIST Special Publication 800-56A 
                      Revision 3, “Recommendation for Pair-Wise Key Establishment Schemes Using Discrete Logarithm
                      Cryptography” and 
                      
                        RFC 3526
                        RFC 7919
                      ;
                    
                    [RSA schemes] using cryptographic key sizes of [2048-bit or greater] that
                      meet the following: [FIPS PUB 186-4, “Digital Signature Standard (DSS),”
                      Appendix B.3];
                    
                    no other key generation methods
                    
                  
                
                
                  This SFR is selection-based in the App PP depending on the selection made in
                  FCS_CKM_EXT.1. Because key generation services (whether implemented by the
                  TOE or invoked from the platform) are required for IPsec, this SFR is mandatory
                  for any TOE that claims conformance to this PP-Module.
                  This SFR is functionally identical to what is defined in the App PP except that ECC
                  key generation has been made mandatory in support of IPsec due to the
                  mandated support for DH groups 19, and 20 in FCS_IPSEC_EXT.1.8. RSA remains
                  present as a selection since it may be used by parts of the TOE that are not
                  specifically related to VPN client functionality.
                
                 
                  Refer to the EA for FCS_CKM.1(1) in the App PP.
                  
                
              
              
            

            
            
              The ST author is instructed to make specific selections at minimum to
                address VPN client requirements and is modified to include Diffie-Hellman Group 14 as an additional supported method for key
                establishment.
              
                The application shall 
                  
                    invoke platform-provided functionality
                    implement functionality
                   to perform cryptographic key
                  establishment in accordance with a specified key establishment method:
                  
                    [Elliptic curve-based key establishment schemes] that meets the following: [NIST
                      Special Publication 800-56A, “Recommendation for Pair-Wise Key Establishment
                      Schemes Using Discrete Logarithm Cryptography”]; and
                    
                  
                  
                    [Finite field-based key establishment schemes] that meets the following: [NIST
                      Special Publication 800-56A, “Recommendation for Pair-Wise Key Establishment
                      Schemes Using Discrete Logarithm Cryptography”]
                    Key establishment scheme using Diffie-Hellman group 14] that meets the
                      following: [RFC 3526, Section 3,
                    [FFC Schemes using “safe-prime” groups]that meet the following: ‘NIST Special
                      Publication 800-56A Revision 3, “Recommendation for Pair-Wise Key
                      Establishment Schemes Using Discrete Logarithm Cryptography” and 
                      
                        RFC 3526
                        RFC 7919
                      
                    
                     [RSA-based key establishment schemes] that meets the following: RSAES-PKCS1-v1_5 as specified
                      in Section 7.2 of RFC 8017, “Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications
                      Version 2.2
                    [RSA-based key establishment schemes] that meet the following: [NIST Special
                      Publication 800-56B, “Recommendation for Pair-Wise Key Establishment
                      Schemes Using Integer Factorization Cryptography”]
                    No other schemes
                  .
                
                
                  This SFR differs from its definition in the App PP by moving elliptic curve-based
                  key establishment schemes from selectable to mandatory (due to the mandated
                  support for DH groups 19 and 20 in FCS_IPSEC_EXT.1.8). It also provides the
                  ability to claim at least one of NIST SP 800-56A, RFC 3526, or NIST SP 800-56A
                  rev. 3 “safe-prime” groups for key establishment using finite field cryptography.
                
                  For all key establishment schemes refer to the EA for FCS_CKM.2 in the App PP.
                  
                
              
              
            

                      
            
              The ST author is instructed to make specific selections at minimum to
                address VPN client requirements; specifically, since key generation
                services are required in some capacity in order to support VPN
                functionality, the ST author loses the choice of stating that the
                application does not have any key generation functionality.
                Additionally, this behavior is selection-based in the App PP but is made
                mandatory since it is required for VPN client functionality.
              
                The application shall 
                  
                    invoke platform-provided functionality for asymmetric key generation
                    implement asymmetric key generation
                  .
                
                
                  This selection differs from its definition in the App PP by
                  removing the selection for “generate no asymmetric cryptographic keys” for this PP-Module because a VPN Client
                  TOE will either perform its own key generation or interface with the underlying platform to provide this 
                  service, either of which causes FCS_CKM.1(1) to be claimed.
                
                 
                  This SFR is evaluated in conjunction with FCS_CKM.1(1) in the App PP.
                  
                
              
              
            

            
            
              The ST author is instructed to make specific selections at minimum to
                address VPN client requirements; the SFR behavior itself is
                unmodified.
              
                The application shall perform encryption/decryption in accordance with
                  a specified cryptographic algorithm 
                  
                    AES-CBC (as defined in NIST SP 800-38A) mode,
                    AES-GCM (as defined in NIST SP 800-38D) mode,
                  ; and 
                  
                    AES-XTS (as defined in NIST SP 800-38E) mode
                    no other modes
                  
                  and cryptographic key sizes [128-bit, 256-bit].
                
                
                  This SFR is selection-based in the Base-PP and remains selection-based here because
                  this PP-Module allows for the possibility that the TSF relies on platform-provided
                  cryptographic algorithm services for its own implementation of IPsec. However, if
                  the TSF does claim this SFR to support IPsec, the ST author must select at minimum
                  both AES-CBC and AES-GCM with both 128-bit and 256-bit key sizes for consistency
                  with the relevant IPsec claims (FCS_IPSEC_EXT.1.4 requires both 128-bit and 256-bit
                  AES-GCM and FCS_IPSEC_EXT.1.6 requires both 128-bit and 256-bit AES-CBC).
                
                
			
				If the TSF implements AES cryptography in support of both credential encryption (per FCS_STO_EXT.1)
				and IPsec, the evaluator shall examine the TSS to ensure that it clearly identifies the modes and key sizes
				that are supported for each usage of AES.
			
			
				There are no operational guidance EAs beyond what is required by the EA for FCS_COP.1(1) in the App PP.
			
			
				There are no test EAs beyond what is required by the EA for FCS_COP.1(1) in the App PP.
			
                
              
              
            
          
            
          
          <div class="comp" id="AP-FCS-CKM-1-1"><h4>FCS_CKM.1/1 Cryptographic Asymmetric Key Generation</h4><div class="component-activity-header">FCS_CKM.1/1</div> 
                  Refer to the EA for <span class="no-link">FCS_CKM.1(1)</span> in the App PP.
                  
                </div>

            
            <div class="comp" id="AP-FCS-CKM-2"><h4>FCS_CKM.2 Cryptographic Key Establishment</h4><div class="component-activity-header">FCS_CKM.2</div>
                  For all key establishment schemes refer to the EA for <span class="no-link">FCS_CKM.2</span> in the App PP.
                  
                </div>

                      
            <div class="comp" id="AP-FCS-CKM-EXT-1"><h4>FCS_CKM_EXT.1 Cryptographic Key Generation Services</h4><div class="component-activity-header">FCS_CKM_EXT.1</div> 
                  This SFR is evaluated in conjunction with <span class="no-link">FCS_CKM.1(1)</span> in the App PP.
                  
                </div>

            
            <div class="comp" id="AP-FCS-COP-1-1"><h4>FCS_COP.1/1 Cryptographic Operation</h4><div class="component-activity-header">FCS_COP.1/1</div>
			
			
			
                <div class="eacategory">TSS</div>
				If the TSF implements AES cryptography in support of both credential encryption (per FCS_STO_EXT.1)
				and IPsec, the evaluator shall examine the TSS to ensure that it clearly identifies the modes and key sizes
				that are supported for each usage of AES.
			<div class="eacategory">Guidance</div>
				There are no operational guidance EAs beyond what is required by the EA for <span class="no-link">FCS_COP.1(1)</span> in the App PP.
			<div class="eacategory">Tests</div>
				There are no test EAs beyond what is required by the EA for <span class="no-link">FCS_COP.1(1)</span> in the App PP.
			</div>
          
        
          <h3 class="indexable" data-level="3" id="ap-m-fia">2.3.1.2 Identification and Authentication (FIA)</h3>
            
            
            
              This PP-Module adds IPsec as a new trusted protocol where x.509
                certificate authentication is used.
              
                The application shall use X.509v3 certificates as defined by RFC 5280 to support
                  authentication for IPsec and [no other protocols].
                
              
              
                When the application cannot establish a connection to determine the validity of a
                  certificate, the TSF shall 
                  
                    allow the administrator to choose whether to accept the certificate in these cases
                    accept the certificate
                    not accept the certificate
                  .
                
                
                  This SFR is identical to what is defined in the App PP except that mandatory
                  support for IPsec is added. Additionally, because this SFR is selection-based in
                  the App PP but is mandatory for VPN client usage, the ‘no other protocols’
                  selection item has been added since it is expected that IPsec is the TOE’s only use
                  of certificates.
                
                
                  Refer to the EA for FIA_X509_EXT.2 in the App PP.
                  
                
              
              
            
          
            
            
            <div class="comp" id="AP-FIA-X509-EXT-2"><h4>FIA_X509_EXT.2 X.509 Certificate Authentication</h4><div class="component-activity-header">FIA_X509_EXT.2</div>
                  Refer to the EA for <span class="no-link">FIA_X509_EXT.2</span> in the App PP.
                  
                </div>
          
        
          <h3 class="indexable" data-level="3" id="ap-m-ftp">2.3.1.3 Trusted Path/Channels (FTP)</h3>
            
            
            
              This PP-Module adds IPsec as a new protocol that is used to
                implement trusted channels.
              
                The application shall [not encrypt any [sensitive data]] between itself
                  and another trusted IT product.
                
                
                  The VPN client itself is the application, and does not maintain any sensitive data
                  of its own. Therefore, there is no need to protect (through FTP_DIT_EXT.1.1)
                  VPN-client-specific data.                
                
                
                  For IPsec, refer to the EA for FCS_IPSEC_EXT.1 in section 2.5.1.1 below. 
                  
                
              
              
            
          
            
            
            <div class="comp" id="AP-FTP-DIT-EXT-1"><h4>FTP_DIT_EXT.1 Protection of Data in Transit</h4><div class="component-activity-header">FTP_DIT_EXT.1</div>
                  For IPsec, refer to the EA for <span class="no-link">FCS_IPSEC_EXT.1</span> in section 2.5.1.1 below. 
                  
                </div>
          
      <h3 class="indexable" data-level="2" id="qq-sfrs-bpp-app-Additional">2.3.2 Additional SFRs
        </h3>

        <h3 class="indexable" data-level="3" id="ap-a-fcs">2.3.2.1 Cryptographic Support (FCS)</h3>
          
          
          
            This PP-Module adds a requirement for key storage, which is new
              functionality when compared to the Base-PP but does not interfere
              with its existing security functions.
            requires the TSF to securely store key data when not in use.
            No specific management functions are identified.
            There are no auditable events foreseen.
            No dependencies
            
              The 
                
                  TOE
                  TOE platform
                 shall store persistent secrets and private keys
                when not in use in platform-provided key storage.
              
              
                This requirement ensures that persistent secrets and private keys are stored
                securely when not in use. This differs from FCS_STO_EXT.1 in the Base-PP, which
                only applies to secure storage of administrative credentials. If some secrets/keys
                are manipulated by the TOE and others are manipulated by the platform, then
                both of the selections can be specified by the ST author.
              
               
                Regardless of whether this requirement is met by the TOE or the TOE platform, the evaluator will check
			the TSS to ensure that it lists each persistent secret (credential, secret key) and private key needed to
			meet the requirements in the ST. For each of these items, the evaluator will confirm that the TSS lists for
			what purpose it is used, and how it is stored. The evaluator then performs the following actions: 

                  	Persistent secrets and private keys manipulated by the platform:

               	 	For each platform listed in the ST, the evaluator shall examine the ST of the platform to ensure that the
			persistent secrets and private keys listed as being stored by the platform in the VPN client ST are identified
			as being protected in that platform's ST

                  	Persistent secrets and private keys manipulated by the TOE:

                  	The evaluator reviews the TSS for to determine that it makes a case that, for each item listed as being
			manipulated by the TOE, it is not written unencrypted to persistent memory, and that the item is stored
			by the platform.
                
                There are no AGD EAs for this requirement.
                There are no test EAs for this requirement.
              
            
            
          

          
          
            This PP-Module adds a requirement for key destruction, which is new
              functionality when compared to the Base-PP but does not interfere
              with its existing security functions.
            requires the TSF to destroy key data when no longer required.
            No specific management functions are identified.
            There are no auditable events foreseen.
            No dependencies
            
              The 
                
                  TOE
                  TOE platform
                 
                shall zeroize all plaintext secret and private cryptographic keys and CSPs when no longer required.
              
              
                Any security related information (such as keys, authentication data, and
                passwords) must be zeroized when no longer in use to prevent the disclosure or
                modification of security critical data.

                The zeroization indicated above applies to each intermediate storage area for
                plaintext key/CSP (i.e., any storage, such as memory buffers, that is included in
                the path of such data) upon the transfer of the key/CSP to another location.

                In practice, the TOE will not implement all of the functionality associated with
                the requirement, since if it performs zeroization at all it will be by invoking
                platform interfaces to perform the storage location clear/overwrite function. The
                ST author should select "TOE" when, for at least one of the keys needed to meet
                the requirements of this PP, the TOE manipulates (reads, writes) the data
                identified in the requirement and thus needs to ensure that those data are
                cleared. In these cases, it is sufficient for the TOE to invoke the correct
                underlying functions of the host to perform the zeroization--it does not imply
                that the TOE has to include a kernel-mode memory driver to ensure the data are
                zeroized.

                In the likely event that some of the data are manipulated by the TOE and other
                data are manipulated entirely by the platform, the ST author must select both
                options.
              
               
                The evaluator shall ensure that all plaintext secret and private cryptographic keys and CSPs (whether
			manipulated by the TOE or exclusively by the platform) are identified in the VPN Client ST's TSS, and that
			they are accounted for by the EAs in this section. 

                  	Requirement met by the platform:

                  	The evaluator shall check to ensure the TSS describes each of the secret keys (keys used for
                  	symmetric encryption), private keys, and CSPs used to generate key that are not otherwise covered
                  	by the FCS_CKM_EXT.4 requirement levied on the TOE.
                  	For each platform listed in the ST, the evaluator shall examine the TSS of the ST of the platform to
                  	ensure that each of the secret keys, private keys, and CSPs used to generate key listed above are
                  	covered. 

                  	Requirement met by the TOE:

                  	The evaluator shall check to ensure the TSS describes when each of the plaintext keys are cleared (e.g.,
			system power off, disconnection of an IPsec connection, when no longer needed by the VPN channel per
			the protocol); and the type of clearing procedure that is performed (cryptographic erase, overwrite with
			zeros, overwrite three or more times by a different alternating pattern, overwrite with random pattern,
			or block erase). If different types of memory are used to store the materials to be protected, the evaluator
			shall check to ensure that the TSS describes the clearing procedure in terms of the memory in which the
			data are stored (for example, "secret keys stored on flash are cleared by overwriting once with zeros,
			while secret keys stored on the internal persistent storage device are cleared by overwriting three times
			with a random pattern that is changed before each write").
		
                There are no AGD EAs for this requirement.
                
			For each key clearing situation described in the TSS, the evaluator shall repeat the following test.
                	
                  		The evaluator shall utilize appropriate combinations of specialized operational environment and
					development tools (debuggers, simulators, etc.) for the TOE and instrumented TOE builds to test that keys
					are cleared correctly, including all intermediate copies of the key that may have been created internally
					by the TOE during normal cryptographic processing with that key. 
                    			Cryptographic TOE implementations in software shall be loaded and exercised under a debugger to
					perform such tests. The evaluator shall perform the following test for each key subject to clearing,
					including intermediate copies of keys that are persisted encrypted by the TOE:
					
						Load the instrumented TOE build in a debugger.
					        Record the value of the key in the TOE subject to clearing.
                    				Cause the TOE to perform a normal cryptographic processing with the key from #1.
                    				Cause the TOE to clear the key.
				                Cause the TOE to stop the execution but not exit.
                    				Cause the TOE to dump the entire memory footprint of the TOE into a binary file.
                    				Search the content of the binary file created in #4 for instances of the known key value from
  					                  #1.
					
		                    	The test succeeds if no copies of the key from #1 are found in step #7 above and fails otherwise.
 		                   	The evaluator shall perform this test on all keys, including those persisted in encrypted form, to ensure
					intermediate copies are cleared.
				
    	            
                
              
            
            
          
        
          
          
          <div class="comp" id="AP-FCS-CKM-EXT-2"><h4>FCS_CKM_EXT.2 Cryptographic Key Storage</h4><div class="component-activity-header">FCS_CKM_EXT.2</div> 
                
                
                
              <div class="eacategory">TSS</div>Regardless of whether this requirement is met by the TOE or the TOE platform, the evaluator will check
			the TSS to ensure that it lists each persistent secret (credential, secret key) and private key needed to
			meet the requirements in the ST. For each of these items, the evaluator will confirm that the TSS lists for
			what purpose it is used, and how it is stored. The evaluator then performs the following actions: <p></p>

                  	<b>Persistent secrets and private keys manipulated by the platform:</b><p></p>

               	 	For each platform listed in the ST, the evaluator shall examine the ST of the platform to ensure that the
			persistent secrets and private keys listed as being stored by the platform in the VPN client ST are identified
			as being protected in that platform's ST<p></p>

                  	<b>Persistent secrets and private keys manipulated by the TOE:</b><p></p>

                  	The evaluator reviews the TSS for to determine that it makes a case that, for each item listed as being
			manipulated by the TOE, it is not written unencrypted to persistent memory, and that the item is stored
			by the platform.<p></p>
                <div class="eacategory">Guidance</div>There are no AGD EAs for this requirement.<p></p><div class="eacategory">Tests</div>There are no test EAs for this requirement.</div>

          
          <div class="comp" id="AP-FCS-CKM-EXT-4"><h4>FCS_CKM_EXT.4 Cryptographic Key Destruction</h4><div class="component-activity-header">FCS_CKM_EXT.4</div> 
                
                
                
              <div class="eacategory">TSS</div>The evaluator shall ensure that all plaintext secret and private cryptographic keys and CSPs (whether
			manipulated by the TOE or exclusively by the platform) are identified in the VPN Client ST's TSS, and that
			they are accounted for by the EAs in this section. <p></p>

                  	<b>Requirement met by the platform:</b><p></p>

                  	The evaluator shall check to ensure the TSS describes each of the secret keys (keys used for
                  	symmetric encryption), private keys, and CSPs used to generate key that are not otherwise covered
                  	by the FCS_CKM_EXT.4 requirement levied on the TOE.<p></p>
                  	For each platform listed in the ST, the evaluator shall examine the TSS of the ST of the platform to
                  	ensure that each of the secret keys, private keys, and CSPs used to generate key listed above are
                  	covered. <p></p>

                  	<b>Requirement met by the TOE:</b><p></p>

                  	The evaluator shall check to ensure the TSS describes when each of the plaintext keys are cleared (e.g.,
			system power off, disconnection of an IPsec connection, when no longer needed by the VPN channel per
			the protocol); and the type of clearing procedure that is performed (cryptographic erase, overwrite with
			zeros, overwrite three or more times by a different alternating pattern, overwrite with random pattern,
			or block erase). If different types of memory are used to store the materials to be protected, the evaluator
			shall check to ensure that the TSS describes the clearing procedure in terms of the memory in which the
			data are stored (for example, "secret keys stored on flash are cleared by overwriting once with zeros,
			while secret keys stored on the internal persistent storage device are cleared by overwriting three times
			with a random pattern that is changed before each write").<p></p>
		<div class="eacategory">Guidance</div>There are no AGD EAs for this requirement.<p></p><div class="eacategory">Tests</div>
			For each key clearing situation described in the TSS, the evaluator shall repeat the following test.
                	<ul>
                  		<li><b>Test 1: </b>The evaluator shall utilize appropriate combinations of specialized operational environment and
					development tools (debuggers, simulators, etc.) for the TOE and instrumented TOE builds to test that keys
					are cleared correctly, including all intermediate copies of the key that may have been created internally
					by the TOE during normal cryptographic processing with that key. <p></p>
                    			Cryptographic TOE implementations in software shall be loaded and exercised under a debugger to
					perform such tests. The evaluator shall perform the following test for each key subject to clearing,
					including intermediate copies of keys that are persisted encrypted by the TOE:<p></p>
					<ol type="1">
						<li>Load the instrumented TOE build in a debugger.</li>
					        <li>Record the value of the key in the TOE subject to clearing.</li>
                    				<li>Cause the TOE to perform a normal cryptographic processing with the key from #1.</li>
                    				<li>Cause the TOE to clear the key.</li>
				                <li>Cause the TOE to stop the execution but not exit.</li>
                    				<li>Cause the TOE to dump the entire memory footprint of the TOE into a binary file.</li>
                    				<li>Search the content of the binary file created in #4 for instances of the known key value from
  					                  #1.</li>
					</ol>
		                    	The test succeeds if no copies of the key from #1 are found in step #7 above and fails otherwise.<p></p>
 		                   	The evaluator shall perform this test on all keys, including those persisted in encrypted form, to ensure
					intermediate copies are cleared.
				</li>
    	            </ul>
                </div>
        
      <h2 class="indexable" data-level="1" id="aa-bpp-mdm">2.4 
    Protection Profile for MDMs</h2>
      The EAs defined in this section are only applicable in cases where the TOE claims conformance
      to a PP-Configuration that includes the MDM PP.
     <h3 class="indexable" data-level="2" id="qq-sfrs-bpp-mdm-Modified">2.4.1 Modified SFRs
        </h3>
        
        <h3 class="indexable" data-level="3" id="dm-m-fcs">2.4.1.1 Cryptographic Support (FCS)</h3>
          
          
          
            The ST author is instructed to make specific selections at minimum to
              address VPN client requirements; the SFR behavior itself is
              unmodified.
            
              The TSF shall 
                
                  invoke platform-provided functionality
                  implement functionality
                
                to generate asymmetric cryptographic keys in accordance with a specified cryptographic key
                generation algorithm: 
                
                  ECC schemes using “NIST curves” P-256, P-384, and 
                      
                        P-521
                        no other curves
                       
                      that meet the following: FIPS PUB 186-4, “Digital Signature Standard (DSS),” Appendix B.4, and
                  
                
                
                  RSA schemes using cryptographic key sizes of 2048-bit or greater that meet
                    FIPS PUB 186-4, "Digital Signature Standard (DSS),” Appendix B.3,
                  FFC schemes using cryptographic key sizes of 2048-bit or greater that meet
                    the following: FIPS PU 186-4, “Digital Signature Standards (DSS),” Appendix B.4,
                  FFC schemes using “safe-prime” groups that meet the following: ‘NIST
                    Special Publication 800-56A Revision 3, “ Recommendation for Pair-Wise Key
                    Establishment Schemes Using Discrete Logarithm Cryptography,” and
                    
                      RFC 3526
                      RFC 7919
                    ,
                  FFC schemes using Diffie-Hellman group 14 that meets the following: RFC
                    3526, Section 3, 
                  No other key generation schemes
                .
              
              
                This SFR is modified from its definition in the MDM PP by mandating the key
                generation algorithms that are required by this PP-Module in support of IPsec due to
                the mandated support for DH groups 19 and 20 in FCS_IPSEC_EXT.1.8. Other
                selections may be chosen by the ST author as needed for parts of the TOE that are
                not specifically related to VPN client functionality
              
              
                Refer to the EA for FCS_CKM.1 in the MDM PP.
                
              
            
            
          

          
          
            The ST author is instructed to make specific selections at minimum to
              address VPN client requirements; the SFR behavior itself is
              unmodified.
            
              The TSF shall 
                
                  invoke platform-provided functionality
                  implement functionality
                
                to perform cryptographic key establishment in accordance with a specified key establishment method:
                
                  Elliptic curve-based key establishment schemes that meets the following:
                    NIST Special Publication 800-56A Revision 3, “Recommendation for Pair-Wise Key
                    Establishment Schemes Using Discrete Logarithm Cryptography,”
                  
                and
                                  
                  RSA-based key establishment schemes that meet the following: 
                    RSAES-PKCS1-v1_5 as specified in Section 7.2 of RFC 8017, “Public-Key Cryptography Standards
                    (PKCS) #1: RSA Cryptography Specifications Version 2.1,"
                  Finite field-based key establishment schemes that meets the following: NIST
                    Special Publication 800-56A Revision 3, “Recommendation for Pair-Wise Key
                    Establishment Schemes Using Discrete Logarithm Cryptography”
                  FFC schemes using "safe-prime" groups that meet the following: 'NIST
                    Special Publication 800-56A Revision 3, "Recommendation for Pair-Wise Key
                    Establishment Schemes Using Discrete Logarithm Cryptography,"' and
                    
                      RFC 3526
                      RFC 7919
                    
                  
                  Key establishment scheme using Diffie-Hellman group 14 that meets the
                    following: RFC 3526, Section 3
                  No other schemes
                .
              
              
                This SFR is modified from its definition in the MDM PP by mandating the key
                establishment algorithms that are required by this PP-Module in support of IPsec due
                to the mandated support for DH groups 19 and 20 in FCS_IPSEC_EXT.1.8. Other
                selections may be chosen by the ST author as needed for parts of the TOE that are
                not specifically related to VPN client functionality.
              
              
                Refer to the EA for FCS_CKM.2 in the MDM PP.
                
              
            
            
          

          
          
            The ST author is instructed to make specific selections at minimum to
              address VPN client requirements; the SFR behavior itself is
              unmodified.
            
              The TSF shall
                
                  invoke platform-provided functionality
                  implement functionality
                
                perform encryption/decryption in accordance with a specified cryptographic algorithm
                
                  AES-CBC (as defined in FIPS PUB 197, NIST SP 800-38A),
                  AES-GCM (as defined in NIST SP 800-38D), and
                
                
                  AES Key Wrap (KW) (as defined in NIST SP 800-38F)
                  AES Key Wrap with Padding (KWP) (as defined in NIST SP 800-38F)
                  AES-CCM (as defined in NIST SP 800-38C)
                  no other modes
                
                and cryptographic key sizes [128-bit, 256-bit].
              
              
                This SFR is modified from its definition in the Base-PP by mandating support for both
                128-bit and 256-bit implementations of AES-CBC (which this PP-Module requires for
                the use of IKE and allows for the use of ESP) and AES-GCM (which this PP-Module
                requires for the use of ESP and allows for the use of IKE). Other AES modes may be
                selected by the ST author as needed to address functions not required by this PPModule.
              
              
                Refer to the EA for FCS_COP.1(1) in the MDM PP.
                
              
            
            
          
        
          
          
          <div class="comp" id="DM-FCS-CKM-1"><h4>FCS_CKM.1 Cryptographic Key Generation</h4><div class="component-activity-header">FCS_CKM.1</div>
                Refer to the EA for <span class="no-link">FCS_CKM.1</span> in the MDM PP.
                
              </div>

          
          <div class="comp" id="DM-FCS-CKM-2"><h4>FCS_CKM.2 Cryptographic Key Establishment</h4><div class="component-activity-header">FCS_CKM.2</div>
                Refer to the EA for <span class="no-link">FCS_CKM.2</span> in the MDM PP.
                
              </div>

          
          <div class="comp" id="DM-FCS-COP-1-1"><h4>FCS_COP.1/1 Cryptographic Operation</h4><div class="component-activity-header">FCS_COP.1/1</div>
                Refer to the EA for <span class="no-link">FCS_COP.1(1)</span> in the MDM PP.
                
              </div>
        
        
        <h3 class="indexable" data-level="3" id="dm-m-fia">2.4.1.2 Identification and Authentication (FIA)</h3>
          
          
          
            This PP-Module adds IPsec as a new trusted protocol where x.509
              certificate authentication is used.
            
              The TSF shall
                
                  
                    Invoke platform-provided functionality to use X.509v3 certificates as defined by
                    RFC 5280 to support authentication for 
                    
                      IPsec
                      HTTPS
                      TLS
                      DTLS
                      SSH
                      no protocols
                     and 
                    
                      code signing for system software updates
                      code signing for integrity verification
                      policy signing
                      other uses
                      no additional uses
                    
                  
                  use X.509v3 certificates as defined by RFC 5280 to support
                    authentication for 
                    
                      IPsec as specified in the PP-Module for VPN client and
                    
                    
                      HTTPS in accordance with FCS_HTTPS_EXT.1
                      TLS as defined in the Package for Transport Layer Security
                      DTLS as defined in the Package for Transport Layer Security
                      SSH as defined in the Extended Package for Secure Shell
                      no other protocols
                    , and
                    
                      code signing for system software updates
                      code signing for integrity verification
                      policy signing
                      other uses
                      no additional uses
                    
                  
                .
              
              
                The PP-Module requires the TOE to implement its own X.509 authentication
                mechanism in support of IPsec communications. Other selections may be chosen by
                the ST author as needed for parts of the TOE that are not specifically related to VPN
                client functionality. The TSF may also rely on a platform-provided mechanism for
                uses of X.509 that do not relate to the establishment of trusted communications, as
                specified in the original SFR. FIA_X509_EXT.2.2 has not been included here as the PPModule 
                does not modify this element.
              
              
                Refer to the EA for FIA_X509_EXT.2 in the MDM PP.
                
              
            
            
          
        
          
          
          <div class="comp" id="DM-FIA-X509-EXT-2"><h4>FIA_X509_EXT.2 X.509 Certificate Authentication</h4><div class="component-activity-header">FIA_X509_EXT.2</div>
                Refer to the EA for <span class="no-link">FIA_X509_EXT.2</span> in the MDM PP.
                
              </div>
        
        
        <h3 class="indexable" data-level="3" id="dm-m-ftp">2.4.1.3 Trusted Path/Channels (FTP)</h3>

		
          
         
            This PP-Module adds IPsec as a new protocol that is used to
              implement trusted channels.
            
				The TSF shall [implement functionality using [IPsec as defined in the PP-Module for
					VPN Client]].
                
				
					When the MDM TOE claims this PP-Module, at least one of its interfaces will implement IPsec
					communications. However, this PP-Module does not specify that any one particular interface must be
					implemented using IPsec. If the TOE is distributed and uses IPsec to secure communications between its
					distributed components, FPT_ITT.1(1) is refined as above.
					This SFR is selection-based in the Base-PP depending on the selections made in the
					Base-PP requirement FTP_ITC_EXT.1. This is not changed by the PP-Module.
					This SFR is modified from its definition in the Base-PP by mandating that the TSF
					implement IPsec communications and by prohibiting the TOE from relying on
					platform-provided functionality to implement this.
              
              
                Refer to the EA for FPT_ITT.1(1) in the MDM PP. Note that the PP-Module does not require any separate
		testing for this if IPsec is not used to implement this function.
                
              
            
            
         		  
		  

	
          
            This PP-Module adds IPsec as a new protocol that is used to
              implement trusted channels.
            
               The TSF shall implement functionality using IPsec as defined in the PP-Module
			  for VPN Client, and 
                
                  SSH as defined in the Extended Package for Secure Shell
                  mutually authenticated TLS as defined in the Package for Transport Layer Security
                  mutually authenticated DTLS as defined in the Package for Transport Layer Security
                  HTTPS in accordance with FCS_HTTPS_EXT.1
                  no other protocols
                 and 
				
					invoke platform-provided functionality to use
						
							SSH
							mutually authenticated TLS
							mutually authenticated DTLS
							HTTPS
						
					not invoke any platform-provided functionality
				
				to provide a trusted communication channel between itself and authorized IT
				entities supporting the following capabilities: audit server, 
				
					authentication server
					other capabilities
				
				that is logically distinct from other communication channels and provides assured identification
				of its end points and protection of channel data from modification and disclosure.
              
            
            
              The TSF shall implement functionality and 
				
					invoke platform-provided functionality
					not invoke platform-provided functionality
				
				to permit the MDM Server or other authorized IT entities to initiate communication via the trusted
				channel.
              
            
            
              The TSF shall implement functionality and 
				
					invoke platform-provided functionality
					not invoke platform-provided functionality
				
				to initiate communication via via the trusted channel for
				list of services for which the TSF is able to initiate communications.
              
              
      			When the MDM TOE claims this PP-Module, at least one of its interfaces will implement IPsec
			communications. However, this PP-Module does not specify that any one particular interface must be
			implemented using IPsec. If the TOE uses IPsec to secure communications between itself and external
			trusted IT entities, FTP_ITC.1(1) is refined as above.
                This SFR is refined from its definition in the Base-PP by mandating that the
				“implement functionality” selection be chosen at minimum for IPsec and by
				prohibiting the TOE from relying on platform-provided IPsec functionality. Since the
				TOE may support multiple trusted channel interfaces, the ST author is given the
				option to select other protocols (SSH, TLS, DTLS, HTTPS) either as being implemented
				by the TSF or invoked from the platform.
              
              
                Refer to the EA for FTP_ITC.1(1) in the MDM PP. Note that the PP-Module does not require any separate
			testing for this if IPsec is not used to implement this function.
                
              
            
            
          

		
		
          
          
            This PP-Module adds IPsec as a new protocol that is used to
              implement trusted channels.
            
               The TSF shall implement functionality using IPsec as defined in the PP-Module
				for VPN Client, and 
                
                  TLS as defined in the Package for Transport Layer Security
                  HTTPS in accordance with FCS_HTTPS_EXT.1
                  SSH as defined in the Extended Package for Secure Shell
                  no other protocols
                  and
				
					invoke platform-provided functionality to use
						
							TLS
							HTTPS
							SSH
						
					not invoke any platform-provided functionality
				
				to provide a trusted communication channel between itself as a 
				
					server
					peer
				 
				and remote administrators that is logically distinct from other communication
				paths and provides assured identification of its endpoints and protection of the
				communicated data from [modification, disclosure].
              
            
            
              The TSF shall implement functionality and 
				
					invoke platform-provided functionality
					not invoke platform-provided functionality
				
				to permit remote administrators to initiate communication via the trusted channel.
              
            
            
              The TSF shall implement functionality and 
				
					invoke platform-provided functionality
					not invoke platform-provided functionality
				
				to require the use of the trusted path for [all remote administration actions].
              
              
		      	When the MDM TOE claims this PP-Module, at least one of its interfaces will implement IPsec
			communications. However, this PP-Module does not specify that any one particular interface must be
			implemented using IPsec. If the TOE uses IPsec to secure communications between itself and trusted
			remote administrators, FPT_TRP.1(1) is refined as below.
                This SFR is refined from its definition in the Base-PP by mandating that the
				“implement functionality” selection be chosen at minimum for IPsec and by
				prohibiting the TOE from relying on platform-provided IPsec functionality. Since the
				TOE may support multiple remote administrative interfaces, the ST author is given
				the option to select other protocols (SSH, TLS, HTTPS) either as being implemented
				by the TSF or invoked from the platform.
              
               
                	Refer to the EA for FTP_TRP.1(1) in the MDM PP. Note that the PP-Module does not require any
			separate testing for this if IPsec is not used to implement this function.
                
              
            
            
          
        

		
          
         <div class="comp" id="DM-FTP-ITT-1-1"><h4>FTP_ITT.1/1 Basic Internal TSF Data Transfer Protection</h4><div class="component-activity-header">FTP_ITT.1/1</div>
                Refer to the EA for <span class="no-link">FPT_ITT.1(1)</span> in the MDM PP. Note that the PP-Module does not require any separate
		testing for this if IPsec is not used to implement this function.
                
              </div>		  
		  

	
          <div class="comp" id="DM-FTP-ITC-1-1"><h4>FTP_ITC.1/1  Inter-TSF Trusted Channel (Authorized IT Entities)</h4><div class="component-activity-header">FTP_ITC.1/1</div>
                Refer to the EA for <span class="no-link">FTP_ITC.1(1)</span> in the MDM PP. Note that the PP-Module does not require any separate
			testing for this if IPsec is not used to implement this function.
                
              </div>

		
		
          
          <div class="comp" id="DM-FTP-TRP-1-1"><h4>FTP_TRP.1/1 Trusted Path (for Remote Administration)</h4><div class="component-activity-header">FTP_TRP.1/1</div> 
                	Refer to the EA for <span class="no-link">FTP_TRP.1(1)</span> in the MDM PP. Note that the PP-Module does not require any
			separate testing for this if IPsec is not used to implement this function.
                
              </div>
        
      <h2 class="indexable" data-level="1" id="man-sfrs">2.5 TOE SFR Evaluation Activities</h2><h2 class="indexable" data-level="2" id="m-fcs">2.5.1 Cryptographic Support (FCS)</h2><div class="comp" id="FCS-CKM-1-VPN"><h4>FCS_CKM.1/1 VPN Cryptographic Key Generation (IKE)</h4><div class="component-activity-header">FCS_CKM.1/1</div>
				
				
				
			<div class="eacategory">TSS</div>
					The evaluator shall examine the TSS to verify that it describes how the key generation functionality is
					invoked.
				<div class="eacategory">Guidance</div>
					There are no AGD EAs for this requirement.
				<div class="eacategory">Tests</div>
					If this functionality is implemented by the TSF, refer to the following EAs, depending on the TOE’s
					claimed Base-PP:<p></p>
					<ul>
						<li>GPOS PP: <span class="no-link">FCS_CKM.1</span></li>
						<li>MDF PP: <span class="no-link">FCS_CKM.1</span></li>
						<li>App PP: <span class="no-link">FCS_CKM.1(1)</span></li>
						<li>MDM PP: <span class="no-link">FCS_CKM.1</span></li>
					</ul>
				</div><div class="comp" id="FCS-IPSEC-EXT-1"><h4>FCS_IPSEC_EXT.1 IPsec</h4><div class="component-activity-header">FCS_IPSEC_EXT.1</div>
		
		
		
			
			<div class="eacategory">TSS</div>
			In addition to the TSS EAs for the individual FCS_IPSEC_EXT.1 elements below, the evaluator shall perform
			the following:<p></p>
			If the TOE boundary includes a general-purpose operating system or mobile device, the evaluator shall
			examine the TSS to ensure that it describes whether the VPN client capability is architecturally integrated
			with the platform itself or whether it is a separate executable that is bundled with the platform.<p></p>
		<div class="eacategory">Guidance</div>
			In addition to the Operational Guidance EAs for the individual FCS_IPSEC_EXT.1 elements below, the
			evaluator shall perform the following:<p></p>
			If the configuration of the IPsec behavior is from an environmental source, most notably a VPN gateway
			(e.g through receipt of required connection parameters from a VPN gateway), the evaluator shall ensure
			that the operational guidance contains any appropriate information for ensuring that this configuration
			can be properly applied.<p></p>
			Note in this case that the implementation of the IPsec protocol must be enforced entirely within the TOE
			boundary; i.e. it is not permissible for a software application TOE to be a graphical front-end for IPsec
			functionality implemented totally or in part by the underlying OS platform. The behavior referenced here
			is for the possibility that the configuration of the IPsec connection is initiated from outside the TOE, which
			is permissible so long as the TSF is solely responsible for enforcing the configured behavior. However, it is
			allowable for the TSF to rely on low-level platform-provided networking functions to implement the SPD
			from the client (e.g., enforcement of packet routing decisions).<p></p>
		<div class="eacategory">Tests</div>
			As a prerequisite for performing the Test EAs for the individual FCS_IPSEC_EXT.1 elements below, the
			evaluator shall do the following:<p></p>
			The evaluator shall minimally create a test environment equivalent to the test environment illustrated
			below. It is expected that the traffic generator is used to construct network packets and will provide the
			evaluator with the ability manipulate fields in the ICMP, IPv4, IPv6, UDP, and TCP packet headers. The
			evaluator shall provide justification for any differences in the test environment.<p></p>

   			


   			Note that the evaluator shall perform all tests using the VPN client and a representative sample of
			platforms listed in the ST (for TOEs that claim to support multiple platforms).
		<div class="element-activity-header">FCS_IPSEC_EXT.1.1</div> 
              <div class="eacategory">TSS</div>The evaluator shall examine the TSS and determine that it describes how the IPsec capabilities are
				implemented.<p></p>

                If the TOE is a standalone software application, the evaluator shall ensure that the TSS asserts that all
				IPsec functionality is implemented by the TSF. The evaluator shall also ensure that the TSS identifies what
				platform functionality the TSF relies upon to support its IPsec implementation, if any (e.g. does it invoke
				cryptographic primitive functions from the platform’s cryptographic library, enforcement of packet
				routing decisions by low-level network drivers).<p></p>

                If the TOE is part of a general-purpose desktop or mobile operating system, the evaluator shall ensure
				that the TSS describes at a high level the architectural relationship between the VPN client portion of the
				TOE and the rest of the TOE (e.g. is the VPN client an integrated part of the OS or is it a standalone
				executable that is bundled into the OS package). If the SPD is implemented by the underlying platform in
				this case, then the TSS describes how the client interacts with the platform to establish and populate the
				SPD, including the identification of the platform's interfaces that are used by the client.<p></p>
		    
				In all cases, the evaluator shall also ensure that the TSS describes how the client interacts with the network
				stack of the platform(s) on which it can run (e.g., does the client insert itself within the stack via kernel
				mods, does the client simply invoke APIs to gain access to network services).<p></p>
		      
				The evaluator shall ensure that the TSS describes how the SPD is implemented and the rules for processing
				both inbound and outbound packets in terms of the IPsec policy. The TSS describes the rules that are
				available and the resulting actions available after matching a rule. The TSS describes how the available
				rules and actions form the SPD using terms defined in RFC 4301 such as BYPASS (e.g., no encryption),
				DISCARD (e.g., drop the packet), and PROTECT (e.g., encrypt the packet) actions defined in RFC 4301.
			  
				As noted in section 4.4.1 of RFC 4301, the processing of entries in the SPD is non-trivial and the evaluator
				shall determine that the description in the TSS is sufficient to determine which rules will be applied given
				the rule structure implemented by the TOE. For example, if the TOE allows specification of ranges,
				conditional rules, etc., the evaluator shall determine that the description of rule processing (for both
				inbound and outbound packets) is sufficient to determine the action that will be applied, especially in the
				case where two different rules may apply. This description shall cover both the initial packets (that is, no
				SA is established on the interface or for that particular packet) as well as packets that are part of an
				established SA. <p></p>
			<br/>    
              <div class="eacategory">Guidance</div>
                The evaluator shall examine the operational guidance to verify it describes how the SPD is created and
		configured. If there is an administrative interface to the client, then the guidance describes how the
		administrator specifies rules for processing a packet. The description includes all three cases - a rule that
		ensures packets are encrypted/decrypted, dropped, and allowing a packet to flow in plaintext. The
		evaluator shall determine that the description in the operational guidance is consistent with the
		description in the TSS, and that the level of detail in the operational guidance is sufficient to allow the
		administrator to set up the SPD in an unambiguous fashion. This includes a discussion of how ordering of
		rules impacts the processing of an IP packet.<p></p>

                If the client is configured by an external application, such as the VPN gateway, then the operational
		guidance should indicate this and provide a description of how the client is configured by the external
		application. The description should contain information as to how the SPD is established and set up in an
		unambiguous fashion. The description should also include what is configurable via the external
		application, how ordering of entries may be expressed, as well as the impacts that ordering of entries may
		have on the packet processing.<p></p>

               	In either case, the evaluator ensures the description provided In the TSS is consistent with the capabilities
		and description provided in the operational guidance.<p></p>
              <br/>
              <div class="eacategory">Tests</div>
                Depending on the implementation, the evaluator may be required to use a VPN gateway or some form of
		application to configure the client. For Test 2, the evaluator is required to choose an application that
		allows for the configuration of the full set of capabilities of the VPN client (in conjunction with the
		platform). For example, if the client provides a robust interface that allows for specification of wildcards,
		subnets, etc., it is unacceptable for the evaluator to choose a VPN Gateway that only allows for specifying
		a single fully qualified IP addresses in the rule.<p></p>

                The evaluator shall perform the following tests:
                <ul>
                  <li><b>Test 1: </b>: The evaluator shall configure an SPD on the client that is capable of the following: dropping a
			packet, encrypting a packet, and allowing a packet to flow in plaintext. The selectors used in the
			construction of the rule shall be different such that the evaluator can generate a packet and send packets
			to the client with the appropriate fields (fields that are used by the rule - e.g., the IP addresses, TCP/UDP
			ports) in the packet header. The evaluator performs both positive and negative test cases for each type
			of rule. The evaluator observes via the audit trail, and packet captures that the TOE exhibited the expected
			behavior: appropriate packets were dropped, allowed through without modification, was encrypted by
			the IPsec implementation.</li>
                  <li><b>Test 2: </b>The evaluator shall devise several tests that cover a variety of scenarios for packet processing.
			These scenarios must exercise the range of possibilities for SPD entries and processing modes as outlined
			in the TSS and operational guidance. Potential areas to cover include rules with overlapping ranges and
			conflicting entries, inbound and outbound packets, and packets that establish SAs as well as packets that
			belong to established SAs. The evaluator shall verify, via the audit trail and packet captures, for each
			scenario that the expected behavior is exhibited, and is consistent with both the TSS and the operational
			guidance.
                  </li>
                </ul>
              <br/>
            <div class="element-activity-header">FCS_IPSEC_EXT.1.2</div>
              <div class="eacategory">TSS</div>The evaluator shall check the TSS to ensure it states that the VPN can be established to operate in tunnel
			mode and/or transport mode (as selected). <p></p><br/>
              <div class="eacategory">Guidance</div>The evaluator shall confirm that the operational guidance contains instructions on how to configure the
			connection in each mode selected.<p></p>
		      If both transport mode and tunnel mode are implemented, the evaluator shall review the operational
			guidance to determine how the use of a given mode is specified.<p></p>
              <br/>
              <div class="eacategory">Tests</div>The evaluator shall perform the following test(s) based on the selections chosen:
              <ul>
                <li><b>Test 1: </b> [conditional]: If tunnel mode is selected, the evaluator uses the operational guidance to configure
			the TOE to operate in tunnel mode and also configures a VPN gateway to operate in tunnel mode. The
			evaluator configures the TOE and the VPN gateway to use any of the allowable cryptographic algorithms, 
			authentication methods, etc. to ensure an allowable SA can be negotiated. The evaluator shall then
			initiate a connection from the client to connect to the VPN GW peer. The evaluator observes (for example,
			in the audit trail and the captured packets) that a successful connection was established using the tunnel
			mode.</li>
                <li><b>Test 2: </b>[conditional]: If transport mode is selected, the evaluator uses the operational guidance to
			configure the TOE to operate in transport mode and also configures an IPsec peer to accept IPsec
			connections using transport mode. The evaluator configures the TOE and the endpoint device to use any
			of the allowed cryptographic algorithms, authentication methods, etc. to ensure an allowable SA can be
			negotiated. The evaluator then initiates a connection from the TOE to connect to the remote endpoint.
			The evaluator observes (for example, in the audit trail and the captured packets) that a successful
			connection was established using the transport mode.
		</li>
                <li><b>Test 3: </b> [conditional]: If both tunnel mode and transport mode are selected, the evaluator shall perform
			both Test 1 and Test 2 above, demonstrating that the TOE can be configured to support both modes.</li>
                <li><b>Test 4: </b> [conditional]: If both tunnel mode and transport mode are selected, the evaluator shall modify the
			testing for FCS_IPSEC_EXT.1 to include the supported mode for SPD PROTECT entries to show that they
			only apply to traffic that is transmitted or received using the indicated mode.
                </li>
              </ul>
              <br/>
            <div class="element-activity-header">FCS_IPSEC_EXT.1.3</div>
              <div class="eacategory">TSS</div>The evaluator shall examine the TSS to verify that the TSS provides a description of how a packet is
		processed against the SPD and that if no “rules” are found to match, that a final rule exists, either implicitly
		or explicitly, that causes the network packet to be discarded.<p></p>
              <br/>
              <div class="eacategory">Guidance</div>The evaluator shall check that the operational guidance provides instructions on how to construct or
		acquire the SPD and uses the guidance to configure the TOE for the following test.<p></p><br/>
              <div class="eacategory">Tests</div>The evaluator shall perform the following test:<p></p>
		      <ul>
			      <li><b>Test 1: </b>
		     		The evaluator shall configure the SPD such that it has entries that contain operations that DISCARD,
				PROTECT, and (if applicable) BYPASS network packets. The evaluator may use the SPD that was created
				for verification of FCS_IPSEC_EXT.1.1. The evaluator shall construct a network packet that matches a
				BYPASS entry and send that packet. The evaluator should observe that the network packet is passed to
				the proper destination interface with no modification. The evaluator shall then modify a field in the packet
				header; such that it no longer matches the evaluator-created entries (there may be a “TOE-created” final
				entry that discards packets that do not match any previous entries). The evaluator sends the packet, and
				observes that the packet was not permitted to flow to any of the TOE’s interfaces.
			      </li>
		      </ul>
	     <br/>
            <div class="element-activity-header">FCS_IPSEC_EXT.1.4</div>
              <div class="eacategory">TSS</div>The evaluator shall examine the TSS to verify that the algorithms AES-GCM-128 and AES-GCM-256 are
		implemented. If the ST author has selected either AES-CBC-128 or AES-CBC-256 in the requirement, then
		the evaluator verifies the TSS describes these as well. In addition, the evaluator ensures that the SHA-
		based HMAC algorithm conforms to the algorithms specified in the relevant iteration of FCS_COP.1 from
		the Base-PP that applies to keyed-hash message authentication.<p></p><br/>
              <div class="eacategory">Guidance</div>The evaluator checks the operational guidance to ensure it provides instructions on how the TOE is
		configured to use the algorithms selected in this component and whether this is performed through direct
		configuration, defined during initial installation, or defined by acquiring configuration settings from an
		environmental component.<p></p>
              <br/>
              <div class="eacategory">Tests</div>
		      <ul>
			      <li><b>Test 1: </b>
				      The evaluator shall configure the TOE as indicated in the operational guidance configuring the TOE
					to using each of the AES-GCM-128, and AES-GCM-256 algorithms, and attempt to establish a connection
					using ESP. If the ST Author has selected either AES-CBC-128 or AES-CBC-256, the TOE is configured to use
					those algorithms and the evaluator attempts to establish a connection using ESP for those algorithms
					selected.
			      </li>
		      </ul>
              <br/>
            <div class="element-activity-header">FCS_IPSEC_EXT.1.5</div>
              <div class="eacategory">TSS</div>The evaluator shall examine the TSS to verify that IKEv1 and/or IKEv2 are implemented. If IKEv1 is
		implemented, the evaluator shall verify that the TSS indicates whether or not XAUTH is supported, and
		that aggressive mode is not used for IKEv1 Phase 1 exchanges (i.e. only main mode is used). It may be that
		these are configurable options.<p></p>
              <br/>
              <div class="eacategory">Guidance</div>The evaluator shall check the operational guidance to ensure it instructs the administrator how to
		configure the TOE to use IKEv1 and/or IKEv2 (as selected), and uses the guidance to configure the TOE to
		perform NAT traversal for the test below. If XAUTH is implemented, the evaluator shall verify that the
		operational guidance provides instructions on how it is enabled or disabled. <p></p>
                If the TOE supports IKEv1, the evaluator shall verify that the operational guidance either asserts that only
		main mode is used for Phase 1 exchanges, or provides instructions for disabling aggressive mode.<p></p>
		<br/>
              <div class="eacategory">Tests</div>
                <ul>
                  <li><b>Test 1: </b>The evaluator shall configure the TOE so that it will perform NAT traversal processing as described
			in the TSS and RFC 7296, section 2.23. The evaluator shall initiate an IPsec connection and determine that
			the NAT is successfully traversed. If the TOE supports IKEv1 with or without XAUTH, the evaluator shall
			verify that this test can be successfully repeated with XAUTH enabled and disabled in the manner specified
			by the operational guidance. If the TOE only supports IKEv1 with XAUTH, the evaluator shall verify that
			connections not using XAUTH are unsuccessful. If the TOE only supports IKEv1 without XAUTH, the
			evaluator shall verify that connections using XAUTH are unsuccessful.</li>
                  <li><b>Test 2: </b> [conditional]: If the TOE supports IKEv1, the evaluator shall perform any applicable operational
			guidance steps to disable the use of aggressive mode and then attempt to establish a connection using an
			IKEv1 Phase 1 connection in aggressive mode. This attempt should fail. The evaluator shall show that the
			TOE will reject a VPN gateway from initiating an IKEv1 Phase 1 connection in aggressive mode. The
			evaluator should then show that main mode exchanges are supported.</li>
                </ul>
              <br/>
            <div class="element-activity-header">FCS_IPSEC_EXT.1.6</div>
              <div class="eacategory">TSS</div>The evaluator shall ensure the TSS identifies the algorithms used for encrypting the IKEv1 and/or IKEv2
		payload, and that the algorithms AES-CBC-128, AES-CBC-256 are specified, and if others are chosen in the
		selection of the requirement, those are included in the TSS discussion.<p></p><br/>
              <div class="eacategory">Guidance</div>The evaluator checks the operational guidance to ensure it provides instructions on how the TOE is
		configured to use the algorithms selected in this component and whether this is performed through direct
		configuration, defined during initial installation, or defined by acquiring configuration settings from an
		environmental component.  <p></p>
              <br/>
              <div class="eacategory">Tests</div>The evaluator shall use the operational guidance to configure the TOE (or to configure the Operational
		Environment to have the TOE receive configuration) to perform the following test for each ciphersuite
		selected:<p></p>
		<ul>
			<li><b>Test 1: </b>
               			The evaluator shall configure the TOE to use the ciphersuite under test to encrypt the IKEv1 and/or
				IKEv2 payload and establish a connection with a peer device, which is configured to only accept the
				payload encrypted using the indicated ciphersuite. The evaluator will confirm the algorithm was that used
				in the negotiation. The evaluator will confirm that the connection is successful by confirming that data
				can be passed through the connection once it is established. For example, the evaluator may connect to
				a webpage on the remote network and verify that it can be reached.
			</li>
	         </ul>
              <br/>
            <div class="element-activity-header">FCS_IPSEC_EXT.1.7</div>
              <div class="eacategory">TSS</div>There are no TSS EAs for this requirement.<p></p><br/>
              <div class="eacategory">Guidance</div>The evaluator shall check the operational guidance to ensure it provides instructions on how the TOE
		configures the values for SA lifetimes. In addition, the evaluator shall check that the guidance has the
		option for either the Administrator or VPN Gateway to configure Phase 1 SAs if time-based limits are
		supported. Currently there are no values mandated for the number of packets or number of bytes, the
		evaluator shall simply check the operational guidance to ensure that this can be configured if selected in
		the requirement.<p></p><br/>
              <div class="eacategory">Tests</div>When testing this functionality, the evaluator needs to ensure that both sides are configured
		appropriately. From the RFC “A difference between IKEv1 and IKEv2 is that in IKEv1 SA lifetimes were
		negotiated. In IKEv2, each end of the SA is responsible for enforcing its own lifetime policy on the SA and
		rekeying the SA when necessary. If the two ends have different lifetime policies, the end with the shorter
		lifetime will end up always being the one to request the rekeying. If the two ends have the same lifetime
		policies, it is possible that both will initiate a rekeying at the same time (which will result in redundant
		SAs). To reduce the probability of this happening, the timing of rekeying requests SHOULD be jittered.”<p></p>
		Each of the following tests shall be performed for each version of IKE selected in the FCS_IPSEC_EXT.1.5
		protocol selection:<p></p>
                Each of the following tests shall be performed for each version of IKE selected in the
                FCS_IPSEC_EXT.1.5 protocol selection:
              <ul>
                <li><b>Test 1: </b> [conditional]: The evaluator shall configure a maximum lifetime in terms of the # of packets (or
			bytes) allowed following the operational guidance. The evaluator shall establish an SA and determine that
			once the allowed # of packets (or bytes) through this SA is exceeded, the connection is closed.</li>
                <li><b>Test 2: </b> [conditional]: The evaluator shall construct a test where a Phase 1 SA is established and attempted
			to be maintained for more than 24 hours before it is renegotiated. The evaluator shall observe that this
			SA is closed or renegotiated in 24 hours or less. If such an action requires that the TOE be configured in a
			specific way, the evaluator shall implement tests demonstrating that the configuration capability of the
			TOE works as documented in the operational guidance.</li>
                <li><b>Test 3: </b> [conditional]: The evaluator shall perform a test similar to Test 2 for Phase 2 SAs, except that the
			lifetime will be 8 hours or less instead of 24 hours or less.</li>
                <li><b>Test 4: </b> [conditional]: If a fixed limit for IKEv1 SAs is supported, the evaluator shall establish an SA and
			observe that the connection is closed after the fixed traffic and/or time value is reached.</li>
              </ul>
              <br/>
            <div class="element-activity-header">FCS_IPSEC_EXT.1.8</div>
              <div class="eacategory">TSS</div>The evaluator shall check to ensure that the DH groups specified in the requirement are listed as being
		supported in the TSS. If there is more than one DH group supported, the evaluator checks to ensure the
		TSS describes how a particular DH group is specified/negotiated with a peer.<p></p><br/>
              <div class="eacategory">Guidance</div>There are no AGD EAs for this requirement.<p></p><br/>
              <div class="eacategory">Tests</div>The evaluator shall perform the following test: 
		      <ul>
			      <li><b>Test 1: </b>For each supported DH group, the evaluator shall test to ensure that all supported IKE 
				      protocols can be successfully completed using that particular DH group.
			      </li>
		      </ul>
		<br/>
            <div class="element-activity-header">FCS_IPSEC_EXT.1.9</div>
              <div class="eacategory">TSS</div>The evaluator shall check to ensure that, for each DH group supported, the TSS describes the process for
		generating "x" (as defined in FCS_IPSEC_EXT.1.9) and each nonce. The evaluator shall verify that the TSS
		indicates that the random number generated that meets the requirements in this EP is used, and that the
		length of "x" and the nonces meet the stipulations in the requirement.<p></p><br/>
              <div class="eacategory">Guidance</div>There are no AGD EAs for this requirement.<p></p><br/>
              <div class="eacategory">Tests</div>There are no test EAs for this requirement.<br/>
            <div class="element-activity-header">FCS_IPSEC_EXT.1.10</div>
              EAs for this element are tested through EAs for FCS_IPSEC_EXT.1.9.
              
            <div class="element-activity-header">FCS_IPSEC_EXT.1.11</div>
              <div class="eacategory">TSS</div>The evaluator ensures that the TSS identifies RSA and/or ECDSA as being used to perform peer
		authentication.<p></p>
                If pre-shared keys are chosen in the selection, the evaluator shall check to ensure that the TSS describes
		how pre-shared keys are established and used in authentication of IPsec connections. The description in
		the TSS shall also indicate how pre-shared key establishment is accomplished depending on whether the
		TSF can generate a pre-shared key, accept a pre-shared key, or both.<p></p>
                The evaluator shall ensure that the TSS describes how the TOE compares the peer’s presented identifier
		to the reference identifier. This description shall include whether the certificate presented identifier is
		compared to the ID payload presented identifier, which field(s) of the certificate are used as the presented
		identifier (DN, Common Name, or SAN) and, if multiple fields are supported, the logical order comparison.
		If the ST author assigned an additional identifier type, the TSS description shall also include a description
		of that type and the method by which that type is compared to the peer’s presented certificate.<p></p><br/>
              <div class="eacategory">Guidance</div>The evaluator shall check that the operational guidance describes how pre-shared keys are to be
		generated and established. <p></p>
                The evaluator ensures the operational guidance describes how to set up the TOE to use the cryptographic
		algorithms RSA and/or ECDSA.<p></p>
               In order to construct the environment and configure the TOE for the following tests, the evaluator will
		ensure that the operational guidance also describes how to configure the TOE to connect to a trusted CA,
		and ensure a valid certificate for that CA is loaded into the TOE as a trusted CA.<p></p>
		The evaluator shall also ensure that the operational guidance includes the configuration of the reference
		identifier(s) for the peer.<p></p><br/>
              <div class="eacategory">Tests</div>For efficiency’s sake, the testing that is performed here has been combined with the testing for
		      <b>FIA_X509_EXT.2</b> and <b>FIA_X509_EXT.3</b> (for IPsec connections and depending on the Base-PP),
		      <b>FCS_IPSEC_EXT.1.12</b>, and <b>FCS_IPSEC_EXT.1.13</b>. The following tests shall be repeated for each peer
		      authentication protocol selected in the <b>FCS_IPSEC_EXT.1.11</b> selection above:
              <ul>
                <li><b>Test 1: </b>The evaluator shall have the TOE generate a public-private key pair, and submit a CSR (Certificate
			Signing Request) to a CA (trusted by both the TOE and the peer VPN used to establish a connection) for
			its signature. The values for the DN (Common Name, Organization, Organizational Unit, and Country) will
			also be passed in the request. Alternatively, the evaluator may import to the TOE a previously generated
			private key and corresponding certificate.
                </li>
                <li><b>Test 2: </b>The evaluator shall configure the TOE to use a private key and associated certificate signed by a
			trusted CA and shall establish an IPsec connection with the peer.                
		</li>
                <li><b>Test 3: </b>: The evaluator shall test that the TOE can properly handle revoked certificates – conditional on
			whether CRL or OCSP is selected; if both are selected, and then a test is performed for each method. For
			this current version of the PP-Module, the evaluator has to only test one up in the trust chain (future
			drafts may require to ensure the validation is done up the entire chain). The evaluator shall ensure that a
			valid certificate is used, and that the SA is established. The evaluator then attempts the test with a
			certificate that will be revoked (for each method chosen in the selection) to ensure when the certificate
			is no longer valid that the TOE will not establish an SA
                </li>
                <li><b>Test 4: </b> [conditional]: The evaluator shall generate a pre-shared key and use it, as indicated in the
			operational guidance, to establish an IPsec connection with the VPN GW peer. If the generation of the
			pre-shared key is supported, the evaluator shall ensure that establishment of the key is carried out for an
			instance of the TOE generating the key as well as an instance of the TOE merely taking in and using the
			key.</li>
                For each supported identifier type (excluding DNs), the evaluator shall repeat the following tests:
                <li><b>Test 5: </b> For each field of the certificate supported for comparison, the evaluator shall configure the peer’s
			reference identifier on the TOE (per the administrative guidance) to match the field in the peer’s
			presented certificate and shall verify that the IKE authentication succeeds.</li>
                <li><b>Test 6: </b>For each field of the certificate support for comparison, the evaluator shall configure the peer’s
			reference identifier on the TOE (per the administrative guidance) to not match the field in the peer’s
			presented certificate and shall verify that the IKE authentication fails.</li>
                The following tests are conditional:
                <li><b>Test 7: </b> [conditional]: If, according to the TSS, the TOE supports both Common Name and SAN certificate
			fields and uses the preferred logic outlined in the Application Note, the tests above with the Common
			Name field shall be performed using peer certificates with no SAN extension. Additionally, the evaluator
			shall configure the peer’s reference identifier on the TOE to not match the SAN in the peer’s presented
			certificate but to match the Common Name in the peer’s presented certificate, and verify that the IKE
			authentication fails.
		</li>
                <li><b>Test 8: </b> [conditional]: If the TOE supports DN identifier types, the evaluator shall configure the peer's
			reference identifier on the TOE (per the administrative guidance) to match the subject DN in the peer's
			presented certificate and shall verify that the IKE authentication succeeds. To demonstrate a bit-wise
			comparison of the DN, the evaluator shall change a single bit in the DN (preferably, in an Object Identifier
			(OID) in the DN) and verify that the IKE authentication fails. <b>To demonstrate a comparison of DN values,
			the evaluator shall change any one of the four DN values and verify that the IKE authentication fails.</b>
                </li>
                <li><b>Test 9: </b> [conditional]: If the TOE supports both IPv4 and IPv6 and supports IP address identifier types, the
			evaluator must repeat test 1 and 2 with both IPv4 address identifiers and IPv6 identifiers. Additionally,
			the evaluator shall verify that the TOE verifies that the IP header matches the identifiers by setting the
			presented identifiers and the reference identifier with the same IP address that differs from the actual IP
			address of the peer in the IP headers and verifying that the IKE authentication fails.
		</li>
                <li><b>Test 10: </b>[conditional]: If, according to the TSS, the TOE performs comparisons between the peer’s ID
			payload and the peer’s certificate, the evaluator shall repeat the following test for each combination of
			supported identifier types and supported certificate fields (as above). The evaluator shall configure the
			peer to present a different ID payload than the field in the peer’s presented certificate and verify that the
			TOE fails to authenticate the IKE peer.</li>
              </ul>
		<br/>
            <div class="element-activity-header">FCS_IPSEC_EXT.1.12</div>
              EAs for this element are tested through EAs for FCS_IPSEC_EXT.1.11.
              
            <div class="element-activity-header">FCS_IPSEC_EXT.1.13</div>
              EAs for this element are tested through EAs for FCS_IPSEC_EXT.1.11.
              
            <div class="element-activity-header">FCS_IPSEC_EXT.1.14</div>
              <div class="eacategory">TSS</div>The evaluator shall check that the TSS describes the potential strengths (in terms of the number of bits in
		the symmetric key) of the algorithms that are allowed for the IKE and ESP exchanges. The TSS shall also
		describe the checks that are done when negotiating IKEv1 Phase 2 and/or IKEv2 CHILD_SA suites to ensure
		that the strength (in terms of the number of bits of key in the symmetric algorithm) of the negotiated
		algorithm is less than or equal to that of the IKE SA this is protecting the negotiation.
		<p></p><br/>
              <div class="eacategory">Guidance</div>There are no AGD EAs for this requirement.<p></p><br/>
              <div class="eacategory">Tests</div>The evaluator follows the guidance to configure the TOE to perform the following tests:
              <ul>
                <li><b>Test 1: </b>This test shall be performed for each version of IKE supported. The evaluator shall successfully
		negotiate an IPsec connection using each of the supported algorithms and hash functions identified in the
		requirements.</li>
                <li><b>Test 2: </b> [conditional]: This test shall be performed for each version of IKE supported. The evaluator shall
			attempt to establish an SA for ESP that selects an encryption algorithm with more strength than that being
			used for the IKE SA (i.e., symmetric algorithm with a key size larger than that being used for the IKE SA).
			Such attempts should fail.</li>
                <li><b>Test 3: </b>This test shall be performed for each version of IKE supported. The evaluator shall attempt to
			establish an IKE SA using an algorithm that is not one of the supported algorithms and hash functions
			identified in the requirements. Such an attempt should fail.
                </li>
                <li><b>Test 4: </b> This test shall be performed for each version of IKE supported. The evaluator shall attempt to
			establish an SA for ESP (assumes the proper parameters where used to establish the IKE SA) that selects
			an encryption algorithm that is not identified in FCS_IPSEC_EXT.1.4. Such an attempt should fail.
                </li>
              </ul>
		<br/>
            </div><h2 class="indexable" data-level="2" id="m-fdp">2.5.2 User Data Protection (FDP)</h2><div class="comp" id="FDP-RIP-2"><h4>FDP_RIP.2 Full Residual Information Protection</h4><div class="component-activity-header">FDP_RIP.2</div>
              
              
              
            <div class="eacategory">TSS</div><b>Requirement met by the platform</b><p></p>
                The evaluator shall examine the TSS to verify that it describes (for each supported platform) the extent to
		which the client processes network packets and addresses the FDP_RIP.2 requirement.<p></p>
                <b>Requirement met by the TOE</b><p></p>
               “Resources” in the context of this requirement are network packets being sent through (as opposed to
		“to”, as is the case when a security administrator connects to the TOE) the TOE. The concern is that once
		a network packet is sent, the buffer or memory area used by the packet still contains data from that
		packet, and that if that buffer is re-used, those data might remain and make their way into a new packet.
		The evaluator shall check to ensure that the TSS describes packet processing to the extent that they can
		determine that no data will be reused when processing network packets. The evaluator shall ensure that
		this description at a minimum describes how the previous data are zeroized/overwritten, and at what
		point in the buffer processing this occurs.
              <div class="eacategory">Guidance</div>There are no AGD EAs for this requirement.<p></p><div class="eacategory">Tests</div>There are no test EAs for this requirement.<p></p></div><h2 class="indexable" data-level="2" id="m-fmt">2.5.3 Security Management (FMT)</h2><div class="comp" id="FMT-SMF-1-VPN"><h4>FMT_SMF.1/VPN Specification of Management Functions (VPN)</h4><div class="component-activity-header">FMT_SMF.1/VPN</div>
              
              
              
            <div class="eacategory">TSS</div>The evaluator shall check to ensure the TSS describes the client credentials and how they are used by the
		TOE.<p></p>
              <div class="eacategory">Guidance</div>The evaluator shall check to make sure that every management function mandated in the ST for this
		requirement is described in the operational guidance and that the description contains the information
		required to perform the management duties associated with each management function. <p></p>
              <div class="eacategory">Tests</div>
                The evaluator shall test the TOE’s ability to provide the management functions by configuring the TOE
		according to the operational guidance and testing each management activity listed in the ST.<p></p>
                The evaluator shall ensure that all management functions claimed in the ST can be performed by
		completing activities described in the AGD. Note that this may be performed in the course of completing
		other testing.
              </div><h2 class="indexable" data-level="2" id="m-fpt">2.5.4 Protection of the TSF (FPT)</h2><div class="comp" id="FPT-TST-EXT-1-VPN"><h4>FPT_TST_EXT.1/VPN TSF Self-Test</h4><div class="component-activity-header">FPT_TST_EXT.1/VPN</div>
              Except for where it is explicitly noted, the evaluator is expected to check the following information
		regardless of whether the functionality is implemented by the TOE or by the TOE platform.<p></p>
              
              
              
            <div class="eacategory">TSS</div>The evaluator shall examine the TSS to ensure that it details the self-tests that are run by the TSF on startup; this description should include an outline of what the tests are actually doing (e.g., rather than saying
		"memory is tested", a description similar to "memory is tested by writing a value to each memory location
		and reading it back to ensure it is identical to what was written" shall be used). The evaluator shall ensure
		that the TSS makes an argument that the tests are sufficient to demonstrate that the TSF is operating
		correctly. If some of the tests are performed by the TOE platform, the evaluator shall check the TSS to
		ensure that those tests are identified, and that the ST for each platform contains a description of those
		tests. Note that the tests that are required by this component are those that support security functionality
		in the VPN Client PP-Module, which may not correspond to the set of all self-tests contained in the
		platform STs.<p></p>

                The evaluator shall examine the TSS to ensure that it describes how the integrity of stored TSF executable
		code is cryptographically verified when it is loaded for execution. The evaluator shall ensure that the TSS
		makes an argument that the tests are sufficient to demonstrate that the integrity of stored TSF executable
		code has not been compromised. The evaluator shall check to ensure that the cryptographic requirements
		listed are consistent with the description of the integrity verification process.<p></p>

                The evaluator also ensures that the TSS (or the operational guidance) describes the actions that take place
		for successful (e.g. hash verified) and unsuccessful (e.g., hash not verified) cases. For checks implemented
		entirely by the platform, the evaluator ensures that the operational guidance for the TOE references or
		includes the platform-specific guidance for each platform listed in the ST.<p></p>
              <div class="eacategory">Guidance</div>If not present in the TSS, the evaluator ensures that the operational guidance describes the actions that
		take place for successful (e.g. hash verified) and unsuccessful (e.g., hash not verified) cases. For checks
		implemented entirely by the platform, the evaluator ensures that the operational guidance for the TOE
		references or includes the platform-specific guidance for each platform listed in the ST.<p></p>
              <div class="eacategory">Tests</div>
                The evaluator shall perform the following tests:
                <ul>
                  <li><b>Test 1: </b>The evaluator performs the integrity check on a known good TSF executable and verifies that the
			check is successful.
                  </li>
                  <li><b>Test 2: </b>The evaluator modifies the TSF executable, performs the integrity check on the modified TSF
			executable and verifies that the check fails.</li>
                </ul>
              </div><h2 class="indexable" data-level="1" id="opt-sfrs">2.6 Evaluation Activities for Optional SFRs</h2>The PP-Module does not define any optional requirements.<h2 class="indexable" data-level="1" id="sel-sfrs">2.7 Evaluation Activities for Selection-Based SFRs</h2><h2 class="indexable" data-level="2" id="s-fia">2.7.1 Identification and Authentication (FIA)</h2><div class="comp" id="FIA-PSK-EXT-1"><h4>FIA_PSK_EXT.1 Pre-Shared Key Composition</h4><div class="component-activity-header">FIA_PSK_EXT.1</div>
              
              
              
            <div class="eacategory">TSS</div>The evaluator shall also examine the TSS to ensure it describes the process by which the
		      bit-based preshared keys are generated (if the TOE supports this functionality), and
		      confirm that this process uses the RBG specified in FCS_RBG_EXT.1.<p></p>
		      The evaluator shall examine the TSS to ensure that it states that text-based pre-shared keys of 22
			characters are supported. The evaluator shall also confirm that the TSS states the conditioning that takes
			place to transform the text-based pre-shared key from the key sequence entered by the user (e.g., ASCII
			representation) to the bit string used by IPsec, and that this conditioning is consistent with the
			FIA_PSK_EXT.1.3.<p></p>
              <div class="eacategory">Guidance</div>If the TOE supports bit-based pre-shared keys, the evaluator shall confirm the operational guidance
		contains instructions for either entering bit-based pre- shared keys for each protocol identified in the
		requirement, or generating a bit-based pre-shared key (or both). The evaluator shall also examine the TSS
		to ensure it describes the process by which the bit-based pre-shared keys are generated (if the TOE
		supports this functionality), and confirm that this process uses the RBG specified in FCS_RBG_EXT.1. <p></p>
                The evaluator shall check that any management functions related to pre-shared keys that are performed
		by the TOE are specified in the operational guidance.<p></p>
                The evaluator shall examine the operational guidance to determine that it provides guidance on the
		composition of strong text-based pre-shared keys, and (if the selection indicates keys of various lengths
		can be entered) that it provides information on the merits of shorter or longer pre-shared keys. The
		guidance must specify the allowable characters for pre-shared keys, and that list must include, at
		minimum, the same items contained in FIA_PSK_EXT.1.2.<p></p>
              <div class="eacategory">Tests</div>The evaluator shall perform the following tests:
              <ul>
                <li><b>Test 1: </b>The evaluator shall compose a pre-shared key of 22 characters that contains a combination of the
			allowed characters in accordance with the operational guidance, and demonstrates that a successful
			protocol negotiation can be performed with the key.
		</li>
                <li><b>Test 2: </b> [conditional]: If the TOE supports pre-shared keys of multiple lengths, the evaluator shall
                  repeat Test 1 using the minimum length; the maximum length; and invalid lengths that are below
                  the minimum length, above the maximum length, null length, empty length, or zero length. The
                  minimum and maximum length tests should be successful, and the invalid lengths must be rejected
                  by the TOE.
                </li>
                <li><b>Test 3: </b> [conditional]: If the TOE supports but does not generate bit-based pre-shared keys, the evaluator
			shall obtain a bit-based pre-shared key of the appropriate length and enter it per the instructions in the 
			operational guidance. The evaluator shall then demonstrate that a successful protocol negotiation can be
			performed with the key.</li>
                <li><b>Test 4: </b> [conditional]: If the TOE does generate bit-based pre-shared keys, the evaluator shall generate a
			bit-based pre-shared key of the appropriate length and use it according to the instructions in the
			operational guidance. The evaluator shall then demonstrate that a successful protocol negotiation can be
			performed with the key.</li>
              </ul>
              </div><h2 class="indexable" data-level="1" id="obj-sfrs">2.8 Evaluation Activities for Objective SFRs</h2><h2 class="indexable" data-level="2" id="ob-fau">2.8.1 Security Audit (FAU)</h2><div class="comp" id="FAU-GEN-1-VPN"><h4>FAU_GEN.1/VPN Audit Data Generation</h4><div class="component-activity-header">FAU_GEN.1/VPN</div>
              
              
              
            <div class="eacategory">TSS</div>The evaluator shall examine the TSS to determine that it describes the auditable events and the
		component that is responsible for each type of auditable event.<p></p><div class="eacategory">Guidance</div>The evaluator shall check the operational guidance and ensure that it lists all of the auditable events and
			provides a format for audit records. Each audit record format type must be covered, along with a brief
			description of each field. The evaluator shall check to make sure that every audit event type mandated by
			the VPN Client PP-Module is described and that the description of the fields contains the information
			required in FAU_GEN.1.2/VPN, and the additional information specified in the Auditable Events table of
			the VPN Client PP-PP-Module.
			<p></p>

               In particular, the evaluator shall ensure that the operational guidance is clear in relation to the contents
		for failed cryptographic events. In the Auditable Events table of the VPN Client PP-Module, information
		detailing the cryptographic mode of operation and a name or identifier for the object being encrypted is
		required. The evaluator shall ensure that name or identifier is sufficient to allow an administrator
		reviewing the audit log to determine the context of the cryptographic operation (for example, performed
		during a key negotiation exchange, performed when encrypting data for transit) as well as the non-TOE
		endpoint of the connection for cryptographic failures relating to communications with other IT systems.<p></p>

               The evaluator shall also make a determination of the administrative actions that are relevant in the
		context of the VPN Client PP-Module. The TOE may contain functionality that is not evaluated in the
		context of the VPN Client PP-Module because the functionality is not specified in an SFR. This functionality
		may have administrative aspects that are described in the operational guidance. Since such administrative
		actions will not be performed in an evaluated configuration of the TOE, the evaluator shall examine the
		operational guidance and make a determination of which administrative commands, including
		subcommands, scripts, and configuration files, are related to the configuration (including enabling or
		disabling) of the mechanisms implemented in the TOE that are necessary to enforce the requirements
		specified in the VPN Client PP-Module, which thus form the set of “all administrative actions”. The
		evaluator may perform this activity as part of the activities associated with ensuring the AGD_OPE
		guidance satisfies the requirements.<p></p>
		    
		For each required auditable event, the evaluator shall examine the operational guidance to determine
		that it is clear to the reader where each event is generated (e.g. the TSF may generate its own audit logs
		in one location while the platform-provided auditable events are generated elsewhere).
	<div class="eacategory">Tests</div>The evaluator shall test the TOE’s ability to correctly generate audit records by having the TOE generate
		audit records in accordance with the EAs associated with the functional requirements in the VPN Client 
		PP-Module. Additionally, the evaluator shall test that each administrative action applicable in the context
		of the VPN Client PP-Module is auditable. When verifying the test results, the evaluator shall ensure the
		audit records generated during testing match the format specified in the administrative guide, and that
		the fields in each audit record have the proper entries.
		<p></p>

              Note that the testing here can be accomplished in conjunction with the testing of the security mechanisms
		directly. For example, testing performed to ensure that the administrative guidance provided is correct
		verifies that AGD_OPE.1 is satisfied and should address the invocation of the administrative actions that
		are needed to verify the audit records are generated as expected.
              </div><div class="comp" id="FAU-SEL-1-VPN"><h4>FAU_SEL.1/VPN Selective Audit</h4><div class="component-activity-header">FAU_SEL.1/VPN</div>
              
              
              
            <div class="eacategory">TSS</div>There are no TSS EAs for this SFR.<p></p><div class="eacategory">Guidance</div>The evaluator shall review the administrative guidance to ensure that the guidance itemizes all event
		types, as well as describes all attributes that are to be selectable in accordance with the requirement, to
		include those attributes listed in the assignment. The administrative guidance shall also contain
		instructions on how to set the pre-selection, or how the VPN gateway will configure the client, as well as
		explain the syntax (if present) for multi-value pre-selection. The administrative guidance shall also identify
		those audit records that are always recorded, regardless of the selection criteria currently being enforced.<p></p><div class="eacategory">Tests</div>The evaluator shall perform the following tests:
              <ul>
                <li><b>Test 1: </b>For each attribute listed in the requirement, the evaluator shall devise a test to show that selecting
			the attribute causes only audit events with that attribute (or those that are always recorded, as identified
			in the administrative guidance) to be recorded.
                </li>
                <li><b>Test 2: </b>[conditional] If the TSF supports specification of more complex audit pre-selection criteria (e.g.,
			multiple attributes, logical expressions using attributes) then the evaluator shall devise tests showing that
			this capability is correctly implemented. The evaluator shall also, in the test plan, provide a short narrative
			justifying the set of tests as representative and sufficient to exercise the capability.
                </li>
              </ul>
              </div><h2 class="indexable" data-level="2" id="ob-fdp">2.8.2 User Data Protection (FDP)</h2><div class="comp" id="FDP-IFC-EXT-1"><h4>FDP_IFC_EXT.1 Subset Information Flow Control</h4><div class="component-activity-header">FDP_IFC_EXT.1</div>
              
              
              
            <div class="eacategory">TSS</div>The evaluator shall verify that the TSS section of the ST describes the routing of IP traffic through processes
		on the TSF when a VPN client is enabled. The evaluator shall ensure that the description indicates which
		traffic does not go through the VPN and which traffic does and that a configuration exists for each
		baseband protocol in which only the traffic identified by the ST author is necessary for establishing the
		VPN connection (IKE traffic and perhaps HTTPS or DNS traffic) is not encapsulated by the VPN protocol 
		(IPsec). The ST author shall also identify in the TSS section any differences in the routing of IP traffic when
		using any supported baseband protocols (e.g. WiFi or, LTE).
		<p></p>
              <div class="eacategory">Guidance</div>The evaluator shall verify that the following is addressed by the documentation:
                <ul>
                <li>The description above indicates that if a VPN client is enabled, all configurations route all IP traffic
			(other than IP traffic required to establish the VPN connection) through the VPN client.</li>
                <li>The AGD guidance describes how the user and/or administrator can configure the TSF to meet
			this requirement.</li>
                </ul><p></p>
              <div class="eacategory">Tests</div>
                The evaluator shall perform the following test:<p></p>
                Step 1 - The evaluator shall use the platform to enable a network connection without using IPsec. The
		evaluator shall use a packet sniffing tool between the platform and an Internet-connected network. The
		evaluator shall turn on the sniffing tool and perform actions with the device such as navigating to
		websites, using provided applications, accessing other Internet resources (Use Case 1), accessing another
		VPN client (Use Case 2), or accessing an IPsec-capable network device (Use Case 3). The evaluator shall
		verify that the sniffing tool captures the traffic generated by these actions, turn off the sniffing tool, and
		save the session data. <p></p>
                Step 2 - The evaluator shall configure an IPsec VPN client that supports the routing specified in this
		requirement, and if necessary, configure the device to perform the routing specified as described in the
		AGD guidance. The evaluator shall turn on the sniffing tool, establish the VPN connection, and perform
		the same actions with the device as performed in the first step. The evaluator shall verify that the sniffing
		tool captures traffic generated by these actions, turn off the sniffing tool, and save the session data.<p></p>
                Step 3 - The evaluator shall examine the traffic from both step one and step two to verify that all IP traffic,
		aside from and after traffic necessary for establishing the VPN (such as IKE, DNS, and possibly HTTPS), is
		encapsulated by IPsec.<p></p>
                Step 4 - The evaluator shall attempt to send packets to the TOE outside the VPN connection and shall
		verify that the TOE discards them.
              </div><h1 id="sar_aas" class="indexable" data-level="0">3 Evaluation Activities for SARs</h1><p>The PP-Module does not define any SARs beyond those defined within the
    
	base-PP to which it must claim conformance.
	It is important to note that a TOE that is evaluated against the PP-Module is
	inherently evaluated against the Base-PP as well.

	The Base-PP includes a number of Evaluation Activities associated with both SFRs and SARs.
	Additionally, the PP-Module includes a number of SFR-based Evaluation Activities 
	that similarly refine the SARs of the Base-PPs.
	The evaluation laboratory will evaluate the TOE against the chosen Base-PP
      
    and supplement that evaluation with the necessary SFRs that are taken from the PP-Module.
    </p><h1 id="sup-info" class="indexable" data-level="0">4 Required Supplementary Information</h1><p>This Supporting Document has no required supplementary information beyond the ST, operational
guidance, and testing.</p><h1 id="biblio" class="indexable" data-level="A">Appendix A -  References</h1><table><tr class="header"><th>Identifier</th><th>Title</th></tr>
    <tr><td><span id="bibCC"> [CC] </span></td><td>Common Criteria for Information Technology Security Evaluation - <ul><li><a href="http://www.commoncriteriaportal.org/files/ccfiles/CCPART1V3.1R5.pdf">Part
                1: Introduction and General Model</a>, CCMB-2017-04-001, Version 3.1 Revision 5,
              April 2017.</li><li><a href="http://www.commoncriteriaportal.org/files/ccfiles/CCPART2V3.1R5.pdf">Part
                2: Security Functional Components</a>, CCMB-2017-04-002, Version 3.1 Revision 5,
              April 2017.</li><li><a href="http://www.commoncriteriaportal.org/files/ccfiles/CCPART3V3.1R5.pdf">Part
                3: Security Assurance Components</a>, CCMB-2017-04-003, Version 3.1 Revision 5,
              April 2017.</li></ul></td></tr>
    <tr><td><span id="bibOSPP"></span>[OS PP]</td><td>
        <a href="https://www.niap-ccevs.org/Profile/Info.cfm?PPID=442&amp;id=442/">
			Protection Profile for General Purpose Operating Systems</a>, Version 4.2.1, April 2019
      </td></tr>

    <tr><td><span id="bibMDPP"></span>[MD PP]</td><td>
        <a href="https://www.niap-ccevs.org/Profile/Info.cfm?PPID=417&amp;id=417">
			Protection Profile for Mobile Device Fundamentals</a>, Version 3.1, June 2017
      </td></tr>

    <tr><td><span id="bibMDMPP"></span>[MDM PP]</td><td>
        <a href="https://www.niap-ccevs.org/Profile/Info.cfm?PPID=417&amp;id=417">
			Protection Profile for Mobile Device Management (This needs to be updated) </a>, Version 3.1, June 2017
      </td></tr>

    <tr><td><span id="bibAppPP"></span>[App PP]</td><td>
        <a href="https://www.niap-ccevs.org/Profile/Info.cfm?PPID=429&amp;id=429/">
			Protection Profile for Application Software</a>, Version 1.3, March 2019
      </td></tr>

    <tr><td><span id="bibSD"></span>[SD]</td><td>
        Supporting Document Mandatory Technical Document, PP-Module for Virtual Private Network (VPN) Clients, 
			Version 2.1, November 2019
      </td></tr>

	</table></body></html>