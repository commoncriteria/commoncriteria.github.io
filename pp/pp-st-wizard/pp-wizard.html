<html xmlns='http://www.w3.org/1999/xhtml'>
   <head>

      <meta charset='utf-8'></meta>

      <title>Protection Profile Security Target Generator</title>

      <style type='text/css'>
@charset "utf-8";
/*! fileicon.css v0.1.1 | MIT License | github.com/picturepan2/fileicon.css */
/* fileicon.basic */
.file-icon {
  font-family: Arial, Tahoma, sans-serif;
  font-weight: 300;
  display: inline-block;
  width: 24px;
  height: 32px;
  background: #018fef;
  position: relative;
  border-radius: 2px;
  text-align: left;
  -webkit-font-smoothing: antialiased;
}
.file-icon::before {
  display: block;
  content: "";
  position: absolute;
  top: 0;
  right: 0;
  width: 0;
  height: 0;
  border-bottom-left-radius: 2px;
  border-width: 5px;
  border-style: solid;
  border-color: #fff #fff rgba(255,255,255,.35) rgba(255,255,255,.35);
}
.file-icon::after {
  display: block;
  /* Puts in the content of the data-type attribute*/
  content: attr(data-type);
  position: absolute;
  bottom: 0;
  left: 0;
  font-size: 10px;
  color: #fff;
  text-transform: lowercase;
  width: 100%;
  padding: 2px;
  white-space: nowrap;
  overflow: hidden;
}
.file-icon-lg {
  width: 48px;
  height: 64px;
  border-radius: 3px;
}
.file-icon-lg::before {
  border-bottom-left-radius: 2px;
  border-width: 8px;
}
.file-icon-lg::after {
  font-size: 16px;
  padding: 4px 6px;
}
.file-icon[data-type=xml] {
  background: #e13d34;
}
.file-icon[data-type=html] {
  background: #5eb533;
}

/* End */
.download{
    cursor: url('data:image/png;base64,\
iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAABmJLR0QA/wD/AP+gvaeTAAAACXBI\
WXMAAAsTAAALEwEAmpwYAAAAtElEQVQoz83QsUqCYRTG8Z8JDU7hR1RO4WCrg0tEN+Go99C9eEvi\
FUQQgjg6NIqDEvW1PEN86Kc29cDh//K+/A/nPRzOPabh3lzUyD08h2fLnxWeJR/N/5EvUeTcqLCd\
94Pp4xVDdFGGQ8zxVCffYYkdZpFn2OIjjWozxjrid7jG6NRdjLCKuKoTb/Cy536At7CaR7Sk+zse\
stEidYVmWPyqa0xQNiJvsMDXid+6RUdGLv9SPyx1L+ZGSvHxAAAAAElFTkSuQmCC'), auto;
}



table tr:nth-child(2n+2){
    background-color:#F4F4F4;
}

.basepane{
    max-width: 900px;
    margin: auto;
}


.comp-notes div::before{
    content: "*";
    color: #111;
}



h1{
    border-bottom-style: double;
}

h2{
    border-bottom-style: ridge;
}

input[type=checkbox] + span {
    opacity: .6;
}

input[type=checkbox]:checked + span {
    opacity: 1;
}

.words{
    padding-left: 40px;
}

a {
    text-decoration: none;
    color: cornflowerblue;
}    
#help-pane{
    position: fixed;
    height:100%;
    top: 0%;
    display: none;
    background-color: lightblue;
    border-radius: 25px;
    padding: 10px;
}

#fade-pane{
    position: fixed;
    background-color: lightblue;
    top: 20%;
    left: 30%;
    font-size:xx-large;
    border-radius: 25px;
    padding: 40;
    opacity: 1;
    -webkit-transition: opacity 1500ms linear;
    transition: opacity 1500ms linear;
}
.modifiedbymodule .f-comp-title{
    text-decoration: line-through;
}

a:visited {
    color: cornflowerblue;
}

div.component{
    padding-top: 20px;
}

.f-comp-title{
    font-family: monospace;
    font-size: x-large;
}

.f-el-title{
    font-family: monospace;
    font-size: large;
    padding-left: 10px;
}

div{
    transition: sliding-vertically 5s ease-in-out;
}




/**
 * Displaying either a green check or red X before  components and requirements.
 */

.component.valid .f-comp-status::before,
.valid .f-el-title::before{
    content: "\2713";
    color: #0F0;
}

.component.invalid .f-comp-status::before,
.requirement.invalid .f-el-title::before{
    content: "\2715";
    color: #F00;
}


.component.valid.optional .f-comp-status::before,
.valid.optional .f-el-title::before{
    content: "\2713";
    color: #2626FF; 
}

.component.invalid.optional .f-comp-status::before,
.requirement.invalid.optional .f-el-title::before{
    content: "\2715";
    color: #2626FF; 
}

.component.modifiedbymodule .f-comp-status::before{
    content: "\26D4";
    color: purple;

}



.hidden {
    display: none;
}

.component.modifiedbymodule{
    pointer-events: none;
}

.comp-notes{
    pointer-event: all;
}

.disabled {
    opacity: .2;
    pointer-events: none;
}

.disabled .modcheckdiv, .disabled .f-comp-status{
    display: none;
}

.aactivity{
    display: none;
}

.warning{
    text-align:center;
    border-style: dashed;
    border-width: medium;
    border-color: red;
}

@media screen{
    .hide.component .f-el-title{
        display: none;
    } 
    
    .hide.component .invalid.f-el-title{
        display: none;
    } 
    
    .hide.component .words{
        display: none;
    } 

    
    .component .f-comp-title::after{
        display: inline-block;
        height: auto;
        content: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8A\
AAAPCAYAAAA71pVKAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAQOFAAEDhQGl\
VDz+AAAAB3RJTUUH4gIXFDM7fhmr1wAAAfRJREFUKM+dkk9I02EYxz/P+25uurWR\
tTkzI4NGl4jQgkq71K1DhnTQIDolRAQFQYSHTtGhU4e6eujQofBSFLOg0C4RUSjh\
FnmqTTdKpj/mfv/eX4cUpmRYn9vz8v3w8D7PA/AWGADCbI4QcAb4AnAF8IBJEdX+\
N0tEda40C4AHADviW1LFvpOX6+FwtAacVzqkGiWtwxo4F21OuPu7+yvxRNoDEhpY\
cpzavkQyc7D76FCk+vN7j7VU6RdR4xAsikjGGP9FKrN3sPfEpajv2i2zhckR4JUG\
UCr0erFavLkn2ytd2WPxcFOsZb74+SIQA0YPHBqIdB8Z6tChJv1m/N4P33OGAUsD\
BIFxPNcOkq07jyeSbbo1tTu2q6vHEqU7D/ddSKcz2ZQJjBSmx925b9NjwEMAafha\
eyQa/3Dq7O0243sCIEoRGAOA59nm5dM7OHVruzH+AkDjYEp23RrLT+U8Ub+fV0UR\
oVyaMfVa9fqquF5GKX3ja2FCuc6yWbMipYNP755UgEdr8o2FMf5ivVYdKRfzRkRW\
RfJTOc+2rWdAcUN5hdGP7x8viGgAXLvGbGFCKxW6tj74J3nOqVvP89M5V6kQ86UZ\
f7lWvWWMt7Sp41VKb21uSfqnB++6kWi8BLTzL4ioq7H4tgC4z3/QAZSBxEaBXygN\
v+jeFnAPAAAAAElFTkSuQmCC');
        max-width: 15px;
    }
    
    .hide.component .f-comp-title::after{
   	content: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8A\
AAAPCAYAAAA71pVKAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAQOFAAEDhQGl\
VDz+AAAAB3RJTUUH4gIXFC4BR3keeQAAAfZJREFUKM+d0k1PE1EUBuB37h2nQ+30\
w5YObR0FhIppqBgWuDCaSBQjiQZNTIxLfoAkBHXh2vg7xID+ABPXBl3UdAMaN1CR\
j5ZijZ22DKW9d44LP1KMROvZnMU5z+KcvBzAAgADwCdV1RzXlYQ26tYhrYM6u/qX\
ATwCcKodrAOYv3z9IV28OuP6/NHPAGYZ45G/QQ5AAFjNbyzdTA2NewcGx7xeI5wu\
FZenQOQQuasHncN/9IJo1sn+unkpbqVFIJhgydQo13VjDKCJSnnLBJAHUPoTBoA3\
uzvlfiNgDhn+KMiVCB6xYCZSoaPHz5wrba/cbuztpBWFvQLI+R2DSGZqleKNuJX2\
cVVjAIExDo/uV7pPjGhSNntrleI9+n7Ox33Y549Wq/ZWTyh8rNcfjPlaZ4xzZvUM\
ezrNvnJ+fXFCiL2k2rpQq2wnAqH4tYjZFyZq/Y8CKZoim51z1nIZQ4jGNIC5fZhz\
7fHA4JVuj26AyIWiMDSbdTi1L/T29RO7ahdfKgqbInJLANCKZ6Kx5J24dVowztW6\
Y+8WNt91FNYXc4WN988BzAL4QOT+Aj/x8GFf+MHI+UlI2cBS9kVlLZfxSFdMS9GY\
V1WtKETDPShhz85emLRHx++TETBLAJ4qCov8c7ajsZMr/5PtBQB3AXSpqsbagd8A\
O+HMRUtPNsQAAAAASUVORK5CYII=');
    }
}
@media print{
    .warning-pane, BUTTON{
        display: none;
    }
    .hide{
        display: block;
    }
}

#main{
    margin-left:50px;
}




/* Tooltip text */
.tooltiptext {
    visibility: hidden;
    width: 120px;
    background-color: black;
    color: #fff;
    text-align: center;
    padding: 5px 0;
    border-radius: 6px;
    
    /* Position the tooltip text - see examples below! */

    z-index: 1;
    position: absolute;
}

/* Show the tooltip text when you mouse over the tooltip container */
.tooltipped:hover .tooltiptext {
    visibility: visible;
}


      </style>
           <script type='text/javascript'>//<![CDATA[
 const XSL64='PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLQogICAgU3R5bGVzaGVldCBmb3IgUHJvdGVjdGlvbiBQcm9maWxlIFNjaGVtYQogICAgQmFzZWQgb24gb3JpZ2luYWwgd29yayBieSBEZW5uaXMgT3J0aAogICAgU3Vic2VxdWVudCBtb2RpZmljYXRpb25zIGluIHN1cHBvcnQgb2YgVVMgTklBUAotLT4KCjx4c2w6c3R5bGVzaGVldCB4bWxuczp4c2w9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvWFNML1RyYW5zZm9ybSIKCQl4bWxucz0naHR0cHM6Ly9uaWFwLWNjZXZzLm9yZy9jYy9yZXBvcnQvdjEnCgkJeG1sbnM6Y2M9J2h0dHBzOi8vbmlhcC1jY2V2cy5vcmcvY2MvcHAvcmVwb3J0L3YxJwoJCXhtbG5zOmh0bT0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIKCQl2ZXJzaW9uPSIxLjAiPgogIAogIDwhLS0gdmVyeSBpbXBvcnRhbnQsIGZvciBzcGVjaWFsIGNoYXJhY3RlcnMgYW5kIHVtbGF1dHMgaXNvODg1OS0xLS0+CiAgPHhzbDpvdXRwdXQgbWV0aG9kPSJodG1sIiBlbmNvZGluZz0iVVRGLTgiIGluZGVudD0ieWVzIi8+CiA8IS0tIDx4c2w6b3V0cHV0IG1ldGhvZD0ieG1sIiBlbmNvZGluZz0iVVRGLTgiLz4gLS0+CgoKICA8eHNsOnRlbXBsYXRlIG1hdGNoPSIvIj4KCTx4c2w6YXBwbHktdGVtcGxhdGVzLz4KICA8L3hzbDp0ZW1wbGF0ZT4KCgogIDx4c2w6dGVtcGxhdGUgbWF0Y2g9ImNjOnNlY3Rpb24vY2M6bmFtZSI+CiAgICA8aDE+PHhzbDphcHBseS10ZW1wbGF0ZXMvPjwvaDE+CiAgPC94c2w6dGVtcGxhdGU+CiAgPHhzbDp0ZW1wbGF0ZSBtYXRjaD0iY2M6Y29tcG9uZW50L2NjOm5hbWUiPgogICAgPGgyPjx4c2w6YXBwbHktdGVtcGxhdGVzLz48L2gyPgogIDwveHNsOnRlbXBsYXRlPgogIDx4c2w6dGVtcGxhdGUgbWF0Y2g9ImNjOnJlcXVpcmVtZW50L2NjOm5hbWUiPgogICAgPGgzPjx4c2w6YXBwbHktdGVtcGxhdGVzLz48L2gzPgogIDwveHNsOnRlbXBsYXRlPgoKICA8eHNsOnRlbXBsYXRlIG1hdGNoPSJjYzphYWN0aXZpdHkiPgogICAgPGJsb2NrcXVvdGU+CiAgICAgIDx4c2w6YXBwbHktdGVtcGxhdGVzLz4KICAgIDwvYmxvY2txdW90ZT4KICA8L3hzbDp0ZW1wbGF0ZT4KICA8IS0tIC0tPgogIDwhLS0gU2VsZWN0YWJsZXMgdGVtcGxhdGUgLS0+CiAgPCEtLSAtLT4KICA8eHNsOnRlbXBsYXRlIG1hdGNoPSJjYzpzZWxlY3RhYmxlcyI+WzxzcGFuIGNsYXNzPSJzZWxlY3Rpb24iPjx4c2w6Y2hvb3NlPiAgICAgIAogICAgPCEtLSBJZiB0aGUgc2VsZWN0aW9uIGhhcyBhIG5lc3RlZCBzZWxlY3Rpb24gLS0+CiAgICA8eHNsOndoZW4gdGVzdD0iLi8vY2M6c2VsZWN0YWJsZXMiPjx1bD48eHNsOmZvci1lYWNoIHNlbGVjdD0iY2M6c2VsZWN0YWJsZXxodG06VUwvaHRtOkxJL2NjOnNlbGVjdGFibGUiPjxsaT48aT48eHNsOmFwcGx5LXRlbXBsYXRlcy8+PC9pPjx4c2w6Y2FsbC10ZW1wbGF0ZSBuYW1lPSJjb21tYWlmbm90bGFzdCIvPjwvbGk+PC94c2w6Zm9yLWVhY2g+PC91bD48L3hzbDp3aGVuPgogICA8eHNsOm90aGVyd2lzZT48eHNsOmZvci1lYWNoIHNlbGVjdD0iY2M6c2VsZWN0YWJsZXxodG06VUwvaHRtOkxJL2NjOnNlbGVjdGFibGUiPjxpPjx4c2w6YXBwbHktdGVtcGxhdGVzLz48L2k+PHhzbDpjYWxsLXRlbXBsYXRlIG5hbWU9ImNvbW1haWZub3RsYXN0Ii8+PC94c2w6Zm9yLWVhY2g+PC94c2w6b3RoZXJ3aXNlPgogIDwveHNsOmNob29zZT48L3NwYW4+XTwveHNsOnRlbXBsYXRlPgoKICA8IS0tIDx4c2w6dGVtcGxhdGUgbmFtZT0iaGFuZGxlX3NlbGVjdGFibGVzIj4gLS0+CiAgPCEtLSAgIDx4c2w6Y2hvb3NlPiAtLT4KICA8IS0tICAgICA8eHNsOndoZW4gdGVzdD0iVUwiPjx4c2w6Zm9yLWVhY2ggc2VsZWN0PSJVTC9MSSI+PGxpPjxpPjx4c2w6YXBwbHktdGVtcGxhdGVzLz48L2k+PC9saT4iPC94c2w6Zm9yLWVhY2g+PC94c2w6d2hlbj4gLS0+CiAgPCEtLSAgICAgPHhzbDpvdGhlcndpc2U+PHhzbDpmb3ItZWFjaCBzZWxlY3Q9ImNjOnNlbGVjdGFibGUiPjxpPjx4c2w6YXBwbHktdGVtcGxhdGVzLz48L2k+PHhzbDpjYWxsLXRlbXBsYXRlIG5hbWU9ImNvbW1haWZub3RsYXN0Ii8+PC94c2w6Zm9yLWVhY2g+PC94c2w6b3RoZXJ3aXNlPiAtLT4KICA8IS0tICAgPC94c2w6Y2hvb3NlPiAtLT4KICA8IS0tIDwveHNsOnRlbXBsYXRlPiAtLT4KCiAgPHhzbDp0ZW1wbGF0ZSBtYXRjaD0iY2M6YXNzaWdubWVudCI+WzxzcGFuIGNsYXNzPSJhc3NpZ25tZW50Ij48eHNsOmFwcGx5LXRlbXBsYXRlcy8+PC9zcGFuPl08L3hzbDp0ZW1wbGF0ZT4KCjwhLS0gIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIC0tPgo8IS0tIE1hbmFnZW1lbnQgRnVuY3Rpb24gVGFibGUgU3RhcnQgLS0+CjwhLS0gIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIC0tPgogIDx4c2w6dGVtcGxhdGUgbWF0Y2g9ImNjOm1hbmFnZW1lbnQtZnVuY3Rpb24tdGFibGUiPjx0YWJsZSBjbGFzcz0ibWZzIiBzdHlsZT0id2lkdGg6IDEwMCU7Ij48eHNsOmFwcGx5LXRlbXBsYXRlcy8+PC90YWJsZT48L3hzbDp0ZW1wbGF0ZT4KICAKICA8eHNsOnRlbXBsYXRlIG1hdGNoPSJjYzpyb3ciPjx0cj48eHNsOmFwcGx5LXRlbXBsYXRlcy8+PC90cj48L3hzbDp0ZW1wbGF0ZT4KCiAgPHhzbDp0ZW1wbGF0ZSBtYXRjaD0iY2M6cm93WzFdL2NjOnZhbCI+PHRoPjx4c2w6YXBwbHktdGVtcGxhdGVzLz48L3RoPjwveHNsOnRlbXBsYXRlPgogIDx4c2w6dGVtcGxhdGUgbWF0Y2g9ImNjOnJvdy9jYzp2YWwiPjx0ZD48eHNsOmFwcGx5LXRlbXBsYXRlcy8+PC90ZD48L3hzbDp0ZW1wbGF0ZT4KCgoKICA8eHNsOnRlbXBsYXRlIG5hbWU9ImNvbW1haWZub3RsYXN0Ij48eHNsOmlmIHRlc3Q9InBvc2l0aW9uKCkgIT0gbGFzdCgpIj48eHNsOnRleHQ+LCA8L3hzbDp0ZXh0PjwveHNsOmlmPjwveHNsOnRlbXBsYXRlPgoKICA8IS0tCiAgICAgICBDaGFuZ2UgYWxsIGh0bSB0YWdzIHRvIHRhZ3Mgd2l0aCBubyBuYW1lc3BhY2UuCiAgICAgICBUaGlzIHNob3VsZCBoZWxwIHRoZSB0cmFuc2l0aW9uIGZyb20gb3V0cHV0IHcvIHBvbGx1dGVkCiAgICAgICBuYW1lc3BhY2UgdG8gb3V0cHV0IGFsbCBpbiBodG0gbmFtZXNwYWNlLiBGb3IgcmlnaHQgbm93CiAgICAgICB0aGlzIGlzIHdoYXQgd2UgaGF2ZS4KICAtLT4KICA8eHNsOnRlbXBsYXRlIG1hdGNoPSJodG06KiI+PHhzbDplbGVtZW50IG5hbWU9Intsb2NhbC1uYW1lKCl9Ij4KICAgICAgPCEtLSBDb3B5IGFsbCB0aGUgYXR0cmlidXRlcyAtLT4KICAgICAgPHhzbDpmb3ItZWFjaCBzZWxlY3Q9IkAqIj4KCTx4c2w6Y29weS8+CiAgICAgIDwveHNsOmZvci1lYWNoPjx4c2w6YXBwbHktdGVtcGxhdGVzLz48L3hzbDplbGVtZW50PjwveHNsOnRlbXBsYXRlPgoKICA8IS0tIENvbnN1bWUgYWxsIGNvbW1lbnRzIC0tPgogIDx4c2w6dGVtcGxhdGUgbWF0Y2g9ImNvbW1lbnQoKSIvPgoKICA8IS0tIENvbnN1bWUgYWxsIHByb2Nlc3NpbmctaW5zdHJ1Y3Rpb25zIC0tPgogIDx4c2w6dGVtcGxhdGUgbWF0Y2g9InByb2Nlc3NpbmctaW5zdHJ1Y3Rpb24oKSIvPgoKICA8IS0tCiAgICAgIFJlY3Vyc2l2ZWx5IGNvcHkgYW5kIHVud3JhcCB1bm1hdGNoZWQgdGhpbmdzIChlbGVtZW50cywgYXR0cmlidXRlcywgdGV4dCkKICAtLT4KICA8eHNsOnRlbXBsYXRlIG1hdGNoPSJAKnxub2RlKCkiPjx4c2w6Y29weT48eHNsOmFwcGx5LXRlbXBsYXRlcyBzZWxlY3Q9IkAqfG5vZGUoKSIvPjwveHNsOmNvcHk+PC94c2w6dGVtcGxhdGU+CgogIDwhLS0gCiAgICAgICBCeSBkZWZhdWx0LCBxdWlldGx5IHVud3JhcCBhbGwgY2MgZWxlbWVudHMgdGhhdCBhcmUgb3RoZXJ3aXNlIHVubWF0Y2hlZAogIC0tPgogIDx4c2w6dGVtcGxhdGUgbWF0Y2g9ImNjOioiPjx4c2w6YXBwbHktdGVtcGxhdGVzLz48L3hzbDp0ZW1wbGF0ZT4KPC94c2w6c3R5bGVzaGVldD4K';
const PREAMBLE = //"<html><head><title></title></head><body>";
 "<html xmlns='http://www.w3.org/1999/xhtml'><head><title>Security Target</title><style type='text/css'>\n"
    + ".selection,.assignment{ font-weight:bold;}\n"
    + ".reqid{  float:left;\n"
    + "   font-size:90%;\n"
    + "   font-family:verdana, arial, helvetica, sans-serif;\n"
    + "   margin-right:1em;\n"
    + "}\n"
    + ".req{\n"
    + "    margin-left:0%;\n"
    + "    margin-top:1em;\n"
    + "    margin-bottom:1em;\n"
    + "}\n"
    + "*.reqdesc{\n"
    + "    margin-left:20%;\n"
    + "}\n"
    + "</style></head><body>\n";
    
const EPILOGUE="</body></html>";
const HIDE="none";
const SHOW="block";
const DISABLED="disabled";
const MODBYMODULE='modifiedbymodule';
const DEP="dep:"
const AMPERSAND=String.fromCharCode(38);
const LT=String.fromCharCode(60);

/// Holds the prefix for the settings we care about
var prefix="";

/// Effective Selection Map (This should be a class probably)
var effSelMap={};
var effSelOwnerMap={};

//////////////////////////////////////////////////
// Aliases
//////////////////////////////////////////////////

/**
 * Aliases getElementsByClassName
 */
function elsByCls(classname){
    return document.getElementsByClassName(classname);
}

function subElsByCls(el, classname){
     return el.getElementsByClassName(classname);
}

/**
 * Aliases getElementById
 */
function elById(id){
    return document.getElementById(id);
}

function forEach(array, func){
    Array.prototype.forEach.call(array, func);
}

//////////////////////////////////////////////////
// Stolen from the regular PP project
//////////////////////////////////////////////////

// Expands targets if they are hidden
function showTarget(id){
    var element = elById(id);
    while (element != document.body.rootNode ){
	element.classList.remove("hide");
	element = element.parentElement;
    }
}
//////////////////////////////////////////////////
// End stolen section
//////////////////////////////////////////////////

//////////////////////////////////////////////////
// Primatives
//////////////////////////////////////////////////

/**
 * Records a major error.
 */
function error(msg){
    Console.log("Error: "+msg);
}

function isCheckbox(elem){
    return elem.getAttribute("type") == "checkbox";
}

function isSelector(elem){
    return elem.tagName == 'SELECT';
}
/**
 * This runs some sort of function on
 * all elements of a class.
 * @param classname Value of the class 
 * @param fun Function that is run on all elements. 
 *    For its 1st parameter, it takes the element. For the 2nd
 *    it's the number of the element.
 */
function performActionOnElements(elements, fun){
    // Run through all the elements with possible
    // values
    var aa;
    for(aa=0; elements.length> aa; aa++){
        fun(elements[aa], aa);
    }
}



// elem is a component element
function handleEnter(elem){
    if (elem != null){
        elem.classList.remove('hide');
    }

    var compsIter, comps;
    comps = elsByCls('component');
    for (compsIter=comps.length-1; compsIter>=0; compsIter--){
        if (comps[compsIter]==elem) continue;
        comps[compsIter].classList.add('hide');
    }
}

function killFade(){
    var fp = elById("fade-pane");
    fp.parentNode.removeChild(fp);
}

function fixToolTips(){
  var tooltipelements = document.getElementsByClassName("tooltiptext");
  var aa;
  for(aa=tooltipelements.length-1; aa>=0; aa--){
      tooltipelements[aa].parentNode.classList.add("tooltipped");
  }
}


//////////////////////////////////////////////////
// Stolen from the regular PP project
//////////////////////////////////////////////////
function changeMyCounter(subroot, val){
    var bb;
    for(bb=0; bb!=subroot.childNodes.length; bb++){
    	if( subroot.childNodes[bb] instanceof Element &&
    	    "counter"==subroot.childNodes[bb].getAttribute("class")){
    	    subroot.childNodes[bb].innerHTML = val;
    	    return;
    	}
    }
}

function fixCounters(){
    var figs = document.getElementsByClassName("ctr");
    var occurs = {};                                         // Map that stores how many times we've seen each thing
    var aa;
    for(aa=0; aa!= figs.length; aa++){                       // Go through every counted object
    	var ct = figs[aa].getAttribute("data-counter-type");  // Get which counter type it is
    	var curr = occurs[ct]!=null?parseInt(occurs[ct]):1;   // Figure out how many times we've seen it
    	occurs[ ct ] = curr + 1;                              // Save off increment for next time
    	changeMyCounter( figs[aa], curr);

    	var figId = figs[aa].id
    	var figRefs = document.getElementsByClassName(figId+"-ref");
    	var bb;
        for(bb=0; bb!=figRefs.length; bb++){
    	    changeMyCounter(figRefs[bb], curr);
    	}
    }
}


/**
 * The initialization function.
 */
function init(){
    if( document.URL.startsWith("file:///") ){
        var warn = elById("url-warning");
        warn.style.display=SHOW;
    }
    var url = new URL(document.URL);
    var fp = elById("fade-pane");
    if(url.searchParams.get("hidefade")=="1"){
	fp.parentNode.removeChild(fp);
    }
    else{
	fp.style.opacity = '0';
	setTimeout(killFade, 2000);
    }
    fixToolTips();
    fixCounters();
    prefix=url.searchParams.get("prefix");
    if (prefix==null) prefix="";
    cookieJar = readAllCookies();
    // var elems = elsByCls("val");
    // performActionOnElements(elems, retrieveFromCookieJar);
    validateRequirements();
    handleEnter(null);
    baseChange(null)
}


// ##################################################
// #               Cookie functions
// ##################################################

/// Dictionary to hold all the cookies
var cookieJar=[];

function saveToCookieJar(elem, index){
    var id = prefix+":"+getId(index);
    if( isCheckbox(elem)){
        cookieJar[id]=elem.checked;
    }
    else if( elem.tagName == 'SELECT' ){
        cookieJar[id]=elem.selectedIndex;
    }
    else{
        if(elem.value != undefined){
            if( elem.value != "undefined" ) cookieJar[id]=elem.value;
        }
    }
}

function getId(index){
    return "v_" + index;
} 


function retrieveFromCookieJar(elem, index){
    var id = prefix+":"+getId(index);
    if( isCheckbox(elem)){
        elem.checked= (cookieJar[id] == "true");
    }
    else if( elem.tagName == 'SELECT' ){
        if( id in cookieJar ){
            elem.selectedIndex = cookieJar[id];
        }
    }
    else{
        if( id in cookieJar) {
            if(cookieJar[id] != "undefined"){
                elem.value= cookieJar[id];
            }
        }
    }
}

function readAllCookies() {
    ret=[];
    var ca = document.cookie.split(';');
    var aa,bb;
    for(aa=0;ca.length > aa ; aa++) {
        if (3>ca[aa].length){ continue;}
        var blah=ca[aa].split('=');
        if (2 != blah.length){
            console.log("Malformed Cookie.");
            continue;
        }
        key=blah[0].trim();
        val=decodeURIComponent(blah[1]);
        ret[key]=val;
    }
    return ret;
}

function saveAllCookies(cookies){
    var key;
    // run through the cookies
    for (key in cookies) {
        createCookie(key, cookies[key] );
    }
}

function createCookie(name,value) {
    var date = new Date();
    // 10 day timeout
    date.setTime(date.getTime()+(10*24*60*60*1000));
    var expires = "; expires="+date.toGMTString();
    document.cookie = name+"="+encodeURIComponent(value)+expires+"; path=/";

}

function eraseCookie(name) {
    createCookie(name,"",-1);
}

// ##################################################
// #          Report Generating Functions
// ##################################################
function resolver(pre){
    if(pre=='cc') return 'https://niap-ccevs.org/cc/v1';
    else return "http://www.w3.org/1999/xhtml";
}

function handleHtmlReport(){
    var xsl = new DOMParser().parseFromString(atob(XSL64), "text/xml");
    // This doesn't work on Chrome. THe max string size cuts us off.
    // var serializer = new XMLSerializer();
    // var xmlString = serializer.serializeToString(pp_xml);
    // var resultStr = (new XMLSerializer()).serializeToString(htmlReport);
    // console.log("Result size: " +resultStr.length);
    // This creates a separate window with the repot
    // Intent was to use this to transform this to docx format.
    // var win = window.open("", "Report");
    // win.document.open();
    // win.document.write(PREAMBLE);
    // win.document.write(EPILOGUE);
    // win.document.close();
    // var htmlReport1 = transform(xsl, pp_xml, win.document);
    // win.document.body.appendChild( htmlReport1 );

    // This way seems to work with Chrome and Mozilla.
    // A little more complicated than it should be b/c
    // Chrome has a max string size.
    var report = generateReport();
    var pp_xml = new DOMParser().parseFromString(report, "text/xml");
    var htmlReport = transform(xsl, pp_xml, document);
    qq(htmlReport);


    var rNode = elById('report-node');
    // Clear its children
    while(rNode.firstChild){
	rNode.removeChild( rNode.firstChild );
    }
    rNode.appendChild( htmlReport );
    var blobTheBuilder = new MyBlobBuilder();
    blobTheBuilder.append(PREAMBLE);
    blobTheBuilder.append(rNode.innerHTML);
    blobTheBuilder.append(EPILOGUE);
    initiateDownload('FullReport.html', blobTheBuilder.getBlob("text/html"));
}

function handleXmlReport(){
    var report = generateReport();// qq(report);
    var blobTheBuilder = new MyBlobBuilder();
    blobTheBuilder.append(report);
    initiateDownload('Report.xml', blobTheBuilder.getBlob("text/xml"));
}

function generateReport(){
    var report = LT+"?xml version='1.0' encoding='utf-8'?>\n"
    var aa;
    report += LT+"cc:report xmlns='http://www.w3.org/1999/xhtml' xmlns:cc='https://niap-ccevs.org/cc/pp/report/v1'>"
    var baseId=getAppliedBaseId();
    if(baseId==null) return;
    report += harvestSection(elById("base:"+baseId));
    var modIds = getAppliedModuleIds();
    for(aa=0; aa<modIds.length; aa++){
	report += harvestSection(elById("module:"+modIds[aa]));
    }
    report += LT+"/cc:report>"							 
    return report;
}

function harvestSection(section){
    var ret=LT+"cc:section>\n";
    ret += LT+"cc:name>"+section.firstElementChild.innerHTML+LT+"/cc:name>\n";
    var aa;
    var comps=subElsByCls(section,"component");
    for(aa=0; aa<comps.length; aa++){
        if(!isApplied(comps[aa])) continue;
        ret+="<cc:component>\n   <cc:name>"
        ret+=subElsByCls(comps[aa], "f-comp-title")[0].innerHTML;
        ret+="</cc:name>\n";
        var reqs = subElsByCls(comps[aa], "requirement");
	ret+=harvestReqs(reqs)
        ret+="</cc:component>";
    }
    ret += LT+"/cc:section>\n"
    return ret;
}
function harvestReqs(reqs){
    var ret="";
    var aa;
    for(aa=0; aa<reqs.length; aa++){
	ret+="<cc:requirement>\n   <cc:name>";
	var title = subElsByCls(reqs[aa], "f-el-title");
	ret+=title[0].innerHTML;
	ret+="</cc:name>\n"
	// Get the requirement and replace all extra spaces 
	var wordsEl=subElsByCls(reqs[aa], "words")[0];
	var words=getRequirement(wordsEl);
	// Convert all new lines/tabs to spaces
	words = words.replace(/(\r\n\t|\n|\r\t)/gm," ");
	// Remove extra spaces
	words = words.replace(/\s+(?= )/g,'');
	ret+=words;
	var next = reqs[aa].nextElementSibling;
	if(next != null && next.classList.contains("aactivity")){
	    ret += "<cc:aactivity>"
		+ getRequirement(next) 
		+ "</cc:aactivity>";
	}
	ret+="</cc:requirement>\n"
    }
    return ret;
}

function getRequirements(nodes){
    ret="";
    var bb=0;
    for(bb=0; bb!=nodes.length; bb++){
        ret+=getRequirement(nodes[bb]);
    }
    return ret;
}


var prevCheckbox = false;
/**
 *
 */
function isPrevCheckbox(elem){
    var ret = prevCheckbox;
    prevCheckbox = false;
    return ret;
}


function getRequirement(node){
    var ret = ""
    // If it's an element
    if(node.nodeType==1){
	// If the previous was a checkbox
        if(isPrevCheckbox(node)){
            return "";
        }
        if(isCheckbox(node)){
            if(node.checked){
                ret+=LT+"cc:selectable index='"+node.getAttribute('data-rindex')+"'>"; 
		// Checkbox precedes the 
                // Like a fake recurrence call here
                ret+=getRequirement(node.nextSibling);
                ret+=LT+"/cc:selectable>";
            }
            // Skip the next check.
            prevCheckbox=true;
        }
        else if(node.classList.contains("selectables")){
            ret+=LT+"cc:selectables>"
            ret+=getRequirements(node.children);
            ret+=LT+"/cc:selectables>"
        }
        else if(node.classList.contains("assignment")){
            var val = "";
            if(node.value){
                val=node.value;
            }
            ret+=LT+"cc:assignment>";
            ret+=escapeXml(val);
            ret+=LT+"/cc:assignment>\n";
        }
        else if(node.classList.contains('mfun-table')){
            ret += LT+"cc:management-function-table>"
            var rows = node.getElementsByTagName("tr");
            for(var row=0; rows.length>row; row++){
                ret += LT+"cc:row>";
                var cols=rows[row].children;
                for( var col=0; cols.length>col; col++){
                    ret += LT+"cc:val>"; 
		    ret += getRequirements(cols[col].childNodes);
                    ret += LT+"/cc:val>";
                }
                ret += LT+"/cc:row>\n";
            }
            ret += LT+"/cc:management-function-table>";
        }
	else if(isSelector(node)){
	    ret+=getRequirement(node.children[node.selectedIndex]);
	}
        else{
	    ret+="<"+node.tagName+">"
            ret+=getRequirements(node.childNodes);
	    ret+="</"+node.tagName+">"
        }
    }
    // If it's text
    else if(node.nodeType==3){
     	ret = node.textContent;
        return escapeXml(ret);
    }
    else{}							   
    return ret;
}





function initiateDownload(filename, blob) {
//    var blob = new Blob([data], {type: mimetype});
    if(window.navigator.msSaveOrOpenBlob) {
        window.navigator.msSaveBlob(blob, filename);
    }
    else{
        var elem = window.document.createElement('a');
        elem.href = window.URL.createObjectURL(blob);
        elem.download = filename;        
        document.body.appendChild(elem);
        elem.click();        
        document.body.removeChild(elem);
    }
}

// A selection group is either bulleted form: 
//    <span><ul><li><input/><span/></li><li><input/><span/></li>...</ul></span> 
//   OR inline form:
//    <span><input/><span/><input/><span/>..</span>
//
function populateSelectableGroup(sel,group){
    // Find the common parent
    var common = sel.parentNode;
    var isSomethingChecked = false;
    // Keep going up until yu hit SPAN
    while( common.tagName != "SPAN" ){
        common = common.parentNode;
    }
    var aa;
    if( isCheckbox(common.children[0])){ // If it's the inline form
	for(aa=0; common.children.length>aa; aa+=2){
	    group.push(common.children[aa])
	    isSomethingChecked = common.children[aa].checked || isSomethingChecked;
		
	}
    }
    else{
	common=common.children[0]; // Dip to ul
	for(aa=0; common.children.length>aa; aa++){
	    group.push(common.children[aa].children[0]);
	    isSomethingChecked = common.children[aa].children[0].checked || isSomethingChecked;
	}
    }
    return isSomethingChecked;
}





// ##################################################
// #         
// ################################################## 
function setVisibility(elements, visibility){
    var aa;
    for(aa=0; elements.length>aa; aa++){
	var hideOrDisable = elements[aa].classList.contains('hidable')?"hidden":DISABLED;
	modifyClass(elements[aa], hideOrDisable, !visibility);
    }
}

function hideAllDependents(classname){
    var aa;
    var masters = elsByCls(classname);
    for(aa=masters.length-1; aa>=0; aa--){
	var id = masters[aa].id.split(":")[1];
	setVisibility(elsByCls(DEP+id), false);
    }
    return masters;
}

/**
 * baseChange handler
 * @changed is the element that changed or null for init.
 */
function baseChange(changed){
    // Hide everything that's dependent on bases
    var basechecks = hideAllDependents('basecheck')
    // If it's checked
    if( changed!=null && changed.checked ){
	var aa;
	//-- Uncheck the other bases
	for(aa=basechecks.length-1;  aa>=0; aa--){
	    // If it's not check
	    if(changed!=basechecks[aa]){
	    	basechecks[aa].checked=false;
	    }
	}
	var baseId = changed.id.split(":")[1];
	setVisibility(elsByCls(DEP+baseId),true);
    }

    // Trigger module change
    moduleChange();
}


function isVisible(el){
// A trick documented here:
// https://stackoverflow.com/questions/19669786/check-if-element-is-visible-in-dom
    return el.offsetParent != null
}

/**
 * moduleChange handler
 */
function moduleChange(){
    // Hide everything
    var modchecks = hideAllDependents("modcheck");
    var aa;

    // Figure out what to show
    for(aa=modchecks.length-1; aa>=0; aa--){// function addNote(parent, classname, notemsg){
//     var noteparent = parent.getElementsByClassName("comp-notes");
//     noteparent[0].appendChild(note);
// }

// function areAnyMastersSelected(id){
//     var masters = elsByCls(id+"_m");
//     var bb;
//     for(bb=0; masters.length>bb; bb++){
//         if (masters[bb].checked){
//             return true;
//         }
//     }
//     return false;
// }
// function modifyMany( arrayOrElement, clazz, isAdd){
//     if( Array.isArray(arrayOrElement)){
// 	var aa;
// 	for(aa=arrayOrElement.length-1; aa>=0; aa--){
// 	    modifyClassHelper(arrayOrElement[aa], clazz, isAdd);
// 	}
//     }
//     else{
// 	modifyClassHelper(arrayOrElement, clazz, isAdd);
//     }
// }

	if(isVisible(modchecks[aa]) &&  
	   modchecks[aa].checked){
	    var modId = modchecks[aa].id.split(":")[1];
	    setVisibility(elsByCls(DEP+modId), true);
	}
    }

    // Remove all modified-by-module classes.
    var modified_sfrs = elsByCls(MODBYMODULE);
    for(aa=modified_sfrs.length-1; aa>=0; aa--){
	modified_sfrs[aa].classList.remove(MODBYMODULE);
    }
    var modifiednotes = elsByCls("modifiedbymodulenote");
    for(aa=modifiednotes.length-1; aa>=0; aa--){
	modifiednotes[aa].parentNode.removeChild(modifiednotes[aa]);
    }

    // Find all mod sfrs that are applied.
    var modifying = elsByCls("mod_sfrs");
    for(aa=modifying.length-1; aa>=0; aa--){
	if(isVisible(modifying[aa])){
	    var modname = modifying[aa].parentNode.previousSibling.innerHTML;
	    applyModifyingGroup(modifying[aa], modname);
	}
    }
    // Clear "Effective Selections Map"
    effSelMap={};
    effSelMapOwner={};
    // Build a new one
    var baseId=getAppliedBaseId();
    if(baseId==null) return;
    // selMap is generated dynamically
    var baseMap=selMap[baseId]
    addEffectiveSelectionIds(selMap[baseId], baseId, true);
    var modIds = getAppliedModuleIds();
    for (aa=modIds.length-1; aa>=0; aa--){
	modId=modIds[aa];
	addEffectiveSelectionIds(selMap[modId], modId, false);
    }
}

function addEffectiveSelectionIds(map, parentId, isbase){
    for(selId in map){
	var triggered;
	if( selId in effSelMap){	// If one exists
	    triggered=effSelMap[selId];	// Take it
	}				// 
	else{				// 
	    triggered={};		// Make a new one
	}				// 
	for( newone in map[selId] ){	// Go through all the new ones
	    triggered[newone]="1";	// And Them
	}
	effSelMap[selId]=triggered;
	// Map the id to the parent
	effSelMapOwner[selId]=parentId;
    }
}

/**
 *
 */
function applyModifyingGroup(parent, modname){
    var aa=0;
    var modsfrs = parent.getElementsByClassName("component");
    for(aa=modsfrs.length-1; aa>=0; aa--){
	var origId = modsfrs[aa].id.split(/\:(.+)/)[1];
	var modified = elById(origId);
	if(modified.classList.contains(MODBYMODULE)){
	    alert("Found collision with: " +origId);
	}
	else{
	    modified.classList.add(MODBYMODULE);
	    var note = document.createElement("div");
	    note.classList.add("modifiedbymodulenote");
	    note.innerHTML=
		""+
		"This component was redefined by the <a href='#"+ 
		modsfrs[aa].id+"'><i>" + modname+ "</i> module</a>";

	    modified.nextElementSibling.appendChild(note);
	}
    }
}


/**
 * Handles when the checkbox infront of an objective or optional
 * requirements is checked.
 */
function handleOCheck(el){
    modifyClass(el.parentElement.nextElementSibling, DISABLED, !el.checked);
}

/**
 * Adds/Removes a specific class from an element.
 */
function modifyClass( el, clazz, isAdd ){
    if(el == null){ return false;   }
    if(isAdd) el.classList.add(clazz);
    else      el.classList.remove(clazz);
    return true;
}




var sched;
function update(el){
    if(isCheckbox(el)){
	handleSelectionGroupUpdate(el);
        // Checkboxes are the only thing that can
	// change what is pulled in (more requirements or packages)
	handleSelections();
    }
    validateRequirements();
    // if (sched != undefined){
    //     clearTimeout(sched);
    // }
    // sched = setTimeout(delayedUpdate, 1000);
}

/**
 * This function figures out
 * what components to pull in
 * based on selections.
 */
function handleSelections(){
    var aa, bb;
    
    // Disable all sel-based requirements.
    forEach(elsByCls("sel-based"), function(el){
	el.classList.add(DISABLED);
    })

    // 
    var baseId=getAppliedBaseId();
    if (baseId == null) return;

    var selIds = [];
    for (sel in effSelMap){
	selIds.push([effSelMapOwner[sel],sel]);
    }
    while(selIds.length>0){
	var tuple  = selIds.pop();
	var ppowner=tuple[0];
	var selId=tuple[1];
	var chkbx = elById(ppowner+":"+selId);
	// If it's not checked, nothing to do
	// (no more to pull in)
	if (!chkbx.checked) continue;
	// If it's not active, nothing to do
	if (!isApplied(chkbx)) continue;
	var localMap =selMap[ppowner] ;
	var compIds = localMap[selId];
	for(compId in compIds){
	    var newSels = enableDominantComponent(compId);
	    // for(sel in newSels){
	    for(aa=newSels.length-1; aa>=0; aa--){
		var sel = newSels[aa];
		qq("Adding " + sel[0] + ":" + sel[1]);
		selIds.push(sel);
	    }
	}
    }
}

/**
 * @returns an array of tuples. Each tuple is the new selections
 * that have been (potentially) activated by enabling this component. 
 * The tuple is composed of the ID of the parent and the local ID.
 * (i.e. FullId.split(":"))
 */
function enableDominantComponent(reqId){
    var comps = elsByCls(reqId);
    var aa=0;
    for(aa=comps.length-1; 
	aa>=0;
	aa--)
    {
	var comp=comps[aa];
	// If it's not visible, it's not the one
	if (!isVisible(comp)) continue;
	// If it's modified, it's not the one
	if (comp.classList.contains('modifiedbymodule')) continue;
	// We can assume we found it
	// If it's already enabled, just leave
	if (!comp.classList.contains(DISABLED)) 
	    return [];
	// Else
	// Enable it
	comp.classList.remove(DISABLED);
	// var splittedID = comp.id.split(":")[0];
	var selboxes=comp.getElementsByClassName('selbox');
	var bb, ret=[];
	for(bb=selboxes.length-1; bb>=0; bb--){
	    if(selboxes[bb].hasAttribute("id")){
		ret.push(selboxes[bb].id.split(":"));
	    }
	}
	//
	return ret;
    }
    error("Could not find an active requirement with ID: " +reqId);
    return [];
}

/**
 * Figures out if this element is part of an applied component
 */
function isApplied(el){
    // ---
    // Need to clean up this function
    // --
    while(true){
        if(el.classList.contains("component")){
           break;
        }
	if('HTML'==el.tagName) return false;
	el = el.parentElement;
    }
    // If the component isn't visible
    if(!isVisible(el))                            return false;
    // If the component
    if(el.classList.contains(DISABLED))           return false;
    if(el.classList.contains('modifiedbymodule')) return false;

    return true;
}

/**
 * Gets a list of the active module ids.
 * @returns a list of modules that are checked
 */
function getAppliedModuleIds(){
    var appmods=[];
    var aa=0;
    var modchecks=elsByCls('modcheck');
    for(aa=modchecks.length-1;
	aa>=0;
	aa--){
	if( isVisible(modchecks[aa]) && modchecks[aa].checked){
	    appmods.push(modchecks[aa].id.split(':')[1])
	}
    }
    return appmods;
}

/**
 * Gets the id of the base that is checked.
 * @return the id of the checked base (or null if there's none).
 */
function getAppliedBaseId(){
    var basechecks=elsByCls('basecheck');
    var aa=0;
    for(aa=basechecks.length-1; aa>=0; aa--){
	if(basechecks[aa].checked) 
	    return basechecks[aa].id.split(':')[1];
    }
    return null;
}


function validateSelectables(sel){
    var child  = sel.firstElementChild;
    if( child.tagName == 'UL' ){
        child=child.firstElementChild;
    }
    var numChecked=0;
    // Now we either have a checkbox or an li
    while(child!=null){
        if(child.tagName == "LI"){
            if(child.firstElementChild.checked){
                numChecked++;
                if( !reqValidator(child) ){
                    return false;
                }
            }
        }
        else if(child.checked){
            numChecked++;
            if( !reqValidator(child) ){
                return false;
            }
        }
        child = child.nextElementSibling;
    }
    if(numChecked==0) return false;
    if(numChecked==1) return true;
    return !sel.classList.contains("onlyone");
}

function setFocusOnComponent(comp){
    comp.getElementsByClassName('f-comp-title')[0].focus();
    return true;
}

function handleKey(event){
    if(! event.ctrlKey ) return;
    if (event.key=='?'){
        handleHelpRequest();
	return "";
    }
    var key = event.which || event.keyCode;

    var curr = document.activeElement;
    var comps = elsByCls('component');
    if (comps.length == 0) return;
    if (curr==document.body){
        curr=null;
    }
    var aa;
    if( key == 28){
        if (curr == null) curr =  comps[comps.length-1];
        for(aa=comps.length-1; aa >= 0; aa--){
            if(comps[aa] == curr) break;
            if(comps[aa].contains(curr)) break;
        }
        for(aa--; aa>=0; aa--){
            if(comps[aa].classList.contains(DISABLED)) continue;
            if(comps[aa].classList.contains('invalid')){
                return setFocusOnComponent(comps[aa]);
            }
        }
        return "";
    }
    else if( key == 30){
        if (curr == null) curr =  comps[0];
        for(aa=0; comps.length > aa; aa++){
            if(comps[aa] == curr) break;
            if(comps[aa].contains(curr)) break;
        }
        for(aa++; comps.length > aa; aa++){
            if(comps[aa].classList.contains(DISABLED)) continue;
            if(comps[aa].classList.contains('invalid')){
                return setFocusOnComponent(comps[aa]);
            }
        }
        return "";
    }
}
function handleHelpRequest(){
    var helppane = elById('help-pane');
    if(helppane.style.display!='block'){
	helppane.style.display='block';
    }
    else{
	helppane.style.display='none';
    }
}

function reqValidator(elem){
    var child = elem.firstElementChild;
    var ret;
    while(child != null){
        if( child.classList.contains("selectables")){
            ret = validateSelectables(child);
            if(!ret) return false;
        }
        else if( child.classList.contains("assignment")){
            if(! child.value) return false;
        }
        else{
            ret = reqValidator(child);
            if(!ret) return false;
        }
        child = child.nextElementSibling;
    }
    return true;
}

/**
 * This validates all requirements regardless
 * if they are visible, disabled,...
 */
function validateRequirements(){
    var aa;
    // Check all requirements
    var reqs = elsByCls('requirement');
    for(aa=0; reqs.length > aa; aa++){
        if(reqValidator(reqs[aa])){
            addRemoveClasses(reqs[aa],'valid','invalid');
        }
        else{
            addRemoveClasses(reqs[aa],'invalid','valid');
        }
    }
    // Check all components
    var components = elsByCls('component');
    for(aa=0; components.length > aa; aa++){
        if(components[aa].getElementsByClassName('invalid').length == 0 ){
            addRemoveClasses(components[aa],'valid','invalid');
        }
        else{
            addRemoveClasses(components[aa],'invalid','valid');
        }
    }
}

function setCheckboxState(cbox, isEnabled){
    if(isEnabled){
	cbox.disabled=false;
	cbox.classList.remove(DISABLED);
	cbox.nextSibling.classList.remove(DISABLED);
    }
    else{
	cbox.disabled=true;
	cbox.classList.add(DISABLED);
	cbox.nextSibling.classList.add(DISABLED);
    }
}

function isExclusive(chk){
    return chk.classList.contains("exclusive");
}

/**
 * Handles the UI for a group of selections
 * @param chk Is the checkbox that the action happened on
 */
function handleSelectionGroupUpdate(chk){
    var aa; 
    var group=[];
    var isSomethingChecked = populateSelectableGroup(chk,group);

    for(aa=0; group.length>aa ; aa++){
	if(isSomethingChecked){                                    // If something's checked
	    if(chk==group[aa]) continue;                           // We're not doing anything to chk
	    if(chk.checked){                                       // If we just checked
		if( isExclusive(chk) || isExclusive(group[aa])){   // And on or the oth
		    setCheckboxState(group[aa], false);		    
		}
	    }
	    else{   		// It's an uncheck event
		if( isExclusive(group[aa]) && !group[aa].checked){// And current is exclusive and not checked.
		    setCheckboxState(group[aa], false);		    
		}
	    }
	}
	else{
	    setCheckboxState(group[aa], true);
	}
    }
}


// Function to expand and contract a given div
function toggle(descendent) {
    var isAddHide = !descendent.parentNode.classList.contains('hide');
    modifyClass( descendent.parentNode, 'hide', isAddHide);
}


function addRemoveClasses(elem, addClass, remClass){
    elem.classList.remove(remClass);
    elem.classList.add(addClass);
}

function delayedUpdate(){
    var elems = elsByCls("val");
    performActionOnElements(elems, saveToCookieJar);
    saveAllCookies(cookieJar);
    sched = undefined;
}

function transform(xsl, xml){
    // code for IE
    if (window.ActiveXObject ){
        return xml.transformNode(xsl);
    }
    // code for Chrome, Firefox, Opera, etc.
    else if (document.implementation && document.implementation.createDocument){
        var xsltProcessor = new XSLTProcessor();
	xsltProcessor.importStylesheet(xsl);
        return xsltProcessor.transformToFragment(xml, document);
    }
}
// ##################################################
// # https://stackoverflow.com/questions/\
// # 7918868/how-to-escape-xml-entities-in-javascript
// # Thanks jordancpaul
// ##################################################
var escapeXml = (function() {
        var doc = document.implementation.createDocument("", "", null)
        var el = doc.createElement("temp");
        el.textContent = "temp";
        el = el.firstChild;
        var ser =  new XMLSerializer();
        return function(text) {
            el.nodeValue = text;
            return ser.serializeToString(el);
        };
    })();


// ##################################################
// #          Logging things
// ##################################################
function qq(msg){
    console.log(msg);
}
    
function logit(val){
    if( prefix=='debug'){
	console.log(val);
    }
}

// ##################################################
// #         Blob the Builder
// ##################################################
// Took this from stack overflow
var MyBlobBuilder = function() {
  this.parts = [];
}

MyBlobBuilder.prototype.append = function(part) {
  this.parts.push(part);
  this.blob = undefined; // Invalidate the blob
};

MyBlobBuilder.prototype.getBlob = function(mimetype) {
  if (!this.blob) {
    this.blob = new Blob(this.parts, { type: mimetype });
  }
  return this.blob;
};

var selMap={'General_Purpose_Operating_System':{
'ec2':{"fcs__tlsc__ext.2":1},
'ec3':{"fcs__tlsc__ext.2":1},
'ec5':{"fcs__tlsc__ext.2":1},
'ec7':{"fcs__tlsc__ext.2":1},
'dtls':{"fcs__dtls__ext.1":1},
'ec6':{"fcs__tlsc__ext.2":1},
'ec8':{"fcs__tlsc__ext.2":1},
'ec4':{"fcs__tlsc__ext.2":1},
'ec1':{"fcs__tlsc__ext.2":1},
},'Mobile_Device_Fundamentals':{
'mutable_hardware':{"fcs__ckm__ext.7":1},
'uau_hybr':{"fdp__pba__ext.1":1,"fia__bmg__ext.1":1},
'uau_fing':{"fdp__pba__ext.1":1,"fia__bmg__ext.1":1},
'uau_iris':{"fdp__pba__ext.1":1,"fia__bmg__ext.1":1},
'x509_sys':{"fpt__tud__ext.3":1},
'x509_sign':{"fpt__tst__ext.3":1},
'tlsc_1':{"fcs__tlsc__ext.2":1},
'tlsc_4':{"fcs__tlsc__ext.2":1},
'tlsc_6':{"fcs__tlsc__ext.2":1},
'upc_dtls':{"fcs__dtls__ext.1":1},
'tlsc_2':{"fcs__tlsc__ext.2":1},
'x509_dtls':{"fcs__dtls__ext.1":1},
'uau_vein':{"fdp__pba__ext.1":1,"fia__bmg__ext.1":1},
'tlsc_8':{"fcs__tlsc__ext.2":1},
'fdp_group':{"fdp__acf__ext.2":1},
'x509_apps':{"fpt__tud__ext.3":1},
'tlsc_5':{"fcs__tlsc__ext.2":1},
'uau_face':{"fdp__pba__ext.1":1,"fia__bmg__ext.1":1},
'tlsc_3':{"fcs__tlsc__ext.2":1},
'itc_dtls':{"fcs__dtls__ext.1":1},
'tlsc_7':{"fcs__tlsc__ext.2":1},
'uau_vox':{"fdp__pba__ext.1":1,"fia__bmg__ext.1":1},
},'TLS':{
'tecdhe1':{"fcs__tlsc__ext.5":1},
'dtlsc_mutual_auth':{"fcs__dtlsc__ext.2":1},
'decdhe4':{"fcs__tlsc__ext.5":1},
'decdhe2':{"fcs__tlsc__ext.5":1},
'tlsc_reneg':{"fcs__tlsc__ext.4":1},
'tecdhe5':{"fcs__tlsc__ext.5":1},
'tecdhe7':{"fcs__tlsc__ext.5":1},
'tecdhe4':{"fcs__tlsc__ext.5":1},
'tlsc_impl':{"fcs__tlsc__ext.1":1},
'tecdhe3':{"fcs__tlsc__ext.5":1},
'tecdhe2':{"fcs__tlsc__ext.5":1},
'decdhe5':{"fcs__tlsc__ext.5":1},
'tlss_mutual_auth':{"fcs__tlss__ext.2":1},
'tlss_impl':{"fcs__tlss__ext.1":1},
'dtlss_mutual_auth':{"fcs__dtlss__ext.2":1},
'decdhe6':{"fcs__tlsc__ext.5":1},
'decdhe7':{"fcs__tlsc__ext.5":1},
'decdhe1':{"fcs__tlsc__ext.5":1},
'dtlsc_impl':{"fcs__dtlsc__ext.1":1},
'tecdhe6':{"fcs__tlsc__ext.5":1},
'dtlss_impl':{"fcs__dtlss__ext.1":1},
'tecdhe8':{"fcs__tlsc__ext.5":1},
'tlss_reneg':{"FCS__TLSS__EXT.4":1},
'decdhe8':{"fcs__tlsc__ext.5":1},
'decdhe3':{"fcs__tlsc__ext.5":1},
'tlsc_mutual_auth':{"fcs__tlsc__ext.2":1},
},};
//]]>
       </script>
    </head>
    <body onkeypress='handleKey(event); return true;' onload='init();'>
      <div id='fade-pane'>
        Press <i>Control+'?'</i> for help.
      </div>
      <div id='help-pane'>
        Future Help Goes Here.
      </div>
      <img style="margin: auto; display: block;" src="https://www.niap-ccevs.org/assets/images/bnr2015.home.jpg" alt="NIAP"></img>
      <div class="basepane">
        <h1>Security Target Worksheet</h1>
      <div class='warning-pane'>
        <noscript><h2 class="warning">This page requires JavaScript.</h2></noscript>
           <h2 class="warning" id='url-warning' style="display: none;">
             Most browsers do not store cookies from local pages (i.e, 'file:///...').
             When you close this page, all data will most likely be lost.</h2>
      </div>
     
    <div id='ws_base'><h3>Select the Base Protection Profile:</h3><input type='checkbox' class='basecheck' onchange='baseChange(this); return false;' id='bases:General_Purpose_Operating_System'></input>General Purpose Operating System 4.2<br/>
<input type='checkbox' class='basecheck' onchange='baseChange(this); return false;' id='bases:Mobile_Device_Fundamentals'></input>Mobile Device Fundamentals 3.1<br/>
</div>
<div id='ws_mods' class='disabled dep:General_Purpose_Operating_System dep:Mobile_Device_Fundamentals'><h3>Select All Applicable Modules/Packages</h3>
<div class='hidable modcheckdiv'><input type='checkbox' class='modcheck' onchange='moduleChange()' id='mods:TLS'></input>TLS 1.0<br/>
</div>
</div><div class='hidable dep:General_Purpose_Operating_System' id='base:General_Purpose_Operating_System'><h2>General Purpose Operating System</h2><span id='General_Purpose_Operating_System:fcs__ckm.1' class='component fcs__ckm.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_CKM.1 &#8212; Cryptographic Key Generation (Refined)</a>
<div class='reqgroup'>
<div id='General_Purpose_Operating_System:fcs__ckm.1.1' class='requirement fcs__ckm.1.1'><div class='f-el-title'>FCS_CKM.1.1</div><div class='words'> The <b>OS</b> shall generate <b>asymmetric</b> cryptographic keys in accordance with a
              specified cryptographic key generation algorithm <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span><b>RSA schemes</b> using cryptographic key sizes of 2048-bit or greater that meet the following: <b>FIPS PUB 186-4, "Digital Signature Standard (DSS)", Appendix B.3</b></span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span><b>ECC schemes</b> using "NIST curves" P-256, P-384 and 
		  <span class='selectables' data-rindex='1'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>P-521</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox exclusive'></input><span> no other curves</span>
</span> that meet the following: FIPS PUB 186-4, "Digital Signature Standard (DSS)", Appendix B.4</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span><b>FFC schemes</b> using cryptographic key sizes of 2048-bit 
                  or greater that meet the following: FIPS PUB 186-4, "Digital Signature 
                  Standard (DSS)", Appendix B.1</span>
</li>
</ul>
</span>
              
              .
            </div>
</div><!-- End: General_Purpose_Operating_System:fcs__ckm.1.1 -->
<div class='aactivity'>
 
	      <p>
	      The evaluator will ensure that the TSS identifies the key
              sizes supported by the OS. If the ST specifies
              more than one scheme, the evaluator will examine the TSS to verify
              that it identifies the usage for each scheme. 
	      </p><p>
	      The evaluator will verify that
              the AGD guidance instructs the administrator how to configure the OS 
	      to use the selected key generation scheme(s) and key size(s) for all uses defined
              in this PP. 
	      </p>
	      <p>
	      Evaluation Activity Note: The following tests may require the
              vendor to furnish a developer environment and developer 
	      tools that are typically not available to end-users of the OS. 
              <p>
		<b>Key Generation for FIPS PUB 186-4 RSA Schemes</b><br/>
		The evaluator will verify
              the implementation of RSA Key Generation by the OS using the Key
              Generation test. This test verifies the ability of the TSF to
              correctly produce values for the key components including the public verification
              exponent e, the private prime factors p and q, the public modulus n and the
              calculation of the private signature exponent d. Key Pair generation specifies 5 ways
              (or methods) to generate the primes p and q. These include: 
	      <ol>
                <li> Random Primes: 
		<ul>
                  <li>Provable primes</li>
                  <li>Probable primes</li>
                </ul>
                </li>
                <li> Primes with Conditions: <ul>
                    <li>Primes p1, p2, q1,q2, p and q shall all be provable primes</li>
                    <li>Primes p1, p2, q1, and q2 shall be provable primes and p and q shall be
                      probable primes</li>
                    <li>Primes p1, p2, q1,q2, p and q shall all be probable primes</li>
                  </ul>
                </li>
              </ol>
	      To test the key generation method for the Random Provable primes method and for
              all the Primes with Conditions methods, the evaluator must seed the TSF key generation routine with sufficient data to deterministically
              generate the RSA key pair. This includes the random seed(s), the public exponent of
              the RSA key, and the desired key length. For each key length supported, the evaluator
              shall have the TSF generate 25 key pairs. The evaluator will verify
              the correctness of the TSF's implementation by comparing values
              generated by the TSF with those generated from a known good
              implementation. 
	      </p><p>
	      If possible, the Random Probable primes method should also be
              verified against a known good implementation as described above. Otherwise, the
              evaluator will have the TSF generate 10 keys pairs for each
              supported key length nlen and verify: <ul>
                <li>n = p⋅q,</li>
                <li>p and q are probably prime according to Miller-Rabin tests,</li>
                <li>GCD(p-1,e) = 1,</li>
                <li>GCD(q-1,e) = 1,</li>
                <li>2<sup>16</sup> ≤ e ≤ 2<sup>256</sup> and e is an odd integer,</li>
                <li>|p-q| &gt; 2<sup>nlen/2 - 100</sup>,</li>
                <li>p ≥ 2<sup>nlen/2 -1/2</sup>,</li>
                <li>q ≥ 2<sup>nlen/2 -1/2</sup>,</li>
                <li>2<sup>(nlen/2)</sup> &lt; d &lt; LCM(p-1,q-1),</li>
                <li>e⋅d = 1 mod LCM(p-1,q-1).</li>
              </ul>

              <b>Key Generation for Elliptic Curve Cryptography (ECC)</b>
	      <p> FIPS 186-4 ECC Key Generation Test</p>
              For each supported NIST curve, i.e., P-256, P-384 and P-521, the
              evaluator will require the implementation under test (IUT) to generate 10
              private/public key pairs. The private key shall be generated using an approved random
              bit generator (RBG). To determine correctness, the evaluator will submit the
              generated key pairs to the public key verification (PKV) function of a known good
              implementation. 
	     </p>
	      <p>FIPS 186-4 Public Key Verification (PKV) Test</p> 
	      <p>
	      For each supported
              NIST curve, i.e., P-256, P-384 and P-521, the evaluator will generate 10
              private/public key pairs using the key generation function of a known good
              implementation and modify five of the public key values so that they are incorrect,
              leaving five values unchanged (i.e., correct). The evaluator will obtain in response
              a set of 10 PASS/FAIL values.

	      </p>
	      <p>
              <b>Key Generation for Finite-Field Cryptography (FFC)</b>
              <br/>
              The evaluator will verify the implementation of the Parameters Generation 
              and the Key Generation for FFC by the TOE using the Parameter Generation 
              and Key Generation test. 
	      This test verifies the ability of the TSF to correctly 
              produce values for the field prime p, the cryptographic prime q (dividing p-1), 
              the cryptographic group generator g, and the calculation of the private 
              key x and public key y.
	      </p><p>
              The Parameter generation specifies 2 ways (or methods) to generate the 
              cryptographic prime q and the field prime p:
              <br/>            
              
              <li>Cryptographic and Field Primes:<ul>
                <li>Primes q and p shall both be provable primes</li>
                <li>Primes q and field prime p shall both be probable primes</li>
              </ul>
              </li>
              and two ways to generate the cryptographic group generator g:
              
              <li>Cryptographic Group Generator:<ul>
                <li>Generator g constructed through a verifiable process</li>
                <li>Generator g constructed through an unverifiable process</li>
              </ul>
              </li>

              The Key generation specifies 2 ways to generate the private key x:              
              
              <li>Private Key:<ul>
                <li>len(q) bit output of RBG where 1 ≤ x ≤ q-1</li>
                <li>len(q) + 64 bit output of RBG, followed by a mod q-1 operation where 1 ≤ x ≤ q-1</li>
              </ul>
              </li>
              
              The security strength of the RBG must be at least that of the security offered by the FFC parameter set.
              
              To test the cryptographic and field prime generation method for the provable primes method and/or the
              group generator g for a verifiable process, the evaluator must seed the TSF parameter 
              generation routine with sufficient data to deterministically generate the parameter set.
              
              For each key length supported, the evaluator will have the TSF generate 25 parameter sets 
              and key pairs. The evaluator will verify the correctness of the TSF's implementation 
              by comparing values generated by the TSF with those generated from a known good 
              implementation. Verification must also confirm:
              <ul>
                <li>g != 0,1</li>
                <li>q divides p-1</li>
                <li>g<sup>q</sup> mod p = 1</li>
                <li>g<sup>x</sup> mod p = y</li>
              </ul>
              for each FFC parameter set and key pair.
              </p>
	      </p>
	    </div>
</div></span><!-- End: General_Purpose_Operating_System:fcs__ckm.1 -->
<span class='comp-notes'></span><br/><span id='General_Purpose_Operating_System:fcs__ckm.2' class='component fcs__ckm.2'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_CKM.2 &#8212; Cryptographic Key Establishment (Refined)</a>
<div class='reqgroup'>
<div id='General_Purpose_Operating_System:fcs__ckm.2.1' class='requirement fcs__ckm.2.1'><div class='f-el-title'>FCS_CKM.2.1</div><div class='words'> The OS shall implement functionality to perform cryptographic key establishment
              in accordance with a specified cryptographic key establishment method:
	      <p></p>
              <b>RSA-based key establishment schemes</b> that meets the following: 
	      NIST Special Publication 800-56B, "Recommendation for Pair-Wise Key Establishment Schemes
              Using Integer Factorization Cryptography"
	      <p></p> 
	      and 
	      <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span><b>Elliptic curve-based key establishment schemes</b> that meets the following:
                    NIST Special Publication 800-56A, "Recommendation for Pair-Wise Key
                    Establishment Schemes Using Discrete Logarithm Cryptography"</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span><b>Finite field-based key establishment schemes</b> that meets the following:
	          NIST Special Publication 800-56A, "Recommendation for Pair-Wise Key
	          Establishment Schemes Using Discrete Logarithm Cryptography"</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox exclusive'></input><span>No other schemes</span>
</li>
</ul>
</span>
              
              . 
            </div>
</div><!-- End: General_Purpose_Operating_System:fcs__ckm.2.1 -->
<div class='aactivity'>
 
	      <p>
		The evaluator will ensure that the supported key establishment schemes
		correspond to the key generation schemes identified in FCS_CKM.1.1. 
		If the ST specifies more than one scheme,
		the evaluator will examine the TSS to verify that it identifies the usage for each scheme. 
	      </p>
	      <p>
		The evaluator will verify that the AGD
		guidance instructs the administrator how to configure the OS to use the selected key
		establishment scheme(s). 
	      </p>
	      <p>
		Evaluation Activity Note: The following tests require
		the developer to provide access to a test platform that provides the evaluator with
		tools that are typically not found on factory products. 
	      </p>
	      <p><b>Key Establishment Schemes</b></p>
	      <p>
		The evaluator will verify the implementation of
		the key establishment schemes supported by the OS using the applicable tests below. 
	      </p>
	      <p><b>SP800-56A Key Establishment Schemes</b>
	      </p> 
	      <p>
	      The evaluator will verify the OS's
              implementation of SP800-56A key agreement schemes using the following Function and
              Validity tests. These validation tests for each key agreement scheme verify that the OS
              has implemented the components of the key agreement scheme according to the
              specifications in the Recommendation. These components include the calculation of the
              discrete logarithm cryptography (DLC) primitives (the shared secret value Z) and the
              calculation of the derived keying material (DKM) via the Key Derivation Function
              (KDF). If key confirmation is supported, the evaluator will also verify that the
              components of key confirmation have been implemented correctly, using the test
              procedures described below. This includes the parsing of the DKM, the generation of
              MAC data and the calculation of MAC tag. <br/>
              
		<p>
		  <b>Function Test</b>
		  <p>The Function test verifies the ability of the OS to implement the key agreement schemes correctly.
To conduct this test the evaluator will generate or obtain test vectors from a known good implementation of the OS's supported schemes.
For each supported key agreement scheme-key agreement role combination, KDF type, and, if supported, key confirmation role- key confirmation type combination, the tester shall generate 10 sets of test vectors. 
The data set consists of the NIST approved curve (ECC) per 10 sets of public keys.
These keys are static, ephemeral or both depending on the scheme being tested.
	      </p>
	      <p> The evaluator will obtain the DKM, the
                corresponding OS's public keys (static and/or ephemeral), the MAC tag(s), and any
                inputs used in the KDF, such as the Other Information field OI and OS id fields.
	      </p>
	      <p>
                If the OS does not use a KDF defined in SP 800-56A, the evaluator will
                obtain only the public keys and the hashed value of the shared secret.
	      </p>
	      <p>
		The
                evaluator will verify the correctness of the TSF's implementation of a given scheme
                by using a known good implementation to calculate the shared secret value, derive
                the keying material DKM, and compare hashes or MAC tags generated from these values.
	      </p>
	      <p>
                If key confirmation is supported, the OS shall perform the above for each
                implemented approved MAC algorithm. 
	      </p>
              </p>
	      <p>
		<b>Validity Test</b><br/>
		<p> The Validity test verifies the ability of the OS to
                recognize another party's valid and invalid key agreement results with or without
                key confirmation. To conduct this test, the evaluator will obtain a list of the
                supporting cryptographic functions included in the SP800-56A key agreement
                implementation to determine which errors the OS should be able to recognize. The
                evaluator generates a set of 30 test vectors consisting of data
                sets including domain parameter values or NIST approved curves, the evaluator's
                public keys, the OS's public/private key pairs, MAC tag, and any inputs used in the
                KDF, such as the other info and OS id fields.
		</p>
		<p>
		The evaluator will inject an
                error in some of the test vectors to test that the OS recognizes invalid key
                agreement results caused by the following fields being incorrect: the shared secret
                value Z, the DKM, the other information field OI, the data to be MAC'd, or the
                generated MAC tag. If the OS contains the full or partial (only ECC) public key
                validation, the evaluator will also individually inject errors in both parties'
                static public keys, both parties' ephemeral public keys and the OS's static private
                key to assure the OS detects errors in the public key validation function and/or
                the partial key validation function (in ECC only). At least two of the test vectors
                shall remain unmodified and therefore should result in valid key agreement results
                (they should pass).
		</p>
		<p>
		  The OS shall use these modified test vectors to emulate
                  the key agreement scheme using the corresponding parameters. The evaluator will
                  compare the OS's results with the results using a known good implementation
                  verifying that the OS detects these errors. 
		</p>
	      </p>
              
	      </p>
	      <p><b>SP800-56B Key Establishment Schemes</b></p>
	      <p> The evaluator will verify that the TSS
              describes whether the OS acts as a sender, a recipient, or both for RSA-based key
              establishment schemes. 
	      </p>
	      <p>
		If the OS acts as a sender, the following assurance
		activity shall be performed to ensure the proper operation of every OS supported
		combination of RSA-based key establishment scheme: <br/>
               To conduct this test the evaluator will generate or obtain test vectors from
                a known good implementation of the OS's supported schemes. For each combination of
                supported key establishment scheme and its options (with or without key confirmation
                if supported, for each supported key confirmation MAC function if key confirmation
                is supported, and for each supported mask generation function if KTS-OAEP is
                supported), the tester shall generate 10 sets of test vectors. Each test vector
                shall include the RSA public key, the plaintext keying material, any additional
                input parameters if applicable, the MAC key and MAC tag if key confirmation is
                incorporated, and the outputted ciphertext. For each test vector, the evaluator
                shall perform a key establishment encryption operation on the OS with the same
                inputs (in cases where key confirmation is incorporated, the test shall use the MAC
                key from the test vector instead of the randomly generated MAC key used in normal
                operation) and ensure that the outputted ciphertext is equivalent to the ciphertext
                in the test vector. 
	      </p>
              <p>
		If the OS acts as a receiver, the following evaluation activities shall be
		performed to ensure the proper operation of every OS supported combination of
		RSA-based key establishment scheme: <br/>
               To conduct this test the evaluator will generate or obtain test vectors from
                a known good implementation of the OS's supported schemes. For each combination of
                supported key establishment scheme and its options (with our without key
                confirmation if supported, for each supported key confirmation MAC function if key
                confirmation is supported, and for each supported mask generation function if
                KTS-OAEP is supported), the tester shall generate 10 sets of test vectors. Each test
                vector shall include the RSA private key, the plaintext keying material, any
                additional input parameters if applicable, the MAC tag in cases where key
                confirmation is incorporated, and the outputted ciphertext. For each test vector,
                the evaluator will perform the key establishment decryption operation on the OS
                and ensure that the outputted plaintext keying material is equivalent to the
                plaintext keying material in the test vector. In cases where key confirmation is
                incorporated, the evaluator will perform the key confirmation steps and ensure that
                the outputted MAC tag is equivalent to the MAC tag in the test vector. 
	      
	      </p>
              <p> The evaluator will ensure that the TSS describes how the OS handles decryption
              errors. In accordance with NIST Special Publication 800-56B, the OS must not reveal
              the particular error that occurred, either through the contents of any outputted or
              logged error message or through timing variations. If KTS-OAEP is supported, the
              evaluator will create separate contrived ciphertext values that trigger each of the
              three decryption error checks described in NIST Special Publication 800-56B section
              7.2.2.3, ensure that each decryption attempt results in an error, and ensure that any
              outputted or logged error message is identical for each. If KTS-KEM-KWS is supported,
              the evaluator will create separate contrived ciphertext values that trigger each of
              the three decryption error checks described in NIST Special Publication 800-56B
              section 7.2.3.3, ensure that each decryption attempt results in an error, and ensure
              that any outputted or logged error message is identical for each. 
	    </p>
	    </div>
</div></span><!-- End: General_Purpose_Operating_System:fcs__ckm.2 -->
<span class='comp-notes'></span><br/><span id='General_Purpose_Operating_System:FCS__CKM__EXT.4' class='component FCS__CKM__EXT.4'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_CKM_EXT.4 &#8212; Cryptographic Key Destruction</a>
<div class='reqgroup'>
<div id='General_Purpose_Operating_System:FCS__CKM__EXT.4.1' class='requirement FCS__CKM__EXT.4.1'><div class='f-el-title'>FCS_CKM_EXT.4.1</div><div class='words'>
The OS shall destroy cryptographic keys and key material in accordance with a specified cryptographic key destruction method 
              <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>For volatile memory, the destruction shall be executed by a 
		<span class='selectables' data-rindex='1'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>single overwrite consisting of <span class='selectables' data-rindex='2'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>a pseudo-random pattern using the TSF's RBG</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>zeroes</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>ones</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span>a new value of a key</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='4' class='val selbox'></input><span><textarea onchange='update(this);' class='assignment val' rows='1' placeholder='any value that does not contain any CSP'></textarea></span>
</li>
</ul>
</span></span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>removal of power to the memory</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>destruction of reference to the key directly followed by a request for garbage collection</span>
</li>
</ul>
</span></span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>For non-volatile memory that consists of the invocation of an interface provided by the underlying platform that <span class='selectables' data-rindex='3'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>logically addresses the storage location of the key and performs a <span class='selectables' data-rindex='4'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>single</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span><textarea onchange='update(this);' class='assignment val' rows='1' placeholder='ST author defined multi-pass'></textarea></span>
</li>
</ul>
</span>
overwrite consisting of 
                      <span class='selectables' data-rindex='5'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>zeroes</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>ones</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>pseudo-random pattern</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span>a new value of a key of the same size</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='4' class='val selbox'></input><span><textarea onchange='update(this);' class='assignment val' rows='1' placeholder='any value that does not contain any CSP'></textarea></span>
</li>
</ul>
</span></span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>instructs the underlying platform to destroy the abstraction that represents the key</span>
</li>
</ul>
</span></span>
</li>
</ul>
</span>
	      .
	    </div>
</div><!-- End: General_Purpose_Operating_System:FCS__CKM__EXT.4.1 -->
<div id='General_Purpose_Operating_System:FCS__CKM__EXT.4.2' class='requirement FCS__CKM__EXT.4.2'><div class='f-el-title'>FCS_CKM_EXT.4.2</div><div class='words'>The OS shall destroy all keys and key material when no longer needed.</div>
</div><!-- End: General_Purpose_Operating_System:FCS__CKM__EXT.4.2 -->
<div class='aactivity'>

	      
	      <p>
The evaluator examines the TSS to ensure it describes how the keys are managed in volatile memory. This description includes details of how each identified key is introduced into volatile memory (e.g. by derivation from user input, or by unwrapping a wrapped key stored in non-volatile memory) and how they are overwritten.
	      </p>
	      <p>
The evaluator will check to ensure the TSS lists each type of key that is stored in in non-volatile memory, and identifies how the TOE interacts with the underlying platform to manage keys (e.g., store, retrieve, destroy). The description includes details on the method of how the TOE interacts with the platform, including an identification and description of the interfaces it uses to manage keys (e.g., file system APIs, platform key store APIs).
	      </p>
	      <p>
If the ST makes use of the open assignment and fills in the type of pattern that is used, the evaluator examines the TSS to ensure it describes how that pattern is obtained and used. The evaluator will verify that the pattern does not contain any CSPs.
	      </p>
	      <p>
The evaluator will check that the TSS identifies any configurations or circumstances that may not strictly conform to the key destruction requirement.
	      </p>
<h3>Operational Guidance</h3>
	      <p>
There are a variety of concerns that may prevent or delay key destruction in some cases. The evaluator will check that the guidance documentation identifies configurations or circumstances that may not strictly conform to the key destruction requirement, and that this description is consistent with the relevant parts of the TSS and any other relevant Required Supplementary Information. The evaluator will check that the guidance documentation provides guidance on situations where key destruction may be delayed at the physical layer and how such situations can be avoided or mitigated if possible.
	      </p>
	      <p>
Some examples of what is expected to be in the documentation are provided here. 
	      </p>
	      <p>
When the TOE does not have full access to the physical memory, it is possible that the storage may be implementing wear-leveling and garbage collection. This may create additional copies of the key that are logically inaccessible but persist physically. In this case, to mitigate this the drive should support the TRIM command and implements garbage collection to destroy these persistent copies when not actively engaged in other tasks.
	      </p>
	      <p>
Drive vendors implement garbage collection in a variety of different ways, as such there is a variable amount of time until data is truly removed from these solutions. There is a risk that data may persist for a longer amount of time if it is contained in a block with other data not ready for erasure. To reduce this risk, the operating system and file system of the OE should support TRIM, instructing the non-volatile memory to erase copies via garbage collection upon their deletion. If a RAID array is being used, only set-ups that support TRIM are utilized. If the drive is connected via PCI-Express, the operating system supports TRIM over that channel.
	      </p>
	      <p>
The drive should be healthy and contains minimal corrupted data and should be end-of-lifed before a significant amount of damage to drive health occurs, this minimizes the risk that small amounts of potentially recoverable data may remain in damaged areas of the drive.
	      </p>
		
		  Applied to each key held as in volatile memory and subject to destruction by overwrite by the TOE (whether or not the value is subsequently encrypted for storage in volatile or non-volatile memory). In the case where the only selection made for the destruction method key was removal of power, then this test is unnecessary. The evaluator will:
		  <ol>
		    <li>Record the value of the key in the TOE subject to clearing.</li>
		    <li>Cause the TOE to perform a normal cryptographic processing with the key from Step #1.</li>
		    <li>Cause the TOE to clear the key.</li>
		    <li>Cause the TOE to stop the execution but not exit.</li>
		    <li>Cause the TOE to dump the entire memory of the TOE into a binary file.</li>
		    <li>Search the content of the binary file created in Step #5 for instances of the known key value from Step #1.</li>
		  </ol>
		  <p>
Steps 1-6 ensure that the complete key does not exist anywhere in volatile memory. If a copy is found, then the test fails.
		  </p>

Applied to each key help in non-volatile memory and subject to destruction by the TOE. The evaluator will use special tools (as needed), provided by the TOE developer if necessary, to ensure the tests function as intended.
<ol>
  <li>Identify the purpose of the key and what access should fail when it is deleted. (e.g. the data encryption key being deleted would cause data decryption to fail.)</li>
  <li>Cause the TOE to clear the key.</li>
  <li>Have the TOE attempt the functionality that the cleared key would be necessary for.</li>
</ol>

<p>
  The test succeeds if step 3 fails.
</p>


<p>
  The following tests apply only to selection a), since the TOE in this instance has more visibility into what is happening within the underlying platform (e.g., a logical view of the media). In selection b), the TOE has no visibility into the inner workings and completely relies on the underlying platform, so there is no reason to test the TOE beyond test 2.
</p>
<p>
For selection a), the following tests are used to determine the TOE is able to request the platform to overwrite the key with a TOE supplied pattern.
</p>
<p>

Applied to each key held in non-volatile memory and subject to destruction by overwrite by the TOE. The evaluator will use a tool that provides a logical view of the media (e.g., MBR file system):
<ol>
<li>Record the value of the key in the TOE subject to clearing.</li>

<li>Cause the TOE to perform a normal cryptographic processing with the key from Step #1.</li>

<li>Cause the TOE to clear the key.</li>

<li>Search the logical view that the key was stored in for instances of the known key value from Step #1. If a copy is found, then the test fails.</li>
</ol>
</p>

 Applied to each key held as non-volatile memory and subject to destruction by overwrite by the TOE. The evaluator will use a tool that provides a logical view of the media:
<ol>
<li>Record the logical storage location of the key in the TOE subject to clearing.</li>

<li>Cause the TOE to perform a normal cryptographic processing with the key from Step #1.</li>

<li>Cause the TOE to clear the key.</li>

<li>Read the logical storage location in Step #1 of non-volatile memory to ensure the appropriate pattern is utilized.</li>
</ol>
<p>
  The test succeeds if correct pattern is used to overwrite the key in the memory location. If the pattern is not found the test fails.
</p>

		
            </div>
</div></span><!-- End: General_Purpose_Operating_System:FCS__CKM__EXT.4 -->
<span class='comp-notes'></span><br/><span id='General_Purpose_Operating_System:fcs__cop.1_l1_r' class='component fcs__cop.1_l1_r'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_COP.1(1) &#8212; Cryptographic Operation - Encryption/Decryption (Refined)</a>
<div class='reqgroup'>
<div id='General_Purpose_Operating_System:fcs__cop.1.1_l1_r' class='requirement fcs__cop.1.1_l1_r'><div class='f-el-title'>FCS_COP.1.1(1)</div><div class='words'>
              The <b>OS</b> shall perform encryption/decryption services for data in 
	      accordance with a specified cryptographic algorithm 
	      <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>AES-XTS (as defined in NIST SP 800-38E)</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>AES-CBC (as defined in NIST SP 800-38A)</span>
</li>
</ul>
</span> 
	      and 
	      <span class='selectables' data-rindex='1'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>AES-CCMP (as defined in FIPS PUB 197, NIST SP 800-38C and IEEE 802.11-2012)</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>AES Key Wrap (KW) (as defined in NIST SP 800-38F)</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>AES Key Wrap with Padding (KWP) (as defined in NIST SP 800-38F)</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span>AES-GCM (as defined in NIST SP 800-38D)</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='4' class='val selbox'></input><span>AES-CCM (as defined in NIST SP 800-38C)</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='5' class='val selbox'></input><span>AES-CCMP-256 (as defined in NIST SP800-38C and IEEE 802.11ac-2013)</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='6' class='val selbox'></input><span>AES-GCMP-256 (as defined in NIST SP800-38D and IEEE 802.11ac-2013)</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='7' class='val selbox exclusive'></input><span>no other modes</span>
</li>
</ul>
</span> 
              and cryptographic key sizes 
              <span class='selectables' data-rindex='2'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>128-bit</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>256-bit</span>
</span>
        
	      .
	    </div>
</div><!-- End: General_Purpose_Operating_System:fcs__cop.1.1_l1_r -->
<div class='aactivity'>
 
	      <p>
	      The evaluator will verify that the AGD documents contains instructions required 
	      to configure the OS to use the required modes and key sizes. 
	      The evaluator will execute all instructions as specified to configure the OS
	      to the appropriate state.
	      The evaluator will perform all of the following tests for each
              algorithm implemented by the OS and used to satisfy the requirements of this PP: 
	      </p>
	      <p>
              <b>AES-CBC Known Answer Tests</b>
	      </p>
	      <p>
		There are four Known Answer Tests (KATs), described below. In all KATs, the
              plaintext, ciphertext, and IV values shall be 128-bit blocks. The results from each
              test may either be obtained by the evaluator directly or by supplying the inputs to
              the implementer and receiving the results in response. To determine correctness, the
              evaluator will compare the resulting values to those obtained by submitting the same
              inputs to a known good implementation. <ul>
                <li>KAT-1. To test the encrypt functionality of AES-CBC, the evaluator will supply
                  a set of 10 plaintext values and obtain the ciphertext value that results from
                  AES-CBC encryption of the given plaintext using a key value of all zeros and an IV
                  of all zeros. Five plaintext values shall be encrypted with a 128-bit all-zeros
                  key, and the other five shall be encrypted with a 256-bit all- zeros key. To test
                  the decrypt functionality of AES-CBC, the evaluator will perform the same test as
                  for encrypt, using 10 ciphertext values as input and AES-CBC decryption.</li>
                <li>KAT-2. To test the encrypt functionality of AES-CBC, the evaluator will supply
                  a set of 10 key values and obtain the ciphertext value that results from AES-CBC
                  encryption of an all-zeros plaintext using the given key value and an IV of all
                  zeros. Five of the keys shall be 128-bit keys, and the other five shall be 256-bit
                  keys. To test the decrypt functionality of AES-CBC, the evaluator will perform
                  the same test as for encrypt, using an all-zero ciphertext value as input and
                  AES-CBC decryption.</li>
                <li>KAT-3. To test the encrypt functionality of AES-CBC, the evaluator will supply
                  the two sets of key values described below and obtain the ciphertext value that
                  results from AES encryption of an all-zeros plaintext using the given key value
                  and an IV of all zeros. The first set of keys shall have 128 128-bit keys, and the
                  second set shall have 256 256-bit keys. Key i in each set shall have the leftmost
                  i bits be ones and the rightmost N-i bits be zeros, for i in [1,N]. To test the
                  decrypt functionality of AES-CBC, the evaluator will supply the two sets of key
                  and ciphertext value pairs described below and obtain the plaintext value that
                  results from AES-CBC decryption of the given ciphertext using the given key and an
                  IV of all zeros. The first set of key/ciphertext pairs shall have 128 128-bit
                  key/ciphertext pairs, and the second set of key/ciphertext pairs shall have 256
                  256-bit key/ciphertext pairs. Key i in each set shall have the leftmost i bits be
                  ones and the rightmost N-i bits be zeros, for i in [1,N]. The ciphertext value in
                  each pair shall be the value that results in an all-zeros plaintext when decrypted
                  with its corresponding key.</li>
                <li>KAT-4. To test the encrypt functionality of AES-CBC, the evaluator will supply
                  the set of 128 plaintext values described below and obtain the two ciphertext
                  values that result from AES-CBC encryption of the given plaintext using a 128-bit
                  key value of all zeros with an IV of all zeros and using a 256-bit key value of
                  all zeros with an IV of all zeros, respectively. Plaintext value i in each set
                  shall have the leftmost i bits be ones and the rightmost 128-i bits be zeros, for
                  i in [1,128].</li>
              </ul>
	      <br/>
	      To test the decrypt functionality of AES-CBC, the evaluator will perform the
              same test as for encrypt, using ciphertext values of the same form as the plaintext in
              the encrypt test as input and AES-CBC decryption.
	      </p>
              <b>AES-CBC Multi-Block Message Test</b>
	      <p>
              The evaluator will test the encrypt functionality by encrypting an i-block
              message where 1 &lt; i ≤ 10. The evaluator will choose a key, an IV and plaintext
              message of length i blocks and encrypt the message, using the mode to be tested, with
              the chosen key and IV. The ciphertext shall be compared to the result of encrypting
              the same plaintext message with the same key and IV using a known good implementation.
              The evaluator will also test the decrypt functionality for each mode by decrypting an
              i-block message where 1 &lt; i ≤10. The evaluator will choose a key, an IV and a
              ciphertext message of length i blocks and decrypt the message, using the mode to be
              tested, with the chosen key and IV. The plaintext shall be compared to the result of
              decrypting the same ciphertext message with the same key and IV using a known good
              implementation. 
	    </p>
	    <p>
	      <b>AES-CBC Monte Carlo Tests</b>
	    </p>
	    <p>
	      The evaluator will test the encrypt
              functionality using a set of 200 plaintext, IV, and key 3- tuples. 100 of these shall
              use 128 bit keys, and 100 shall use 256 bit keys. The plaintext and IV values shall be
              128-bit blocks. For each 3-tuple, 1000 iterations shall be run as follows:
              <pre>
              # Input: PT, IV, Key
              for i = 1 to 1000:
                if i == 1:
                      CT[1] = AES-CBC-Encrypt(Key, IV, PT)
                      PT = IV
                else:
                  CT[i] = AES-CBC-Encrypt(Key, PT) 
                  PT = CT[i-1]
              </pre>The
              ciphertext computed in the 1000th iteration (i.e., CT[1000]) is the result for that
              trial. This result shall be compared to the result of running 1000 iterations with the
              same values using a known good implementation. 
	    </p>
	    <p>
	      The evaluator will test the
              decrypt functionality using the same test as for encrypt, exchanging CT and PT and
              replacing AES-CBC-Encrypt with AES-CBC-Decrypt. 
	    </p>
	    <p>
              <b>AES-GCM Monte Carlo Tests</b>
              <p></p>The evaluator will test the authenticated encrypt functionality of AES-GCM for
              each combination of the following input parameter lengths: <ul>
                <li>128 bit and 256 bit keys</li>
                <li>Two plaintext lengths. One of the plaintext lengths shall be a non-zero integer
                  multiple of 128 bits, if supported. The other plaintext length shall not be an
                  integer multiple of 128 bits, if supported.</li>
                <li>Three AAD lengths. One AAD length shall be 0, if supported. One AAD length shall
                  be a non-zero integer multiple of 128 bits, if supported. One AAD length shall not
                  be an integer multiple of 128 bits, if supported.</li>
                <li>Two IV lengths. If 96 bit IV is supported, 96 bits shall be one of the two IV
                  lengths tested.</li>
              </ul>The evaluator will test the encrypt functionality using a set of 10 key,
              plaintext, AAD, and IV tuples for each combination of parameter lengths above and
              obtain the ciphertext value and tag that results from AES-GCM authenticated encrypt.
              Each supported tag length shall be tested at least once per set of 10. The IV value
              may be supplied by the evaluator or the implementation being tested, as long as it is
              known. 
	    </p>
	    <p>


	      The evaluator will test the decrypt functionality using a set of 10 key,
              ciphertext, tag, AAD, and IV 5-tuples for each combination of parameter lengths above
              and obtain a Pass/Fail result on authentication and the decrypted plaintext if Pass.
              The set shall include five tuples that Pass and five that Fail. 
	    </p>
	    <p>
	      The results from
              each test may either be obtained by the evaluator directly or by supplying the inputs
              to the implementer and receiving the results in response. To determine correctness,
              the evaluator will compare the resulting values to those obtained by submitting the
              same inputs to a known good implementation.
	      </p>

              <p><b>AES-CCM Tests</b></p>
	      <p>
              The evaluator will test the generation-encryption and decryption-verification
              functionality of AES-CCM for the following input parameter and tag lengths: <ul>
                <li>128 bit and 256 bit keys</li>
                <li>Two payload lengths. One payload length shall be the shortest supported payload
                  length, greater than or equal to zero bytes. The other payload length shall be the
                  longest supported payload length, less than or equal to 32 bytes (256 bits).
                </li>
                <li>Two or three associated data lengths. One associated data length shall be 0, if
                  supported. One associated data length shall be the shortest supported payload length,
                  greater than or equal to zero bytes. One associated data length shall be the longest
                  supported payload length, less than or equal to 32 bytes (256 bits). If the
                  implementation supports an associated data length of 2
                  16 bytes, an associated data length of 216 bytes shall be tested.
                </li>
                <li>Nonce lengths. All supported nonce lengths between 7 and 13 bytes, inclusive, shall
                  be tested.
                </li>
                <li>Tag lengths. All supported tag lengths of 4, 6, 8, 10, 12, 14 and 16 bytes shall be
                  tested.
                </li>
              </ul>
              To test the generation-encryption functionality of AES-CCM, the evaluator will perform the
              following four tests: 
	      
		 For EACH supported key and associated data length and ANY supported
                  payload, nonce and tag length, the evaluator will supply one key value, one nonce
                  value and 10 pairs of associated data and payload values and obtain the resulting
                  ciphertext.
		
		For EACH supported key and payload length and ANY supported associated
                  data, nonce and tag length, the evaluator will supply one key value, one nonce value
                  and 10 pairs of associated data and payload values and obtain the resulting ciphertext.
		

                For EACH supported key and nonce length and ANY supported associated
                  data, payload and tag length, the evaluator will supply one key value and 10
                  associated data, payload and nonce value 3-tuples and obtain the resulting ciphertext.
                
                For EACH supported key and tag length and ANY supported associated data,
                  payload and nonce length, the evaluator will supply one key value, one nonce value
                  and 10 pairs of associated data and payload values and obtain the resulting ciphertext.
                
	      
	      </p>
	      <p>
              To determine correctness in each of the above tests, the evaluator will compare the
              ciphertext with the result of generation-encryption of the same inputs with a known good
              implementation. 
	      </p>
	      <p>
              To test the decryption-verification functionality of AES-CCM, for EACH combination of
              supported associated data length, payload length, nonce length and tag length, the evaluator
              shall supply a key value and 15 nonce, associated data and ciphertext 3-tuples and obtain
              either a FAIL result or a PASS result with the decrypted payload. The evaluator will supply
              10 tuples that should FAIL and 5 that should PASS per set of 15. 
	      </p>
	      <p>
              Additionally, the evaluator will use tests from the IEEE 802.11-02/362r6 document
              "Proposed Test vectors for IEEE 802.11 TGi", dated September 10, 2002, Section 2.1 AESCCMP
              Encapsulation Example and Section 2.2 Additional AES CCMP Test Vectors to
              further verify the IEEE 802.11-2007 implementation of AES-CCMP.
	      </p>
	      <p> <b>AES-GCM Test</b></p>
              <p>The evaluator will test the authenticated encrypt functionality of AES-GCM for each
                combination of the following input parameter lengths: <br/>
              <ul>
                <li>128 bit and 256 bit keys</li>
                <li>Two plaintext lengths. One of the plaintext lengths shall be a non-zero integer
                  multiple of 128 bits, if supported. The other plaintext length shall not be an integer
                  multiple of 128 bits, if supported.
                </li>
                <li>Three AAD lengths. One AAD length shall be 0, if supported. One AAD length shall
                  be a non-zero integer multiple of 128 bits, if supported. One AAD length shall not be
                  an integer multiple of 128 bits, if supported.
                </li>
                <li>Two IV lengths. If 96 bit IV is supported, 96 bits shall be one of the two IV lengths
                  tested.
                </li>
              </ul>
              The evaluator will test the encrypt functionality using a set of 10 key, plaintext, AAD, and
              IV tuples for each combination of parameter lengths above and obtain the ciphertext value
              and tag that results from AES-GCM authenticated encrypt. Each supported tag length shall be
              tested at least once per set of 10. The IV value may be supplied by the evaluator or the
              implementation being tested, as long as it is known.
	      </p>
	      <p>
              The evaluator will test the decrypt functionality using a set of 10 key, ciphertext, tag, AAD,
              and IV 5-tuples for each combination of parameter lengths above and obtain a Pass/Fail result
              on authentication and the decrypted plaintext if Pass. The set shall include five tuples that
              Pass and five that Fail.
	      </p>
	      <p>
              The results from each test may either be obtained by the evaluator directly or by supplying
              the inputs to the implementer and receiving the results in response. To determine correctness,
              the evaluator will compare the resulting values to those obtained by submitting the same
              inputs to a known good implementation.
	      </p>
	      <p><b>XTS-AES Test</b></p>
	      <p>
		The evaluator will test the encrypt functionality of XTS-AES for each combination of the
              following input parameter lengths:
              <ul>
                <li>256 bit (for AES-128) and 512 bit (for AES-256) keys</li>
                <li>Three data unit (i.e., plaintext) lengths. One of the data unit lengths shall be a nonzero
                  integer multiple of 128 bits, if supported. One of the data unit lengths shall be an
                  integer multiple of 128 bits, if supported. The third data unit length shall be either the
                  longest supported data unit length or 216 bits, whichever is smaller.
                </li>
              </ul>
              using a set of 100 (key, plaintext and 128-bit random tweak value) 3-tuples and obtain the
              ciphertext that results from XTS-AES encrypt.
	      </p>
	      <p>
		The evaluator may supply a data unit sequence number instead of the tweak value if the
		implementation supports it. The data unit sequence number is a base-10 number ranging
		between 0 and 255 that implementations convert to a tweak value internally.
	      </p>
	      <p>
		The evaluator will test the decrypt functionality of XTS-AES using the same test as for
		encrypt, replacing plaintext values with ciphertext values and XTS-AES encrypt with XTSAES
              decrypt.
	      </p>
	      <p><b>AES Key Wrap (AES-KW) and Key Wrap with Padding (AES-KWP) Test</b></p>
              <p>
		The evaluator will test the authenticated encryption functionality of AES-KW for EACH
		combination of the following input parameter lengths:
              <ul>
                <li>128 and 256 bit key encryption keys (KEKs)</li>
                <li>Three plaintext lengths. One of the plaintext lengths shall be two semi-blocks (128
                  bits). One of the plaintext lengths shall be three semi-blocks (192 bits). The third data
                  unit length shall be the longest supported plaintext length less than or equal to 64
                  semi-blocks (4096 bits).
                </li>
              </ul>
              using a set of 100 key and plaintext pairs and obtain the ciphertext that results from AES-KW
              authenticated encryption. To determine correctness, the evaluator will use the AES-KW
              authenticated-encryption function of a known good implementation.
	      </p>
	      <p>

              The evaluator will test the authenticated-decryption functionality of AES-KW using the
              same test as for authenticated-encryption, replacing plaintext values with ciphertext values
              and AES-KW authenticated-encryption with AES-KW authenticated-decryption.
	      </p>
	      <p>
              The evaluator will test the authenticated-encryption functionality of AES-KWP using the
              same test as for AES-KW authenticated-encryption with the following change in the three
              plaintext lengths:
              <ul>
                <li>One plaintext length shall be one octet. One plaintext length shall be 20 octets (160
                  bits).</li>
                <li>
                  One plaintext length shall be the longest supported plaintext length less than or equal
                  to 512 octets (4096 bits).
                </li>
              </ul>
              The evaluator will test the authenticated-decryption functionality of AES-KWP using the
              same test as for AES-KWP authenticated-encryption, replacing plaintext values with
              ciphertext values and AES-KWP authenticated-encryption with AES-KWP authenticated-decryption.
            </p>
	  </div>
</div></span><!-- End: General_Purpose_Operating_System:fcs__cop.1_l1_r -->
<span class='comp-notes'></span><br/><span id='General_Purpose_Operating_System:fcs__cop.1_l2_r' class='component fcs__cop.1_l2_r'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_COP.1(2) &#8212; Cryptographic Operation - Hashing (Refined)</a>
<div class='reqgroup'>
<div id='General_Purpose_Operating_System:fcs__cop.1.1_l2_r' class='requirement fcs__cop.1.1_l2_r'><div class='f-el-title'>FCS_COP.1.1(2)</div><div class='words'>The <b>OS</b> shall perform cryptographic hashing services in accordance with a
              specified cryptographic algorithm SHA-1 and <span class='selectables' data-rindex='0'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>SHA-256</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>SHA-384</span>
<input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>SHA-512</span>
<input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox exclusive'></input><span>no other algorithms</span>
</span> and message digest sizes 160 bits and <span class='selectables' data-rindex='1'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>256 bits</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>384 bits</span>
<input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>512 bits</span>
<input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox exclusive'></input><span>no other sizes</span>
</span> that meet the following: FIPS Pub 180-4. </div>
</div><!-- End: General_Purpose_Operating_System:fcs__cop.1.1_l2_r -->
<div class='aactivity'>

	      <p>
	      The evaluator will check that the association of the hash function with
              other application cryptographic functions (for example, the digital signature
              verification function) is documented in the TSS. 
	      </p>
	      <p>
		The TSF
              hashing functions can be implemented in one of two modes. The first mode is the
              byte-oriented mode. In this mode the TSF only hashes messages that
              are an integral number of bytes in length; i.e., the length (in bits) of the message
              to be hashed is divisible by 8. The second mode is the bit-oriented mode. In this mode
              the TSF hashes messages of arbitrary length. As there are different
              tests for each mode, an indication is given in the following sections for the
              bit-oriented vs. the byte-oriented testmacs. The evaluator will perform all of the
              following tests for each hash algorithm implemented by the TSF and
              used to satisfy the requirements of this PP.
	      </p>
	      <p>
		The following tests require the
		developer to provide access to a test application that provides the evaluator with
		tools that are typically not found in the production application.
                Short Messages Test (Bit oriented Mode) - The evaluator will generate an input set
                  consisting of m+1 messages, where m is the block length of the hash algorithm. The
                  length of the messages range sequentially from 0 to m bits. The message text shall
                  be pseudorandomly generated. The evaluator will compute the message digest for each of
                  the messages and ensure that the correct result is produced when the messages are
                  provided to the TSF.
                Short Messages Test (Byte oriented Mode) - The evaluator will generate an input set
                  consisting of m/8+1 messages, where m is the block length of the hash algorithm.
                  The length of the messages range sequentially from 0 to m/8 bytes, with each
                  message being an integral number of bytes. The message text shall be
                  pseudorandomly generated. The evaluator will compute the message digest for each of
                  the messages and ensure that the correct result is produced when the messages are
                  provided to the TSF.
                Selected Long Messages Test (Bit oriented Mode) - The evaluator will generate an input
                  set consisting of m messages, where m is the block length of the hash algorithm.
                  The length of the <i>i</i>th message is 512 + 99⋅i, where 1 ≤ i ≤ m. The message
                  text shall be pseudorandomly generated. The evaluator will compute the message digest
                  for each of the messages and ensure that the correct result is produced when the
                  messages are provided to the TSF.
                Selected Long Messages Test (Byte oriented Mode) - The evaluator will generate an
                  input set consisting of m/8 messages, where m is the block length of the hash
                  algorithm. The length of the <i>i</i>th message is 512 + 8⋅99⋅i, 
		  where 1 ≤ i ≤ m/8. The message text shall be pseudorandomly generated. 
		  The evaluator will compute
                  the message digest for each of the messages and ensure that the correct result is
                  produced when the messages are provided to the TSF.
                Pseudorandomly Generated Messages Test -  This test is for byte-oriented
                  implementations only. The evaluator will randomly generate a seed that is n bits long,
                  where n is the length of the message digest produced by the hash function to be
                  tested. The evaluator will then formulate a set of 100 messages and associated digests
                  by following the algorithm provided in Figure 1 of [SHAVS]. The evaluator will then
                  ensure that the correct result is produced when the messages are provided to the
                  TSF.
		
              
	      </p>
            </div>
</div></span><!-- End: General_Purpose_Operating_System:fcs__cop.1_l2_r -->
<span class='comp-notes'></span><br/><span id='General_Purpose_Operating_System:fcs__cop.1_l3_r' class='component fcs__cop.1_l3_r'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_COP.1(3) &#8212; Cryptographic Operation - Signing (Refined)</a>
<div class='reqgroup'>
<div id='General_Purpose_Operating_System:fcs__cop.1.1_l3_r' class='requirement fcs__cop.1.1_l3_r'><div class='f-el-title'>FCS_COP.1.1(3)</div><div class='words'>The <b>OS</b> shall perform cryptographic signature services (generation and
              verification) in accordance with a specified cryptographic algorithm <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span><b>RSA schemes</b> using cryptographic key sizes of 2048-bit or greater
                  that meet the following: FIPS PUB 186-4, "Digital Signature Standard (DSS)",  Section 4</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span><b>ECDSA schemes</b> using "NIST curves" P-256, P-384 and <span class='selectables' data-rindex='1'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>P-521</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox exclusive'></input><span>no other curves</span>
</span> 
		  that meet the following: FIPS PUB 186-4, "Digital Signature   Standard (DSS)", Section 5</span>
</li>
</ul>
</span>
              . 
            </div>
</div><!-- End: General_Purpose_Operating_System:fcs__cop.1.1_l3_r -->
<div class='aactivity'>

	      <p>
		The evaluator will perform the following activities based on the selections
		in the ST. 
	      </p>
	      <p>
		The following tests require the developer to
		provide access to a test application that provides the evaluator with tools that are
		typically not found in the production application.
	      </p>
	      <p><b>ECDSA Algorithm Tests</b></p>
	      <p>
	      
                ECDSA FIPS 186-4 Signature Generation Test. For each supported NIST curve
                  (i.e., P-256, P-384 and P-521) and SHA function pair, the evaluator will generate
                  10 1024-bit long messages and obtain for each message a public key and the
                  resulting signature values R and S. To determine correctness, the evaluator will
                  use the signature verification function of a known good implementation. 
                
		  ECDSA FIPS 186-4 Signature Verification Test. For each supported NIST curve
                  (i.e., P-256, P-384 and P-521) and SHA function pair, the evaluator will generate
                  a set of 10 1024-bit message, public key and signature tuples and modify one of
                  the values (message, public key or signature) in five of the 10 tuples.
		  The evaluator will verify that 5 responses indicate success and
		  5 responses indicate failure.
		
               
	      </p>
	      <p><b>RSA Signature Algorithm Tests </b></p>
	      <p>
	      
                Signature Generation Test. The evaluator will verify the implementation of
                  RSA Signature Generation by the OS using the Signature
                  Generation Test. To conduct this test the evaluator must generate or obtain 10
                  messages from a trusted reference implementation for each modulus size/SHA
                  combination supported by the TSF. 
		  The evaluator will have the
                    OS use its private key and modulus value to sign these
                  messages. The evaluator will verify the correctness of the TSF's signature using a known good implementation and the associated public keys to
                  verify the signatures. 
                Signature Verification Test. The evaluator will perform the Signature
                  Verification test to verify the ability of the OS to recognize
                  another party's valid and invalid signatures. The evaluator will inject errors
                  into the test vectors produced during the Signature Verification Test by
                  introducing errors in some of the public keys, e, messages, IR format, and/or
                  signatures. 
		  The evaluator will verify that the OS returns failure when
		  validating each signature.
		
              
	      </p>
            </div>
</div></span><!-- End: General_Purpose_Operating_System:fcs__cop.1_l3_r -->
<span class='comp-notes'></span><br/><span id='General_Purpose_Operating_System:fcs__cop.1_l4_r' class='component fcs__cop.1_l4_r'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_COP.1(4) &#8212; Cryptographic Operation - Keyed-Hash Message Authentication (Refined)</a>
<div class='reqgroup'>
<div id='General_Purpose_Operating_System:fcs__cop.1.1_l4_r' class='requirement fcs__cop.1.1_l4_r'><div class='f-el-title'>FCS_COP.1.1(4)</div><div class='words'>The <b>OS</b> shall perform keyed-hash message authentication services 
	    in accordance with a specified cryptographic algorithm
	      <span class='selectables' data-rindex='0'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>SHA-1</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>SHA-256</span>
<input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>SHA-384</span>
<input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span>SHA-512</span>
</span> 
	      with key sizes <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='key size (in bits) used in HMAC'></textarea>
              <b>and message digest sizes 
	      <span class='selectables' data-rindex='1'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>160 bits</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>256 bits</span>
<input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>384 bits</span>
<input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span>512 bits</span>
</span></b> that meet the following: FIPS Pub 198-1 <i>The Keyed-Hash Message
                Authentication Code</i> and FIPS Pub 180-4 <i>Secure Hash Standard</i>. </div>
</div><!-- End: General_Purpose_Operating_System:fcs__cop.1.1_l4_r -->
<div class='aactivity'>

	      <p>

		The evaluator will perform the following activities based on the selections
              in the ST. 
	      </p><p>
	      For each of the supported parameter sets, the
              evaluator will compose 15 sets of test data. Each set shall consist of a key and
              message data. The evaluator will have the OS generate HMAC tags for these sets of
              test data. The resulting MAC tags shall be compared against the result of generating HMAC
              tags with the same key and IV using a known-good implementation. 
	      </p>
	    </div>
</div></span><!-- End: General_Purpose_Operating_System:fcs__cop.1_l4_r -->
<span class='comp-notes'></span><br/><span id='General_Purpose_Operating_System:fcs__dtls__ext.1' class='component fcs__dtls__ext.1 sel-based disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_DTLS_EXT.1 &#8212; DTLS Implementation</a>
<div class='reqgroup'>
<div id='General_Purpose_Operating_System:fcs__dtls__ext.1.1' class='requirement fcs__dtls__ext.1.1'><div class='f-el-title'>FCS_DTLS_EXT.1.1</div><div class='words'>The OS shall implement the DTLS protocol in accordance with 
              <span class='selectables' data-rindex='0'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>DTLS 1.0 (RFC 4347)</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>DTLS 1.2 (RFC 6347)</span>
</span>.
            </div>
</div><!-- End: General_Purpose_Operating_System:fcs__dtls__ext.1.1 -->
<div class='aactivity'>

              
                 
		  The evaluator will attempt to establish a connection with a DTLS server,
                  observe the traffic with a packet analyzer, and verify that the connection
                  succeeds and that the traffic is identified as DTLS.
		
		<br/>
		  Other tests are performed in conjunction with the evaluation activity listed
                for FCS_TLSC_EXT.1. 
            </div><div id='General_Purpose_Operating_System:fcs__dtls__ext.1.2' class='requirement fcs__dtls__ext.1.2'><div class='f-el-title'>FCS_DTLS_EXT.1.2</div><div class='words'>The OS shall implement the requirements in TLS (FCS_TLSC_EXT.1) for the DTLS implementation, except where variations are allowed according to DTLS
              1.2 (RFC 6347). </div>
</div><!-- End: General_Purpose_Operating_System:fcs__dtls__ext.1.2 -->
<div class='aactivity'>
 The evaluator will perform the evaluation activities listed for FCS_TLSC_EXT.1. </div>
</div></span><!-- End: General_Purpose_Operating_System:fcs__dtls__ext.1 -->
<span class='comp-notes'></span><br/><span id='General_Purpose_Operating_System:fcs__rbg__ext.1' class='component fcs__rbg__ext.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_RBG_EXT.1 &#8212; Random Bit Generation</a>
<div class='reqgroup'>
<div id='General_Purpose_Operating_System:fcs__rbg__ext.1.1' class='requirement fcs__rbg__ext.1.1'><div class='f-el-title'>FCS_RBG_EXT.1.1</div><div class='words'> 
              The OS shall perform all deterministic random bit generation (DRBG) services in
              accordance with NIST Special Publication 800-90A using
              <span class='selectables' data-rindex='0'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>Hash_DRBG (any)</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>HMAC_DRBG (any)</span>
<input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>CTR_DRBG (AES)</span>
</span>
	      .
            </div>
</div><!-- End: General_Purpose_Operating_System:fcs__rbg__ext.1.1 -->
<div class='aactivity'>

	      <p>
	      The evaluator will perform the following tests:
	      </p><p>
              The evaluator will perform 15 trials for the RNG implementation. If the RNG
              is configurable, the evaluator will perform 15 trials for each configuration. The
              evaluator will also confirm that the operational guidance contains appropriate
              instructions for configuring the RNG functionality. 
	      </p><p>
	      If the RNG has  prediction resistance enabled, each trial consists of (1) instantiate DRBG, (2)
              generate the first block of random bits (3) generate a second block of random bits
              (4) uninstantiate. The evaluator verifies that the second block of random bits is
              the expected value. The evaluator will generate eight input values for each
              trial. The first is a count (0 – 14). The next three are entropy input, nonce, and
              personalization string for the instantiate operation. The next two are additional
              input and entropy input for the first call to generate. The final two are
              additional input and entropy input for the second call to generate. These values
              are randomly generated. "generate one block of random bits" means to generate
              random bits with number of returned bits equal to the Output Block Length (as
              defined in NIST SP 800-90A). 
	      </p><p>
	      If the RNG does not have prediction resistance,
              each trial consists of (1) instantiate DRBG, (2) generate the first block of
              random bits (3) reseed, (4) generate a second block of random bits (5)
              uninstantiate. The evaluator verifies that the second block of random bits is the
              expected value. The evaluator will generate eight input values for each trial.
              The first is a count (0 – 14). The next three are entropy input, nonce, and
              personalization string for the instantiate operation. The fifth value is
              additional input to the first call to generate. The sixth and seventh are
              additional input and entropy input to the call to reseed. The final value is
              additional input to the second generate call. 
	      </p><p>
	      The following list contains more information on some of the input values to be generated/selected by the evaluator.
	      <ul>
		<li> <b>Entropy input:</b> The length of the entropy input value must equal the seed
                  length.</li>
		  
                  <li><b>Nonce:</b> If a nonce is supported (CTR_DRBG with no Derivation Function does
                  not use a nonce), the nonce bit length is one-half the seed length. </li>
                  <li><b>Personalization string:</b> The length of the personalization string must be
                  less than or equal to seed length. If the implementation only supports one
                  personalization string length, then the same length can be used for both values.
                  If more than one string length is support, the evaluator will use personalization
                  strings of two different lengths. If the implementation does not use a
                  personalization string, no value needs to be supplied. </li>
                  <li><b>Additional input:</b> The additional input bit lengths have the same defaults
                  and restrictions as the personalization string lengths.</li>
		</ul>
	      </p>
            </div><div id='General_Purpose_Operating_System:fcs__rbg__ext.1.2' class='requirement fcs__rbg__ext.1.2'><div class='f-el-title'>FCS_RBG_EXT.1.2</div><div class='words'>
              The deterministic RBG used by the OS shall be seeded by an entropy source that
              accumulates entropy from a
              <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>software-based noise source</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>platform-based noise source</span>
</li>
</ul>
</span>
              with a minimum of
              <span class='selectables' data-rindex='1'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>128 bits</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>256 bits</span>
</span>
              of entropy at least equal to the greatest security strength (according to NIST SP 800-57) 
              of the keys and hashes that it will generate. 
	    </div>
</div><!-- End: General_Purpose_Operating_System:fcs__rbg__ext.1.2 -->
<div class='aactivity'>

	      <p>
		Documentation shall be produced - and the evaluator will perform the
		activities - in accordance with  and
		the 
		<a href='https://www.niap-ccevs.org/Documents_and_Guidance/ccevs/Entropy%20Documentation%20and%20Assessment%20Clarification.pdf'>Clarification to the Entropy Documentation and Assessment Annex</a>.
	      </p><p>
              In the future, specific statistical testing (in line with NIST SP 800-90B) will 
              be required to verify the entropy estimates.
	    </p>
            </div>
</div></span><!-- End: General_Purpose_Operating_System:fcs__rbg__ext.1 -->
<span class='comp-notes'></span><br/><span id='General_Purpose_Operating_System:fcs__sto__ext.1' class='component fcs__sto__ext.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_STO_EXT.1 &#8212; Storage of Sensitive Data</a>
<div class='reqgroup'>
<div id='General_Purpose_Operating_System:fcs__sto__ext.1.1' class='requirement fcs__sto__ext.1.1'><div class='f-el-title'>FCS_STO_EXT.1.1</div><div class='words'>
	      The OS shall implement functionality to encrypt sensitive data 
	      stored in non-volatile storage and provide interfaces to applications to invoke this functionality.
            </div>
</div><!-- End: General_Purpose_Operating_System:fcs__sto__ext.1.1 -->
<div class='aactivity'>

	      <p>
	      The evaluator will check the TSS to ensure that it lists all persistent
              sensitive data for which the OS provides a storage capability.  For each of these
              items, the evaluator will confirm that the TSS lists for what purpose it can be used,
              and how it is stored.  
	      The evaluator will confirm that cryptographic operations used to protect the data occur as specified in fcs_cop.1(1).
	      </p><p>
	      The evaluator will also consult the developer documentation to verify that an interface
	      exists for applications to securely store credentials.
	    </p>
            </div>
</div></span><!-- End: General_Purpose_Operating_System:fcs__sto__ext.1 -->
<span class='comp-notes'></span><br/><span id='General_Purpose_Operating_System:fcs__tlsc__ext.1' class='component fcs__tlsc__ext.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_TLSC_EXT.1 &#8212; TLS Client Protocol</a>
<div class='reqgroup'>
<div id='General_Purpose_Operating_System:fcs__tlsc__ext.1.1' class='requirement fcs__tlsc__ext.1.1'><div class='f-el-title'>FCS_TLSC_EXT.1.1</div><div class='words'> The OS shall implement  1.2
              (RFC 5246) supporting the following cipher suites:
	      <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>TLS_RSA_WITH_AES_128_CBC_SHA as defined in RFC 5246</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>TLS_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>TLS_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span>TLS_RSA_WITH_AES_256_CBC_SHA384 as defined in RFC 5288</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='4' class='val selbox'></input><span>TLS_DHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='5' class='val selbox'></input><span>TLS_DHE_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='6' class='val selbox'></input><span>TLS_DHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5288</span>
</li>
<li><input type='checkbox' id='General_Purpose_Operating_System:ec1' onchange='update(this); ' data-rindex='7' class='val selbox ec1'></input><span>TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</span>
</li>
<li><input type='checkbox' id='General_Purpose_Operating_System:ec2' onchange='update(this); ' data-rindex='8' class='val selbox ec2'></input><span>TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</span>
</li>
<li><input type='checkbox' id='General_Purpose_Operating_System:ec3' onchange='update(this); ' data-rindex='9' class='val selbox ec3'></input><span>TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384 as defined in RFC 5289</span>
</li>
<li><input type='checkbox' id='General_Purpose_Operating_System:ec4' onchange='update(this); ' data-rindex='10' class='val selbox ec4'></input><span>TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5289</span>
</li>
<li><input type='checkbox' id='General_Purpose_Operating_System:ec5' onchange='update(this); ' data-rindex='11' class='val selbox ec5'></input><span>TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</span>
</li>
<li><input type='checkbox' id='General_Purpose_Operating_System:ec6' onchange='update(this); ' data-rindex='12' class='val selbox ec6'></input><span>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</span>
</li>
<li><input type='checkbox' id='General_Purpose_Operating_System:ec7' onchange='update(this); ' data-rindex='13' class='val selbox ec7'></input><span>TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 as defined in RFC 5289</span>
</li>
<li><input type='checkbox' id='General_Purpose_Operating_System:ec8' onchange='update(this); ' data-rindex='14' class='val selbox ec8'></input><span>TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5289</span>
</li>
</ul>
</span>. </div>
</div><!-- End: General_Purpose_Operating_System:fcs__tlsc__ext.1.1 -->
<div class='aactivity'>

              The evaluator will check the description of the implementation of this
              protocol in the TSS to
              ensure that the cipher suites supported are specified. The evaluator will check the
                TSS to ensure that the
              cipher suites specified include those listed for this component. The evaluator will
              also check the operational guidance to ensure that it contains instructions on
              configuring the OS so that
              TLS conforms to the description in the TSS. The evaluator will also perform the following tests: 
              
                 
                  The evaluator will establish a  connection 
                  using each of the cipher suites specified by the
                  requirement. This connection may be established as part of the establishment of a
                  higher-level protocol, e.g., as part of an EAP session. It is sufficient to
                  observe the successful negotiation of a cipher suite to satisfy the intent of the
                  test; it is not necessary to examine the characteristics of the encrypted traffic
                  in an attempt to discern the cipher suite being used (for example, that the
                  cryptographic algorithm is 128-bit AES and not 256-bit AES). 
                
                 
                  The evaluator will attempt to establish the connection using a server with a
                  server certificate that contains the Server Authentication purpose in the
                  <i>extendedKeyUsage</i> field and verify that a connection is established. The evaluator
                  will then verify that the client rejects an otherwise valid server certificate
                  that lacks the Server Authentication purpose in the <i>extendedKeyUsage</i> field and a
                  connection is not established. Ideally, the two certificates should be identical
                  except for the <i>extendedKeyUsage</i> field. 
                
                 
                  The evaluator will send a server certificate in the  connection 
                  that does not match the server-selected cipher suite (for example, send a ECDSA certificate while using the
                  TLS_RSA_WITH_AES_128_CBC_SHA cipher suite or send a RSA certificate while using one
                  of the ECDSA cipher suites.) The evaluator will verify that the OS disconnects after
                  receiving the server's Certificate handshake message. 
                
                 
                  The evaluator will configure the server to select the
                  TLS_NULL_WITH_NULL_NULL cipher suite and verify that the client denies the
                  connection. 
                
                 
                  The evaluator will perform the following modifications to the traffic: 
                  
                     
                      Change the  version
                      selected by the server in the Server Hello to a non-supported  version (for example 1.3
                      represented by the two bytes 03 04) and verify that the client rejects the
                      connection. 
                    
                    
                      Modify at least one byte in the server's nonce in the Server Hello
                      handshake message, and verify that the client rejects the Server Key Exchange
                      handshake message (if using a DHE or ECDHE cipher suite) or that the server
                      denies the client's Finished handshake message. 
                    
                    
                      Modify the server's selected cipher suite in the Server Hello handshake
                      message to be a cipher suite not presented in the Client Hello handshake
                      message. The evaluator will verify that the client rejects the connection
                      after receiving the Server Hello.
                    
                    
If an ECDHE or DHE ciphersuite is selected, 
modify the signature block in the Server's Key Exchange handshake message, 
and verify that the client rejects the connection after receiving the Server Key Exchange message.
                    
                     
                      Modify a byte in the Server Finished handshake message, and verify that
                      the client sends a fatal alert upon receipt and does not send any application
                      data. 
                    
                    
                      Send a garbled message from the Server after the Server has issued the
                      Change Cipher Spec message and verify that the client denies the connection.
                    
                  
                
              
            </div><div id='General_Purpose_Operating_System:fcs__tlsc__ext.1.2' class='requirement fcs__tlsc__ext.1.2'><div class='f-el-title'>FCS_TLSC_EXT.1.2</div><div class='words'> The OS shall verify that the presented identifier matches the reference
              identifier according to RFC 6125. </div>
</div><!-- End: General_Purpose_Operating_System:fcs__tlsc__ext.1.2 -->
<div class='aactivity'>
 
	      <p>
              The evaluator will ensure that the TSS describes the client's method of establishing all reference
              identifiers from the application-configured reference identifier, including which
              types of reference identifiers are supported (e.g. Common Name, DNS Name, URI Name,
              Service Name, or other application-specific Subject Alternative Names) and whether IP
              addresses and wildcards are supported. The evaluator will ensure that this
              description identifies whether and the manner in which certificate pinning is
              supported or used by the OS.
              <br/> The evaluator will verify that the AGD guidance includes instructions for
              setting the reference identifier to be used for the purposes of certificate validation
              in . 
	      </p><p>
	      The evaluator will
              configure the reference identifier according to the AGD guidance and perform the
              following tests during a  connection: 
              
                 The evaluator will present a server certificate that does not contain an
                  identifier in either the Subject Alternative Name (SAN) or Common Name (CN) that
                  matches the reference identifier. The evaluator will verify that the connection
                  fails. 
                
                 
                  The evaluator will present a server certificate that contains a CN that
                  matches the reference identifier, contains the SAN extension, but does not contain
                  an identifier in the SAN that matches the reference identifier. The evaluator
                  shall verify that the connection fails. The evaluator will repeat this test for
                  each supported SAN type. 
                
                 
		  [conditional]
		  If the TOE does not mandate the presence of the SAN extension, 
		  the evaluator will present a server certificate that contains a CN that
                  matches the reference identifier and does not contain the SAN extension. The
                  evaluator will verify that the connection succeeds. 
		  If the TOE mandates the presence of the SAN extension, this test shall be omitted.
                
                 
                  The evaluator will present a server certificate that contains a CN that does
                  not match the reference identifier but does contain an identifier in the SAN that
                  matches. The evaluator will verify that the connection succeeds. 
                
                 
                  The evaluator will perform the following wildcard tests with each supported
                  type of reference identifier: 
                  
                    
                      The evaluator will present a server certificate containing a wildcard
                      that is not in the left-most label of the presented identifier (e.g.
                      foo.*.example.com) and verify that the connection fails. 
                    
                    
                      The evaluator will present a server certificate containing a wildcard in
                      the left-most label but not preceding the public suffix (e.g. *.example.com).
                      The evaluator will configure the reference identifier with a single left-most
                      label (e.g. foo.example.com) and verify that the connection succeeds. The
                      evaluator will configure the reference identifier without a left-most label
                      as in the certificate (e.g. example.com) and verify that the connection fails.
                      The evaluator will configure the reference identifier with two left-most
                      labels (e.g. bar.foo.example.com) and verify that the connection fails. 
                    
                     
                      The evaluator will present a server certificate containing a wildcard in
                      the left-most label immediately preceding the public suffix (e.g. *.com). The
                      evaluator will configure the reference identifier with a single left-most
                      label (e.g. foo.com) and verify that the connection fails. The evaluator will
                      configure the reference identifier with two left-most labels (e.g.
                      bar.foo.com) and verify that the connection fails. 
                    
                  
                
                 
                  [conditional] If URI or Service name reference identifiers are supported, the
                  evaluator will configure the  name and
                  the service identifier. The evaluator will present a server certificate
                  containing the correct  name and
                  service identifier in the URIName or SRVName fields of the SAN and verify that the
                  connection succeeds. The evaluator will repeat this test with the wrong service
                  identifier (but correct  name) and
                  verify that the connection fails. 
                
                
                  [conditional] If pinned certificates are supported the evaluator will
                  present a certificate that does not match the pinned certificate and verify that
                  the connection fails. 
                
              
	    </p>
            </div><div id='General_Purpose_Operating_System:fcs__tlsc__ext.1.3' class='requirement fcs__tlsc__ext.1.3'><div class='f-el-title'>FCS_TLSC_EXT.1.3</div><div class='words'>The OS shall only establish a trusted channel if the peer certificate is valid. </div>
</div><!-- End: General_Purpose_Operating_System:fcs__tlsc__ext.1.3 -->
<div class='aactivity'>
 The evaluator will use  as
              a function to verify that the validation rules in FIA_X509_EXT.1.1
	      are adhered to and shall perform the following additional test: 
                 The evaluator will demonstrate that a peer using a certificate without a
                  valid certification path results in an authenticate failure. Using the
                  administrative guidance, the evaluator will then load the trusted CA
                  certificate(s) needed to validate the peer's certificate, and demonstrate that the
                  connection succeeds. The evaluator then shall delete one of the CA certificates,
                  and show that the connection fails. 
                 The evaluator will demonstrate that a peer using a certificate which has
                  been revoked results in an authentication failure. 
                 The evaluator will demonstrate that a peer using a certificate which has
                  passed its expiration date results in an authentication failure. 
                 the evaluator will demonstrate that a peer using a certificate which does
                  not have a valid identifier shall result in an authentication failure. 
              
            </div>
</div></span><!-- End: General_Purpose_Operating_System:fcs__tlsc__ext.1 -->
<span class='comp-notes'></span><br/><span id='General_Purpose_Operating_System:fcs__tlsc__ext.2' class='component fcs__tlsc__ext.2 sel-based disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_TLSC_EXT.2 &#8212; TLS Client Protocol</a>
<div class='reqgroup'>
<div id='General_Purpose_Operating_System:fcs__tlsc__ext.2.1' class='requirement fcs__tlsc__ext.2.1'><div class='f-el-title'>FCS_TLSC_EXT.2.1</div><div class='words'> The OS shall present the Supported Elliptic Curves Extension in the Client Hello
              with the following NIST curves: <span class='selectables' data-rindex='0'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>secp256r1</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>secp384r1</span>
<input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>secp521r1</span>
</span>. 
	    </div>
</div><!-- End: General_Purpose_Operating_System:fcs__tlsc__ext.2.1 -->
<div class='aactivity'>
 
	      <p>
	      The evaluator will verify that TSS describes the supported Elliptic Curves Extension and
              whether the required behavior is performed by default or may be configured. If the
                TSS indicates that the
              supported Elliptic Curves Extension must be configured to meet the requirement, the
              evaluator will verify that AGD guidance includes configuration of the supported
              Elliptic Curves Extension. 
	      </p><p>
	      The evaluator will also perform the following test: 
              <br/>
	      The evaluator will configure a server to perform ECDHE key exchange using each of the TOE's supported curves and shall verify that the TOE successfully connects to the server.
	    </p>
            </div>
</div></span><!-- End: General_Purpose_Operating_System:fcs__tlsc__ext.2 -->
<span class='comp-notes'></span><br/><span class='tooltipped'><input type='checkbox' onchange='handleOCheck(this); return false;'></input></span>
<span id='General_Purpose_Operating_System:fcs__tlsc__ext.3' class='component fcs__tlsc__ext.3 disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_TLSC_EXT.3 &#8212; TLS Client Protocol</a><span class='tooltiptext'>objective</span>
<div class='reqgroup'>
<div id='General_Purpose_Operating_System:fcs__tlsc__ext.3.1' class='requirement fcs__tlsc__ext.3.1'><div class='f-el-title'>FCS_TLSC_EXT.3.1</div><div class='words'> The OS shall present the signature_algorithms extension in the Client Hello with
              the supported_signature_algorithms value containing the following hash algorithms: <span class='selectables' data-rindex='0'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>SHA256</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>SHA384</span>
<input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>SHA512</span>
</span> and no other hash algorithms. </div>
</div><!-- End: General_Purpose_Operating_System:fcs__tlsc__ext.3.1 -->
<div class='aactivity'>

	      <p>
	      The evaluator will verify that TSS describes the signature_algorithm extension and whether the
              required behavior is performed by default or may be configured. If the TSS indicates that the
              signature_algorithm extension must be configured to meet the requirement, the
              evaluator will verify that AGD guidance includes configuration of the
              signature_algorithm extension. 
	      </p><p>
	      The evaluator will also perform the following test:
              <br/>
                The evaluator will configure the server to send a certificate in the 
		 connection that is not supported
                according to the Client's HashAlgorithm enumeration within the
                signature_algorithms extension (for example, send a certificate with a SHA-1
                signature). The evaluator will verify that the OS disconnects after receiving the server's Certificate
                handshake message.
	      </p>
            </div>
</div></span><!-- End: General_Purpose_Operating_System:fcs__tlsc__ext.3 -->
<span class='comp-notes'></span><br/><span class='tooltipped'><input type='checkbox' onchange='handleOCheck(this); return false;'></input></span>
<span id='General_Purpose_Operating_System:fcs__tlsc__ext.4' class='component fcs__tlsc__ext.4 disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_TLSC_EXT.4 &#8212; TLS Client Protocol</a><span class='tooltiptext'>optional</span>
<div class='reqgroup'>
<div id='General_Purpose_Operating_System:fcs__tlsc__ext.4.1' class='requirement fcs__tlsc__ext.4.1'><div class='f-el-title'>FCS_TLSC_EXT.4.1</div><div class='words'> The OS shall support mutual authentication using X.509v3 certificates. </div>
</div><!-- End: General_Purpose_Operating_System:fcs__tlsc__ext.4.1 -->
<div class='aactivity'>
 
	      <p>
		The evaluator will ensure that the 
		TSS 
		description required per FIA_X509_EXT.2.1 
		includes the use of client-side certificates for TLS
		mutual authentication. 
	      </p><p>
	      The evaluator will verify that the AGD guidance required
              per FIA_X509_EXT.2.1 includes instructions for configuring the
              client-side certificates for  mutual
              authentication. 
	      </p><p>
	      The evaluator will also perform the following test: 

	      
		
The evaluator will establish a connection to a peer server that is not configured for mutual authentication (i.e. does not send Server's Certificate Request (type 13) message).
The evaluator observes negotiation of a TLS channel and confirms that the TOE did not send Client's Certificate message (type 11) during handshake.
		
		
The evaluator will establish a connection to a peer server with a shared trusted root that is configured for mutual authentication (i.e. it sends Server's Certificate Request (type 13) message).
The evaluator observes negotiation of a TLS channel and confirms that the TOE responds with a non-empty Client's Certificate message (type 11) and Certificate Verify (type 15) messages.
		
	      
	      </p>
            </div>
</div></span><!-- End: General_Purpose_Operating_System:fcs__tlsc__ext.4 -->
<span class='comp-notes'></span><br/><span id='General_Purpose_Operating_System:fdp__acf__ext.1' class='component fdp__acf__ext.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FDP_ACF_EXT.1 &#8212; Access Controls for Protecting User Data</a>
<div class='reqgroup'>
<div id='General_Purpose_Operating_System:fdp__acf__ext.1.1' class='requirement fdp__acf__ext.1.1'><div class='f-el-title'>FDP_ACF_EXT.1.1</div><div class='words'>
	      The OS shall implement access controls which can prohibit unprivileged users from
              accessing files and directories owned by other users.
            </div>
</div><!-- End: General_Purpose_Operating_System:fdp__acf__ext.1.1 -->
<div class='aactivity'>

	      <p>
	      The evaluator will confirm that the TSS comprehensively describes the access control policy enforced by the OS.
              The description must include the rules by which accesses to particular files and directories
	      are determined for particular users.
              The evaluator will inspect the TSS to ensure that it describes the access control rules 
              in such detail that given any possible scenario between a user and a file governed by
              the OS the access control decision is unambiguous.
	      </p><p>

              The evaluator will create two new standard user accounts on the system and conduct the following tests:
              
                
                  The evaluator will authenticate to the system as the first user and create a file within that user's home directory. 
		  The evaluator will then log off the system and log in as the second user.
		  The evaluator will then attempt to read the file created in the first user's home directory.
		  The evaluator will ensure that the read attempt is denied.
                
                
                  The evaluator will authenticate to the system as the first user and create a file within that user's home directory. 
		  The evaluator will then log off the system and log in as the second user.
		  The evaluator will then attempt to modify the file created in the first user's home directory.
		  The evaluator will ensure that the modification is denied.
                
                
                  The evaluator will authenticate to the system as the first user and create a file within that user's user directory. 
		  The evaluator will then log off the system and log in as the second user.
		  The evaluator will then attempt to delete the file created in the first user's home directory.
		  The evaluator will ensure that the deletion is denied.
                
                
                  The evaluator will authenticate to the system as the first user.
		  The evaluator will attempt to create a file in the second user's home directory.
                  The evaluator will ensure that the creation of the file is denied.
                       
                
                  The evaluator will authenticate to the system as the first user and attempt to modify the file created in the first user's home directory.
                  The evaluator will ensure that the modification of the file is accepted.
                       
                
                  The evaluator will authenticate to the system as the first user and attempt to delete the file created in the first user's directory.
                  The evaluator will ensure that the deletion of the file is accepted.
                
              
	    </p>
            </div>
</div></span><!-- End: General_Purpose_Operating_System:fdp__acf__ext.1 -->
<span class='comp-notes'></span><br/><span class='tooltipped'><input type='checkbox' onchange='handleOCheck(this); return false;'></input></span>
<span id='General_Purpose_Operating_System:fdp__ifc__ext.1' class='component fdp__ifc__ext.1 disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FDP_IFC_EXT.1 &#8212; Information flow control</a><span class='tooltiptext'>optional</span>
<div class='reqgroup'>
<div id='General_Purpose_Operating_System:fdp__ifc__ext.1.1' class='requirement fdp__ifc__ext.1.1'><div class='f-el-title'>FDP_IFC_EXT.1.1</div><div class='words'> The OS shall
	    <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>provide an interface which allows a VPN client to protect all IP traffic using IPsec</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>provide a VPN client which can protects all IP traffic using IPsec</span>
</li>
</ul>
</span>
	    with the exception of IP traffic required to establish the VPN connection
	    and
	    <span class='selectables' data-rindex='1'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>signed updates directly from the OS vendor</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox exclusive'></input><span>no other traffic</span>
</li>
</ul>
</span>
	    .
            </div>
</div><!-- End: General_Purpose_Operating_System:fdp__ifc__ext.1.1 -->
<div class='aactivity'>
 The evaluator will verify that the TSS section of the ST describes the
              routing of IP traffic when a VPN client is enabled. The
              evaluator will ensure that the description indicates which traffic does not go
              through the VPN and which traffic does, and that a configuration exists for each
              in which only the traffic identified by the ST author as necessary
              for establishing the VPN connection (IKE traffic and perhaps HTTPS or DNS traffic) is
              not encapsulated by the VPN protocol (IPsec).
	      
	      The evaluator will perform the following test:
	      
		The evaluator will enable a network connection. 
		  The evaluator will sniff packets while performing running applications that use the network such as web browsers and email clients.
		  The evaluator will verify that the sniffer captures the traffic generated by these actions, turn off the sniffing tool, and save the session data. 
		  
		  
                  The evaluator will configure an IPsec VPN client that supports the routing specified in this requirement.
		  The evaluator will turn on the sniffing tool, establish the VPN connection, and perform the same actions with the device as performed in the first step.
		  The evaluator will verify that the sniffing tool captures traffic generated by these actions, turn off the sniffing tool, and save the session data.
                  
                  
		  The evaluator will examine the traffic from both step one and step two to verify that all non-excepted Data Plane traffic in Step 2 is encapsulated by IPsec.
		  The evaluator will examine the Security Parameter Index (SPI) value present in the encapsulated packets captured in Step 2 from the TOE to the Gateway and shall verify this value is the same for all actions used to generate traffic through the VPN. 
		  Note that it is expected that the SPI value for packets from the Gateway to the TOE is different than the SPI value for packets from the TOE to the Gateway.
		  
		  
                  The evaluator will perform a ping on the TOE host on the local network and verify that no packets sent are captured with the sniffer. 
		  The evaluator will attempt to send packets to the TOE outside the VPN tunnel (i.e. not through the VPN gateway), including from the local network, and verify that the TOE discards them. 
		  
	      
	    </div>
</div></span><!-- End: General_Purpose_Operating_System:fdp__ifc__ext.1 -->
<span class='comp-notes'></span><br/><span id='General_Purpose_Operating_System:fmt__mof__ext.1' class='component fmt__mof__ext.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FMT_MOF_EXT.1 &#8212; Management of security functions behavior</a>
<div class='reqgroup'>
<div id='General_Purpose_Operating_System:fmt__mof__ext.1.1' class='requirement fmt__mof__ext.1.1'><div class='f-el-title'>FMT_MOF_EXT.1.1</div><div class='words'> 
	      The OS shall restrict the ability to perform the function indicated in the "Administrator" column in fmt_smf_ext.1.1 to the administrator.
	    </div>
</div><!-- End: General_Purpose_Operating_System:fmt__mof__ext.1.1 -->
<div class='aactivity'>

	      <p>
          The evaluator will verify that the TSS describes those management functions
          that are restricted to Administrators, including how the user is prevented
          from performing those functions, or not able to use any interfaces that
          allow access to that function.
  	      For each function that is indicated as restricted to the administrator,
            the evaluation shall perform the function as an administrator, as specified in the
            Operational Guidance, and determine that it has the expected effect as outlined by
            the Operational Guidance and the SFR.  The evaluator will then perform the function
            (or otherwise attempt to access the function) as a non-administrator and observe
            that they are unable to invoke that functionality.
        
	      </p>
            </div>
</div></span><!-- End: General_Purpose_Operating_System:fmt__mof__ext.1 -->
<span class='comp-notes'></span><br/><span id='General_Purpose_Operating_System:fmt__smf__ext.1' class='component fmt__smf__ext.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FMT_SMF_EXT.1 &#8212; Specification of Management Functions</a>
<div class='reqgroup'>
<div id='General_Purpose_Operating_System:fmt__smf__ext.1.1' class='requirement fmt__smf__ext.1.1'><div class='f-el-title'>FMT_SMF_EXT.1.1</div><div class='words'> 
	      The OS shall be capable of performing the following management functions:
	      <br/>
	      <table class='mfun-table'>
<tr><th>Management Function</th><th>Administrator</th><th>User</th></tr>
<tr>
<td>Enable/disable <span class='selectables' data-rindex='0'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>screen lock</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>session timeout</span>
</span></td><td>X</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>Configure <span class='selectables' data-rindex='1'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>screen lock</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>session</span>
</span> inactivity timeout</td><td>X</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>Configure local audit storage capacity</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>Configure minimum password length</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>Configure minimum number of special characters in password</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>Configure minimum number of numeric characters in password</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>Configure minimum number of uppercase characters in password</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>Configure minimum number of lowercase characters in password</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
Configure lockout policy for unsuccessful authentication attempts through
                  <span class='selectables' data-rindex='2'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>timeouts between attempts</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>limiting number of attempts during a time period</span>
</li>
</ul>
</span>
		</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>Configure host-based firewall</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>Configure name/address of directory server with which to bind</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>Configure name/address of remote management server from which to receive management settings</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>Configure name/address of audit/logging server to which to send audit/logging records</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>Configure audit rules</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>Configure name/address of network time server</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>Enable/disable automatic software update</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>Configure WiFi interface</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>Enable/disable Bluetooth interface</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>Enable/disable <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='list of other external interfaces'></textarea></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td><textarea onchange='update(this);' class='assignment val' rows='1' placeholder='list of other management functions to be provided by the TSF'></textarea></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
</table>

	      .
	    </div>
</div><!-- End: General_Purpose_Operating_System:fmt__smf__ext.1.1 -->
<div class='aactivity'>

The evaluator will verify that every management function captured in the ST is described in the operational guidance and that the description contains the information required to perform the management duties associated with the management function.
The evaluator will test the OS's ability to provide the management functions by configuring the operating system and testing each option selected from above.
The evaluator is expected to test these functions in all the ways in which the ST and guidance documentation state the configuration can be managed.
	    </div>
</div></span><!-- End: General_Purpose_Operating_System:fmt__smf__ext.1 -->
<span class='comp-notes'></span><br/><span id='General_Purpose_Operating_System:fpt__acf__ext.1' class='component fpt__acf__ext.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FPT_ACF_EXT.1 &#8212; Access controls</a>
<div class='reqgroup'>
<div id='General_Purpose_Operating_System:fpt__acf__ext.1.1' class='requirement fpt__acf__ext.1.1'><div class='f-el-title'>FPT_ACF_EXT.1.1</div><div class='words'> The OS shall implement access controls which prohibit unprivileged users from
              modifying: <ul>
                <li>Kernel and its drivers/modules</li>
                <li>Security audit logs</li>
                <li>Shared libraries</li>
                <li>System executables</li>
                <li>System configuration files</li>
                <li><textarea onchange='update(this);' class='assignment val' rows='1' placeholder='other objects'></textarea></li>
              </ul>
	      .
            </div>
</div><!-- End: General_Purpose_Operating_System:fpt__acf__ext.1.1 -->
<div class='aactivity'>
 
	      The evaluator will confirm that the TSS specifies the locations of kernel drivers/modules, security
	      audit logs, shared libraries, system executables, and system configuration files.  Every
		  file does not need to be individually identified, but the system's conventions for storing and protecting
		  such files must be specified.
	      The evaluator will create an unprivileged user account. 
	      Using this account, the evaluator will ensure that the following tests result in a negative
              outcome (i.e., the action results in the OS denying the evaluator permission to
              complete the action): 
              
                The evaluator will attempt to modify all kernel drivers and modules.
                The evaluator will attempt to modify all security audit logs generated by the logging subsystem.
                The evaluator will attempt to modify all shared libraries that are used throughout the system.
                The evaluator will attempt to modify all system executables.
                The evaluator will attempt to modify all system configuration files.
                The evaluator will attempt to modify any additional components selected.
              
            </div><div id='General_Purpose_Operating_System:fpt__acf__ext.1.2' class='requirement fpt__acf__ext.1.2'><div class='f-el-title'>FPT_ACF_EXT.1.2</div><div class='words'> The OS shall implement access controls which prohibit unprivileged users from
              reading: <ul>
                <li>Security audit logs</li>
                <li>System-wide credential repositories</li>
                <li><textarea onchange='update(this);' class='assignment val' rows='1' placeholder='list of other objects'></textarea></li>
              </ul>
	      .
            </div>
</div><!-- End: General_Purpose_Operating_System:fpt__acf__ext.1.2 -->
<div class='aactivity'>

	      The evaluator will create an unprivileged user account. 
	      Using this account, the evaluator will ensure that the following tests result in a negative
              outcome (i.e., the action results in the OS denying the evaluator permission to
              complete the action): 
              
                The evaluator will attempt to read security audit logs generated by the auditing subsystem
                The evaluator will attempt to read system-wide credential repositories
                The evaluator will attempt to read any other object specified in the assignment
              
            </div>
</div></span><!-- End: General_Purpose_Operating_System:fpt__acf__ext.1 -->
<span class='comp-notes'></span><br/><span id='General_Purpose_Operating_System:fpt__aslr__ext.1' class='component fpt__aslr__ext.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FPT_ASLR_EXT.1 &#8212; Address Space Layout Randomization</a>
<div class='reqgroup'>
<div id='General_Purpose_Operating_System:fpt__aslr__ext.1.1' class='requirement fpt__aslr__ext.1.1'><div class='f-el-title'>FPT_ASLR_EXT.1.1</div><div class='words'>The OS shall always randomize process address space memory locations with 
	    <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>8</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span><textarea onchange='update(this);' class='assignment val' rows='1' placeholder='number greater than 8'></textarea></span>
</li>
</ul>
</span>
	    bits of entropy except for
                <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='list of explicit exceptions'></textarea>.
            </div>
</div><!-- End: General_Purpose_Operating_System:fpt__aslr__ext.1.1 -->
<div class='aactivity'>


The evaluator will select 3 executables included with the TSF. 
If the TSF includes a web browser it must be selected.
If the TSF includes a mail client it must be selected.
For each of these apps, the evaluator will launch the same executables on two separate instances of the 
OS on identical hardware and compare all memory mapping locations.
The evaluator will ensure that no memory mappings are placed in the same location.
If the rare chance occurs that two mappings are the same for a single executable and
not the same for the other two, the evaluator will repeat the test with that executable to verify
that in the second test the mappings are different.
This test can also be completed on the same hardware and rebooting between application launches. 

	    </div>
</div></span><!-- End: General_Purpose_Operating_System:fpt__aslr__ext.1 -->
<span class='comp-notes'></span><br/><span id='General_Purpose_Operating_System:fpt__sbop__ext.1' class='component fpt__sbop__ext.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FPT_SBOP_EXT.1 &#8212; Stack Buffer Overflow Protection</a>
<div class='reqgroup'>
<div id='General_Purpose_Operating_System:fpt__sbop__ext.1.1' class='requirement fpt__sbop__ext.1.1'><div class='f-el-title'>FPT_SBOP_EXT.1.1</div><div class='words'>
The OS shall <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>employ stack-based buffer overflow protections</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>not store parameters/variables in the same data structures as control flow values</span>
</li>
</ul>
</span>.
</div>
</div><!-- End: General_Purpose_Operating_System:fpt__sbop__ext.1.1 -->
<div class='aactivity'>

<p>For stack-based OSes, the evaluator will determine that the TSS contains a description of stack-based buffer overflow protections used by the OS.
These are referred to by a variety of terms, such as stack cookie, stack guard, and stack canaries.
The TSS must include a rationale for any binaries that are not protected in this manner.
The evaluator will also preform the following test:
            
                
                  The evaluator will inventory the kernel, libraries, and application binaries
                  to determine those that do not implement stack-based buffer overflow protections. This list should
                  match up with the list provided in the TSS.
                
            
</p>

<p>For OSes that store parameters/variables separately from control flow values, the evaluator will verify that the TSS describes what data structures control values, parameters, and variables are stored.
The evaluator will also ensure that the TSS includes a description of the safeguards that ensure parameters and variables do not intermix with control flow values.
</p>
            </div>
</div></span><!-- End: General_Purpose_Operating_System:fpt__sbop__ext.1 -->
<span class='comp-notes'></span><br/><span class='tooltipped'><input type='checkbox' onchange='handleOCheck(this); return false;'></input></span>
<span id='General_Purpose_Operating_System:fpt__srp__ext.1' class='component fpt__srp__ext.1 disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FPT_SRP_EXT.1 &#8212; Software Restriction Policies</a><span class='tooltiptext'>objective</span>
<div class='reqgroup'>
<div id='General_Purpose_Operating_System:fpt__srp__ext.1.1' class='requirement fpt__srp__ext.1.1'><div class='f-el-title'>FPT_SRP_EXT.1.1</div><div class='words'> The OS shall restrict execution to only programs which match an administrator-specified
              <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>file path</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>file digital signature</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>version</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span>hash</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='4' class='val selbox'></input><span><textarea onchange='update(this);' class='assignment val' rows='1' placeholder='other characteristics'></textarea></span>
</li>
</ul>
</span>
	      .
            </div>
</div><!-- End: General_Purpose_Operating_System:fpt__srp__ext.1.1 -->
<div class='aactivity'>
For each selection specified in the ST, the evaluator will ensure that the corresponding tests result in a negative
              outcome (i.e., the action results in the OS denying the evaluator permission to
              complete the action): 
              
                
                  The evaluator will configure the OS to only allow code execution from the core
                  OS directories. The evaluator will then attempt to execute code from a directory
                  that is in the allowed list. The evaluator will ensure that the code they
                  attempted to execute has been executed.
                                
                
                  The evaluator will configure the OS to only allow code execution from the core
                  OS directories. The evaluator will then attempt to execute code from a directory
                  that is not in the allowed list. The evaluator will ensure that the code they
                  attempted to execute has not been executed.
                
                
                  The evaluator will configure the OS to only allow code that has been signed by
                  the OS vendor to execute. The evaluator will then attempt to execute code signed
                  by the OS vendor. The evaluator will ensure that the code they
                  attempted to execute has been executed.
                                
                
                  The evaluator will configure the OS to only allow code that has been signed by
                  the OS vendor to execute. The evaluator will then attempt to execute code signed
                  by another digital authority. The evaluator will ensure that the code they
                  attempted to execute has not been executed.
                
                
                  The evaluator will configure the OS to allow execution of a specific
                  application based on version. The evaluator will then attempt to execute the same
                  version of the application. The evaluator will ensure that the code they attempted
                  to execute has been executed.
                                
                
                  The evaluator will configure the OS to allow execution of a specific
                  application based on version. The evaluator will then attempt to execute an older
                  version of the application. The evaluator will ensure that the code they attempted
                  to execute has not been executed.
                
                
                  The evaluator will configure the OS to allow execution based on the hash of the application
                  executable. The evaluator will then attempt to execute 
                  the application with the matching hash. The evaluator will
                  ensure that the code they attempted to execute has been executed.
                
                
                  The evaluator will configure the OS to allow execution based on the hash of the application
                  executable. The evaluator will modify the
                  application in such a way that the application hash is changed. The evaluator 
                  will then attempt to execute the application with the matching hash. The evaluator will
                  ensure that the code they attempted to execute has not been executed.
                
              
              
            </div>
</div></span><!-- End: General_Purpose_Operating_System:fpt__srp__ext.1 -->
<span class='comp-notes'></span><br/><span id='General_Purpose_Operating_System:fpt__tst__ext.1' class='component fpt__tst__ext.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FPT_TST_EXT.1 &#8212; Boot Integrity</a>
<div class='reqgroup'>
<div id='General_Purpose_Operating_System:fpt__tst__ext.1.1' class='requirement fpt__tst__ext.1.1'><div class='f-el-title'>FPT_TST_EXT.1.1</div><div class='words'>The OS shall verify the integrity of the bootchain up through the OS kernel and 
              <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>all executable code stored in mutable media</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span><textarea onchange='update(this);' class='assignment val' rows='1' placeholder='list of other executable code'></textarea></span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox exclusive'></input><span>no other executable code</span>
</li>
</ul>
</span> 
	      prior to its execution through the use of
              <span class='selectables' data-rindex='1'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>a digital signature using a hardware-protected asymmetric key</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>a hardware-protected hash</span>
</li>
</ul>
</span>
	      .
            </div>
</div><!-- End: General_Purpose_Operating_System:fpt__tst__ext.1.1 -->
<div class='aactivity'>

	      <p>
              The evaluator will verify that the TSS section of the ST includes a comprehensive description of the boot
              procedures, including a description of the entire bootchain, for the TSF. 
              The evaluator will ensure that the OS cryptographically verifies each
	      piece of software it loads in the bootchain to include bootloaders and the kernel.
	      Software loaded for execution directly by the platform (e.g. first-stage bootloaders) is out of scope.
	      For each additional category of executable code verified before
              execution, the evaluator will verify that the description in the TSS describes how that
              software is cryptographically verified.
	      </p>
	      <p>
              
              The evaluator will verify that the TSS contains a description of the
              protection afforded to the mechanism performing the cryptographic verification.
	      </p>
	      <p>
              The evaluator will perform the following tests:
              
                
                  The evaluator will perform actions to cause TSF software to load and observe that the
                  integrity mechanism does not flag any executables as containing integrity errors and that the
                  OS properly boots.
                
                
                  The evaluator will modify a TSF executable that is part of the bootchain verified by the TSF (i.e. Not the first-stage bootloader) 
		  and attempt to boot.
		  The evaluator will ensure that an integrity violation is triggered and the OS does not boot 
		  (Care must be taken so that the integrity
                  violation is determined to be the cause of the failure to load the module, and not the fact that
                  in such a way to invalidate the structure of the module.).
                
                
                  If the ST author indicates that the integrity verification is performed
                  using a public key, the evaluator will verify that the update mechanism includes a certificate
                  validation according to FIA_X509_EXT.1.
                
              
	      </p>
             </div>
</div></span><!-- End: General_Purpose_Operating_System:fpt__tst__ext.1 -->
<span class='comp-notes'></span><br/><span id='General_Purpose_Operating_System:fpt__tud__ext.1' class='component fpt__tud__ext.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FPT_TUD_EXT.1 &#8212; Trusted Update</a>
<div class='reqgroup'>
<div id='General_Purpose_Operating_System:fpt__tud__ext.1.1' class='requirement fpt__tud__ext.1.1'><div class='f-el-title'>FPT_TUD_EXT.1.1</div><div class='words'>The OS shall provide the ability to check for updates to the OS
              software itself. </div>
</div><!-- End: General_Purpose_Operating_System:fpt__tud__ext.1.1 -->
<div class='aactivity'>
 
              The evaluator will check for an update using procedures described in the 
              documentation and verify that the OS provides a list of available updates. 
			  Testing this capability may require
			  installing and temporarily placing the system into a
			  configuration in conflict with secure configuration guidance
			  which specifies automatic update.
			  (The evaluator is also to ensure that this query occurs over a
			  trusted channel as described in ftp_itc_ext.1.)  
            </div><div id='General_Purpose_Operating_System:fpt__tud__ext.1.2' class='requirement fpt__tud__ext.1.2'><div class='f-el-title'>FPT_TUD_EXT.1.2</div><div class='words'>
              The OS shall cryptographically verify updates to itself using a digital
              signature prior to installation using schemes specified in FCS_COP.1(3).
	    </div>
</div><!-- End: General_Purpose_Operating_System:fpt__tud__ext.1.2 -->
<div class='aactivity'>
 
                  For the following tests, the evaluator will initiate the download of an update and 
				  capture the update prior to installation.  
				  The download could originate from the vendor's website, an enterprise-hosted 
				  update repository, or another system (e.g. network peer).  
				  All supported origins
				  for the update must be indicated in the TSS and evaluated.
              
                
				  The evaluator will ensure that the update has a digital
				  signature belonging to the vendor prior to its installation.
				  The evaluator will modify the downloaded update in such a way
				  that the digital signature is no longer valid. The evaluator
				  will then attempt to install the modified update. The
				  evaluator will ensure that the OS does not install the
				  modified update.
                
                
				  The evaluator will ensure that the update has a digital
				  signature belonging to the vendor. The evaluator will then
				  attempt to install the update (or permit installation to continue). 
				  The evaluator will ensure that
				  the OS successfully installs the update.
                                
              
            </div>
</div></span><!-- End: General_Purpose_Operating_System:fpt__tud__ext.1 -->
<span class='comp-notes'></span><br/><span id='General_Purpose_Operating_System:fpt__tud__ext.2' class='component fpt__tud__ext.2'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FPT_TUD_EXT.2 &#8212; Trusted Update for Application Software</a>
<div class='reqgroup'>
<div id='General_Purpose_Operating_System:fpt__tud__ext.2.1' class='requirement fpt__tud__ext.2.1'><div class='f-el-title'>FPT_TUD_EXT.2.1</div><div class='words'>
	      The OS shall provide the ability to check for updates to 
              application software.
	    </div>
</div><!-- End: General_Purpose_Operating_System:fpt__tud__ext.2.1 -->
<div class='aactivity'>
The evaluator will check for updates to application software
			  using procedures described in the
			  documentation and verify that the OS provides a list of available
			  updates.  Testing this capability may require 
			  temporarily placing the system into a configuration in conflict
			  with secure configuration guidance which specifies automatic
			  update.  (The evaluator is also to ensure that this query occurs
			  over a trusted channel as described in ftp_itc_ext.1.)  
            </div><div id='General_Purpose_Operating_System:fpt__tud__ext.2.2' class='requirement fpt__tud__ext.2.2'><div class='f-el-title'>FPT_TUD_EXT.2.2</div><div class='words'>
	      The OS shall cryptographically verify the integrity of updates 
	      to applications using a digital signature specified by 
	      FCS_COP.1(3) prior to installation.
	    </div>
</div><!-- End: General_Purpose_Operating_System:fpt__tud__ext.2.2 -->
<div class='aactivity'>

                  The evaluator will initiate an update to an application.  This may vary depending on the application,
		          but it could be through the application vendor's website, a commercial app store, or another system.
				  All origins supported by the OS must be indicated in the TSS and evaluated.  However, this only includes
				  those mechanisms for which the OS is providing a trusted installation and update functionality.  
				  It does not include user or administrator-driven download and installation of arbitrary files.
              
                
				  The evaluator will ensure that the update has a digital
				  signature which chains to the OS vendor or another trusted
				  root managed through the OS.  The evaluator will modify the
				  downloaded update in such a way that the
                  digital signature is no longer valid. The evaluator will then attempt to install the
                  modified update. The evaluator will ensure that the OS does not install the modified
                  update.
                
                
				  The evaluator will ensure that the update has a digital
				  signature belonging to the OS vendor or another trusted root
				  managed through the OS. The evaluator will then attempt to
				  install the update.  The evaluator will ensure that the OS
				  successfully installs the update.
                                
              
            </div>
</div></span><!-- End: General_Purpose_Operating_System:fpt__tud__ext.2 -->
<span class='comp-notes'></span><br/><span class='tooltipped'><input type='checkbox' onchange='handleOCheck(this); return false;'></input></span>
<span id='General_Purpose_Operating_System:fpt__w_cx__ext.1' class='component fpt__w_cx__ext.1 disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FPT_W^X_EXT.1 &#8212; Write XOR Execute Memory Pages</a><span class='tooltiptext'>objective</span>
<div class='reqgroup'>
<div id='General_Purpose_Operating_System:fpt__w_cx__ext.1.1' class='requirement fpt__w_cx__ext.1.1'><div class='f-el-title'>FPT_W^X_EXT.1.1</div><div class='words'> The OS shall prevent allocation of any memory region with both write and 
              execute permissions except for <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='list of exceptions'></textarea>.
            </div>
</div><!-- End: General_Purpose_Operating_System:fpt__w_cx__ext.1.1 -->
<div class='aactivity'>
 
              The evaluator will inspect the vendor-provided developer documentation and 
	      verify that no memory-mapping can be made with
              write and execute permissions except for the cases listed in the assignment.
	      
		
                  The evaluator will acquire or construct a test program which attempts 
		  to allocate memory that is both writable and executable.  
		  The evaluator will run the program and confirm that it fails to
		  allocate memory that is both writable and executable.
		
		
                  The evaluator will acquire or construct a test program which 
		  allocates memory that is executable and then
		  subsequently requests additional write/modify permissions on that memory.
		  The evaluator will run the program and confirm that at no time
		  during the lifetime of the process is the memory both writable and executable.
		
		
                  The evaluator will acquire or construct a test program which 
		  allocates memory that is writable and then
		  subsequently requests additional execute permissions on that memory.
		  The evaluator will run the program and confirm that at no time
		  during the lifetime of the process is the memory both writable and executable.
		
	      
            </div>
</div></span><!-- End: General_Purpose_Operating_System:fpt__w_cx__ext.1 -->
<span class='comp-notes'></span><br/><span id='General_Purpose_Operating_System:fau__gen.1' class='component fau__gen.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FAU_GEN.1 &#8212; Audit Data Generation (Refined)</a>
<div class='reqgroup'>
<div id='General_Purpose_Operating_System:fau__gen.1.1' class='requirement fau__gen.1.1'><div class='f-el-title'>FAU_GEN.1.1</div><div class='words'> 
The <b>OS</b> shall be able to generate an audit record of the following auditable
              events: 
              <ol type='a'>
                <li>Start-up and shut-down of the audit functions;</li>
                <li>All auditable events for the <b>not specified</b> level of audit; and</li>
                <li><b>
		  <ul><li>Authentication events (Success/Failure);</li>
                  <li>Use of privileged/special rights events (Successful and unsuccessful security, audit, and configuration changes);</li>
                  <li>Privilege or role escalation events (Success/Failure);</li>
		  <li><span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>File and object events (Successful and unsuccessful attempts to create, access, delete, modify, modify permissions)</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>User and Group management events (Successful and unsuccessful add, delete, modify, disable, enable, and credential change)</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>Audit and log data access events (Success/Failure)</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span>Cryptographic verification of software (Success/Failure)</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='4' class='val selbox'></input><span>Attempted application invocation with arguments (Success/Failure e.g. due to software restriction policy)</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='5' class='val selbox'></input><span>System reboot, restart, and shutdown events (Success/Failure)</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='6' class='val selbox'></input><span>Kernel module loading and unloading events (Success/Failure)</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='7' class='val selbox'></input><span>Administrator or root-level access events (Success/Failure)</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='8' class='val selbox'></input><span><textarea onchange='update(this);' class='assignment val' rows='1' placeholder='other specifically defined auditable events'></textarea>.</span>
</li>
</ul>
</span>
		  </li>
		  </ul>
		</b>
		</li>
	      </ol>
	      .
            </div>
</div><!-- End: General_Purpose_Operating_System:fau__gen.1.1 -->
<div class='aactivity'>

	      <p>
			  The evaluator will check the administrative guide and ensure
			  that it lists all of the auditable events.  The evaluator will
			  check to make sure that every audit event type selected in the ST
			  is included.
	      </p>
	      <p>
			  The evaluator will test the OS's ability to correctly generate
			  audit records by having the TOE generate audit records for the
			  events listed in the ST.  This should include all instance types
			  of an event specified.  
			  When verifying the test results, the evaluator will ensure the
			  audit records generated during testing match the format specified
			  in the administrative guide, and that the fields in each audit
			  record have the proper entries.
	      </p>
           </div><div id='General_Purpose_Operating_System:fau__gen.1.2' class='requirement fau__gen.1.2'><div class='f-el-title'>FAU_GEN.1.2</div><div class='words'> The <b>OS</b> shall record within each audit record at least the following information: 
	    <ol type='a'>
	      <li>Date and time of the event, type of event, subject identity (if applicable),
	      and outcome (success or failure) of the event; and </li>
	      <li>For each audit event type, based on the auditable event
              definitions of the functional components included in the PP/ST,
              <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='other audit relevant information'></textarea>
	      </li>
	    </ol>
	    .
            </div>
</div><!-- End: General_Purpose_Operating_System:fau__gen.1.2 -->
<div class='aactivity'>

	      <p>
			  The evaluator will check the administrative guide and ensure
			  that it provides a format
			  for audit records. Each audit record format type must be covered,
			  along with a brief description of each field. The evaluator will
			  ensure that the fields contains the information required. 
	      </p>
	      <p>
			  The evaluator shall test the OS's ability to correctly generate
			  audit records by having the TOE generate audit records for the
			  events listed in the ST.
			  The evaluator will
			  ensure the audit records generated during testing match the
			  format specified in the administrative guide, and that the fields
			  in each audit record provide the required information.
	      </p>
           </div>
</div></span><!-- End: General_Purpose_Operating_System:fau__gen.1 -->
<span class='comp-notes'></span><br/><span id='General_Purpose_Operating_System:fia__afl.1' class='component fia__afl.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FIA_AFL.1 &#8212; Authentication failure handling (Refined)</a>
<div class='reqgroup'>
<div id='General_Purpose_Operating_System:fia__afl.1.1' class='requirement fia__afl.1.1'><div class='f-el-title'>FIA_AFL.1.1</div><div class='words'>
            The <b>OS</b> shall detect when 
            <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span><textarea onchange='update(this);' class='assignment val' rows='1' placeholder='positive integer number'></textarea></span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>an administrator configurable positive integer within <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='range of acceptable values'></textarea></span>
</li>
</ul>
</span>
            unsuccessful authentication attempts occur related to
	    <b>
	      events with
            <span class='selectables' data-rindex='1'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>authentication based on user name and password</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>authentication based on user name and a PIN that
	      releases an asymmetric key stored in OE-protected storage</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>authentication based on X.509 certificates</span>
</li>
</ul>
</span>
	    </b>.
	    </div>
</div><!-- End: General_Purpose_Operating_System:fia__afl.1.1 -->
<div class='aactivity'>

		  The evaluator will set an administrator-configurable threshold for
		  failed attempts, or note the ST-specified assignment.  The evaluator
		  will then (per selection) repeatedly attempt to authenticate with an
		  incorrect password, PIN, or certificate until the number of attempts
		  reaches the threshold.  Note that the authentication attempts and
		  lockouts must also be logged as specified in 
		  fau_gen.1.

	    </div><div id='General_Purpose_Operating_System:fia__afl.1.2' class='requirement fia__afl.1.2'><div class='f-el-title'>FIA_AFL.1.2</div><div class='words'> 
	      When the defined number of unsuccessful authentication attempts for an 
	      account has been <b>met</b>, the <b>OS</b> shall:
	      <b>
	      <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>Account Lockout</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>Account Disablement</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>Mandatory Credential Reset</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span><textarea onchange='update(this);' class='assignment val' rows='1' placeholder='list of actions'></textarea></span>
</li>
</ul>
</span>
	      </b>.
            </div>
</div><!-- End: General_Purpose_Operating_System:fia__afl.1.2 -->
<div class='aactivity'>
 
              
                
                  The evaluator will attempt to authenticate repeatedly to the system with a
                  known bad password. Once the defined number of failed authentication attempts has been
                  reached the evaluator will ensure that the account that was being used for testing
                  has had the actions detailed in the assignment list above applied to it. The evaluator will ensure that 
                  an event has been logged to the security event log detailing that the account has had these actions applied. 
                
                
                  The evaluator will attempt to authenticate repeatedly to the system with a
                  known bad certificate. Once the defined number of failed authentication attempts has been
                  reached the evaluator will ensure that the account that was being used for testing
                  has had the actions detailed in the assignment list above applied to it. The evaluator will ensure that 
                  an event has been logged to the security event log detailing that the account has had these actions applied. 
                
                
                  The evaluator will attempt to authenticate repeatedly to the system using both a bad password and a bad certificate. 
                  Once the defined number of failed authentication attempts has been
                  reached the evaluator will ensure that the account that was being used for testing
                  has had the actions detailed in the assignment list above applied to it. The evaluator will ensure that 
                  an event has been logged to the security event log detailing that the account has had these actions applied. 
                
              
            </div>
</div></span><!-- End: General_Purpose_Operating_System:fia__afl.1 -->
<span class='comp-notes'></span><br/><span id='General_Purpose_Operating_System:fia__uau.5' class='component fia__uau.5'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FIA_UAU.5 &#8212; Multiple Authentication Mechanisms (Refined)</a>
<div class='reqgroup'>
<div id='General_Purpose_Operating_System:fia__uau.5.1' class='requirement fia__uau.5.1'><div class='f-el-title'>FIA_UAU.5.1</div><div class='words'>
The <b>OS</b> shall provide the following authentication mechanisms
<b><span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>authentication based on user name and password</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>authentication based on user name and a PIN that releases an asymmetric key stored 
  in OE-protected storage</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>authentication based on X.509 certificates</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span>for use in SSH only, SSH public key-based authentication as specified by the EP for Secure Shell</span>
</li>
</ul>
</span>
</b>
to support user authentication.
            </div>
</div><!-- End: General_Purpose_Operating_System:fia__uau.5.1 -->
<div class='aactivity'>

              If user name and password authentication is selected, the evaluator will configure the OS with a 
			  known user name and password and conduct the following tests:
              
                
				  The evaluator will attempt to authenticate to the OS using
				  the known user name and password. The evaluator will ensure
				  that the authentication attempt is successful.
                
                
				  The evaluator will attempt to authenticate to the OS using
				  the known user name but an incorrect password. The evaluator
				  will ensure that the authentication attempt is unsuccessful.
                
              
			  If user name and PIN that releases an asymmetric key is selected,
			  the evaluator will examine the TSS for guidance on supported
			  protected storage and will then configure the TOE or OE to establish a PIN
			  which enables release of the asymmetric key from the protected storage (such as a TPM, a hardware token, or
			  isolated execution environment) with which the
			  OS can interface.  The evaluator will then conduct the following tests:
			   
			     The evaluator will attempt to
			    authenticate to the OS using the known user name and PIN. The
			    evaluator will ensure that the authentication attempt is
			    successful. 
			     
				 The evaluator will attempt to
			    authenticate to the OS using the known user name but an incorrect
			    PIN. The evaluator will ensure that the authentication attempt is
			    unsuccessful.
				 
			  
			  If X.509 certificate authentication is selected, the evaluator
			  will generate an X.509v3 certificate for a user with the Client
			  Authentication Enhanced Key Usage field set. The evaluator will
			  provision the OS for authentication with the X.509v3 certificate.
			  The evaluator will ensure that the
			  certificates are validated by the OS as per FIA_X509_EXT.1.1 and then conduct the following tests:
              
                 
					The evaluator will attempt to authenticate to the OS using
					the X.509v3 certificate. The evaluator
					will ensure that the authentication attempt is successful.
                  
                
				  The evaluator will generate a second certificate identical to
				  the first except for the public key and any values derived
				  from the public key. The evaluator will attempt to
				  authenticate to the OS with this certificate. The evaluator
				  will ensure that the authentication attempt is unsuccessful.
                
              

            </div><div id='General_Purpose_Operating_System:fia__uau.5.2' class='requirement fia__uau.5.2'><div class='f-el-title'>FIA_UAU.5.2</div><div class='words'>
The <b>OS</b> shall authenticate any user's claimed identity according to the
              <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='rules describing how the multiple authentication mechanisms provide authentication'></textarea>.
            </div>
</div><!-- End: General_Purpose_Operating_System:fia__uau.5.2 -->
<div class='aactivity'>

		<p>
		The evaluator will ensure that the TSS
              describes each mechanism provided to support user authentication and
              the rules describing how the authentication mechanism(s) provide
              authentication. 
	      </p><p>
	      The evaluator will verify that
              configuration guidance for each authentication mechanism is
              addressed in the AGD guidance.
              
                For each
		authentication mechanism selected, the evaluator will enable that
		mechanism and verify that it can be used to authenticate the user at
		the specified authentication factor interfaces. 
		
For each authentication mechanism rule, the evaluator will ensure that
the authentication mechanism(s) behave as documented in the TSS.
		
              
	    </p>
          </div>
</div></span><!-- End: General_Purpose_Operating_System:fia__uau.5 -->
<span class='comp-notes'></span><br/><span id='General_Purpose_Operating_System:fia__x509__ext.1' class='component fia__x509__ext.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FIA_X509_EXT.1 &#8212; X.509 Certificate Validation</a>
<div class='reqgroup'>
<div id='General_Purpose_Operating_System:fia__x509__ext.1.1' class='requirement fia__x509__ext.1.1'><div class='f-el-title'>FIA_X509_EXT.1.1</div><div class='words'>
The OS shall implement functionality to validate certificates in accordance with
the following rules: <ul>
<li> RFC 5280 certificate validation and certificate path validation. </li>
<li> The certificate path must terminate with a trusted CA certificate. </li>
<li> The OS shall validate a certificate path by ensuring the presence of the
<i>basicConstraints</i> extension and that the <i>CA</i> flag is set to <code>TRUE</code> for all CA  certificates. </li>
<li> The OS shall validate the revocation status of the certificate using 
<span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>the Online Certificate Status Protocol (OCSP) as specified in RFC 2560</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>a Certificate Revocation List (CRL) as specified in RFC 5759</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>an OCSP TLS Status Request Extension (i.e., OCSP stapling) as specified in RFC 6066</span>
</li>
</ul>
</span>. </li>
<li> The OS shall validate the <i>extendedKeyUsage</i> field according to the following rules: 
<ul>
  <li> Certificates used for trusted updates and executable code integrity
  verification shall have the Code Signing purpose (id-kp 3 with OID 1.3.6.1.5.5.7.3.3) in the <i>extendedKeyUsage</i> field. </li>
  <li> Server certificates presented for <abbr title='Transport Layer Security'>TLS</abbr>
  shall have the Server Authentication purpose (id-kp 1 with OID
  1.3.6.1.5.5.7.3.1) in the <i>extendedKeyUsage</i> field. </li>
  <li> Client certificates presented for <abbr title='Transport Layer Security'>TLS</abbr> 
  shall have the Client Authentication purpose (id-kp 2 with OID 1.3.6.1.5.5.7.3.2) 
  in the <i>extendedKeyUsage</i> field. </li>
  <li> S/MIME certificates presented for email encryption and signature shall have
  the Email Protection purpose (id-kp 4 with OID 1.3.6.1.5.5.7.3.4) in the
  <i>extendedKeyUsage</i> field. </li>
  <li> OCSP certificates presented for OCSP responses shall have the OCSP Signing
  purpose (id-kp 9 with OID 1.3.6.1.5.5.7.3.9) in the <i>extendedKeyUsage</i> field. </li>
  <li> (Conditional) Server certificates presented for EST shall have the CMC Registration
  Authority (RA) purpose (id-kp-cmcRA with OID 1.3.6.1.5.5.7.3.28) in the
  <i>extendedKeyUsage</i> field. </li>
                  </ul>
                </li>
              </ul>
	      .
            </div>
</div><!-- End: General_Purpose_Operating_System:fia__x509__ext.1.1 -->
<div class='aactivity'>

	      <p>
	      The evaluator will ensure the TSS describes where the
              check of validity of the certificates takes place. 
	      The evaluator ensures the TSS also provides a description of the certificate path validation algorithm. 
	      </p><p>
	      The tests described must be performed in conjunction with the other
              certificate services evaluation activities, including the functions in FIA_X509_EXT.2.1. The tests for the <i>extendedKeyUsage</i> rules are performed
              in conjunction with the uses that require those rules. The evaluator will create a
              chain of at least four certificates: the node certificate to be tested, two
              Intermediate CAs, and the self-signed Root CA. 
                 The evaluator will demonstrate that validating a certificate without a valid
                  certification path results in the function failing. The evaluator will then load
                  a certificate or certificates as trusted CAs needed to validate the certificate to
                  be used in the function, and demonstrate that the function succeeds. The evaluator
                  shall then delete one of the certificates, and show that the function fails. 
                 The evaluator will demonstrate that validating an expired certificate
                  results in the function failing. 
                 The evaluator will test that the OS can properly handle
                  revoked certificates-–conditional on whether CRL, OCSP, or OCSP stapling is selected; 
		  if multiple methods are selected, then a test shall be performed for each method. 
		  The evaluator will test
                  revocation of the node certificate and revocation of the intermediate CA
                  certificate (i.e. the intermediate CA certificate should be revoked by the root
                  CA). The evaluator will ensure that a valid certificate is used, and that the
                  validation function succeeds. The evaluator then attempts the test with a
                  certificate that has been revoked (for each method chosen in the selection) to
                  ensure when the certificate is no longer valid that the validation function fails. 
                 If either OCSP option is selected, the evaluator will configure the OCSP server or use a
                  man-in-the-middle tool to present a certificate that does not have the OCSP
                  signing purpose and verify that validation of the OCSP response fails. If CRL is
                  selected, the evaluator will configure the CA to sign a CRL with a certificate
                  that does not have the cRLsign key usage bit set, and verify that validation of
                  the CRL fails. 
                 The evaluator will modify any byte in the first eight bytes of the
                  certificate and demonstrate that the certificate fails to validate. (The
                  certificate should fail to parse correctly.) 
                 The evaluator will modify any byte in the last byte of the certificate and
                  demonstrate that the certificate fails to validate. (The signature on the
                  certificate should not validate.) 
                 The evaluator will modify any byte in the public key of the certificate and
                  demonstrate that the certificate fails to validate. (The signature on the
                  certificate should not validate.) 
              
	    </p>
            </div><div id='General_Purpose_Operating_System:fia__x509__ext.1.2' class='requirement fia__x509__ext.1.2'><div class='f-el-title'>FIA_X509_EXT.1.2</div><div class='words'>
The OS shall only treat a certificate as a CA certificate if the
<i>basicConstraints</i> extension is present and the CA flag is set to TRUE. 
	    </div>
</div><!-- End: General_Purpose_Operating_System:fia__x509__ext.1.2 -->
<div class='aactivity'>

The tests described must be performed in conjunction with the other
certificate services evaluation activities, including the functions in 
FIA_X509_EXT.2.1.
The evaluator will create a chain of at least four certificates: 
the node certificate to be tested, two Intermediate CAs, and the
              self-signed Root CA. 

   The evaluator will construct a certificate path, such that the certificate
  of the CA issuing the OS's certificate does not contain the
  <i>basicConstraints</i> extension. The validation of the certificate path fails. 
   The evaluator will construct a certificate path, such that the certificate
  of the CA issuing the OS's certificate has the CA flag in the
  <i>basicConstraints</i> extension not set. The validation of the certificate path fails. 
   The evaluator will construct a certificate path, such that the certificate
  of the CA issuing the OS's certificate has the CA flag in the
  <i>basicConstraints</i> extension set to TRUE. The validation of the certificate path
  succeeds. 

            </div>
</div></span><!-- End: General_Purpose_Operating_System:fia__x509__ext.1 -->
<span class='comp-notes'></span><br/><span id='General_Purpose_Operating_System:fia__x509__ext.2' class='component fia__x509__ext.2'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FIA_X509_EXT.2 &#8212; X.509 Certificate Authentication</a>
<div class='reqgroup'>
<div id='General_Purpose_Operating_System:fia__x509__ext.2.1' class='requirement fia__x509__ext.2.1'><div class='f-el-title'>FIA_X509_EXT.2.1</div><div class='words'> The OS shall use X.509v3 certificates as defined by RFC 5280 to support
              authentication for TLS and 
			  <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>DTLS</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>HTTPS</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span><textarea onchange='update(this);' class='assignment val' rows='1' placeholder='other protocols'></textarea></span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox exclusive'></input><span>no other protocols</span>
</li>
</ul>
</span>
			  connections. 
			</div>
</div><!-- End: General_Purpose_Operating_System:fia__x509__ext.2.1 -->
<div class='aactivity'>
 
	      <p>
		The evaluator will acquire or develop an application that uses the OS
		TLS mechanism with an X.509v3 certificate. The evaluator will then run the
		application and ensure that the provided certificate is used to authenticate the
		connection. 
	      </p>
	      <p>
		The evaluator will repeat the activity for any other selections listed.
	      </p>
	    </div>
</div></span><!-- End: General_Purpose_Operating_System:fia__x509__ext.2 -->
<span class='comp-notes'></span><br/><span class='tooltipped'><input type='checkbox' onchange='handleOCheck(this); return false;'></input></span>
<span id='General_Purpose_Operating_System:fta__tab.1' class='component fta__tab.1 disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FTA_TAB.1 &#8212; Default TOE access banners</a><span class='tooltiptext'>optional</span>
<div class='reqgroup'>
<div id='General_Purpose_Operating_System:fta__tab.1.1' class='requirement fta__tab.1.1'><div class='f-el-title'>FTA_TAB.1.1</div><div class='words'>
            Before establishing a user session, the OS shall display an advisory
            warning message regarding unauthorized use of the OS.
            </div>
</div><!-- End: General_Purpose_Operating_System:fta__tab.1.1 -->
<div class='aactivity'>
 
            The evaluator will configure the OS, per instructions in the OS manual,
            to display the advisory warning message "TEST TEST Warning Message TEST TEST". 
            The evaluator will then log out and confirm that the advisory message is 
            displayed before logging in can occur.
            </div>
</div></span><!-- End: General_Purpose_Operating_System:fta__tab.1 -->
<span class='comp-notes'></span><br/><span id='General_Purpose_Operating_System:ftp__itc__ext.1' class='component ftp__itc__ext.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FTP_ITC_EXT.1 &#8212; Trusted channel communication</a>
<div class='reqgroup'>
<div id='General_Purpose_Operating_System:ftp__itc__ext.1.1' class='requirement ftp__itc__ext.1.1'><div class='f-el-title'>FTP_ITC_EXT.1.1</div><div class='words'>
     	      The OS shall use 
      	      <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' id='General_Purpose_Operating_System:tls' onchange='update(this); ' data-rindex='0' class='val selbox tls'></input><span>TLS as conforming to FCS_TLSC_EXT.1</span>
</li>
<li><input type='checkbox' id='General_Purpose_Operating_System:dtls' onchange='update(this); ' data-rindex='1' class='val selbox dtls'></input><span>DTLS as conforming to FCS_DTLS_EXT.1</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>IPsec as conforming to the <a href='https://www.niap-ccevs.org/pp/'><i>EP for IPsec VPN Clients</i></a></span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span>SSH as conforming to the <a href='https://www.niap-ccevs.org/pp/'><i>EP for Secure Shell</i></a></span>
</li>
</ul>
</span>
		    to provide a trusted communication channel between itself and 
		    authorized IT entities supporting the following capabilities: 
		    <span class='selectables' data-rindex='1'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>audit server</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>authentication server</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>management server</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span><textarea onchange='update(this);' class='assignment val' rows='1' placeholder='other capabilities'></textarea></span>
</li>
</ul>
</span>
		    that is logically distinct from other communication
		    channels and provides assured identification of its end points and protection of the channel 
		    data from disclosure and detection of modification of the channel data.
      	    </div>
</div><!-- End: General_Purpose_Operating_System:ftp__itc__ext.1.1 -->
<div class='aactivity'>

	      The evaluator will configure the OS to communicate with another
	      trusted IT product as identified in the second selection.  
      	  The evaluator will monitor network traffic while the OS performs communication with each of the
      	  servers identified in the second selection.
      	  The evaluator will ensure that for each session a trusted channel was established
      	  in conformance with the protocols identified in the first selection.
      	  </div>
</div></span><!-- End: General_Purpose_Operating_System:ftp__itc__ext.1 -->
<span class='comp-notes'></span><br/><span id='General_Purpose_Operating_System:ftp__trp.1' class='component ftp__trp.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FTP_TRP.1 &#8212; Trusted Path</a>
<div class='reqgroup'>
<div id='General_Purpose_Operating_System:ftp__trp.1.1' class='requirement ftp__trp.1.1'><div class='f-el-title'>FTP_TRP.1.1</div><div class='words'>
The OS shall provide a communication path between itself and 
<span class='selectables' data-rindex='0'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>remote</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>local</span>
</span>
users that is logically distinct from other communication paths and provides assured 
identification of its endpoints and protection of the communicated data from 
modification and disclosure.
              </div>
</div><!-- End: General_Purpose_Operating_System:ftp__trp.1.1 -->
<div id='General_Purpose_Operating_System:ftp__trp.1.2' class='requirement ftp__trp.1.2'><div class='f-el-title'>FTP_TRP.1.2</div><div class='words'> The OS shall permit 
                <span class='selectables' data-rindex='0'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>the TSF</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>local users</span>
<input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>remote users</span>
</span>
                to initiate communication via the trusted path.
              </div>
</div><!-- End: General_Purpose_Operating_System:ftp__trp.1.2 -->
<div id='General_Purpose_Operating_System:ftp__trp.1.3' class='requirement ftp__trp.1.3'><div class='f-el-title'>FTP_TRP.1.3</div><div class='words'> The OS shall require use of the trusted path for all remote administrative actions.
              </div>
</div><!-- End: General_Purpose_Operating_System:ftp__trp.1.3 -->
<div class='aactivity'>

                The evaluator will examine the TSS to determine that the methods of remote OS administration
                are indicated, along with how those communications are protected. The evaluator will also
                confirm that all protocols listed in the TSS in support of OS administration are consistent with those
                specified in the requirement, and are included in the requirements in the ST. The evaluator will
                confirm that the operational guidance contains instructions for establishing the remote
                administrative sessions for each supported method. The evaluator will also perform the following
                tests:
                
                  
                    The evaluator will ensure that communications using each remote administration method is 
                    tested during the course of the evaluation, setting up the connections as described in the 
                    operational guidance and ensuring that communication is successful.
                  
                  
                    For each method of remote administration supported, the evaluator will
                    follow the operational guidance to ensure that there is no available interface that can be
                    used by a remote user to establish a remote administrative sessions without invoking the
                    trusted path.
                  
                  
                    The evaluator will ensure, for each method of remote administration, the
                    channel data is not sent in plaintext.
                  
                  
                    The evaluator will ensure, for each method of remote administration,
                    modification of the channel data is detected by the OS.
                  
                
              </div>
</div></span><!-- End: General_Purpose_Operating_System:ftp__trp.1 -->
<span class='comp-notes'></span><br/><span id='General_Purpose_Operating_System:adv__fsp.1' class='component adv__fsp.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>ADV_FSP.1 &#8212; Basic Functional Specification (ADV_FSP.1)</a>
<div class='reqgroup'>
<div id='General_Purpose_Operating_System:adv__fsp.1.1d' class='requirement adv__fsp.1.1d'><div class='f-el-title'>ADV_FSP.1.1D</div><div class='words'>The developer shall provide a functional specification.</div>
</div><!-- End: General_Purpose_Operating_System:adv__fsp.1.1d -->
<div id='General_Purpose_Operating_System:adv__fsp.1.2d' class='requirement adv__fsp.1.2d'><div class='f-el-title'>ADV_FSP.1.2D</div><div class='words'>The developer shall provide a tracing from the functional specification to the
              SFRs.</div>
</div><!-- End: General_Purpose_Operating_System:adv__fsp.1.2d -->
<div id='General_Purpose_Operating_System:adv__fsp.1.1c' class='requirement adv__fsp.1.1c'><div class='f-el-title'>ADV_FSP.1.1C</div><div class='words'>The functional specification shall describe the purpose and method of use for
              each SFR-enforcing and SFR-supporting .</div>
</div><!-- End: General_Purpose_Operating_System:adv__fsp.1.1c -->
<div id='General_Purpose_Operating_System:adv__fsp.1.2c' class='requirement adv__fsp.1.2c'><div class='f-el-title'>ADV_FSP.1.2C</div><div class='words'>The functional specification shall identify all parameters associated with each
              SFR-enforcing and SFR-supporting .</div>
</div><!-- End: General_Purpose_Operating_System:adv__fsp.1.2c -->
<div id='General_Purpose_Operating_System:adv__fsp.1.3c' class='requirement adv__fsp.1.3c'><div class='f-el-title'>ADV_FSP.1.3C</div><div class='words'>The functional specification shall provide rationale for the implicit
              categorization of interfaces as SFR-non-interfering.</div>
</div><!-- End: General_Purpose_Operating_System:adv__fsp.1.3c -->
<div id='General_Purpose_Operating_System:adv__fsp.1.4c' class='requirement adv__fsp.1.4c'><div class='f-el-title'>ADV_FSP.1.4C</div><div class='words'>
		The tracing shall demonstrate that the SFRs trace to 
		s 
		in the functional specification.
	      </div>
</div><!-- End: General_Purpose_Operating_System:adv__fsp.1.4c -->
<div id='General_Purpose_Operating_System:adv__fsp.1.1e' class='requirement adv__fsp.1.1e'><div class='f-el-title'>ADV_FSP.1.1E</div><div class='words'>The evaluator will confirm that the information provided meets all requirements
              for content and presentation of evidence.</div>
</div><!-- End: General_Purpose_Operating_System:adv__fsp.1.1e -->
<div id='General_Purpose_Operating_System:adv__fsp.1.2e' class='requirement adv__fsp.1.2e'><div class='f-el-title'>ADV_FSP.1.2E</div><div class='words'>The evaluator will determine that the functional specification is an accurate
              and complete instantiation of the SFRs.</div>
</div><!-- End: General_Purpose_Operating_System:adv__fsp.1.2e -->
<div class='aactivity'>
There are no specific evaluation activities associated with these SARs, except
              ensuring the information is provided. The functional specification documentation is
              provided to support the evaluation activities described in , and
              other activities described for AGD, ATE, and AVA SARs. The requirements on the content
              of the functional specification information is implicitly assessed by virtue of the
              other evaluation activities being performed; if the evaluator is unable to perform an
              activity because there is insufficient interface information, then an adequate
              functional specification has not been provided.
	      </div>
</div></span><!-- End: General_Purpose_Operating_System:adv__fsp.1 -->
<span class='comp-notes'></span><br/><span id='General_Purpose_Operating_System:agd__ope.1' class='component agd__ope.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>AGD_OPE.1 &#8212; Operational User Guidance (AGD_OPE.1)</a>
<div class='reqgroup'>
<div id='General_Purpose_Operating_System:agd__ope.1.1d' class='requirement agd__ope.1.1d'><div class='f-el-title'>AGD_OPE.1.1D</div><div class='words'>The developer shall provide operational user guidance.</div>
</div><!-- End: General_Purpose_Operating_System:agd__ope.1.1d -->
<div id='General_Purpose_Operating_System:agd__ope.1.1c' class='requirement agd__ope.1.1c'><div class='f-el-title'>AGD_OPE.1.1C</div><div class='words'>The operational user guidance shall describe, for each user role, the
              user-accessible functions and privileges that should be controlled in a secure
              processing environment, including appropriate warnings.</div>
</div><!-- End: General_Purpose_Operating_System:agd__ope.1.1c -->
<div id='General_Purpose_Operating_System:agd__ope.1.2c' class='requirement agd__ope.1.2c'><div class='f-el-title'>AGD_OPE.1.2C</div><div class='words'>The operational user guidance shall describe, for each user role, how to use the
              available interfaces provided by the OS in a secure manner.</div>
</div><!-- End: General_Purpose_Operating_System:agd__ope.1.2c -->
<div id='General_Purpose_Operating_System:agd__ope.1.3c' class='requirement agd__ope.1.3c'><div class='f-el-title'>AGD_OPE.1.3C</div><div class='words'>The operational user guidance shall describe, for each user role, the available
              functions and interfaces, in particular all security parameters under the control of
              the user, indicating secure values as appropriate.</div>
</div><!-- End: General_Purpose_Operating_System:agd__ope.1.3c -->
<div id='General_Purpose_Operating_System:agd__ope.1.4c' class='requirement agd__ope.1.4c'><div class='f-el-title'>AGD_OPE.1.4C</div><div class='words'>The operational user guidance shall, for each user role, clearly present each
              type of security-relevant event relative to the user-accessible functions that need to
              be performed, including changing the security characteristics of entities under the
              control of the TSF.</div>
</div><!-- End: General_Purpose_Operating_System:agd__ope.1.4c -->
<div id='General_Purpose_Operating_System:agd__ope.1.5c' class='requirement agd__ope.1.5c'><div class='f-el-title'>AGD_OPE.1.5C</div><div class='words'>The operational user guidance shall identify all possible modes of operation of
              the OS (including operation following failure or operational
              error), their consequences, and implications for maintaining secure operation.</div>
</div><!-- End: General_Purpose_Operating_System:agd__ope.1.5c -->
<div id='General_Purpose_Operating_System:agd__ope.1.6c' class='requirement agd__ope.1.6c'><div class='f-el-title'>AGD_OPE.1.6C</div><div class='words'>The operational user guidance shall, for each user role, describe the security
              measures to be followed in order to fulfill the security objectives for the
              operational environment as described in the ST.</div>
</div><!-- End: General_Purpose_Operating_System:agd__ope.1.6c -->
<div id='General_Purpose_Operating_System:agd__ope.1.7c' class='requirement agd__ope.1.7c'><div class='f-el-title'>AGD_OPE.1.7C</div><div class='words'>The operational user guidance shall be clear and reasonable.</div>
</div><!-- End: General_Purpose_Operating_System:agd__ope.1.7c -->
<div id='General_Purpose_Operating_System:agd__ope.1.1e' class='requirement agd__ope.1.1e'><div class='f-el-title'>AGD_OPE.1.1E</div><div class='words'>The evaluator will confirm that the information provided meets all requirements
              for content and presentation of evidence. </div>
</div><!-- End: General_Purpose_Operating_System:agd__ope.1.1e -->
<div class='aactivity'>
Some of the contents of the operational guidance are verified by the
              evaluation activities in  and evaluation of the OS according to the . The following additional
              information is also required. If cryptographic functions are provided by the OS, the operational guidance shall contain instructions for configuring
              the cryptographic engine associated with the evaluated configuration of the OS. It shall provide a warning to the administrator that use of other
              cryptographic engines was not evaluated nor tested during the CC evaluation of the
              OS. The documentation must describe the process for verifying
              updates to the OS by verifying a digital signature – this may be
              done by the OS or the underlying platform. The evaluator will
              verify that this process includes the following steps: Instructions for obtaining the
              update itself. This should include instructions for making the update accessible to
              the OS (e.g., placement in a specific directory). Instructions for
              initiating the update process, as well as discerning whether the process was
              successful or unsuccessful. This includes generation of the hash/digital signature.
              The OS will likely contain security functionality that does not
              fall in the scope of evaluation under this PP. The operational guidance shall make it
              clear to an administrator which security functionality is covered by the evaluation
              activities. </div>
</div></span><!-- End: General_Purpose_Operating_System:agd__ope.1 -->
<span class='comp-notes'></span><br/><span id='General_Purpose_Operating_System:agd__pre.1' class='component agd__pre.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>AGD_PRE.1 &#8212; Preparative Procedures (AGD_PRE.1)</a>
<div class='reqgroup'>
<div id='General_Purpose_Operating_System:agd__pre.1.1d' class='requirement agd__pre.1.1d'><div class='f-el-title'>AGD_PRE.1.1D</div><div class='words'>The developer shall provide the OS, including its preparative
              procedures.</div>
</div><!-- End: General_Purpose_Operating_System:agd__pre.1.1d -->
<div id='General_Purpose_Operating_System:agd__pre.1.1c' class='requirement agd__pre.1.1c'><div class='f-el-title'>AGD_PRE.1.1C</div><div class='words'>The preparative procedures shall describe all the steps necessary for secure
              acceptance of the delivered OS in accordance with the developer's
              delivery procedures.</div>
</div><!-- End: General_Purpose_Operating_System:agd__pre.1.1c -->
<div id='General_Purpose_Operating_System:agd__pre.1.2c' class='requirement agd__pre.1.2c'><div class='f-el-title'>AGD_PRE.1.2C</div><div class='words'>The preparative procedures shall describe all the steps necessary for secure
              installation of the OS and for the secure preparation of the
              operational environment in accordance with the security objectives for the operational
              environment as described in the ST.</div>
</div><!-- End: General_Purpose_Operating_System:agd__pre.1.2c -->
<div id='General_Purpose_Operating_System:agd__pre.1.1e' class='requirement agd__pre.1.1e'><div class='f-el-title'>AGD_PRE.1.1E</div><div class='words'>The evaluator will confirm that the information provided meets all requirements
              for content and presentation of evidence.</div>
</div><!-- End: General_Purpose_Operating_System:agd__pre.1.1e -->
<div id='General_Purpose_Operating_System:agd__pre.1.2e' class='requirement agd__pre.1.2e'><div class='f-el-title'>AGD_PRE.1.2E</div><div class='words'>The evaluator will apply the preparative procedures to confirm that the OS can be prepared securely for operation.</div>
</div><!-- End: General_Purpose_Operating_System:agd__pre.1.2e -->
<div class='aactivity'>
As indicated in the introduction above, there are significant expectations
              with respect to the documentation—especially when configuring the operational
              environment to support OS functional requirements. The evaluator
              shall check to ensure that the guidance provided for the OS
              adequately addresses all platforms claimed for the OS in the ST. </div>
</div></span><!-- End: General_Purpose_Operating_System:agd__pre.1 -->
<span class='comp-notes'></span><br/><span id='General_Purpose_Operating_System:alc__cmc.1' class='component alc__cmc.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>ALC_CMC.1 &#8212; Labeling of the TOE (ALC_CMC.1)</a>
<div class='reqgroup'>
<div id='General_Purpose_Operating_System:alc__cmc.1.1d' class='requirement alc__cmc.1.1d'><div class='f-el-title'>ALC_CMC.1.1D</div><div class='words'>The developer shall provide the OS and a reference for the
              OS.</div>
</div><!-- End: General_Purpose_Operating_System:alc__cmc.1.1d -->
<div id='General_Purpose_Operating_System:alc__cmc.1.1c' class='requirement alc__cmc.1.1c'><div class='f-el-title'>ALC_CMC.1.1C</div><div class='words'>The OS shall be labeled with a unique reference.</div>
</div><!-- End: General_Purpose_Operating_System:alc__cmc.1.1c -->
<div id='General_Purpose_Operating_System:alc__cmc.1.1e' class='requirement alc__cmc.1.1e'><div class='f-el-title'>ALC_CMC.1.1E</div><div class='words'>The evaluator will confirm that the information provided meets all requirements
              for content and presentation of evidence.</div>
</div><!-- End: General_Purpose_Operating_System:alc__cmc.1.1e -->
<div class='aactivity'>
The evaluator will check the ST to ensure that it contains
              an identifier (such as a product name/version number) that specifically identifies the
              version that meets the requirements of the ST. Further, the
              evaluator will check the AGD guidance and OS samples received for
              testing to ensure that the version number is consistent with that in the ST. If the vendor maintains a web site advertising the OS, the evaluator will examine the information on the web site to
              ensure that the information in the ST is sufficient to distinguish
              the product.</div>
</div></span><!-- End: General_Purpose_Operating_System:alc__cmc.1 -->
<span class='comp-notes'></span><br/><span id='General_Purpose_Operating_System:alc__cms.1' class='component alc__cms.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>ALC_CMS.1 &#8212; TOE CM Coverage (ALC_CMS.1)</a>
<div class='reqgroup'>
<div id='General_Purpose_Operating_System:alc__cms.1.1d' class='requirement alc__cms.1.1d'><div class='f-el-title'>ALC_CMS.1.1D</div><div class='words'>
		The developer shall provide a configuration list for the  OS.
	      </div>
</div><!-- End: General_Purpose_Operating_System:alc__cms.1.1d -->
<div id='General_Purpose_Operating_System:alc__cms.1.1c' class='requirement alc__cms.1.1c'><div class='f-el-title'>ALC_CMS.1.1C</div><div class='words'>The configuration list shall include the following: the OS
              itself; and the evaluation evidence required by the SARs.</div>
</div><!-- End: General_Purpose_Operating_System:alc__cms.1.1c -->
<div id='General_Purpose_Operating_System:alc__cms.1.2c' class='requirement alc__cms.1.2c'><div class='f-el-title'>ALC_CMS.1.2C</div><div class='words'>The configuration list shall uniquely identify the configuration items.</div>
</div><!-- End: General_Purpose_Operating_System:alc__cms.1.2c -->
<div id='General_Purpose_Operating_System:alc__cms.1.1e' class='requirement alc__cms.1.1e'><div class='f-el-title'>ALC_CMS.1.1E</div><div class='words'>The evaluator will confirm that the information provided meets all requirements
              for content and presentation of evidence.</div>
</div><!-- End: General_Purpose_Operating_System:alc__cms.1.1e -->
<div class='aactivity'>

		<p>
		  The "evaluation evidence required by the SARs" in this PP is limited to the
              information in the ST coupled with the guidance provided to
              administrators and users under the AGD requirements. By ensuring that the OS is specifically identified and that this identification is
              consistent in the ST and in the AGD guidance (as done in the
              evaluation activity for ALC_CMC.1), the evaluator implicitly confirms the information
              required by this component. Life-cycle support is targeted aspects of the developer's
              life-cycle and instructions to providers of applications for the developer's devices,
              rather than an in-depth examination of the TSF manufacturer's
              development and configuration management process. This is not meant to diminish the
              critical role that a developer's practices play in contributing to the overall
              trustworthiness of a product; rather, it's a reflection on the information to be made
              available for evaluation.
	      </p><p>
	      The evaluator will ensure that the developer has
              identified (in guidance documentation for application developers concerning the
              targeted platform) one or more development environments appropriate for use in
              developing applications for the developer's platform. For each of these development
              environments, the developer shall provide information on how to configure the
              environment to ensure that buffer overflow protection mechanisms in the environment(s)
              are invoked (e.g., compiler and linker flags). The evaluator will ensure that this documentation
              also includes an indication of whether such protections are on by default, or have to
              be specifically enabled. The evaluator will ensure that the TSF is
              uniquely identified (with respect to other products from the TSF
              vendor), and that documentation provided by the developer in association with the
              requirements in the ST is associated with the TSF
              using this unique identification.
	      </p>
	      </div>
</div></span><!-- End: General_Purpose_Operating_System:alc__cms.1 -->
<span class='comp-notes'></span><br/><span id='General_Purpose_Operating_System:alc__tsu__ext.1' class='component alc__tsu__ext.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>ALC_TSU_EXT.1 &#8212; Timely Security Updates</a>
<div class='reqgroup'>
<div id='General_Purpose_Operating_System:alc__tsu__ext.1.1d' class='requirement alc__tsu__ext.1.1d'><div class='f-el-title'>ALC_TSU_EXT.1.1D</div><div class='words'>The developer shall provide a description in the TSS of how timely security
              updates are made to the OS.</div>
</div><!-- End: General_Purpose_Operating_System:alc__tsu__ext.1.1d -->
<div id='General_Purpose_Operating_System:alc__tsu__ext.1.2d' class='requirement alc__tsu__ext.1.2d'><div class='f-el-title'>ALC_TSU_EXT.1.2D</div><div class='words'> The developer shall provide a description in the TSS of how users are notified
              when updates change security properties or the configuration of the product. </div>
</div><!-- End: General_Purpose_Operating_System:alc__tsu__ext.1.2d -->
<div id='General_Purpose_Operating_System:alc__tsu__ext.1.1c' class='requirement alc__tsu__ext.1.1c'><div class='f-el-title'>ALC_TSU_EXT.1.1C</div><div class='words'>The description shall include the process for creating and deploying security
              updates for the OS software.</div>
</div><!-- End: General_Purpose_Operating_System:alc__tsu__ext.1.1c -->
<div id='General_Purpose_Operating_System:alc__tsu__ext.1.2c' class='requirement alc__tsu__ext.1.2c'><div class='f-el-title'>ALC_TSU_EXT.1.2C</div><div class='words'>The description shall include the mechanisms publicly available for reporting
              security issues pertaining to the OS.</div>
</div><!-- End: General_Purpose_Operating_System:alc__tsu__ext.1.2c -->
<div id='General_Purpose_Operating_System:alc__tsu__ext.1.1e' class='requirement alc__tsu__ext.1.1e'><div class='f-el-title'>ALC_TSU_EXT.1.1E</div><div class='words'>The evaluator will confirm that the information provided meets all
              requirements for content and presentation of evidence.</div>
</div><!-- End: General_Purpose_Operating_System:alc__tsu__ext.1.1e -->
<div class='aactivity'>
 
		<p>
		The evaluator will verify that the TSS contains a description of the timely
              security update process used by the developer to create and deploy security updates.
              The evaluator will verify that this description addresses the entire application. The
              evaluator will also verify that, in addition to the OS developer's process, any
              third-party processes are also addressed in the description. The evaluator will also
              verify that each mechanism for deployment of security updates is described. 
	      </p><p> 
	      The
              evaluator will verify that, for each deployment mechanism described for the update
              process, the TSS lists a time between public disclosure of a vulnerability and public
              availability of the security update to the OS patching this vulnerability, to include
              any third-party or carrier delays in deployment. The evaluator will verify that this
              time is expressed in a number or range of days.
	      </p><p>
	      The evaluator will verify that
              this description includes the publicly available mechanisms (including either an email
              address or website) for reporting security issues related to the OS. The evaluator
              shall verify that the description of this mechanism includes a method for protecting
              the report either using a public key for encrypting email or a trusted channel for a
              website. 
	    </p>
	    </div>
</div></span><!-- End: General_Purpose_Operating_System:alc__tsu__ext.1 -->
<span class='comp-notes'></span><br/><span id='General_Purpose_Operating_System:ate__ind.1' class='component ate__ind.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>ATE_IND.1 &#8212; Independent Testing - Conformance (ATE_IND.1)</a>
<div class='reqgroup'>
<div id='General_Purpose_Operating_System:ate__ind.1.1d' class='requirement ate__ind.1.1d'><div class='f-el-title'>ATE_IND.1.1D</div><div class='words'>The developer shall provide the OS for testing.</div>
</div><!-- End: General_Purpose_Operating_System:ate__ind.1.1d -->
<div id='General_Purpose_Operating_System:ate__ind.1.1c' class='requirement ate__ind.1.1c'><div class='f-el-title'>ATE_IND.1.1C</div><div class='words'>The OS shall be suitable for testing.</div>
</div><!-- End: General_Purpose_Operating_System:ate__ind.1.1c -->
<div id='General_Purpose_Operating_System:ate__ind.1.1e' class='requirement ate__ind.1.1e'><div class='f-el-title'>ATE_IND.1.1E</div><div class='words'>The evaluator <i>shall confirm</i> that the information provided meets all
              requirements for content and presentation of evidence.</div>
</div><!-- End: General_Purpose_Operating_System:ate__ind.1.1e -->
<div id='General_Purpose_Operating_System:ate__ind.1.2e' class='requirement ate__ind.1.2e'><div class='f-el-title'>ATE_IND.1.2E</div><div class='words'>The evaluator will test a subset of the TSF to confirm that
              the TSF operates as specified.</div>
</div><!-- End: General_Purpose_Operating_System:ate__ind.1.2e -->
<div class='aactivity'>

		<p>
		  The evaluator will prepare a test plan and report documenting the testing
              aspects of the system, including any application crashes during testing. The evaluator
              shall determine the root cause of any application crashes and include that information
              in the report. The test plan covers all of the testing actions contained in the  and the body of this PP's evaluation activities. 
	      </p><p>
	      While it is
              not necessary to have one test case per test listed in an evaluation activity, the
              evaluator must document in the test plan that each applicable testing requirement in
              the ST is covered. The test plan identifies the platforms to be
              tested, and for those platforms not included in the test plan but included in the
                ST, the test plan provides a justification for not testing the
              platforms. This justification must address the differences between the tested
              platforms and the untested platforms, and make an argument that the differences do not
              affect the testing to be performed. It is not sufficient to merely assert that the
              differences have no affect; rationale must be provided. If all platforms claimed in
              the ST are tested, then no rationale is necessary. The test plan
              describes the composition of each platform to be tested, and any setup that is
              necessary beyond what is contained in the AGD documentation. It should be noted that
              the evaluator is expected to follow the AGD documentation for installation and setup
              of each platform either as part of a test or as a standard pre-test condition. This
              may include special test drivers or tools. For each driver or tool, an argument (not
              just an assertion) should be provided that the driver or tool will not adversely
              affect the performance of the functionality by the OS and its
              platform.
	      </p><p>
	      This also includes the configuration of the cryptographic engine to be
              used. The cryptographic algorithms implemented by this engine are those specified by
              this PP and used by the cryptographic protocols being evaluated (IPsec, TLS). The test
              plan identifies high-level test objectives as well as the test procedures to be
              followed to achieve those objectives. These procedures include expected results.
	      </p><p>
              The test report (which could just be an annotated version of the test plan) details
              the activities that took place when the test procedures were executed, and includes
              the actual results of the tests. This shall be a cumulative account, so if there was a
              test run that resulted in a failure; a fix installed; and then a successful re-run of
              the test, the report would show a "fail" and "pass" result (and the supporting
              details), and not just the "pass" result.
	    </p>
	    </div>
</div></span><!-- End: General_Purpose_Operating_System:ate__ind.1 -->
<span class='comp-notes'></span><br/><span id='General_Purpose_Operating_System:ava__van.1' class='component ava__van.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>AVA_VAN.1 &#8212; Vulnerability Survey (AVA_VAN.1)</a>
<div class='reqgroup'>
<div id='General_Purpose_Operating_System:ava__van.1.1d' class='requirement ava__van.1.1d'><div class='f-el-title'>AVA_VAN.1.1D</div><div class='words'>The developer shall provide the OS for testing.</div>
</div><!-- End: General_Purpose_Operating_System:ava__van.1.1d -->
<div id='General_Purpose_Operating_System:ava__van.1.1c' class='requirement ava__van.1.1c'><div class='f-el-title'>AVA_VAN.1.1C</div><div class='words'>The OS shall be suitable for testing.</div>
</div><!-- End: General_Purpose_Operating_System:ava__van.1.1c -->
<div id='General_Purpose_Operating_System:ava__van.1.1e' class='requirement ava__van.1.1e'><div class='f-el-title'>AVA_VAN.1.1E</div><div class='words'>The evaluator will confirm that the information provided meets all requirements
            for content and presentation of evidence.</div>
</div><!-- End: General_Purpose_Operating_System:ava__van.1.1e -->
<div id='General_Purpose_Operating_System:ava__van.1.2e' class='requirement ava__van.1.2e'><div class='f-el-title'>AVA_VAN.1.2E</div><div class='words'>The evaluator will perform a search of public domain sources to identify
              potential vulnerabilities in the OS.</div>
</div><!-- End: General_Purpose_Operating_System:ava__van.1.2e -->
<div id='General_Purpose_Operating_System:ava__van.1.3e' class='requirement ava__van.1.3e'><div class='f-el-title'>AVA_VAN.1.3E</div><div class='words'>The evaluator will conduct penetration testing, based on the identified
              potential vulnerabilities, to determine that the OS is resistant to
              attacks performed by an attacker possessing Basic attack potential.</div>
</div><!-- End: General_Purpose_Operating_System:ava__van.1.3e -->
<div class='aactivity'>

	      <p>
	      The evaluator will generate a report to document their
              findings with respect to this requirement. This report could physically be part of the
              overall test report mentioned in ATE_IND, or a separate document. The evaluator
              performs a search of public information to find vulnerabilities that have been found
              in similar applications with a particular focus on network protocols the application
              uses and document formats it parses. 
              The evaluator documents the sources consulted and
              the vulnerabilities found in the report. 
	      </p><p>
              For each vulnerability found, the evaluator
              either provides a rationale with respect to its non-applicability, or the evaluator
              formulates a test (using the guidelines provided in ATE_IND) to confirm the
              vulnerability, if suitable. Suitability is determined by assessing the attack vector
              needed to take advantage of the vulnerability. If exploiting the vulnerability
              requires expert skills and an electron microscope, for instance, then a test would not
              be suitable and an appropriate justification would be formulated.
	    </p>
	    </div>
</div></span><!-- End: General_Purpose_Operating_System:ava__van.1 -->
<span class='comp-notes'></span><br/></div><div class='hidable dep:Mobile_Device_Fundamentals' id='base:Mobile_Device_Fundamentals'><h2>Mobile Device Fundamentals</h2><span id='Mobile_Device_Fundamentals:fau__gen.1' class='component fau__gen.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FAU_GEN.1 &#8212; Audit Data Generation</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fau__gen.1.1' class='requirement fau__gen.1.1'><div class='f-el-title'>FAU_GEN.1.1</div><div class='words'>The TSF shall be able to generate an audit record of the following auditable events:<br/>
            <ol>
              <li>Start-up and shutdown of the audit functions</li>
              <li>All auditable events for the [not selected] level of audit</li>
              <li><span class='refinement'>All administrative actions</span></li>
              <li><span class='refinement'>Start-up and shutdown of the Rich OS</span></li>
              <li><span class='refinement'>Insertion or removal of removable media</span></li>
              <li><span class='refinement'>Specifically defined auditable events in <a onclick='showTarget("cc-Mobile_Device_Fundamentals:manaudit")' href="#cc-Mobile_Device_Fundamentals:manaudit" class="cc-Mobile_Device_Fundamentals:manaudit-ref"><span class="counter">Mobile_Device_Fundamentals:manaudit</span></a></span></li>
              <li><span class='refinement'><span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>Audit records reaching <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='integer value less than 100'></textarea> percentage of audit capacity</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span><textarea onchange='update(this);' class='assignment val' rows='1' placeholder='other auditable events derived from this profile'></textarea></span>
</li>
</ul>
</span></span></li>
              <li><span class='refinement'>
                <span class='selectables' data-rindex='1'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>Specifically defined auditable event in <a onclick='showTarget("cc-Mobile_Device_Fundamentals:objaudit")' href="#cc-Mobile_Device_Fundamentals:objaudit" class="cc-Mobile_Device_Fundamentals:objaudit-ref"><span class="counter">Mobile_Device_Fundamentals:objaudit</span></a></span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>no additional auditable events</span>
</li>
</ul>
</span></span></li>
            </ol></div>
</div><!-- End: Mobile_Device_Fundamentals:fau__gen.1.1 -->
<div id='Mobile_Device_Fundamentals:fau__gen.1.2' class='requirement fau__gen.1.2'><div class='f-el-title'>FAU_GEN.1.2</div><div class='words'>The TSF shall record within each audit record at least the following information:
              <ol>
              <li>Date and time of the event</li> 
              <li>Type of event</li>
              <li>Subject identity</li> 
              <li>The outcome (success or failure) of the event</li> 
              <li>Additional information in <a onclick='showTarget("cc-Mobile_Device_Fundamentals:manaudit")' href="#cc-Mobile_Device_Fundamentals:manaudit" class="cc-Mobile_Device_Fundamentals:manaudit-ref"><span class="counter">Mobile_Device_Fundamentals:manaudit</span></a></li>
              <li>
                <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>Additional information in <a onclick='showTarget("cc-Mobile_Device_Fundamentals:objaudit")' href="#cc-Mobile_Device_Fundamentals:objaudit" class="cc-Mobile_Device_Fundamentals:objaudit-ref"><span class="counter">Mobile_Device_Fundamentals:objaudit</span></a></span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span> no additional information</span>
</li>
</ul>
</span></li>
                </ol>
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fau__gen.1.2 -->
<div class='aactivity'>

              The evaluator shall check the administrative guide and ensure that it lists all of the auditable events and provides a format for audit records. Each audit record format type must be covered, along with a brief description of each field. The evaluator shall check to make sure that every audit event type mandated by the PP is described and that the description of the fields contains the information required in FAU_GEN.1.2. 
              <br/><br/>
              The evaluator shall also make a determination of the administrative actions that are relevant in the context of this PP including those listed in the Management section. The evaluator shall examine the administrative guide and make a determination of which administrative commands are related to the configuration (including enabling or disabling) of the mechanisms implemented in the TOE that are necessary to enforce the requirements specified in the PP. The evaluator shall document the methodology or approach taken while determining which actions in the administrative guide are security relevant with respect to this PP. The evaluator may perform this activity as part of the activities associated with ensuring the AGD_OPE guidance satisfies the requirements.
              <br/><br/>
              The evaluator shall test the TOE’s ability to correctly generate audit records by having the TOE generate audit records for the events listed in the provided table and administrative actions. This should include all instances of an event. The evaluator shall test that audit records are generated for the establishment and termination of a channel for each of the cryptographic protocols contained in the ST. For administrative actions, the evaluator shall test that each action determined by the evaluator above to be security relevant in the context of this PP is auditable. When verifying the test results, the evaluator shall ensure the audit records generated during testing match the format specified in the administrative guide, and that the fields specified in FAU_GEN.1.2 are contained in each audit record.
              <br/><br/>
              Note that the testing here can be accomplished in conjunction with the testing of the security mechanisms directly. For example, testing performed to ensure that the administrative guidance provided is correct verifies that AGD_OPE.1 is satisfied and should address the invocation of the administrative actions that are needed to verify the audit records are generated as expected.
              <br/><br/>

              
	      

	      <b>
	      <span class='ctr' data-counter-type='ct-Table' id='cc-Mobile_Device_Fundamentals:manaudit'>
Table <span class='counter'>Mobile_Device_Fundamentals:manaudit</span>: Mandatory Auditable Events</span>
	     </b><br/>
              <table>
                <tr class='header'><td>Requirement</td><td>Auditable Events</td><td>Additional Audit Record Contents</td></tr>
               <tr><td>FAU_GEN.1</td><td>None.</td><td></td></tr>
                <tr><td>FAU_STG.1</td><td>None.</td><td></td></tr>
                <tr><td>FAU_STG.4</td><td>None.</td><td></td></tr>
                <tr><td>FCS_CKM_EXT.1</td><td>
                  <span class='selectables' data-rindex='1'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>generation of a REK</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>None</span>
</span>.</td><td>No additional information.</td></tr>
                <tr><td>FCS_CKM_EXT.2</td><td>None.</td><td></td></tr>
                <tr><td>FCS_CKM_EXT.3</td><td>None.</td><td></td></tr>
                <tr><td>FCS_CKM_EXT.4</td><td>None.</td><td></td></tr>
                <tr><td>FCS_CKM_EXT.5</td><td><span class='selectables' data-rindex='2'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>Failure of the wipe</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>None</span>
</span>.</td><td>No additional information.</td></tr>
                <tr><td>FCS_CKM_EXT.6</td><td>None.</td><td></td></tr>
                <tr><td>FCS_CKM.1</td><td><span class='selectables' data-rindex='3'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>Failure of key generation activity for authentication keys</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>None</span>
</li>
</ul>
</span>.</td><td>No additional information.</td></tr>
                <tr><td>FCS_CKM.2(*)</td><td>None.</td><td></td></tr>
                <tr><td>FCS_COP.1(*)</td><td>None.</td><td></td></tr>
                <tr><td>FCS_IV_EXT.1</td><td>None.</td><td></td></tr>
                <tr><td>FCS_SRV_EXT.1</td><td>None.</td><td></td></tr>                
                <tr><td rowspan='2'>FCS_STG_EXT.1</td><td>Import or destruction of key.</td><td rowspan='2'>Identity of key. Role and identity of requestor.</td></tr>
                <tr><td><span class='selectables' data-rindex='4'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>Exceptions to use and destruction rules</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox exclusive'></input><span>No other events</span>
</li>
</ul>
</span></td>
                  </tr>
                <tr><td>FCS_STG_EXT.2</td><td>None.</td><td></td></tr>
                <tr><td>FCS_STG_EXT.3</td><td>Failure to verify integrity of stored key.</td><td>Identity of key being verified.</td></tr>
                <tr><td>FDP_DAR_EXT.1</td><td><span class='selectables' data-rindex='5'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>Failure to encrypt/decrypt data</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>None</span>
</span>.</td><td>No additional information.</td></tr>
                <tr><td>FDP_DAR_EXT.2</td><td>Failure to encrypt/decrypt data.</td><td>No additional information.</td></tr>
                <tr><td>FDP_IFC_EXT.1</td><td>None.</td><td></td></tr>
                <tr><td>FDP_STG_EXT.1</td><td>Addition or removal of certificate from Trust Anchor Database.</td><td>Subject name of certificate.</td></tr>
                <tr><td>FIA_PMG_EXT.1</td><td>None.</td><td></td></tr>
                <tr><td>FIA_TRT_EXT.1</td><td>None.</td><td></td></tr>
                <tr><td>FIA_UAU_EXT.1</td><td>None.</td><td></td></tr>
                <tr><td>FIA_UAU.5</td><td>None.</td><td></td></tr>
                <tr><td>FIA_UAU.7</td><td>None.</td><td></td></tr>
                <tr><td>FIA_X509_EXT.1</td><td>Failure to validate X.509v3 certificate. </td><td>Reason for failure of validation.</td></tr>
                <tr><td>FMT_MOF_EXT.1</td><td>None.</td><td></td></tr>
                <tr><td>FPT_AEX_EXT.1</td><td>None.</td><td></td></tr>
                <tr><td>FPT_AEX_EXT.2</td><td>None.</td><td></td></tr>
                <tr><td>FPT_AEX_EXT.3</td><td>None.</td><td></td></tr>
                <tr><td>FPT_JTA_EXT.1</td><td>None.</td><td></td></tr>
                <tr><td>FPT_KST_EXT.1</td><td>None.</td><td></td></tr>
                <tr><td>FPT_KST_EXT.2</td><td>None.</td><td></td></tr>
                <tr><td>FPT_KST_EXT.3</td><td>None.</td><td></td></tr>
                <tr><td>FPT_NOT_EXT.1</td><td><span class='selectables' data-rindex='6'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>Measurement of TSF software</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>None</span>
</span>.</td><td><span class='selectables' data-rindex='7'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>Integrity verification value</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>No additional information</span>
</li>
</ul>
</span>.</td></tr>
                <tr><td>FPT_STM.1</td><td>None.</td><td></td></tr>
                <tr><td rowspan='2'>FPT_TST_EXT.1</td><td>Initiation of self-test.</td><td rowspan='2'><span class='selectables' data-rindex='8'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>Algorithm that caused the failure</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>none</span>
</span></td></tr><tr><td>Failure of self-test.</td></tr>  
                <tr><td rowspan='2'>FPT_TST_EXT.2(1)</td><td>Start-up of TOE.</td><td>No additional information.</td></tr><tr><td><span class='selectables' data-rindex='9'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>Detected integrity violation</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>none</span>
</span></td><td><span class='selectables' data-rindex='10'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>The TSF code file that caused the integrity violation</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>No additional information</span>
</li>
</ul>
</span></td></tr>      
                <tr><td>FPT_TUD_EXT.1</td><td>None.</td><td></td></tr>
                <tr><td>FTA_SSL_EXT.1</td><td>None.</td><td></td></tr>
              </table>
              <br/>
             
              
              <b><span class='ctr' data-counter-type='ct-Table' id='cc-Mobile_Device_Fundamentals:objaudit'>
Table <span class='counter'>Mobile_Device_Fundamentals:objaudit</span>: Additional Auditable Events</span></b><br/>            
              <table>
                <tr class='header'><td>Requirement</td><td>Auditable Events</td><td>Additional Audit Record Contents</td></tr>
                <tr><td>FAU_SAR.1</td><td>None.</td><td></td></tr>
                <tr><td>FAU_SEL.1</td><td>All modifications to the audit configuration that occur while the audit collection functions are operating. </td><td>No additional Information.</td></tr>
                <tr><td>FCS_CKM_EXT.7</td><td>None.</td><td></td></tr>
                <tr><td>FCS_CKM_EXT.8</td><td>None.</td><td></td></tr>
                <tr><td>FCS_DTLS_EXT.1</td><td>Failure of the certificate validity check.</td><td>Issuer Name and Subject Name of certificate. </td></tr>
                <tr><td>FCS_HTTPS_EXT.1</td><td>Failure of the certificate validity check.</td>
                  <td>Issuer Name and Subject Name of certificate.<br/> 
                    <span class='selectables' data-rindex='11'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>User’s authorization decision</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>No additional information</span>
</li>
</ul>
</span>.</td></tr>
                <tr><td>FCS_RBG_EXT.1</td><td>Failure of the randomization process.</td><td>No additional information.</td></tr>
                <tr><td>FCS_RBG_EXT.2</td><td>None.</td><td></td></tr>
                <tr><td>FCS_RBG_EXT.3</td><td>None.</td><td></td></tr>
                <tr><td>FCS_SRV_EXT.2</td><td>None.</td><td></td></tr>                
                <tr><td rowspan='3'>FCS_TLSC_EXT.1</td><td>Establishment/termination of a TLS session.</td><td>Non-TOE endpoint of connection.</td></tr>
                <tr><td>Failure to establish a TLS session.</td><td>Reason for failure.</td></tr>
                <tr><td>Failure to verify presented identifier.</td><td>Presented identifier and reference identifier.</td></tr>
                <tr><td>FCS_TLSC_EXT.2</td><td>None.</td><td></td></tr>
                <tr><td>FCS_TLSC_EXT.3</td><td>None.</td><td></td></tr>
                <tr><td>FDP_ACF_EXT.1</td><td>None.</td><td></td></tr>
                <tr><td>FDP_ACF_EXT.2</td><td>None.</td><td></td></tr>
                <tr><td>FDP_ACF_EXT.3</td><td>None.</td><td></td></tr>
                <tr><td>FDP_BCK_EXT.1</td><td>None.</td><td></td></tr>
                <tr><td>FDP_BLT_EXT.1</td><td>None.</td><td></td></tr>
                <tr><td>FDP_PBA_EXT.1</td><td>None.</td><td></td></tr>
                <tr><td>FDP_UPC_EXT.1</td><td>Application initiation of trusted channel.</td><td>Name of application. Trusted channel protocol. Non-TOE endpoint of connection.</td></tr>
                <tr><td>FIA_AFL_EXT.1</td><td>Excess of authentication failure limit.</td><td>Authentication factor used.</td></tr>
                <tr><td rowspan='2'>FIA_BLT_EXT.1</td><td>User authorization of Bluetooth device.</td><td rowspan='2'>User authorization decision.<br/>Bluetooth address and name of device.<br/>Bluetooth profile.<br/>Identity of local service.</td></tr>
                <tr><td>User authorization for local Bluetooth service.</td></tr>
                
                <tr><td rowspan='2'>FIA_BLT_EXT.2</td><td>Initiation of Bluetooth connection.</td><td>Bluetooth address and name of device.</td></tr>
                <tr><td>Failure of Bluetooth connection.</td><td>Reason for failure.</td></tr>
                
                <tr><td>FIA_BLT_EXT.3</td><td>Duplicate connection attempt.</td><td>BD_ADDR of connection attempt</td></tr>
                <tr><td>FIA_BLT_EXT.4</td><td>None.</td><td></td></tr>
                <tr><td>FIA_BLT_EXT.5</td><td>None.</td><td></td></tr>
                <tr><td>FIA_BLT_EXT.6</td><td>None.</td><td></td></tr>
                <tr><td>FIA_BMG_EXT.1</td><td>None.</td><td></td></tr>
                <tr><td>FIA_BMG_EXT.2</td><td>None.</td><td></td></tr>
                <tr><td>FIA_BMG_EXT.3</td><td>None.</td><td></td></tr>
                <tr><td>FIA_BMG_EXT.4</td><td>None.</td><td></td></tr>
                <tr><td>FIA_BMG_EXT.5</td><td>None.</td><td></td></tr>
                <tr><td>FIA_BMG_EXT.6</td><td>None.</td><td></td></tr>
                <tr><td>FIA_UAU_EXT.2</td><td>Action performed before authentication.</td><td>No additional information.</td></tr>
                <tr><td>FIA_UAU.6</td><td>User changes Password Authentication Factor.</td><td>No additional information.</td></tr>
                <tr><td>FIA_UAU_EXT.4</td><td>None.</td><td></td></tr>
                <tr><td>FIA_X509_EXT.2</td><td>Failure to establish connection to determine revocation status.</td><td>No additional information.</td></tr>
                <tr><td>FIA_X509_EXT.3</td><td>None.</td><td></td></tr>
                <tr><td rowspan='3'>FIA_X509_EXT.4</td><td>Generation of Certificate Enrollment Request.</td><td>Issuer and Subject name of EST Server. Method of authentication. Issuer and Subject name of certificate used to authenticate. Content of Certificate Request Message.</td></tr>
                <tr><td>Success or failure of enrollment.</td><td>Issuer and Subject name of added certificate or reason for failure.</td></tr>
                <tr><td>Update of EST Trust Anchor Database</td><td>Subject name of added Root CA.</td></tr>
                <tr><td>FIA_X509_EXT.5</td><td>None.</td><td></td></tr>
                <tr><td rowspan='5'>FMT_SMF_EXT.1</td>
                  <td><span class='selectables' data-rindex='12'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>Initiation of policy update</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>none</span>
</span>.</td>
                  <td><span class='selectables' data-rindex='13'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>Policy name</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>none</span>
</span>.</td></tr>
                <tr><td><span class='selectables' data-rindex='14'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>Change of settings</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>none</span>
</span></td>
                  <td><span class='selectables' data-rindex='15'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>Role of user that changed setting</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>Value of new setting</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>none</span>
</li>
</ul>
</span>.</td></tr>
                <tr><td><span class='selectables' data-rindex='16'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>Success of failure of function</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>none</span>
</span></td>
                  <td><span class='selectables' data-rindex='17'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>Role of user that performed function</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>Function performed</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>Reason for failure, none</span>
</li>
</ul>
</span>.</td></tr>
                <tr><td>Initiation of software update.</td><td>Version of update. </td></tr>
                <tr><td>Initiation of application installation or update.</td><td>Name and version of application.</td></tr>
                <tr><td>FMT_SMF_EXT.2</td>
                  <td><span class='selectables' data-rindex='18'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>Unenrollment</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>Initiation of unenrollment</span>
<input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>none</span>
</span></td>
                  <td><span class='selectables' data-rindex='19'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>Identity of administrator Remediation action performed</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>failure of accepting command to unenroll</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>none</span>
</li>
</ul>
</span></td></tr>
                <tr><td>FMT_SMF_EXT.3</td><td>None.</td><td></td></tr>
                <tr><td>FPT_AEX_EXT.4</td><td>None.</td><td></td></tr>
                <tr><td>FPT_AEX_EXT.5</td><td>None.</td><td></td></tr>
                <tr><td>FPT_AEX_EXT.6</td><td>None.</td><td></td></tr>
                <tr><td>FPT_AEX_EXT.7</td><td>None.</td><td></td></tr>
                <tr><td>FPT_BBD_EXT.1</td><td>None.</td><td></td></tr>
                <tr><td>FPT_BLT_EXT.1</td><td>None.</td><td></td></tr>
                <tr><td>FPT_NOT_EXT.2</td><td>None.</td><td></td></tr>
                
                <tr><td>FPT_TST_EXT.2(2)</td><td><span class='selectables' data-rindex='20'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>Detected integrity violation</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>none</span>
</span></td>
                  <td><span class='selectables' data-rindex='21'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>The TSF code file that caused the integrity violation</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>No additional information</span>
</li>
</ul>
</span></td></tr>
                
                <tr><td>FPT_TST_EXT.3</td><td>None.</td><td></td></tr>
                <tr><td rowspan='2'>FPT_TUD_EXT.2</td><td>Success or failure of signature verification for software updates.</td><td>No additional information.</td></tr>
                <tr><td>Success or failure of signature verification for applications.</td><td>No additional information.</td></tr>
                
                <tr><td>FPT_TUD_EXT.3</td><td>None.</td><td></td></tr>
                <tr><td>FPT_TUD_EXT.4</td><td>None.</td><td></td></tr>
                <tr><td>FTA_TAB.1</td><td>None.</td><td></td></tr>
                <tr><td>FTP_BLT_EXT.1</td><td>None.</td><td></td></tr>
                <tr><td>FTP_BLT_EXT.2</td><td>None.</td><td></td></tr>
                <tr><td>FTP_ITC_EXT.1</td><td>Initiation and termination of trusted channel.</td><td>Trusted channel protocol. Non-TOE endpoint of connection.</td></tr>
              </table>
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fau__gen.1 -->
<span class='comp-notes'></span><br/><span class='tooltipped'><input type='checkbox' onchange='handleOCheck(this); return false;'></input></span>
<span id='Mobile_Device_Fundamentals:fau__sar.1' class='component fau__sar.1 disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FAU_SAR.1 &#8212; Audit Review</a><span class='tooltiptext'>objective</span>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fau__sar.1.1' class='requirement fau__sar.1.1'><div class='f-el-title'>FAU_SAR.1.1</div><div class='words'>The TSF shall provide <span class='refinement'>the administrator</span> with the capability to read <span class='refinement'>all audited events and record contents</span> from the audit records.</div>
</div><!-- End: Mobile_Device_Fundamentals:fau__sar.1.1 -->
<div id='Mobile_Device_Fundamentals:fau__sar.1.2' class='requirement fau__sar.1.2'><div class='f-el-title'>FAU_SAR.1.2</div><div class='words'>The TSF shall provide the audit records in a manner suitable for the user to interpret the information.</div>
</div><!-- End: Mobile_Device_Fundamentals:fau__sar.1.2 -->
<div class='aactivity'>
The assurance activity for this requirement is performed in conjunction with test 32 of FMT_SMF_EXT.1.
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fau__sar.1 -->
<span class='comp-notes'></span><br/><span class='tooltipped'><input type='checkbox' onchange='handleOCheck(this); return false;'></input></span>
<span id='Mobile_Device_Fundamentals:fau__sel.1' class='component fau__sel.1 disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FAU_SEL.1 &#8212; Selective Audit</a><span class='tooltiptext'>objective</span>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fau__sel.1.1' class='requirement fau__sel.1.1'><div class='f-el-title'>FAU_SEL.1.1</div><div class='words'>The TSF shall be able to select the set of events to be audited from the set of all auditable events based on the following attributes 
              <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>event type</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>success of auditable security events</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>failure of auditable security events</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span><textarea onchange='update(this);' class='assignment val' rows='1' placeholder='other attributes'></textarea></span>
</li>
</ul>
</span>.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fau__sel.1.1 -->
<div class='aactivity'>
                            
              The evaluator shall review the administrative guidance to ensure that the guidance itemizes all event types, as well as describes all attributes that are to be selectable in accordance with the requirement, to include those attributes listed in the assignment. The administrative guidance shall also contain instructions on how to set the pre-selection as well as explain the syntax (if present) for multi-value pre-selection. The administrative guidance shall also identify those audit records that are always recorded, regardless of the selection criteria currently being enforced.<br/><br/>
              The evaluator shall also perform the following tests:<br/>
              
                For each attribute listed in the requirement, the evaluator shall devise a test to show that selecting the attribute causes only audit events with that attribute (or those that are always recorded, as identified in the administrative guidance) to be recorded.<br/>
                [conditional] If the TSF supports specification of more complex audit pre-selection criteria (e.g., multiple attributes, logical expressions using attributes) then the evaluator shall devise tests showing that this capability is correctly implemented. The evaluator shall also, in the test plan, provide a short narrative justifying the set of tests as representative and sufficient to exercise the capability.
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fau__sel.1 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fau__stg.1' class='component fau__stg.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FAU_STG.1 &#8212; Audit Storage Protection</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fau__stg.1.1' class='requirement fau__stg.1.1'><div class='f-el-title'>FAU_STG.1.1</div><div class='words'>The TSF shall protect the stored audit records in the audit trail from unauthorized deletion. 
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fau__stg.1.1 -->
<div id='Mobile_Device_Fundamentals:fau__stg.1.2' class='requirement fau__stg.1.2'><div class='f-el-title'>FAU_STG.1.2</div><div class='words'>The TSF shall be able to <span class='refinement'>prevent</span> unauthorized modifications to the stored audit records in the audit trail.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fau__stg.1.2 -->
<div class='aactivity'>
The evaluator shall ensure that the TSS lists the location of all logs and the access controls of those files such that unauthorized modification and deletion are prevented.
              
                The evaluator shall attempt to delete the audit trail in a manner that the access controls should prevent (as an unauthorized user) and shall verify that the attempt fails.
                The evaluator shall attempt to modify the audit trail in a manner that the access controls should prevent (as an unauthorized application) and shall verify that the attempt fails.
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fau__stg.1 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fau__stg.4' class='component fau__stg.4'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FAU_STG.4 &#8212; Prevention of Audit Data Loss</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fau__stg.4.1' class='requirement fau__stg.4.1'><div class='f-el-title'>FAU_STG.4.1</div><div class='words'>The TSF shall overwrite the oldest stored audit records if the audit trail is full.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fau__stg.4.1 -->
<div class='aactivity'>

              The evaluator shall examine the TSS to ensure that it describes the size limits on the audit records, the detection of a full audit trail, and the action(s) taken by the TSF when the audit trail is full. The evaluator shall ensure that the action(s) results in the deletion or overwrite of the oldest stored record.
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fau__stg.4 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fcs__ckm.1' class='component fcs__ckm.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_CKM.1 &#8212; Cryptographic key generation</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fcs__ckm.1.1' class='requirement fcs__ckm.1.1'><div class='f-el-title'>FCS_CKM.1.1</div><div class='words'> The TSF shall generate <span class='refinement'>asymmetric</span> cryptographic keys in accordance with a specified cryptographic key generation algorithm 
              <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span><span class='refinement'>RSA schemes using</span> cryptographic key sizes of <span class='refinement'>2048-bit or greater</span> that meet <span class='refinement'>FIPS PUB 186-4, "Digital Signature Standard (DSS)", Appendix B.3</span></span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span><span class='refinement'>ECC schemes using </span><span class='selectables' data-rindex='1'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span><span class='refinement'>"NIST curves" P-384 and </span><span class='selectables' data-rindex='2'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span><span class='refinement'>P-256</span></span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span><span class='refinement'>P-521</span></span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox exclusive'></input><span><span class='refinement'>no other curves</span></span>
</li>
</ul>
</span> that meet the following: <span class='refinement'>FIPS PUB 186-4, "Digital Signature Standard (DSS)", Appendix B.4</span></span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span><span class='refinement'>Curve25519 schemes that meet the following: RFC 7748</span></span>
</li>
</ul>
</span>
                </span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span><span class='refinement'>FFC schemes using </span>cryptographic key sizes of <span class='refinement'>2048-bit or greater</span> that meet the following: <span class='refinement'>FIPS PUB 186-4, "Digital Signature Standard (DSS)", Appendix B.1</span></span>
</li>
</ul>
</span>.               
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__ckm.1.1 -->
<div class='aactivity'>

              The evaluator shall ensure that the TSS identifies the key sizes supported by the TOE. If the ST specifies more than one scheme, the evaluator shall examine the TSS to verify that it identifies the usage for each scheme.
              <br/><br/>
              The evaluator shall verify that the AGD guidance instructs the administrator how to configure the TOE to use the selected key generation scheme(s) and key size(s) for all uses defined in this PP.
              <br/><br/>
              <i>Assurance Activity Note: The following tests require the developer to provide access to a test platform that provides the evaluator with tools that are typically not found on factory products.
              </i><br/><br/>
              <i><b>Key Generation for FIPS PUB 186-4 RSA Schemes</b></i><br/><br/>
              The evaluator shall verify the implementation of RSA Key Generation by the TOE using the Key 
              Generation test. This test verifies the ability of the TSF to correctly produce values for the 
              key components including the public verification exponent <i>e</i>, the private 
              prime factors <i>p</i> and <i>q</i>, 
              the public modulus n and the calculation of the private signature exponent <i>d</i>.
              <br/><br/>
              Key Pair generation specifies 5 ways (or methods) to generate the primes <i>p</i> and <i>q</i>. These include: 
              <ol>
                <li>Random Primes: 
                  <ul>
                    <li>Provable primes</li>
                    <li>Probable primes</li>
                  </ul>
                </li>
                <li>Primes with Conditions:
                  <ul>
                    <li>Primes p1, p2, q1,q2, p and q shall all be provable primes </li>
                    <li>Primes p1, p2, q1, and q2 shall be provable primes and p and q shall be probable primes</li>
                    <li>Primes p1, p2, q1,q2, p and q shall all be probable primes </li>
                  </ul>
                </li>
              </ol>
              To test the key generation method for the Random Provable primes method and for all the Primes with Conditions methods, the evaluator must seed the TSF key generation routine with sufficient data to deterministically generate the RSA key pair. This includes the random seed(s), the public exponent of the RSA key, and the desired key length. For each key length supported, the evaluator shall have the TSF generate 25 key pairs. The evaluator shall verify the correctness of the TSF’s implementation by comparing values generated by the TSF with those generated from a known good implementation.
              <br/><br/>
              If possible, the Random Probable primes method should also be verified against a known good implementation as described above. Otherwise, the evaluator shall have the TSF generate 10 keys pairs for each supported key length nlen and verify:
              <ul>
                <li>n = p*q</li>
                <li>p and q are probably prime according to Miller-Rabin tests</li>
                <li>GCD(p-1,e) = 1</li>
                <li>GCD(q-1,e) = 1</li>
                <li>2^16 &lt; e &lt; 2^256 and e is an odd integer</li>
                <li>|p-q| &gt; 2^(nlen/2 – 100)</li>
                <li>p &gt;= squareroot(2)*( 2^(nlen/2 -1) )</li>
                <li>q &gt;= squareroot(2)*( 2^(nlen/2 -1) )</li>
                <li>2^(nlen/2) &lt; d &lt; LCM(p-1,q-1)</li>
                <li>e*d = 1 mod LCM(p-1,q-1)</li>
              </ul>
              <br/>
              <i><b>Key Generation for FIPS 186-4 Elliptic Curve Cryptography (ECC)</b></i><br/>
              <i>FIPS 186-4 ECC Key Generation Test</i><br/><br/>
              For each supported NIST curve, i.e. P-256, P-384 and P-521, the evaluator shall require the implementation under test (IUT) to generate 10 private/public key pairs. The private key shall be generated using an approved random bit generator (RBG). To determine correctness, the evaluator shall submit the generated key pairs to the public key verification (PKV) function of a known good implementation.
              <br/><br/>
              <i>FIPS 186-4 Public Key Verification (PKV) Test</i><br/><br/>
              For each supported NIST curve, i.e. P-256, P-384 and P-521, the evaluator shall generate 10 private/public key pairs using the key generation function of a known good implementation and modify five of the public key values so that they are incorrect, leaving five values unchanged (i.e. correct). The evaluator shall obtain in response a set of 10 PASS/FAIL values.
              <br/><br/>
              <i><b>Key Generation for Curve25519</b></i><br/><br/>
              The evaluator shall require the implementation under test (IUT) to generate 10 private/public key pairs. The private key shall be generated as specified in RFC 7748 using an approved random bit generator (RBG). To determine correctness, the evaluator shall submit the generated key pairs to the public key verification (PKV) function of a known good implementation.
              <br/><br/>
              Note: Assuming the PKV function of the good implementation will:
              <ol type='a'>
              <li>confirm the private and public keys are 32-byte values</li>
                <li>confirm the three least significant bits of the most significant byte of the private key are zero</li>
                <li>confirm the most significant bit of the least significant byte is zero</li>
                <li>confirm the second most significant bit of the most significant byte is one </li>
                <li>calculate the expected public key from the private key and confirm it matches the supplied public key</li>
              </ol>
	      
              <br/><br/>
              The evaluator shall generate 10 private/public key pairs using the key generation function of a known good implementation and modify 5 of the public key values so that they are incorrect, leaving five values unchanged (i.e. correct). The evaluator shall obtain in response a set of 10 PASS/FAIL values.
              <br/><br/>
              <i><b>Key Generation for Finite-Field Cryptography (FFC)</b></i><br/>
              The evaluator shall verify the implementation of the Parameters Generation and the Key Generation for FFC by the TOE using the Parameter Generation and Key Generation test. This test verifies the ability of the TSF to correctly produce values for the field prime p, the cryptographic prime q (dividing p-1), the cryptographic group generator g, and the calculation of the private key x and public key y.<br/>
              The Parameter generation specifies 2 ways (or methods) to generate the cryptographic prime q and the field prime p:<br/><br/>
              Cryptographic and Field Primes:<br/><br/>
              <ul>
                <li>Primes q and p shall both be provable primes</li>
                <li>Primes q and field prime p shall both be probable primes</li>
              </ul>
              and two ways to generate the cryptographic group generator g:<br/><br/>
              
              Cryptographic Group Generator:<br/><br/>
              <ul><li>Generator g constructed through a verifiable process</li>
              <li>Generator g constructed through an unverifiable process</li>
              </ul>
              The Key generation specifies 2 ways to generate the private key x:<br/><br/>
              Private Key:<br/><br/>
                <ul>
                  <li>len(q) bit output of RBG where 1 &lt;= x &lt;= q-1 </li>
                  <li>len(q) + 64 bit output of RBG, followed by a mod q-1 operation where 1&lt;= x&lt;=q-1</li>
                </ul>
              The security strength of the RBG must be at least that of the security offered by the FFC parameter set.<br/><br/>
              To test the cryptographic and field prime generation method for the provable primes method and/or the group generator g for a verifiable process, the evaluator must seed the TSF parameter generation routine with sufficient data to deterministically generate the parameter set.<br/><br/>
              
              For each key length supported, the evaluator shall have the TSF generate 25 parameter sets and key pairs. The evaluator shall verify the correctness of the TSF’s implementation by comparing values generated by the TSF with those generated from a known good implementation. Verification must also confirm<br/>
              <ul><li>g != 0,1</li>
                <li>q divides p-1</li>
                <li>g^q mod p = 1</li>
                <li>g^x mod p = y</li>
              </ul>
              <br/>
              for each FFC parameter set and key pair.
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fcs__ckm.1 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fcs__ckm.2_l1_r' class='component fcs__ckm.2_l1_r'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_CKM.2(1) &#8212; Cryptographic key establishment</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fcs__ckm.2.1_l1_r' class='requirement fcs__ckm.2.1_l1_r'><div class='f-el-title'>FCS_CKM.2.1(1)</div><div class='words'>The TSF shall <span class='refinement'>perform</span> cryptographic <span class='refinement'>key establishment</span> in accordance with a specified cryptographic key <span class='refinement'>establishment</span> method:
              <ul><li><span class='refinement'>RSA-based key establishment schemes</span> that meets the following: <span class='refinement'>NIST Special Publication 800-56B, "Recommendation for Pair-Wise Key Establishment Schemes Using Integer Factorization Cryptography"</span>
              </li></ul>
              and 
              <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span><span class='refinement'>Elliptic curve-based key establishment schemes</span> that meets the following: <span class='refinement'>NIST Special Publication 800-56A, "Recommendation for Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography"</span></span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span><span class='refinement'>Finite field-based key establishment schemes</span> that meets the following: <span class='refinement'>NIST Special Publication 800-56A, "Recommendation for Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography"</span></span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox exclusive'></input><span><span class='refinement'>No other schemes</span></span>
</li>
</ul>
</span>.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__ckm.2.1_l1_r -->
<div class='aactivity'>

              The evaluator shall ensure that the supported key establishment schemes correspond to the key generation schemes identified in FCS_CKM.1.1. If the ST specifies more than one scheme, the evaluator shall examine the TSS to verify that it identifies the usage for each scheme. 
              <br/><br/>
              The evaluator shall verify that the AGD guidance instructs the administrator how to configure the TOE to use the selected key establishment scheme(s).
              <br/><br/>
              Assurance Activity Note: The following tests require the developer to provide access to a test platform that provides the evaluator with tools that are typically not found on factory products.
              <br/><br/>
              <b>Key Establishment Schemes</b>
              <br/><br/>
              The evaluator shall verify the implementation of the key establishment schemes supported by the TOE using the applicable tests below. 
              <br/><br/>
                <i><b>SP800-56A Key Establishment Schemes</b></i>
              <br/><br/>
              The evaluator shall verify a TOE's implementation of SP800-56A key agreement schemes using the following Function and Validity tests. These validation tests for each key agreement scheme verify that a TOE has implemented the components of the key agreement scheme according to the specifications in the Recommendation. These components include the calculation of the DLC primitives (the shared secret value Z) and the calculation of the derived keying material (DKM) via the Key Derivation Function (KDF). If key confirmation is supported, the evaluator shall also verify that the components of key confirmation have been implemented correctly, using the test procedures described below. This includes the parsing of the DKM, the generation of MACdata and the calculation of MACtag.
              <br/><br/>
                  <i><b>Function Test</b></i>
              <br/><br/>
              The Function test verifies the ability of the TOE to implement the key agreement schemes correctly. To conduct this test the evaluator shall generate or obtain test vectors from a known good implementation of the TOE supported schemes. For each supported key agreement scheme-key agreement role combination, KDF type, and, if supported, key confirmation role- key confirmation type combination, the tester shall generate 10 sets of test vectors. The data set consists of one set of domain parameter values (FFC) or the NIST approved curve (ECC) per 10 sets of public keys. These keys are static, ephemeral or both depending on the scheme being tested.
              <br/><br/>
              The evaluator shall obtain the DKM, the corresponding TOE’s public keys (static and/or ephemeral), the MAC tag(s), and any inputs used in the KDF, such as the Other Information field OI and TOE id fields.
              <br/><br/>
              If the TOE does not use a KDF defined in SP 800-56A, the evaluator shall obtain only the public keys and the hashed value of the shared secret.
              <br/><br/>
              The evaluator shall verify the correctness of the TSF’s implementation of a given scheme by using a known good implementation to calculate the shared secret value, derive the keying material DKM, and compare hashes or MAC tags generated from these values.<br/><br/>
                    If key confirmation is supported, the TSF shall perform the above for each implemented approved MAC algorithm.
              <br/><br/>
                    <i><b>Validity Test</b></i>
              <br/><br/>
              The Validity test verifies the ability of the TOE to recognize another party’s valid and invalid key agreement results with or without key confirmation. To conduct this test, the evaluator shall obtain a list of the supporting cryptographic functions included in the SP800-56A key agreement implementation to determine which errors the TOE should be able to recognize. The evaluator generates a set of 24 (FFC) or 30 (ECC) test vectors consisting of data sets including domain parameter values or NIST approved curves, the evaluator’s public keys, the TOE’s public/private key pairs, MACTag, and any inputs used in the KDF, such as the other info and TOE id fields.
              <br/><br/>
              The evaluator shall inject an error in some of the test vectors to test that the TOE recognizes invalid key agreement results caused by the following fields being incorrect: the shared secret value Z, the DKM, the other information field OI, the data to be MACed, or the generated MACTag. If the TOE contains the full or partial (only ECC) public key validation, the evaluator will also individually inject errors in both parties’ static public keys, both parties’ ephemeral public keys and the TOE’s static private key to assure the TOE detects errors in the public key validation function and/or the partial key validation function (in ECC only). At least two of the test vectors shall remain unmodified and therefore should result in valid key agreement results (they should pass).
              <br/><br/>
              The TOE shall use these modified test vectors to emulate the key agreement scheme using the corresponding parameters. The evaluator shall compare the TOE’s results with the results using a known good implementation verifying that the TOE detects these errors.
              <br/><br/>
                      <i><b>SP800-56B Key Establishment Schemes</b></i>
              <br/><br/>
              The evaluator shall verify that the TSS describes whether the TOE acts as a sender, a recipient, or both for RSA-based key establishment schemes.
              <br/><br/>
              If the TOE acts as a sender, the following assurance activity shall be performed to ensure the proper operation of every TOE supported combination of RSA-based key establishment scheme:
              <br/><br/>
              To conduct this test the evaluator shall generate or obtain test vectors from a known good implementation of the TOE supported schemes. For each combination of supported key establishment scheme and its options (with or without key confirmation if supported, for each supported key confirmation MAC function if key confirmation is supported, and for each supported mask generation function if KTS-OAEP is supported), the tester shall generate 10 sets of test vectors. Each test vector shall include the RSA public key, the plaintext keying material, any additional input parameters if applicable, the MacKey and MacTag if key confirmation is incorporated, and the outputted ciphertext. For each test vector, the evaluator shall perform a key establishment encryption operation on the TOE with the same inputs (in cases where key confirmation is incorporated, the test shall use the MacKey from the test vector instead of the randomly generated MacKey used in normal operation) and ensure that the outputted ciphertext is equivalent to the ciphertext in the test vector.
              <br/><br/>
              If the TOE acts as a receiver, the following assurance activities shall be performed to ensure the proper operation of every TOE supported combination of RSA-based key establishment scheme:
              <br/><br/>
              To conduct this test the evaluator shall generate or obtain test vectors from a known good implementation of the TOE supported schemes. For each combination of supported key establishment scheme and its options (with our without key confirmation if supported, for each supported key confirmation MAC function if key confirmation is supported, and for each supported mask generation function if KTS-OAEP is supported), the tester shall generate 10 sets of test vectors. Each test vector shall include the RSA private key, the plaintext keying material (KeyData), any additional input parameters if applicable, the MacTag in cases where key confirmation is incorporated, and the outputted ciphertext. For each test vector, the evaluator shall perform the key establishment decryption operation on the TOE and ensure that the outputted plaintext keying material (KeyData) is equivalent to the plaintext keying material in the test vector. In cases where key confirmation is incorporated, the evaluator shall perform the key confirmation steps and ensure that the outputted MacTag is equivalent to the MacTag in the test vector.
              <br/><br/>
              The evaluator shall ensure that the TSS describes how the TOE handles decryption errors. In accordance with NIST Special Publication 800-56B, the TOE must not reveal the particular error that occurred, either through the contents of any outputted or logged error message or through timing variations. If KTS-OAEP is supported, the evaluator shall create separate contrived ciphertext values that trigger each of the three decryption error checks described in NIST Special Publication 800-56B section 7.2.2.3, ensure that each decryption attempt results in an error, and ensure that any outputted or logged error message is identical for each. If KTS-KEM-KWS is supported, the evaluator shall create separate contrived ciphertext values that trigger each of the three decryption error checks described in NIST Special Publication 800-56B section 7.2.3.3, ensure that each decryption attempt results in an error, and ensure that any outputted or logged error message is identical for each.
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fcs__ckm.2_l1_r -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fcs__ckm.2_l2_r' class='component fcs__ckm.2_l2_r'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_CKM.2(2) &#8212; Cryptographic key establishment (While device is locked)</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fcs__ckm.2.1_l2_r' class='requirement fcs__ckm.2.1_l2_r'><div class='f-el-title'>FCS_CKM.2.1(2)</div><div class='words'>The TSF shall <span class='refinement'>perform</span> cryptographic <span class='refinement'>key establishment</span> in accordance with a specified cryptographic key <span class='refinement'>establishment</span> method:
              <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span><span class='refinement'>RSA-based key establishment schemes</span> that meets the following: <span class='refinement'>NIST Special Publication 800-56B, "Recommendation for Pair-Wise Key Establishment Schemes Using Integer Factorization Cryptography"</span></span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span><span class='refinement'>Elliptic curve-based key establishment schemes</span> that meets the following: 
                    <span class='selectables' data-rindex='1'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span><span class='refinement'>NIST Special Publication 800-56A, "Recommendation for Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography"</span></span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span><span class='refinement'>RFC 7748, "Elliptic Curves for Security"</span></span>
</li>
</ul>
</span>
                </span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span><span class='refinement'>Finite field-based key establishment schemes</span> that meets the following: <span class='refinement'>NIST Special Publication 800-56A, "Recommendation for Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography"</span></span>
</li>
</ul>
</span>
              <span class='refinement'>for the purposes of encrypting sensitive data received while the device is locked.</span>
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__ckm.2.1_l2_r -->
<div class='aactivity'>

              The test for SP800-56A and SP800-56B key establishment schemes is performed in association with FCS_CKM.2.1(1).
              <br/><br/>
              <b>Curve25519 Key Establishment Schemes</b><br/><br/>
              The evaluator shall verify a TOE's implementation of the key agreement scheme using the following Function and Validity tests. These validation tests for each key agreement scheme verify that a TOE has implemented the components of the key agreement scheme according to the specification. These components include the calculation of the shared secret K and the hash of K.
              <br/><br/>
              <b>Function Test</b><br/><br/>
              The Function test verifies the ability of the TOE to implement the key agreement schemes correctly. To conduct this test the evaluator shall generate or obtain test vectors from a known good implementation of the TOE supported schemes. For each supported key agreement role and hash function combination, the tester shall generate 10 sets of public keys. These keys are static, ephemeral or both depending on the scheme being tested.
              <br/><br/>
              The evaluator shall obtain the shared secret value K, and the hash of K.<br/><br/>
              The evaluator shall verify the correctness of the TSF’s implementation of a given scheme by using a known good implementation to calculate the shared secret value K and compare the hash generated from this value.
              <br/><br/>
              <b> Validity Test</b><br/><br/>
              The Validity test verifies the ability of the TOE to recognize another party’s valid and invalid key agreement results. To conduct this test, the evaluator generates a set of 30 test vectors consisting of data sets including the evaluator’s public keys and the TOE’s public/private key pairs.
              <br/><br/>
              The evaluator shall inject an error in some of the test vectors to test that the TOE recognizes invalid key agreement results caused by the following fields being incorrect: the shared secret value K or the hash of K. At least two of the test vectors shall remain unmodified and therefore should result in valid key agreement results (they should pass).
              <br/><br/>
              The TOE shall use these modified test vectors to emulate the key agreement scheme using the corresponding parameters. The evaluator shall compare the TOE’s results with the results using a known good implementation verifying that the TOE detects these errors.
              <br/><br/>
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fcs__ckm.2_l2_r -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fcs__ckm__ext.1' class='component fcs__ckm__ext.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_CKM_EXT.1 &#8212; Extended: Cryptographic Key Support</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fcs__ckm__ext.1.1' class='requirement fcs__ckm__ext.1.1'><div class='f-el-title'>FCS_CKM_EXT.1.1</div><div class='words'>The TSF shall support 
              <span class='selectables' data-rindex='0'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>immutable hardware</span>
<input type='checkbox' id='Mobile_Device_Fundamentals:mutable_hardware' onchange='update(this); ' data-rindex='1' class='val selbox mutable_hardware'></input><span>mutable hardware</span>
</span> REK(s) with a 
              <span class='selectables' data-rindex='1'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>symmetric</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>asymmetric</span>
</span> key of strength 
              <span class='selectables' data-rindex='2'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>112 bits</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>128 bits</span>
<input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>192 bits</span>
<input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span>256 bits</span>
</span>. 
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__ckm__ext.1.1 -->
<div id='Mobile_Device_Fundamentals:fcs__ckm__ext.1.2' class='requirement fcs__ckm__ext.1.2'><div class='f-el-title'>FCS_CKM_EXT.1.2</div><div class='words'>Each REK shall be hardware-isolated from Rich OS on the TSF in runtime. 
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__ckm__ext.1.2 -->
<div id='Mobile_Device_Fundamentals:fcs__ckm__ext.1.3' class='requirement fcs__ckm__ext.1.3'><div class='f-el-title'>FCS_CKM_EXT.1.3</div><div class='words'>Each REK shall be generated by a RBG in accordance with FCS_RBG_EXT.1. 
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__ckm__ext.1.3 -->
<div class='aactivity'>

              The evaluator shall review the TSS to determine that a REK is supported by the TOE, that the TSS includes a description of the protection provided by the TOE for a REK, and that the TSS includes a description of the method of generation of a REK.
              <br/><br/>
              The evaluator shall verify that the description of the protection of a REK describes how any reading, import, and export of that REK is prevented. (For example, if the hardware protecting the REK is removable, the description should include how other devices are prevented from reading the REK.) The evaluator shall verify that the  TSS describes how encryption/decryption/derivation actions are isolated so as to prevent applications and system-level processes from reading the REK while allowing encryption/decryption/derivation by the key.
              <br/><br/>
              The evaluator shall verify that the description includes how the Rich OS is prevented from accessing the memory containing REK key material, which software is allowed access to the REK, how any other software in the execution environment is prevented from reading that key material, and what other mechanisms prevent the REK key material from being written to shared memory locations between the Rich OS and the separate execution environment.
              <br/><br/>
              If key derivation is performed using a REK, the evaluator shall ensure that the  TSS description includes a description of the key derivation function and shall verify the key derivation uses an approved derivation mode and key expansion algorithm according to FCS_CKM_EXT.3.2. 
              <br/><br/>
              The evaluator shall verify that the generation of a REK meets the FCS_RBG_EXT.1.1 and FCS_RBG_EXT.1.2 requirements:
              <br/><br/>
              <ul>
                <li>If REK(s) is/are generated on-device, the  TSS shall include a description of the generation mechanism including what triggers a generation, how the functionality described by FCS_RBG_EXT.1 is invoked, and whether a separate instance of the RBG is used for REK(s).</li>
                <li>If REK(s) is/are generated off-device, the  TSS shall include evidence that the RBG meets FCS_RBG_EXT.1. This will likely necessitate a second set of RBG documentation equivalent to the documentation provided for the RBG assurance activities. In addition, the  TSS shall describe the manufacturing process that prevents the device manufacturer from accessing any REK(s).</li>
              </ul>
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fcs__ckm__ext.1 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fcs__ckm__ext.2' class='component fcs__ckm__ext.2'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_CKM_EXT.2 &#8212; Extended: Cryptographic Key Random Generation</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fcs__ckm__ext.2.1' class='requirement fcs__ckm__ext.2.1'><div class='f-el-title'>FCS_CKM_EXT.2.1</div><div class='words'>All DEKs shall be randomly generated with entropy corresponding to the security strength of AES key sizes of 
              <span class='selectables' data-rindex='0'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>128</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>256</span>
</span> bits.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__ckm__ext.2.1 -->
<div class='aactivity'>

              The evaluator shall review the  TSS to determine that it describes how the functionality described by FCS_RBG_EXT.1 is invoked to generate DEKs. The evaluator uses the description of the RBG functionality in FCS_RBG_EXT.1 or documentation available for the operational environment to determine that the key size being requested is identical to the key size and mode to be used for the encryption/decryption of the data.
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fcs__ckm__ext.2 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fcs__ckm__ext.3' class='component fcs__ckm__ext.3'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_CKM_EXT.3 &#8212; Extended: Cryptographic Key Generation</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fcs__ckm__ext.3.1' class='requirement fcs__ckm__ext.3.1'><div class='f-el-title'>FCS_CKM_EXT.3.1</div><div class='words'>The TSF shall use 
              <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>asymmetric KEKs of <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='security strength greater than or equal to 112 bits'></textarea> security strength</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>symmetric KEKs of    <span class='selectables' data-rindex='1'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>128-bit</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>256-bit</span>
</span> security strength
              corresponding to at least the security strength of the keys encrypted by the KEK</span>
</li>
</ul>
</span>.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__ckm__ext.3.1 -->
<div id='Mobile_Device_Fundamentals:fcs__ckm__ext.3.2' class='requirement fcs__ckm__ext.3.2'><div class='f-el-title'>FCS_CKM_EXT.3.2</div><div class='words'>The TSF shall generate all KEKs using one of the following methods:        
              <ul><li>Derive the KEK from a Password Authentication Factor using PBKDF and </li></ul>
              <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>Generate the KEK using an RBG that meets this profile (as specified in FCS_RBG_EXT.1)</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>Generate the KEK using a key generation scheme that meets this profile (as specified in FCS_CKM.1)</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>Combine the KEK from other KEKs in a way that preserves the effective entropy of each factor by 
                      <span class='selectables' data-rindex='1'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>using an XOR operation</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>concatenating the keys and using a KDF (as described in SP 800-108)</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>concatenating the keys and using a KDF (as described in SP 800-56C)</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span>encrypting one key with another</span>
</li>
</ul>
</span>
                </span>
</li>
</ul>
</span>.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__ckm__ext.3.2 -->
<div class='aactivity'>
The evaluator shall examine the key hierarchy section of the TSS to ensure that the formation of all KEKs is described and that the key sizes match that described by the ST author. The evaluator shall examine the key hierarchy section of the  TSS to ensure that each key (DEKs, software-based key storage, and KEKs) is encrypted by keys of equal or greater security strength using one of the selected methods.
              <br/>
              <ul>
                <li>The evaluator shall review the  TSS to verify that it contains a description of the PBKDF use to derive KEKs. This description must include the size and storage location of salts. This activity may be performed in combination with that for FCS_COP.1(5).</li>
                <li>If the symmetric KEK is generated by an RBG, the evaluator shall review the  TSS to determine that it describes how the functionality described by FCS_RBG_EXT.1 is invoked. The evaluator uses the description of the RBG functionality in FCS_RBG_EXT.1 or documentation available for the operational environment to determine that the key size being requested is greater than or equal to the key size and mode to be used for the encryption/decryption of the data.</li>
                <li>If the KEK is generated according to an asymmetric key scheme, the evaluator shall review the  TSS to determine that it describes how the functionality described by FCS_CKM.1 is invoked. The evaluator uses the description of the key generation functionality in FCS_CKM.1 or documentation available for the operational environment to determine that the key strength being requested is greater than or equal to 112 bits.</li>
                <li>If the KEK is formed from a combination, the evaluator shall verify that the  TSS describes the method of combination and that this method is either an XOR, a KDF, or encryption. </li>
              </ul>
              <br/>
              (conditional) If a KDF is used, the evaluator shall ensure that the  TSS includes a description of the key derivation function and shall verify the key derivation uses an approved derivation mode and key expansion algorithm according to SP 800-108. 
              <br/><br/>
              If "concatenating the keys and using a KDF (as described in (SP 800-56C)" is selected, the evaluator shall ensure the TSS includes a description of the randomness extraction step. 
              <ul>
                <li>The description must include how an approved untruncated MAC function is being used for the randomness extraction step and the evaluator must verify the TSS describes that the output length (in bits) of the MAC function is at least as large as the targeted security strength (in bits) of the parameter set employed by the key establishment scheme (see Tables 1-3 of SP 800-56C).</li>
                <li>The description must include how the MAC function being used for the randomness extraction step is related to the PRF used in the key expansion and verify the TSS description includes the correct MAC function:</li>
                <ul>
                  <li>If an HMAC-hash is used in the randomness extraction step, then the same HMAC-hash (with the same hash function hash) is used as the PRF in the key expansion step.</li>
                  <li>If an AES-CMAC (with key length 128, 192, or 256 bits) is used in the randomness extraction step, then AES-CMAC with a 128-bit key is used as the PRF in the key expansion step.</li>
                  </ul>
                <li>The description must include the lengths of the salt values being used in the randomness extraction step and the evaluator shall verify the TSS description includes correct salt lengths:</li>
                <ul>
                  <li>If an HMAC-hash is being used as the MAC, the salt length can be any value up to the maximum bit length permitted for input to the hash function hash.</li>
                  <li>If an AES-CMAC is being used as the MAC, the salt length shall be the same length as the AES key (i.e. 128, 192, or 256 bits). </li>
                  </ul>               
              </ul>

              If a KDF is used, the evaluator shall perform one or more of the following tests to verify the correctness of the key derivation function, depending on the mode(s) that are supported.  <a onclick='showTarget("cc-Mobile_Device_Fundamentals:KDF")' href="#cc-Mobile_Device_Fundamentals:KDF" class="cc-Mobile_Device_Fundamentals:KDF-ref"><span class="counter">Mobile_Device_Fundamentals:KDF</span></a> maps the data fields to the notations used in SP 800-108 and SP 800-56C.
              <br/><br/>
              <b>
                <span class='ctr' data-counter-type='ct-Table' id='cc-Mobile_Device_Fundamentals:KDF'>
Table <span class='counter'>Mobile_Device_Fundamentals:KDF</span>: Notations used in SP 800-108 and SP 800-56C</span>
              </b><br/>
              <table>
                <tr class='header'><td>Data Fields</td><td colspan='2'>Notations</td></tr>
                <tr class='header'><td></td><td>SP 800-108</td><td>SP 800-56C</td></tr>
                <tr><td>Pseudorandom function</td><td>PRF</td><td>PRF</td></tr>
                <tr><td>Counter length</td><td>r</td><td>r</td></tr>
                <tr><td>Length of output of PRF</td><td>h</td><td>h</td></tr>
                <tr><td>Length of derived keying material</td><td>L</td><td>L</td></tr>
                <tr><td>Length of input values</td><td>I_length</td><td>I_length</td></tr>
                <tr><td>Pseudorandom input values I</td><td>K<sub>1</sub> (key derivation key)</td><td>Z (shared secret)</td></tr>
                <tr><td>Pseudorandom salt values</td><td>n/a</td><td>s</td></tr>
                <tr><td>Randomness extraction MAC</td><td>n/a</td><td>MAC</td></tr>
              
              
              
              
              </table>
            
              <br/><br/>
              <b>Counter Mode Tests:</b>
              <br/><br/>
              The evaluator shall determine the following characteristics of the key derivation function:
              <ul><li>One or more pseudorandom functions that are supported by the implementation (PRF).</li>
                <li>One or more of the values {8, 16, 24, 32} that equal the length of the binary representation of the counter (r).</li>
                  <li>The length (in bits) of the output of the PRF (h).</li>
                <li>Minimum and maximum values for the length (in bits) of the derived keying material (L). These values can be equal if only one value of L is supported. These must be evenly divisible by h.</li>
                      <li>Up to two values of L that are NOT evenly divisible by h.</li>
                      <li>Location of the counter relative to fixed input data: before, after, or in the middle.
                <ul> 
                  <li>Counter before fixed input data: fixed input data string length (in bytes), fixed input data string value. </li>
                  <li>Counter after fixed input data: fixed input data string length (in bytes), fixed input data string value.</li>
                  <li>Counter in the middle of fixed input data: length of data before counter (in bytes), length of data after counter (in bytes), value of string input before counter, value of string input after counter.</li>                                  
                </ul></li>
                <li>The length (I_length) of the input values I.</li>
                
              </ul><br/>
              For each supported combination of I_length, MAC, salt, PRF, counter location, value of r, and value of L, the evaluator shall generate 10 test vectors that include pseudorandom input values I, and pseudorandom salt values. If there is only one value of L that is evenly divisible by h, the evaluator shall generate 20 test vectors for it. For each test vector, the evaluator shall supply this data to the TOE in order to produce the keying material output.
              <br/><br/>
              
              The results from each test may either be obtained by the evaluator directly or by supplying the inputs to the implementer and receiving the results in response. To determine correctness, the evaluator shall compare the resulting values to those obtained by submitting the same inputs to a known good implementation.
              <br/><br/>
              
              <b>Feedback Mode Tests:</b>
              <br/>
              The evaluator shall determine the following characteristics of the key derivation function:<br/>
              <ul><li>One or more pseudorandom functions that are supported by the implementation (PRF).</li>
                <li>The length (in bits) of the output of the PRF (h).</li>
                  <li>Minimum and maximum values for the length (in bits) of the derived keying material (L). These values can be equal if only one value of L is supported. These must be evenly divisible by h.</li>
                    <li>Up to two values of L that are NOT evenly divisible by h.</li>
                      <li>Whether or not zero-length IVs are supported.</li>
                        <li>Whether or not a counter is used, and if so:
                          <ul>
                            <li>One or more of the values {8, 16, 24, 32} that equal the length of the binary representation of the counter (r).</li>
                            <li>Location of the counter relative to fixed input data: before, after, or in the middle.</li>
                            <ul><li>Counter before fixed input data: fixed input data string length (in bytes), fixed input data string value.</li>
                              <li>Counter after fixed input data: fixed input data string length (in bytes), fixed input data string value.</li>
                              <li>Counter in the middle of fixed input data: length of data before counter (in bytes), length of data after counter (in bytes), value of string input before counter, value of string input after counter.</li>
                            </ul>
                          </ul>
                        </li>
                <li>The length (I_length) of the input values I.</li>
                  </ul><br/>
              For each supported combination of I_length, MAC, salt, PRF, counter location (if a counter is used), value of r (if a counter is used), and value of L, the evaluator shall generate 10 test vectors that include pseudorandom input values I and pseudorandom salt values. If the KDF supports zero-length IVs, five of these test vectors will be accompanied by pseudorandom IVs and the other five will use zero-length IVs. If zero-length IVs are not supported, each test vector will be accompanied by an pseudorandom IV. If there is only one value of L that is evenly divisible by h, the evaluator shall generate 20 test vectors for it. 
              <br/><br/>
              For each test vector, the evaluator shall supply this data to the TOE in order to produce the keying material output. The results from each test may either be obtained by the evaluator directly or by supplying the inputs to the implementer and receiving the results in response. To determine correctness, the evaluator shall compare the resulting values to those obtained by submitting the same inputs to a known good implementation.
              <br/><br/>
             
              <b>Double Pipeline Iteration Mode Tests:</b>
              <br/><br/>
              The evaluator shall determine the following characteristics of the key derivation function:
              <br/><br/>
              <ul><li>One or more pseudorandom functions that are supported by the implementation (PRF).</li>
                <li>The length (in bits) of the output of the PRF (h).</li>
                  <li>Minimum and maximum values for the length (in bits) of the derived keying material (L). These values can be equal if only one value of L is supported. These must be evenly divisible by h.</li>
                    <li>Up to two values of L that are NOT evenly divisible by h.</li>
                      <li>Whether or not a counter is used, and if so:
                        <ul>
                          <li>One or more of the values {8, 16, 24, 32} that equal the length of the binary representation of the counter (r).</li>
                          <li>Location of the counter relative to fixed input data: before, after, or in the middle.
                 <ul><li>Counter before fixed input data: fixed input data string length (in bytes), fixed input data string value.</li>
                              <li>Counter after fixed input data: fixed input data string length (in bytes), fixed input data string value.</li>
                              <li>Counter in the middle of fixed input data: length of data before counter (in bytes), length of data after counter (in bytes), value of string input before counter, value of string input after counter.</li>
                            </ul>       
                        </li>
                        </ul>
                      </li>
                <li>The length (I_length) of the input values I.</li>
                      </ul><br/>
              For each supported combination of I_length, MAC, salt, PRF, counter location (if a counter is used), value of r (if a counter is used), and value of L, the evaluator shall generate 10 test vectors that include pseudorandom input values I, and pseudorandom salt values. If there is only one value of L that is evenly divisible by h, the evaluator shall generate 20 test vectors for it. 
              <br/><br/>
              For each test vector, the evaluator shall supply this data to the TOE in order to produce the keying material output. The results from each test may either be obtained by the evaluator directly or by supplying the inputs to the implementer and receiving the results in response. To determine correctness, the evaluator shall compare the resulting values to those obtained by submitting the same inputs to a known good implementation.
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fcs__ckm__ext.3 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fcs__ckm__ext.4' class='component fcs__ckm__ext.4'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_CKM_EXT.4 &#8212; Extended: Key Destruction</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fcs__ckm__ext.4.1' class='requirement fcs__ckm__ext.4.1'><div class='f-el-title'>FCS_CKM_EXT.4.1</div><div class='words'>The TSF shall destroy cryptographic keys in accordance with the specified cryptographic key destruction methods: 
              <br/>
              <ul>
                <li>by clearing the KEK encrypting the target key</li>
                <li>in accordance with the following rules
                  <ul><li>For volatile memory, the destruction shall be executed by a single direct overwrite 
                    <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>consisting of a pseudo-random pattern using the TSF’s RBG</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>consisting of zeroes</span>
</li>
</ul>
</span>.</li>
                    <li>For non-volatile EEPROM, the destruction shall be executed by a single direct overwrite consisting of a pseudo random pattern using the TSF’s RBG (as specified in FCS_RBG_EXT.1), followed by a read-verify.</li>
                      <li>For non-volatile flash memory, that is not wear-leveled, the destruction shall be executed 
                        <span class='selectables' data-rindex='1'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>by a single direct overwrite consisting of zeros followed by a read-verify</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>by a block erase that erases the reference to memory that stores data as well as the data itself
                            </span>
</li>
</ul>
</span>.</li>
                        <li>For non-volatile flash memory, that is wear-leveled, the destruction shall be executed 
                          <span class='selectables' data-rindex='2'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>by a single direct overwrite consisting of zeros</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>by a block erase</span>
</li>
</ul>
</span>.</li>
                    <li>For non-volatile memory other than EEPROM and flash, the destruction shall be executed by a single direct overwrite with a random pattern that is changed before each write.</li>
                  </ul>
                </li>
              </ul>
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__ckm__ext.4.1 -->
<div id='Mobile_Device_Fundamentals:fcs__ckm__ext.4.2' class='requirement fcs__ckm__ext.4.2'><div class='f-el-title'>FCS_CKM_EXT.4.2</div><div class='words'>The TSF shall destroy all plaintext keying material and critical security parameters when no longer needed.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__ckm__ext.4.2 -->
<div class='aactivity'>

              The evaluator shall check to ensure the  TSS lists each type of plaintext key material (DEKs, software-based key storage, KEKs, trusted channel keys, passwords, etc.) and its generation and storage location.
              <br/><br/>
              The evaluator shall verify that the  TSS describes when each type of key material is cleared (for example, on system power off, on wipe function, on disconnection of trusted channels, when no longer needed by the trusted channel per the protocol, when transitioning to the locked state, and possibly including immediately after use, while in the locked state, etc.). 
              <br/><br/>
              The evaluator shall also verify that, for each type of key, the type of clearing procedure that is performed (cryptographic erase, overwrite with zeros, overwrite with random pattern, or block erase) is listed. If different types of memory are used to store the materials to be protected, the evaluator shall check to ensure that the  TSS describes the clearing procedure in terms of the memory in which the data are stored. 
              <br/><br/>
              Assurance Activity Note 1: The following tests require the developer to provide access to a test platform that provides the evaluator with tools that are typically not found on factory products. 
              <br/><br/>
              For each software and firmware key clearing situation (including on system power off, on wipe function, on disconnection of trusted channels, when no longer needed by the trusted channel per the protocol, when transitioning to the locked state, and possibly including immediately after use, while in the locked state) the evaluator shall repeat the following tests. 
              <br/><br/>
              For these tests the evaluator shall utilize appropriate development environment (e.g. a Virtual Machine) and development tools (debuggers, simulators, etc.) to test that keys are cleared, including all copies of the key that may have been created internally by the TOE during normal cryptographic processing with that key.
              <br/><br/>
              
                
                  Applied to each key held as plaintext in volatile memory and subject to destruction by overwrite by the TOE (whether or not the plaintext value is subsequently encrypted for storage in volatile or non-volatile memory). In the case where the only selection made for the destruction method key was removal of power, then this test is unnecessary. The evaluator shall:
                  <br/>
                  <ol>
                    <li>Record the value of the key in the TOE subject to clearing.</li>
                    <li>Cause the TOE to perform a normal cryptographic processing with the key from Step #1.</li>
                    <li>Cause the TOE to clear the key.</li>
                    <li>Cause the TOE to stop the execution but not exit.</li>
                    <li>Cause the TOE to dump the entire memory of the TOE into a binary file.</li>
                    <li>Search the content of the binary file created in Step #5 for instances of the known key value from Step #1.</li>
                    <li>Break the key value from Step #1 into 3 similar sized pieces and perform a search using each piece.</li>
                  </ol>
                  <br/>
                  Steps 1-6 ensure that the complete key does not exist anywhere in volatile memory. If a copy is found, then the test fails.
                  <br/><br/>
                  Step 7 ensures that partial key fragments do not remain in memory. If a fragment is found, there is a minuscule chance that it is not within the context of a key (e.g., some random bits that happen to match). If this is the case the test should be repeated with a different key in Step #1. If a fragment is found the test fails.
                  <br/><br/>
                
                
                  Applied to each key held in non-volatile memory and subject to destruction by overwrite by the TOE. The evaluator shall use special tools (as needed), provided by the TOE developer if necessary, to view the key storage location:
                  <br/>
                  <ol>
                    <li>Record the value of the key in the TOE subject to clearing.</li>
                    <li>Cause the TOE to perform a normal cryptographic processing with the key from Step #1.</li>
                    <li>Cause the TOE to clear the key.</li>
                    <li>Search the non-volatile memory the key was stored in for instances of the known key value from Step #1. If a copy is found, then the test fails.</li>
                    <li>Break the key value from Step #1 into 3 similar sized pieces and perform a search using each piece. If a fragment is found then the test is repeated (as described for test 1 above), and if a fragment is found in the repeated test then the test fails.</li>
                  </ol>
                  <br/><br/>
                
                
                  Applied to each key held as non-volatile memory and subject to destruction by overwrite by the TOE. The evaluator shall use special tools (as needed), provided by the TOE developer if necessary, to view the key storage location:
                  <br/>
                  <ol>
                    <li>Record the storage location of the key in the TOE subject to clearing.</li>
                    <li>Cause the TOE to perform a normal cryptographic processing with the key from Step #1.</li>
                    <li>Cause the TOE to clear the key.</li>
                    <li>Read the storage location in Step #1 of non-volatile memory to ensure the appropriate pattern is utilized. </li>
                  </ol>
                    <br/>
                  The test succeeds if correct pattern is used to overwrite the key in the memory location. If the pattern is not found the test fails.
                
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fcs__ckm__ext.4 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fcs__ckm__ext.5' class='component fcs__ckm__ext.5'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_CKM_EXT.5 &#8212; Extended: TSF Wipe</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fcs__ckm__ext.5.1' class='requirement fcs__ckm__ext.5.1'><div class='f-el-title'>FCS_CKM_EXT.5.1</div><div class='words'>The TSF shall wipe all protected data by 
              <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>Cryptographically erasing the encrypted DEKs and/or the KEKs in non-volatile memory by following the requirements in FCS_CKM_EXT.4.1</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>Overwriting all  according to the following rules:
                  <ul>
                    <li>For EEPROM, the destruction shall be executed by a single direct overwrite consisting of a pseudo random pattern using the TSF’s RBG (as specified in FCS_RBG_EXT.1, followed by a read-verify.
                    </li>
                    <li>For flash memory, that is not wear-leveled, the destruction shall be executed 
                          <span class='selectables' data-rindex='1'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>by a single direct overwrite consisting of zeros followed by a read-verify</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>by a block erase that erases the reference to memory that stores data as well as the data itself</span>
</li>
</ul>
</span>.
                    </li>
                    <li>For flash memory, that is wear-leveled, the destruction shall be executed 
                          <span class='selectables' data-rindex='2'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>by a single direct overwrite consisting of zeros</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>by a block erase</span>
</li>
</ul>
</span>.
                    </li>
                    <li>For non-volatile memory other than EEPROM and flash, the destruction shall be executed by a single direct overwrite with a random pattern that is changed before each write.
                    </li>
              </ul>
                </span>
</li>
</ul>
</span>.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__ckm__ext.5.1 -->
<div id='Mobile_Device_Fundamentals:fcs__ckm__ext.5.2' class='requirement fcs__ckm__ext.5.2'><div class='f-el-title'>FCS_CKM_EXT.5.2</div><div class='words'>The TSF shall perform a power cycle on conclusion of the wipe procedure.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__ckm__ext.5.2 -->
<div class='aactivity'>

              The evaluator shall check to ensure the  TSS describes how the device is wiped; and the type of clearing procedure that is performed (cryptographic erase or overwrite) and, if overwrite is performed, the overwrite procedure (overwrite with zeros, overwrite three or more times by a different alternating pattern, overwrite with random pattern, or block erase). If different types of memory are used to store the data to be protected, the evaluator shall check to ensure that the  TSS describes the clearing procedure in terms of the memory in which the data are stored (for example, data stored on flash are cleared by overwriting once with zeros, while data stored on the internal persistent storage device are cleared by overwriting three times with a random pattern that is changed before each write).
              <br/><br/>
              Assurance Activity Note: The following test may require the developer to provide access to a test platform that provides the evaluator with tools that are typically not found on consumer Mobile Device products. 
              <br/><br/>
              The evaluator shall perform one of the following tests. The test before and after the wipe command shall be identical. This test shall be repeated for each type of memory used to store the data to be protected. <br/><br/>
              <i>Method 1 for File-based Methods:</i><br/>
              
                The evaluator shall enable encryption according to the AGD guidance. The evaluator shall create a user data (protected data or sensitive data) file, for example, by using an application. The evaluator shall use a tool provided by the developer to examine this data stored in memory (for example, by examining a decrypted files). The evaluator shall initiate the wipe command according to the AGD guidance provided for FMT_SMF_EXT.1. The evaluator shall use a tool provided by the developer to examine the same data location in memory to verify that the data has been wiped according to the method described in the  TSS (for example, the files are still encrypted and cannot be accessed). 
              
              <i>Method 2 for Volume-based Methods:</i><br/>
              
                The evaluator shall enable encryption according to the AGD guidance. The evaluator shall create a unique data string, for example, by using an application. The evaluator shall use a tool provided by the developer to search decrypted data for the unique string. The evaluator shall initiate the wipe command according to the AGD guidance provided for FMT_SMF_EXT.1. The evaluator shall use a tool provided by the developer to search for the same unique string in decrypted memory to verify that the data has been wiped according to the method described in the  TSS (for example, the files are still encrypted and cannot be accessed).
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fcs__ckm__ext.5 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fcs__ckm__ext.6' class='component fcs__ckm__ext.6'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_CKM_EXT.6 &#8212; Extended: Salt Generation</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fcs__ckm__ext.6.1' class='requirement fcs__ckm__ext.6.1'><div class='f-el-title'>FCS_CKM_EXT.6.1</div><div class='words'>The TSF shall generate all salts using a RBG that meets FCS_RBG_EXT.1.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__ckm__ext.6.1 -->
<div class='aactivity'>

              The evaluator shall verify that the  TSS contains a description regarding the salt generation, including which algorithms on the TOE require salts. The evaluator shall confirm that the salt is generated using an RBG described in FCS_RBG_EXT.1. For PBKDF derivation of KEKs, this assurance activity may be performed in conjunction with FCS_CKM_EXT.3.2.
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fcs__ckm__ext.6 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fcs__ckm__ext.7' class='component fcs__ckm__ext.7 sel-based disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_CKM_EXT.7 &#8212; Extended: Cryptographic Key Support (REK)</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fcs__ckm__ext.7.1' class='requirement fcs__ckm__ext.7.1'><div class='f-el-title'>FCS_CKM_EXT.7.1</div><div class='words'>A REK shall not be able to be read from or exported from the hardware. 
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__ckm__ext.7.1 -->
<div class='aactivity'>
The assurance activity for this element is performed in conjunction with the assurance activity for FCS_CKM_EXT.1.
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fcs__ckm__ext.7 -->
<span class='comp-notes'></span><br/><span class='tooltipped'><input type='checkbox' onchange='handleOCheck(this); return false;'></input></span>
<span id='Mobile_Device_Fundamentals:fcs__ckm__ext.8' class='component fcs__ckm__ext.8 disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_CKM_EXT.8 &#8212; Extended: Bluetooth Key Generation</a><span class='tooltiptext'>objective</span>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fcs__ckm__ext.8.1' class='requirement fcs__ckm__ext.8.1'><div class='f-el-title'>FCS_CKM_EXT.8.1</div><div class='words'>The TSF shall randomly generate public/private ECDH key pairs every 
              <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='frequency of and/or criteria for new key pair generation'></textarea>.</div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__ckm__ext.8.1 -->
<div class='aactivity'>
The evaluator shall ensure that the  TSS describes the criteria used to determine the frequency of generating new ECDH public/private key pairs. In particular, the evaluator shall ensure that the implementation does not permit the use of static ECDH key pairs.
              <br/><br/>
              The evaluator shall perform the following test:
              
                The evaluator shall perform the following steps:<br/><br/>
                  Step 1 - Pair the TOE to a remote Bluetooth device and record the public key currently in use by the TOE. (This public key can be obtained using a Bluetooth protocol analyzer to inspect packets exchanged during pairing.)
                  <br/><br/>
                  Step 2 - Perform necessary actions to generate new ECDH public/private key pairs. (Note that this test step depends on how the  TSS describes the criteria used to determine the frequency of generating new ECDH public/private key pairs.)
                  <br/><br/>
                  Step 3 - Pair the TOE to a remote Bluetooth device and again record the public key currently in use by the TOE. 
                  <br/><br/>
                  Step 4 - Verify that the public key in Step 1 differs from the public key in Step 3.
                
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fcs__ckm__ext.8 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fcs__cop.1_l1_r' class='component fcs__cop.1_l1_r'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_COP.1(1) &#8212; Cryptographic operation</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fcs__cop.1.1_l1_r' class='requirement fcs__cop.1.1_l1_r'><div class='f-el-title'>FCS_COP.1.1(1)</div><div class='words'>The TSF shall perform encryption/decryption in accordance with a specified cryptographic algorithm: <br/>
              <ul>
                <li><span class='refinement'>AES-CBC (as defined in FIPS PUB 197, and NIST SP 800-38A) mode</span></li> 
                <li><span class='refinement'>AES-CCMP (as defined in FIPS PUB 197, NIST SP 800-38C and IEEE 802.11-2012), and</span></li>
                <li><span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span><span class='refinement'>AES Key Wrap (KW) (as defined in NIST SP 800-38F)</span></span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span><span class='refinement'>AES Key Wrap with Padding (KWP) (as defined in NIST SP 800-38F)</span></span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span><span class='refinement'>AES-GCM (as defined in NIST SP 800-38D)</span></span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span><span class='refinement'>AES-CCM (as defined in NIST SP 800-38C)</span></span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='4' class='val selbox'></input><span><span class='refinement'>AES-XTS (as defined in NIST SP 800-38E) mode</span></span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='5' class='val selbox'></input><span><span class='refinement'>AES-CCMP-256 (as defined in NIST SP800-38C and IEEE 802.11ac-2013)</span></span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='6' class='val selbox'></input><span><span class='refinement'>AES-GCMP-256 (as defined in NIST SP800-38D and IEEE 802.11ac-2013)</span></span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='7' class='val selbox exclusive'></input><span><span class='refinement'>no other modes</span></span>
</li>
</ul>
</span></li>
              </ul>
              and cryptographic key sizes 128-bit key sizes and 
                <span class='selectables' data-rindex='1'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span><span class='refinement'>256-bit key sizes</span></span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox exclusive'></input><span><span class='refinement'>no other key sizes</span></span>
</li>
</ul>
</span>.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__cop.1.1_l1_r -->
<div class='aactivity'>
Assurance Activity Note: The following tests require the developer to provide access to a test platform that provides the evaluator with tools that are typically not found on factory products.
              <br/><br/>
            
              <b><u>AES-CBC Tests</u></b>
                AES-CBC Known Answer Tests
                  <br/><br/>
                  There are four Known Answer Tests (KATs), described below. In all KATs, the plaintext, ciphertext, and IV values shall be 128-bit blocks. The results from each test may either be obtained by the evaluator directly or by supplying the inputs to the implementer and receiving the results in response. To determine correctness, the evaluator shall compare the resulting values to those obtained by submitting the same inputs to a known good implementation.
                  
                    <br/>
                    KAT-1. To test the encrypt functionality of AES-CBC, the evaluator shall supply a set of 10 plaintext values and obtain the ciphertext value that results from AES-CBC encryption of the given plaintext using a key value of all zeros and an IV of all zeros. Five plaintext values shall be encrypted with a 128-bit all-zeros key, and the other five shall be encrypted with a 256-bit all-zeros key.
                      <br/><br/>
                      To test the decrypt functionality of AES-CBC, the evaluator shall perform the same test as for encrypt, using 10 ciphertext values as input and AES-CBC decryption.
                    
                    <br/>
                    KAT-2. To test the encrypt functionality of AES-CBC, the evaluator shall supply a set of 10 key values and obtain the ciphertext value that results from AES-CBC encryption of an all-zeros plaintext using the given key value and an IV of all zeros. Five of the keys shall be 128-bit keys, and the other five shall be 256-bit keys.
                      <br/><br/>
                      To test the decrypt functionality of AES-CBC, the evaluator shall perform the same test as for encrypt, using an all-zero ciphertext value as input and AES-CBC decryption.
                      
                    <br/>
                    KAT-3. To test the encrypt functionality of AES-CBC, the evaluator shall supply the two sets of key values described below and obtain the ciphertext value that results from AES encryption of an all-zeros plaintext using the given key value and an IV of all zeros. The first set of keys shall have 128 128-bit keys, and the second set shall have 256 256-bit keys. Key i in each set shall have the leftmost i bits be ones and the rightmost N-i bits be zeros, for i in [1,N].
                      <br/><br/>
                      To test the decrypt functionality of AES-CBC, the evaluator shall supply the two sets of key and ciphertext value pairs described below and obtain the plaintext value that results from AES-CBC decryption of the given ciphertext using the given key and an IV of all zeros. The first set of key/ciphertext pairs shall have 128 128-bit key/ciphertext pairs, and the second set of key/ciphertext pairs shall have 256 256-bit key/ciphertext pairs. Key i in each set shall have the leftmost i bits be ones and the rightmost N-i bits be zeros, for i in [1,N]. The ciphertext value in each pair shall be the value that results in an all-zeros plaintext when decrypted with its corresponding key.
                    
                    <br/>
                    KAT-4. To test the encrypt functionality of AES-CBC, the evaluator shall supply the set of 128 plaintext values described below and obtain the two ciphertext values that result from AES-CBC encryption of the given plaintext using a 128-bit key value of all zeros with an IV of all zeros and using a 256-bit key value of all zeros with an IV of all zeros, respectively. Plaintext value i in each set shall have the leftmost i bits be ones and the rightmost 128-i bits be zeros, for i in [1,128].
                      <br/><br/>
                      To test the decrypt functionality of AES-CBC, the evaluator shall perform the same test as for encrypt, using ciphertext values of the same form as the plaintext in the encrypt test as input and AES-CBC decryption.
                    
                  
                
                <br/>
                AES-CBC Multi-Block Message Test<br/><br/>
                  The evaluator shall test the encrypt functionality by encrypting an i-block message where 1 &lt; i &lt;= 10. The evaluator shall choose a key, an IV and plaintext message of length i blocks and encrypt the message, using the mode to be tested, with the chosen key and IV. The ciphertext shall be compared to the result of encrypting the same plaintext message with the same key and IV using a known good implementation.
                  <br/><br/>
                  The evaluator shall also test the decrypt functionality for each mode by decrypting an i-block message where 1 &lt; i &lt;= 10. The evaluator shall choose a key, an IV and a ciphertext message of length i blocks and decrypt the message, using the mode to be tested, with the chosen key and IV. The plaintext shall be compared to the result of decrypting the same ciphertext message with the same key and IV using a known good implementation.
                
                <br/>
                AES-CBC Monte Carlo Tests<br/><br/>
                  The evaluator shall test the encrypt functionality using a set of 200 plaintext, IV, and key 3-tuples. 100 of these shall use 128 bit keys, and 100 shall use 256 bit keys. The plaintext and IV values shall be 128-bit blocks. For each 3-tuple, 1000 iterations shall be run as follows:
                  <br/><br/>
                  <pre>
                    # Input: PT, IV, Key
                    for i = 1 to 1000:
                        if i == 1:
                              CT[1] = AES-CBC-Encrypt(Key, IV, PT)
                              PT = IV
                        else:
                              CT[i] = AES-CBC-Encrypt(Key, PT)
                              PT = CT[i-1]
                  </pre>
                  <br/>
                  The ciphertext computed in the 1000<sup>th</sup> iteration (i.e. CT[1000]) is the result for that trial. This result shall be compared to the result of running 1000 iterations with the same values using a known good implementation.
                  <br/><br/>
                  The evaluator shall test the decrypt functionality using the same test as for encrypt, exchanging CT and PT and replacing AES-CBC-Encrypt with AES-CBC-Decrypt.
                
              
              <br/>
              <b><u>AES-CCM Tests</u></b>
              
                The evaluator shall test the generation-encryption and decryption-verification functionality of AES-CCM for the following input parameter and tag lengths:
                <br/><br/>
                <ul style='list-style-type:none'>
                  <li><b>128 bit and 256 bit keys</b></li>
                  <br/>
                  <li><b>Two payload lengths.</b> One payload length shall be the shortest supported payload length, greater than or equal to zero bytes. The other payload length shall be the longest supported payload length, less than or equal to 32 bytes (256 bits).
                </li>
                  <br/>
                  <li><b>Two or three associated data lengths.</b> One associated data length shall be 0, if supported. One associated data length shall be the shortest supported payload length, greater than or equal to zero bytes. One associated data length shall be the longest supported payload length, less than or equal to 32 bytes (256 bits). If the implementation supports an associated data length of 2<sup>16</sup> bytes, an associated data length of 2<sup>16</sup> bytes shall be tested.
                </li>
                  <br/>
                  <li><b>Nonce lengths.</b> All supported nonce lengths between 7 and 13 bytes, inclusive, shall be tested.
                </li>
                  <br/>
                  <li><b>Tag lengths.</b> All supported tag lengths of 4, 6, 8, 10, 12, 14 and 16 bytes shall be tested.</li>
                </ul>
                To test the generation-encryption functionality of AES-CCM, the evaluator shall perform the following four tests: 
                <br/>
                
                  For EACH supported key and associated data length and ANY supported payload, nonce and tag length, the evaluator shall supply one key value, one nonce value and 10 pairs of associated data and payload values and obtain the resulting ciphertext.
                  <br/>
                  For EACH supported key and payload length and ANY supported associated data, nonce and tag length, the evaluator shall supply one key value, one nonce value and 10 pairs of associated data and payload values and obtain the resulting ciphertext.
                  <br/>
                  For EACH supported key and nonce length and ANY supported associated data, payload and tag length, the evaluator shall supply one key value and 10 associated data, payload and nonce value 3-tuples and obtain the resulting ciphertext.
                  <br/>
                  For EACH supported key and tag length and ANY supported associated data, payload and nonce length, the evaluator shall supply one key value, one nonce value and 10 pairs of associated data and payload values and obtain the resulting ciphertext.
                
                To determine correctness in each of the above tests, the evaluator shall compare the ciphertext with the result of generation-encryption of the same inputs with a known good implementation.
                <br/><br/>
                To test the decryption-verification functionality of AES-CCM, for EACH combination of supported associated data length, payload length, nonce length and tag length, the evaluator shall supply a key value and 15 nonce, associated data and ciphertext 3-tuples and obtain either a FAIL result or a PASS result with the decrypted payload. The evaluator shall supply 10 tuples that should FAIL and 5 that should PASS per set of 15.
              
              
              <br/>
              <b><u>AES-GCM Test</u></b><br/>
                The evaluator shall test the authenticated encrypt functionality of AES-GCM for each combination of the following input parameter lengths:
                <br/><br/>
                <ul style='list-style-type:none'>
                  <li><b>128 bit and 256 bit keys</b></li>
                  <br/>
                  <li><b>Two plaintext lengths.</b> One of the plaintext lengths shall be a non-zero integer multiple of 128 bits, if supported. The other plaintext length shall not be an integer multiple of 128 bits, if supported.
                  </li>
                  <br/>
                  <li><b>Three AAD lengths.</b> One AAD length shall be 0, if supported. One AAD length shall be a non-zero integer multiple of 128 bits, if supported. One AAD length shall not be an integer multiple of 128 bits, if supported.
                  </li>
                  <br/>
                  <li><b>Two IV lengths.</b> If 96 bit IV is supported, 96 bits shall be one of the two IV lengths tested.
                    </li>
                </ul>
                The evaluator shall test the encrypt functionality using a set of 10 key, plaintext, AAD, and IV tuples for each combination of parameter lengths above and obtain the ciphertext value and tag that results from AES-GCM authenticated encrypt. Each supported tag length shall be tested at least once per set of 10. The IV value may be supplied by the evaluator or the implementation being tested, as long as it is known.
                
                <br/>
                The evaluator shall test the decrypt functionality using a set of 10 key, ciphertext, tag, AAD, and IV 5-tuples for each combination of parameter lengths above and obtain a Pass/Fail result on authentication and the decrypted plaintext if Pass. The set shall include five tuples that Pass and five that Fail.
                
                <br/>
                The results from each test may either be obtained by the evaluator directly or by supplying the inputs to the implementer and receiving the results in response. To determine correctness, the evaluator shall compare the resulting values to those obtained by submitting the same inputs to a known good implementation.
              <br/>
              <b><u>XTS-AES Test</u></b><br/>
                The evaluator shall test the encrypt functionality of XTS-AES for each combination of the following input parameter lengths:
                  <br/><br/>
                  <ul style='list-style-type:none'>
                    <li><b>256 bit (for AES-128) and 512 bit (for AES-256) keys</b></li><br/>
                    <li><b>Three data unit (i.e. plaintext) lengths.</b> One of the data unit lengths shall be a non-zero integer multiple of 128 bits, if supported. One of the data unit lengths shall be an integer multiple of 128 bits, if supported. The third data unit length shall be either the longest supported data unit length or 216 bits, whichever is smaller.
                    </li><br/>
                  </ul>
                  using a set of 100 (key, plaintext and 128-bit random tweak value) 3-tuples and obtain the ciphertext that results from XTS-AES encrypt.
                  <br/><br/>
                  The evaluator may supply a data unit sequence number instead of the tweak value if the implementation supports it. The data unit sequence number is a base-10 number ranging between 0 and 255 that implementations convert to a tweak value internally.
                <br/>
                The evaluator shall test the decrypt functionality of XTS-AES using the same test as for encrypt, replacing plaintext values with ciphertext values and XTS-AES encrypt with XTS-AES decrypt.
                
              <br/>
              <b><u>AES Key Wrap (AES-KW) and Key Wrap with Padding (AES-KWP) Test</u></b>
                The evaluator shall test the authenticated encryption functionality of AES-KW for EACH combination of the following input parameter lengths:
                  <br/><br/>
                  <ul style='list-style-type:none'>
                    <li><b>128 and 256 bit key encryption keys (KEKs)</b></li><br/>
                    <li><b>Three plaintext lengths.</b> One of the plaintext lengths shall be two semi-blocks (128 bits). One of the plaintext lengths shall be three semi-blocks (192 bits). The third data unit length shall be the longest supported plaintext length less than or equal to 64 semi-blocks (4096 bits).</li>
                  </ul>
                  using a set of 100 key and plaintext pairs and obtain the ciphertext that results from AES-KW authenticated encryption. To determine correctness, the evaluator shall use the AES-KW authenticated-encryption function of a known good implementation.
                <br/>
                The evaluator shall test the authenticated-decryption functionality of AES-KW using the same test as for authenticated-encryption, replacing plaintext values with ciphertext values and AES-KW authenticated-encryption with AES-KW authenticated-decryption.
                <br/>
                The evaluator shall test the authenticated-encryption functionality of AES-KWP using the same test as for AES-KW authenticated-encryption with the following change in the three plaintext lengths:
                  <ul>
                    <li>One plaintext length shall be one octet. One plaintext length shall be 20 octets (160 bits).</li><br/>
                    <li>One plaintext length shall be the longest supported plaintext length less than or equal to 512 octets (4096 bits).</li>
                  </ul>
                
                The evaluator shall test the authenticated-decryption functionality of AES-KWP using the same test as for AES-KWP authenticated-encryption, replacing plaintext values with ciphertext values and AES-KWP authenticated-encryption with AES-KWP authenticated-decryption.
                
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fcs__cop.1_l1_r -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fcs__cop.1_l2_r' class='component fcs__cop.1_l2_r'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_COP.1(2) &#8212; Cryptographic operation</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fcs__cop.1.1_l2_r' class='requirement fcs__cop.1.1_l2_r'><div class='f-el-title'>FCS_COP.1.1(2)</div><div class='words'>The TSF shall perform <span class='refinement'>cryptographic hashing</span> in accordance with a specified cryptographic algorithm <span class='refinement'>SHA-1 and 
              <span class='selectables' data-rindex='0'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>SHA-256</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>SHA-384</span>
<input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>SHA-512</span>
<input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox exclusive'></input><span>no other algorithms</span>
</span></span> and <span class='refinement'>message digest</span> sizes <span class='refinement'>160 and 
              <span class='selectables' data-rindex='1'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>256</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>384</span>
<input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>512 bits</span>
<input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox exclusive'></input><span>no other message digest sizes</span>
</span></span> that meet the following: <span class='refinement'>FIPS Pub 180-4</span>.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__cop.1.1_l2_r -->
<div class='aactivity'>

              The evaluator checks the AGD documents to determine that any configuration that is required to be done to configure the functionality for the required hash sizes is present. The evaluator shall check that the association of the hash function with other TSF cryptographic functions (for example, the digital signature verification function) is documented in the  TSS.
              <br/><br/>
              The TSF hashing functions can be implemented in one of two modes. The first mode is the byte­oriented mode. In this mode the TSF only hashes messages that are an integral number of bytes in length; i.e. the length (in bits) of the message to be hashed is divisible by 8. The second mode is the bit­oriented mode. In this mode the TSF hashes messages of arbitrary length. As there are different tests for each mode, an indication is given in the following sections for the bit­oriented vs. the byte­oriented testmacs.
              <br/><br/>
              The TSF may implement either bit-oriented or byte-oriented; both implementations are not required. The evaluator shall perform all of the following tests for each hash algorithm implemented by the TSF and used to satisfy the requirements of this PP.
              <br/><br/>
              Assurance Activity Note: The following tests require the developer to provide access to a test platform that provides the evaluator with tools that are typically not found on factory products.
              <br/><br/>
              
                <i>Short Messages Test: Bit-­oriented Mode</i><br/>
                  The evaluators devise an input set consisting of m+1 messages, where m is the block length of the hash algorithm. The length of the messages ranges sequentially from 0 to m bits. The message text shall be pseudorandomly generated. The evaluators compute the message digest for each of the messages and ensure that the correct result is produced when the messages are provided to the TSF.
                <br/>
                <i>Short Messages Test: Byte-­oriented Mode</i><br/>
                  The evaluators devise an input set consisting of m/8+1 messages, where m is the block length of the hash algorithm. The length of the messages range sequentially from 0 to m/8 bytes, with each message being an integral number of bytes. The message text shall be pseudorandomly generated. The evaluators compute the message digest for each of the messages and ensure that the correct result is produced when the messages are provided to the TSF.
                <br/>
                <i>Selected Long Messages Test: Bit-­oriented Mode</i><br/>
                  The evaluators devise an input set consisting of m messages, where m is the block length of the hash algorithm. The length of the i<sup>th</sup> message is 512 + 99*i, where 1 ≤ i ≤ m. The message text shall be pseudorandomly generated. The evaluators compute the message digest for each of the messages and ensure that the correct result is produced when the messages are provided to the TSF.
                <br/>
                <i>Selected Long Messages Test: Byte-­oriented Mode</i><br/>
                  The evaluators devise an input set consisting of m/8 messages, where m is the block length of the hash algorithm. The length of the i<sup>th</sup> message is 512 + 8*99*i, where 1 ≤ i ≤ m/8. The message text shall be pseudorandomly generated. The evaluators compute the message digest for each of the messages and ensure that the correct result is produced when the messages are provided to the TSF.

                <br/>
                <i>Pseudorandomly Generated Messages Test</i><br/>
                  This test is for byte­oriented implementations only. The evaluators randomly generate a seed that is n bits long, where n is the length of the message digest produced by the hash function to be tested. The evaluators then formulate a set of 100 messages and associated digests by following the algorithm provided in Figure 1 of SHAVS. The evaluators then ensure that the correct result is produced when the messages are provided to the TSF.

                
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fcs__cop.1_l2_r -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fcs__cop.1_l3_r' class='component fcs__cop.1_l3_r'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_COP.1(3) &#8212; Cryptographic operation</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fcs__cop.1.1_l3_r' class='requirement fcs__cop.1.1_l3_r'><div class='f-el-title'>FCS_COP.1.1(3)</div><div class='words'>The TSF shall perform <span class='refinement'>cryptographic signature services (generation and verification)</span> in accordance with a specified cryptographic algorithm
              <ul>
                <li><span class='refinement'>RSA schemes using cryptographic key sizes of 2048-bit or greater that meet the following: FIPS PUB 186-4, "Digital Signature Standard (DSS)", Section 4</span> and</li>             
              <li><span class='refinement'><span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>ECDSA schemes using "NIST curves" P-384 and 
              <span class='selectables' data-rindex='1'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>P-256</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>P-521</span>
<input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox exclusive'></input><span>no other curves</span>
</span> that meet the following: FIPS PUB 186-4, "Digital Signature Standard (DSS)", Section 5</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox exclusive'></input><span>No other algorithms</span>
</li>
</ul>
</span></span>.</li>
              </ul>
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__cop.1.1_l3_r -->
<div class='aactivity'>
Assurance Activity Note: The following tests require the developer to provide access to a test platform that provides the evaluator with tools that are typically not found on factory products.
              <br/>
                <b>ECDSA Algorithm Tests</b><br/>
                  
                    <b>ECDSA FIPS 186-4 Signature Generation Test</b><br/>
                      For each supported NIST curve (i.e. P-256, P-384 and P-521) and SHA function pair, the evaluator shall generate 10 1024-bit long messages and obtain for each message a public key and the resulting signature values R and S. To determine correctness, the evaluator shall use the signature verification function of a known good implementation.
                    <br/>
                    <b>ECDSA FIPS 186-4 Signature Verification Test</b><br/>
                      For each supported NIST curve (i.e. P-256, P-384 and P-521) and SHA function pair, the evaluator shall generate a set of 10 1024-bit message, public key and signature tuples and modify one of the values (message, public key or signature) in five of the 10 tuples. The evaluator shall obtain in response a set of 10 PASS/FAIL values.
                    
                  
                
                <b>RSA Signature Algorithm Tests</b><br/>
                  
                    <b>Signature Generation Test</b><br/>
                      The evaluator shall verify the implementation of RSA Signature Generation by the TOE using the Signature Generation Test. To conduct this test the evaluator must generate or obtain 10 messages from a trusted reference implementation for each modulus size/SHA combination supported by the TSF. The evaluator shall have the TOE use their private key and modulus value to sign these messages.
                      <br/><br/>
                      The evaluator shall verify the correctness of the TSF’s signature using a known good implementation and the associated public keys to verify the signatures.
                    <br/>
                    <b>Signature Verification Test</b><br/>
                      The evaluator shall perform the Signature Verification test to verify the ability of the TOE to recognize another party’s valid and invalid signatures. The evaluator shall inject errors into the test vectors produced during the Signature Verification Test by introducing errors in some of the public keys e, messages, IR format, and/or signatures. The TOE attempts to verify the signatures and returns success or failure.
                    
                  
                
              
              The evaluator shall use these test vectors to emulate the signature verification test using the corresponding parameters and verify that the TOE detects these errors.
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fcs__cop.1_l3_r -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fcs__cop.1_l4_r' class='component fcs__cop.1_l4_r'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_COP.1(4) &#8212; Cryptographic operation</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fcs__cop.1.1_l4_r' class='requirement fcs__cop.1.1_l4_r'><div class='f-el-title'>FCS_COP.1.1(4)</div><div class='words'>The TSF shall perform <span class='refinement'>keyed-hash message authentication</span> in accordance with a specified cryptographic algorithm <span class='refinement'>HMAC-SHA-1 and 
              <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>HMAC-SHA-256</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>HMAC-SHA-384</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>HMAC-SHA-512</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox exclusive'></input><span>no other algorithms</span>
</li>
</ul>
</span></span> and cryptographic key sizes 
              <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='key size (in bits) used in HMAC'></textarea><span class='refinement'> and message digest sizes 160 and 
              <span class='selectables' data-rindex='1'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>256</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>384</span>
<input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>512</span>
<input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox exclusive'></input><span>no other</span>
</span> bits</span> that meet the following: <span class='refinement'>FIPS Pub 198-1, "The Keyed-Hash Message Authentication Code", and FIPS Pub 180-4, "Secure Hash Standard"</span>.
          </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__cop.1.1_l4_r -->
<div class='aactivity'>

            The evaluator shall examine the  TSS to ensure that it specifies the following values used by the HMAC function: key length, hash function used, block size, and output MAC length used. 
            <br/><br/>
            Assurance Activity Note: The following tests require the developer to provide access to a test platform that provides the evaluator with tools that are typically not found on factory products.
            <br/><br/>
            For each of the supported parameter sets, the evaluator shall compose 15 sets of test data. Each set shall consist of a key and message data. The evaluator shall have the TSF generate HMAC tags for these sets of test data. The resulting MAC tags shall be compared to the result of generating HMAC tags with the same key and IV using a known good implementation.
          </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fcs__cop.1_l4_r -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fcs__cop.1_l5_r' class='component fcs__cop.1_l5_r'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_COP.1(5) &#8212; Cryptographic operation</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fcs__cop.1.1_l5_r' class='requirement fcs__cop.1.1_l5_r'><div class='f-el-title'>FCS_COP.1.1(5)</div><div class='words'>The TSF shall perform <span class='refinement'>Password-based Key Derivation Functions</span> in accordance with a specified cryptographic algorithm 
              <span class='refinement'>HMAC-<span class='selectables' data-rindex='0'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>SHA-256</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>SHA-384</span>
<input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>SHA-512</span>
</span>], with 
              <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='integer number greater than or equal to 1000'></textarea> iterations, and output </span>cryptographic key sizes<span class='refinement'> 
                <span class='selectables' data-rindex='1'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>128</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>256</span>
</span></span> that meet the following: <span class='refinement'>NIST SP 800-132.</span>
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__cop.1.1_l5_r -->
<div class='aactivity'>
The evaluator shall check that the  TSS describes the method by which the password is first encoded and then fed to the SHA algorithm. The settings for the algorithm (padding, blocking, etc.) shall be described, and the evaluator shall verify that these are supported by the selections in this component as well as the selections concerning the hash function itself. The evaluator shall verify that the  TSS contains a description of how the output of the hash function is used to form the submask that will be input into the function and is the same length as the KEK as specified in FCS_CKM_EXT.3.
              <br/><br/>
              For the NIST SP 800-132-based conditioning of the passphrase, the required assurance activities will be performed when doing the assurance activities for the appropriate requirements (FCS_COP.1.1(4)). If any manipulation of the key is performed in forming the submask that will be used to form the KEK, that process shall be described in the  TSS.
              <br/><br/>
              No explicit testing of the formation of the submask from the input password is required.
              <br/><br/>
              The evaluator shall verify that the iteration count for PBKDFs performed by the TOE comply with NIST SP 800-132 by ensuring that the  TSS contains a description of the estimated time required to derive key material from passwords and how the TOE increases the computation time for password-based key derivation (including but not limited to increasing the iteration count). 
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fcs__cop.1_l5_r -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fcs__dtls__ext.1' class='component fcs__dtls__ext.1 sel-based disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_DTLS_EXT.1 &#8212; Extended: DTLS Protocol</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fcs__dtls__ext.1.1' class='requirement fcs__dtls__ext.1.1'><div class='f-el-title'>FCS_DTLS_EXT.1.1</div><div class='words'>The TSF shall implement the DTLS protocol in accordance with DTLS 1.2 (RFC 6347).</div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__dtls__ext.1.1 -->
<div id='Mobile_Device_Fundamentals:fcs__dtls__ext.1.2' class='requirement fcs__dtls__ext.1.2'><div class='f-el-title'>FCS_DTLS_EXT.1.2</div><div class='words'>The TSF shall implement the requirements in TLS (FCS_TLSC_EXT.1) for the DTLS implementation, except where variations are allowed according to DTLS 1.2 (RFC 6347).
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__dtls__ext.1.2 -->
<div id='Mobile_Device_Fundamentals:fcs__dtls__ext.1.3' class='requirement fcs__dtls__ext.1.3'><div class='f-el-title'>FCS_DTLS_EXT.1.3</div><div class='words'>The TSFTSF shall not establish a trusted communication channel if the peer certificate is deemed invalid.</div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__dtls__ext.1.3 -->
<div class='aactivity'>

              
                The evaluator shall attempt to establish a connection with a DTLS server, observe the traffic with a packet analyzer, and verify that the connection succeeds and that the traffic is identified as DTLS.<br/><br/>
                  Other tests are performed in conjunction with the Assurance Activity listed for FCS_TLSC_EXT.1.<br/><br/>
                  Certificate validity shall be tested in accordance with testing performed for FIA_X509_EXT.1, and the evaluator shall perform the following test.
                The evaluator shall demonstrate that using a certificate without a valid certification path results in the function failing. Using the administrative guidance, the evaluator shall then load a certificate or certificates to the Trust Anchor Database needed to validate the certificate to be used in the function, and demonstrate that the function succeeds. The evaluator then shall delete one of the certificates, and show that the function fails.
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fcs__dtls__ext.1 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fcs__https__ext.1' class='component fcs__https__ext.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_HTTPS_EXT.1 &#8212; Extended: HTTPS Protocol</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fcs__https__ext.1.1' class='requirement fcs__https__ext.1.1'><div class='f-el-title'>FCS_HTTPS_EXT.1.1</div><div class='words'>The TSF shall implement the HTTPS protocol that complies with RFC 2818.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__https__ext.1.1 -->
<div id='Mobile_Device_Fundamentals:fcs__https__ext.1.2' class='requirement fcs__https__ext.1.2'><div class='f-el-title'>FCS_HTTPS_EXT.1.2</div><div class='words'>The TSF shall implement HTTPS using TLS (FCS_TLSC_EXT.1).
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__https__ext.1.2 -->
<div id='Mobile_Device_Fundamentals:fcs__https__ext.1.3' class='requirement fcs__https__ext.1.3'><div class='f-el-title'>FCS_HTTPS_EXT.1.3</div><div class='words'>The TSF shall notify the application and 
              <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>not establish the connection</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>request application authorization to establish the connection</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox exclusive'></input><span>no other action</span>
</li>
</ul>
</span> if the peer certificate is deemed invalid. 
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__https__ext.1.3 -->
<div class='aactivity'>

              
                The evaluator shall attempt to establish an HTTPS connection with a webserver, observe the traffic with a packet analyzer, and verify that the connection succeeds and that the traffic is identified as TLS or HTTPS.
                  <br/><br/>
                  Other tests are performed in conjunction with FCS_TLSC_EXT.1.
                  <br/><br/>
                  Certificate validity shall be tested in accordance with testing performed for FIA_X509_EXT.1, and the evaluator shall perform the following test:
                <br/><br/>
                The evaluator shall demonstrate that using a certificate without a valid certification path results in an application notification. Using the administrative guidance, the evaluator shall then load a certificate or certificates to the Trust Anchor Database needed to validate the certificate to be used in the function, and demonstrate that the function succeeds. The evaluator then shall delete one of the certificates, and show that the application is notified of the validation failure.
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fcs__https__ext.1 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fcs__iv__ext.1' class='component fcs__iv__ext.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_IV_EXT.1 &#8212; Extended: Initialization Vector Generation</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fcs__iv__ext.1.1' class='requirement fcs__iv__ext.1.1'><div class='f-el-title'>FCS_IV_EXT.1.1</div><div class='words'>The TSF shall generate IVs in accordance with <a onclick='showTarget("cc-Mobile_Device_Fundamentals:ivtable")' href="#cc-Mobile_Device_Fundamentals:ivtable" class="cc-Mobile_Device_Fundamentals:ivtable-ref"><span class="counter">Mobile_Device_Fundamentals:ivtable</span></a>: References and IV Requirements for NIST-approved Cipher Modes.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__iv__ext.1.1 -->
<div class='aactivity'>
The evaluator shall examine the key hierarchy section of the  TSS to ensure that the encryption of all keys is described and the formation of the IVs for each key encrypted by the same KEK meets FCS_IV_EXT.1.
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fcs__iv__ext.1 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fcs__rbg__ext.1' class='component fcs__rbg__ext.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_RBG_EXT.1 &#8212; Extended: Cryptographic Operation (Random Bit Generation)</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fcs__rbg__ext.1.1' class='requirement fcs__rbg__ext.1.1'><div class='f-el-title'>FCS_RBG_EXT.1.1</div><div class='words'>The TSF shall perform all deterministic random bit generation services in accordance with NIST Special Publication 800-90A using 
              <span class='selectables' data-rindex='0'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>Hash_DRBG (any)</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>HMAC_DRBG (any)</span>
<input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>CTR_DRBG (AES)</span>
</span>.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__rbg__ext.1.1 -->
<div id='Mobile_Device_Fundamentals:fcs__rbg__ext.1.2' class='requirement fcs__rbg__ext.1.2'><div class='f-el-title'>FCS_RBG_EXT.1.2</div><div class='words'>The deterministic RBG shall be seeded by an entropy source that accumulates entropy from 
              <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>a software-based noise source</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>TSF-hardware-based noise source</span>
</li>
</ul>
</span> with a minimum of 
              <span class='selectables' data-rindex='1'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>128 bits</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>256 bits</span>
</span> of entropy at least equal to the greatest security strength (according to NIST SP 800-57) of the keys and hashes that it will generate.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__rbg__ext.1.2 -->
<div id='Mobile_Device_Fundamentals:fcs__rbg__ext.1.3' class='requirement fcs__rbg__ext.1.3'><div class='f-el-title'>FCS_RBG_EXT.1.3</div><div class='words'>The TSF shall be capable of providing output of the RBG to applications running on the TSF that request random bits.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__rbg__ext.1.3 -->
<div class='aactivity'>

              Documentation shall be produced and the evaluator shall perform the activities in accordance with , the "Clarification to the Entropy Documentation and Assessment". 
              <br/><br/>
              The evaluator shall verify that the API documentation provided according to , includes the security functions described in FCS_RBG_EXT.1.3.
              <br/><br/>
              Assurance Activity Note: The following tests require the developer to provide access to a test platform that provides the evaluator with tools that are typically not found on factory products.
              <br/><br/>
              The evaluator shall perform the following tests.
              <br/><br/>
              The evaluator shall perform 15 trials for the RNG implementation. If the RNG is configurable, the evaluator shall perform 15 trials for each configuration. The evaluator shall also confirm that the operational guidance contains appropriate instructions for configuring the RNG functionality.
              <br/><br/>
              If the RNG has prediction resistance enabled, each trial consists of (1) instantiate DRBG, (2) generate the first block of random bits (3) generate a second block of random bits (4) uninstantiate. The evaluator verifies that the second block of random bits is the expected value. The evaluator shall generate eight input values for each trial. The first is a count (0 – 14). The next three are entropy input, nonce, and personalization string for the instantiate operation. The next two are additional input and entropy input for the first call to generate. The final two are additional input and entropy input for the second call to generate. These values are randomly generated. "generate one block of random bits" means to generate random bits with number of returned bits equal to the Output Block Length (as defined in NIST SP800-90A).
              <br/><br/>
              If the RNG does not have prediction resistance, each trial consists of (1) instantiate DRBG, (2) generate the first block of random bits (3) reseed, (4) generate a second block of random bits (5) uninstantiate. The evaluator verifies that the second block of random bits is the expected value. The evaluator shall generate eight input values for each trial. The first is a count (0 – 14). The next three are entropy input, nonce, and personalization string for the instantiate operation. The fifth value is additional input to the first call to generate. The sixth and seventh are additional input and entropy input to the call to reseed. The final value is additional input to the second generate call.
              <br/><br/>
              The following paragraphs contain more information on some of the input values to be generated/selected by the evaluator.
              <br/><br/>
              <ul style='list-style-type:none'>
                <li><b>Entropy input: </b>the length of the entropy input value must equal the seed length.</li>
                <li><b>Nonce: </b>If a nonce is supported (CTR_DRBG with no Derivation Function does not use a nonce), the nonce bit length is one-half the seed length.</li>
                <li><b>Personalization string: </b>The length of the personalization string must be ࣘ seed length. If the implementation only supports one personalization string length, then the same length can be used for both values. If more than one string length is support, the evaluator shall use personalization strings of two different lengths. If the implementation does not use a personalization string, no value needs to be supplied.</li>
                <li><b>Additional input: </b>the additional input bit lengths have the same defaults and restrictions as the personalization string lengths.</li>
              </ul>
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fcs__rbg__ext.1 -->
<span class='comp-notes'></span><br/><span class='tooltipped'><input type='checkbox' onchange='handleOCheck(this); return false;'></input></span>
<span id='Mobile_Device_Fundamentals:fcs__rbg__ext.2' class='component fcs__rbg__ext.2 disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_RBG_EXT.2 &#8212; Extended: Cryptographic Operation (Random Bit Generation)</a><span class='tooltiptext'>objective</span>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fcs__rbg__ext.2.1' class='requirement fcs__rbg__ext.2.1'><div class='f-el-title'>FCS_RBG_EXT.2.1</div><div class='words'>The TSF shall save the state of the deterministic RBG at power-off, and shall use this state as input to the deterministic RBG at startup.</div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__rbg__ext.2.1 -->
<div class='aactivity'>
The assurance activity for this requirement is captured in the RBG documentation for . The evaluator shall verify that the documentation describes how the state is generated so as to be available for the next startup, how the state is used as input to the DRBG, and any protection measures used for the state while the TOE is powered off. 
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fcs__rbg__ext.2 -->
<span class='comp-notes'></span><br/><span class='tooltipped'><input type='checkbox' onchange='handleOCheck(this); return false;'></input></span>
<span id='Mobile_Device_Fundamentals:fcs__rbg__ext.3' class='component fcs__rbg__ext.3 disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_RBG_EXT.3 &#8212; Extended: Cryptographic Operation (Random Bit Generation)</a><span class='tooltiptext'>objective</span>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fcs__rbg__ext.3.1' class='requirement fcs__rbg__ext.3.1'><div class='f-el-title'>FCS_RBG_EXT.3.1</div><div class='words'>The TSF shall allow applications to add data to the deterministic RBG using the Personalization String as defined in SP 800-90A. </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__rbg__ext.3.1 -->
<div class='aactivity'>
The evaluator shall verify that this function is included as an interface to the RBG in the documentation required by  and that the behavior of the RBG following a call to this interface is described. The evaluator shall also verify that the documentation of the RBG describes the conditions of use and possible values for the Personalization String input to the SP 800-90A specified DRBG. The evaluator shall also perform the following test.
              
                The evaluator shall write, or the developer shall provide, an application that adds data to the RBG via the Personalization String. The evaluator shall verify that the request succeeds.
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fcs__rbg__ext.3 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fcs__srv__ext.1' class='component fcs__srv__ext.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_SRV_EXT.1 &#8212; Extended: Cryptographic Algorithm Services</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fcs__srv__ext.1.1' class='requirement fcs__srv__ext.1.1'><div class='f-el-title'>FCS_SRV_EXT.1.1</div><div class='words'>The TSF shall provide a mechanism for applications to request the TSF to perform the following cryptographic operations:
             <ul>
             <li>All mandatory and 
              <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>selected algorithms</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span> selected algorithms with the exception of ECC over curve 25519-based algorithms</span>
</li>
</ul>
</span>
                in FCS_CKM.2(2)</li>
               <li>The following algorithms in FCS_COP.1(1): AES-CBC, 
              <span class='selectables' data-rindex='1'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>AES Key Wrap</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>AES Key Wrap with Padding</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>AES-GCM</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span>AES-CCM</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='4' class='val selbox exclusive'></input><span>no other modes</span>
</li>
</ul>
</span>
               </li>
               <li>All mandatory and selected algorithms in FCS_COP.1(3)</li>
               <li>All mandatory and selected algorithms in FCS_COP.1(2)</li>
               <li>All mandatory and selected algorithms in FCS_COP.1(4)</li>
               <li>
              <span class='selectables' data-rindex='2'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>All mandatory and <span class='selectables' data-rindex='3'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>selected algorithms</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>selected algorithms with the exception of ECC over curve 25519-based algorithms</span>
</li>
</ul>
</span> in FCS_CKM.1</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>The selected algorithms in FCS_COP.1(5)</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox exclusive'></input><span>No other cryptographic operations</span>
</li>
</ul>
</span>
              </li>
             </ul>
              
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__srv__ext.1.1 -->
<div class='aactivity'>

              The evaluator shall verify that the API documentation provided according to  includes the security functions (cryptographic algorithms) described in these requirements.
              <br/><br/>
              The evaluator shall write, or the developer shall provide access to, an application that requests cryptographic operations by the TSF. The evaluator shall verify that the results from the operation match the expected results according to the API documentation. This application may be used to assist in verifying the cryptographic operation assurance activities for the other algorithm services requirements. 
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fcs__srv__ext.1 -->
<span class='comp-notes'></span><br/><span class='tooltipped'><input type='checkbox' onchange='handleOCheck(this); return false;'></input></span>
<span id='Mobile_Device_Fundamentals:fcs__srv__ext.2' class='component fcs__srv__ext.2 disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_SRV_EXT.2 &#8212; Extended: Cryptographic Algorithm Services</a><span class='tooltiptext'>objective</span>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fcs__srv__ext.2.1' class='requirement fcs__srv__ext.2.1'><div class='f-el-title'>FCS_SRV_EXT.2.1</div><div class='words'>The TSF shall provide a mechanism for applications to request the TSF to perform the following cryptographic operations: 
              <ul>
              <li>Algorithms in FCS_COP.1(1)</li>
              <li>Algorithms in FCS_COP.1(3)</li>
              </ul>
              by keys stored in the secure key storage.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__srv__ext.2.1 -->
<div class='aactivity'>
The evaluator shall verify that the API documentation for the secure key storage includes the cryptographic operations by the stored keys. 
              <br/><br/>
              The evaluator shall write, or the developer shall provide access to, an application that requests cryptographic operations of stored keys by the TSF. The evaluator shall verify that the results from the operation match the expected results according to the API documentation. The evaluator shall use these APIs to test the functionality of the secure key storage according to the Assurance Activities in FCS_STG_EXT.1. 
             </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fcs__srv__ext.2 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fcs__stg__ext.1' class='component fcs__stg__ext.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_STG_EXT.1 &#8212; Extended: Cryptographic Key Storage</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fcs__stg__ext.1.1' class='requirement fcs__stg__ext.1.1'><div class='f-el-title'>FCS_STG_EXT.1.1</div><div class='words'>The TSF shall provide 
              <span class='selectables' data-rindex='0'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>mutable hardware</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>software-based</span>
</span> secure key storage for asymmetric private keys and 
              <span class='selectables' data-rindex='1'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>symmetric keys</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>persistent secrets</span>
<input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox exclusive'></input><span>no other keys</span>
</span>. 
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__stg__ext.1.1 -->
<div id='Mobile_Device_Fundamentals:fcs__stg__ext.1.2' class='requirement fcs__stg__ext.1.2'><div class='f-el-title'>FCS_STG_EXT.1.2</div><div class='words'>The TSF shall be capable of importing keys/secrets into the secure key storage upon request of 
              <span class='selectables' data-rindex='0'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>the user</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>the administrator</span>
</span> and 
                <span class='selectables' data-rindex='1'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>applications running on the TSF</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox exclusive'></input><span>no other subjects</span>
</span>.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__stg__ext.1.2 -->
<div id='Mobile_Device_Fundamentals:fcs__stg__ext.1.3' class='requirement fcs__stg__ext.1.3'><div class='f-el-title'>FCS_STG_EXT.1.3</div><div class='words'>The TSF shall be capable of destroying keys/secrets in the secure key storage upon request of 
              <span class='selectables' data-rindex='0'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>the user</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>the administrator</span>
</span>.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__stg__ext.1.3 -->
<div id='Mobile_Device_Fundamentals:fcs__stg__ext.1.4' class='requirement fcs__stg__ext.1.4'><div class='f-el-title'>FCS_STG_EXT.1.4</div><div class='words'>The TSF shall have the capability to allow only the application that imported the key/secret the use of the key/secret. Exceptions may only be explicitly authorized by 
              <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>the user</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>the administrator</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>a common application developer</span>
</li>
</ul>
</span>.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__stg__ext.1.4 -->
<div id='Mobile_Device_Fundamentals:fcs__stg__ext.1.5' class='requirement fcs__stg__ext.1.5'><div class='f-el-title'>FCS_STG_EXT.1.5</div><div class='words'>The TSF shall allow only the application that imported the key/secret to request that the key/secret be destroyed. Exceptions may only be explicitly authorized by 
              <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>the user</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>the administrator</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>a common application developer</span>
</li>
</ul>
</span>. 
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__stg__ext.1.5 -->
<div class='aactivity'>
The evaluator shall review the  TSS to determine that the TOE’s implements the required secure key storage. The evaluator shall ensure that the  TSS contains a description of the key storage mechanism that justifies the selection of "mutable hardware" or "software-based".
              <br/><br/>
              The evaluator shall review the AGD guidance to determine that it describes the steps needed to import or destroy keys/secrets. The evaluator shall also verify that the API documentation provided according to  includes the security functions (import, use, and destruction) described in these requirements. The API documentation shall include the method by which applications restrict access to their keys/secrets in order to meet FCS_STG_EXT.1.4. 
              <br/><br/>
              The evaluator shall test the functionality of each security function:
              
              
                The evaluator shall import keys/secrets of each supported type according to the AGD guidance. The evaluator shall write, or the developer shall provide access to, an application that generates a key/secret of each supported type and calls the import functions. The evaluator shall verify that no errors occur during import.<br/>
                The evaluator shall write, or the developer shall provide access to, an application that uses an imported key/secret:
                  <br/>
                  <ul>
                    <li>For RSA, the secret shall be used to sign data.</li>
                    <li>For ECDSA, the secret shall be used to sign data</li>
                  </ul>
                  <br/>
                  In the future additional types will be required to be tested:
                  <br/>
                  <ul>
                    <li>For symmetric algorithms, the secret shall be used to encrypt data.</li>
                    <li>For persistent secrets, the secret shall be compared to the imported secret. </li>
                  </ul>
                  <br/>
                  The evaluator shall repeat this test with the application-imported keys/secrets and a different application’s imported keys/secrets. The evaluator shall verify that the TOE requires approval before allowing the application to use the key/secret imported by the user or by a different application:
                  <br/>
                    <ul>
                      <li>The evaluator shall deny the approvals to verify that the application is not able to use the key/secret as described. </li>
                      <li>The evaluator shall repeat the test, allowing the approvals to verify that the application is able to use the key/secret as described.</li>
                    </ul>
                  <br/>
                  If the ST Author has selected "common application developer", this test is performed by either using applications from different developers or appropriately (according to API documentation) not authorizing sharing.
                
                <br/>
                The evaluator shall destroy keys/secrets of each supported type according to the AGD guidance. The evaluator shall write, or the developer shall provide access to, an application that destroys an imported key/secret.
                  <br/><br/>
                  The evaluator shall repeat this test with the application-imported keys/secrets and a different application’s imported keys/secrets. The evaluator shall verify that the TOE requires approval before allowing the application to destroy the key/secret imported by the administrator or by a different application:
                  <br/><br/>
                  <ul>
                    <li>The evaluator shall deny the approvals and verify that the application is still able to use the key/secret as described. </li>
                    <li>The evaluator shall repeat the test, allowing the approvals and verifying that the application is no longer able to use the key/secret as described.</li>
                  </ul>
                  <br/>
                  If the ST Author has selected "common application developer", this test is performed by either using applications from different developers or appropriately (according to API documentation) not authorizing sharing.
                
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fcs__stg__ext.1 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fcs__stg__ext.2' class='component fcs__stg__ext.2'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_STG_EXT.2 &#8212; Extended: Encrypted Cryptographic Key Storage</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fcs__stg__ext.2.1' class='requirement fcs__stg__ext.2.1'><div class='f-el-title'>FCS_STG_EXT.2.1</div><div class='words'>The TSF shall encrypt all DEKs, KEKs, 
              <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='any long-term trusted channel key material'></textarea> and 
              <span class='selectables' data-rindex='0'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>all software-based key storage</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox exclusive'></input><span>no other keys</span>
</span> by KEKs that are 
              <span class='selectables' data-rindex='1'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>Protected by the REK with 
                  <span class='selectables' data-rindex='2'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>encryption by a REK</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>encryption by a KEK chaining from a REK</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>encryption by a KEK that is derived from a REK</span>
</li>
</ul>
</span>
                 </span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>Protected by the REK and the password with 
                  <span class='selectables' data-rindex='3'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>encryption by a REK and the password-derived KEK</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>encryption by a KEK chaining to a REK and the password-derived or biometric-unlocked KEK</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>encryption by a KEK that is derived from a REK and the password-derived or biometric-unlocked KEK</span>
</li>
</ul>
</span>
              </span>
</li>
</ul>
</span>.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__stg__ext.2.1 -->
<div class='aactivity'>
The evaluator shall review the  TSS to determine that the  TSS includes key hierarchy description of the protection of each DEK for data-at-rest, of software-based key storage, of long-term trusted channel keys, and of KEK related to the protection of the DEKs, long-term trusted channel keys, and software-based key storage. This description must include a diagram illustrating the key hierarchy implemented by the TOE in order to demonstrate that the implementation meets FCS_STG_EXT.2. The description shall indicate how the functionality described by FCS_RBG_EXT.1 is invoked to generate DEKs (FCS_CKM_EXT.2), the key size (FCS_CKM_EXT.2 and FCS_CKM_EXT.3) for each key, how each KEK is formed (generated, derived, or combined according to FCS_CKM_EXT.3), the integrity protection method for each encrypted key (FCS_STG_EXT.3), and the IV generation for each key encrypted by the same KEK (FCS_IV_EXT.1). More detail for each task follows the corresponding requirement. 
            </div><div id='Mobile_Device_Fundamentals:fcs__stg__ext.2.2' class='requirement fcs__stg__ext.2.2'><div class='f-el-title'>FCS_STG_EXT.2.2</div><div class='words'>DEKs, KEKs, <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='any long-term trusted channel key material'></textarea> and
              <span class='selectables' data-rindex='0'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>all software-based key storage</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox exclusive'></input><span>no other keys</span>
</span> shall be encrypted using one of the following methods: 
              <span class='selectables' data-rindex='1'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>using a SP800-56B key establishment scheme</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>using AES in the 
                <span class='selectables' data-rindex='2'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>Key Wrap (KW) mode</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>Key Wrap with Padding (KWP) mode</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>GCM</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span>CCM</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='4' class='val selbox'></input><span>CBC mode</span>
</li>
</ul>
</span></span>
</li>
</ul>
</span>
                . </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__stg__ext.2.2 -->
<div class='aactivity'>
The evaluator shall examine the key hierarchy description in the  TSS section to verify that each DEK and software-stored key is encrypted according to FCS_STG_EXT.2.</div>
</div></span><!-- End: Mobile_Device_Fundamentals:fcs__stg__ext.2 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fcs__stg__ext.3' class='component fcs__stg__ext.3'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_STG_EXT.3 &#8212; Extended: Integrity of encrypted key storage</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fcs__stg__ext.3.1' class='requirement fcs__stg__ext.3.1'><div class='f-el-title'>FCS_STG_EXT.3.1</div><div class='words'>The TSF shall protect the integrity of any encrypted DEKs and KEKs and 
              <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>long-term trusted channel key material</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>all software-based key storage</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox exclusive'></input><span>no other keys</span>
</li>
</ul>
</span> 
                by 
              <span class='selectables' data-rindex='1'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>
                  <span class='selectables' data-rindex='2'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>GCM</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>CCM</span>
<input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>Key Wrap</span>
<input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span>Key Wrap with Padding</span>
</span> cipher mode for encryption according to FCS_STG_EXT.2</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>a hash (FCS_COP.1(2)) of the stored key that is encrypted by a key protected by FCS_STG_EXT.2</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>a keyed hash (FCS_COP.1(4)) using a key protected by a key protected by FCS_STG_EXT.2</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span>a digital signature of the stored key using an asymmetric key protected according to FCS_STG_EXT.2</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='4' class='val selbox'></input><span>an immediate application of the key for decrypting the protected data followed by a successful verification of the decrypted data with previously known information</span>
</li>
</ul>
</span>.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__stg__ext.3.1 -->
<div id='Mobile_Device_Fundamentals:fcs__stg__ext.3.2' class='requirement fcs__stg__ext.3.2'><div class='f-el-title'>FCS_STG_EXT.3.2</div><div class='words'>The TSF shall verify the integrity of the 
              <span class='selectables' data-rindex='0'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>hash</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>digital signature</span>
<input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>MAC</span>
</span> of the stored key prior to use of the key.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__stg__ext.3.2 -->
<div class='aactivity'>
The evaluator shall examine the key hierarchy description in the  TSS section to verify that each encrypted key is integrity protected according to one of the options in FCS_STG_EXT.3. 
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fcs__stg__ext.3 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fcs__tlsc__ext.1' class='component fcs__tlsc__ext.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_TLSC_EXT.1 &#8212; Extended: TLS Protocol</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fcs__tlsc__ext.1.1' class='requirement fcs__tlsc__ext.1.1'><div class='f-el-title'>FCS_TLSC_EXT.1.1</div><div class='words'>The TSF shall implement TLS 1.2 (RFC 5246) supporting the following ciphersuites:<br/>
            <ul>
              <li>Mandatory Ciphersuites:<span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>TLS_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>TLS_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</span>
</li>
</ul>
</span>
              </li>
              <li>Optional Ciphersuites:
                <span class='selectables' data-rindex='1'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>TLS_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5288</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>TLS_DHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>TLS_DHE_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span>TLS_DHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5288</span>
</li>
<li><input type='checkbox' id='Mobile_Device_Fundamentals:tlsc_1' onchange='update(this); ' data-rindex='4' class='val selbox tlsc_1'></input><span>TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</span>
</li>
<li><input type='checkbox' id='Mobile_Device_Fundamentals:tlsc_2' onchange='update(this); ' data-rindex='5' class='val selbox tlsc_2'></input><span>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</span>
</li>
<li><input type='checkbox' id='Mobile_Device_Fundamentals:tlsc_3' onchange='update(this); ' data-rindex='6' class='val selbox tlsc_3'></input><span>TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 as defined in RFC 5289</span>
</li>
<li><input type='checkbox' id='Mobile_Device_Fundamentals:tlsc_4' onchange='update(this); ' data-rindex='7' class='val selbox tlsc_4'></input><span>TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5289</span>
</li>
<li><input type='checkbox' id='Mobile_Device_Fundamentals:tlsc_5' onchange='update(this); ' data-rindex='8' class='val selbox tlsc_5'></input><span>TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</span>
</li>
<li><input type='checkbox' id='Mobile_Device_Fundamentals:tlsc_6' onchange='update(this); ' data-rindex='9' class='val selbox tlsc_6'></input><span>TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384 as defined in RFC 5289</span>
</li>
<li><input type='checkbox' id='Mobile_Device_Fundamentals:tlsc_7' onchange='update(this); ' data-rindex='10' class='val selbox tlsc_7'></input><span>TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</span>
</li>
<li><input type='checkbox' id='Mobile_Device_Fundamentals:tlsc_8' onchange='update(this); ' data-rindex='11' class='val selbox tlsc_8'></input><span>TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5289</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='12' class='val selbox exclusive'></input><span>no other ciphersuite</span>
</li>
</ul>
</span>
              </li>
            </ul>
          </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__tlsc__ext.1.1 -->
<div class='aactivity'>
The evaluator shall check the description of the implementation of this protocol in the TSS to ensure that the ciphersuites supported are specified. The evaluator shall check the TSS to ensure that the ciphersuites specified include those listed for this component. The evaluator shall also check the operational guidance to ensure that it contains instructions on configuring the TOE so that TLS conforms to the description in the TSS.<br/><br/>
            The evaluator shall write, or the ST author shall provide, an application for the purposes of testing TLS. The evaluator shall also perform the following tests:
            
              The evaluator shall establish a TLS connection using each of the ciphersuites specified by the requirement. This connection may be established as part of the establishment of a higher-level protocol, e.g., as part of an EAP session. It is sufficient to observe the successful negotiation of a ciphersuite to satisfy the intent of the test; it is not necessary to examine the characteristics of the encrypted traffic in an attempt to discern the ciphersuite being used (for example, that the cryptographic algorithm is 128-bit AES and not 256-bit AES).
              The evaluator shall attempt to establish the connection using a server with a server certificate that contains the Server Authentication purpose in the extendedKeyUsage field and verify that a connection is established. The evaluator will then verify that the client rejects an otherwise valid server certificate that lacks the Server Authentication purpose in the extendedKeyUsage field and a connection is not established. Ideally, the two certificates should be identical except for the extendedKeyUsage field.
              The evaluator shall send a server certificate in the TLS connection that the does not match the server-selected ciphersuite (for example, send a ECDSA certificate while using the TLS_RSA_WITH_AES_128_CBC_SHA ciphersuite or send a RSA certificate while using one of the ECDSA ciphersuites.) The evaluator shall verify that the TOE disconnects after receiving the server’s Certificate handshake message.
              The evaluator shall configure the server to select the TLS_NULL_WITH_NULL_NULL ciphersuite and verify that the client denies the connection.
              The evaluator shall perform the following modifications to the traffic:<br/>
                <ul>
                  <li>Change the TLS version selected by the server in the Server Hello to a non-supported TLS version (for example, 1.3 represented by the two bytes 03 04) and verify that the client rejects the connection.</li>
                  <li>Modify at least one byte in the server’s nonce in the Server Hello handshake message, and verify that the client rejects the Server Key Exchange handshake message (if using a DHE or ECDHE ciphersuite) or that the server denies the client’s Finished handshake message.</li>
                  <li>Modify the server’s selected ciphersuite in the Server Hello handshake message to be a ciphersuite not presented in the Client Hello handshake message. The evaluator shall verify that the client rejects the connection after receiving the Server Hello.</li>
                  <li>(conditional) If an ECDHE or DHE ciphersuite is selected, modify the signature block in the Server’s Key Exchange handshake message, and verify that the client rejects the connection after receiving the Server Key Exchange message.</li>
                  <li>Modify a byte in the Server Finished handshake message, and verify that the client sends a fatal alert upon receipt and does not send any application data.</li>
                  <li>Send a valid Server Finished message in plaintext and verify the client sends a fatal alert upon receipt and does not send any application data. The server’s finished message shall contain valid verify_data and shall parse correctly using a network protocol analysis tool.</li>
                </ul>
            
          </div><div id='Mobile_Device_Fundamentals:fcs__tlsc__ext.1.2' class='requirement fcs__tlsc__ext.1.2'><div class='f-el-title'>FCS_TLSC_EXT.1.2</div><div class='words'>The TSF shall verify that the presented identifier matches the reference identifier according to RFC 6125.
          </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__tlsc__ext.1.2 -->
<div class='aactivity'>
The evaluator shall ensure that the TSS describes the client’s method of establishing all reference identifiers from the application-configured reference identifier, including which types of reference identifiers are supported (e.g. Common Name, DNS Name, URI Name, Service Name, or other application-specific Subject Alternative Names) and whether IP addresses and wildcards are supported. The evaluator shall ensure that this description identifies whether and the manner in which certificate pinning is supported or used by the TOE.<br/><br/>
            The evaluator shall verify that the AGD guidance includes instructions for setting the reference identifier to be used for the purposes of certificate validation in TLS. In particular, the AGD guidance should describe the API used by applications for configuring the reference identifier.<br/><br/>
            The evaluator shall configure the reference identifier according to the AGD guidance and perform the following tests during a TLS connection:
            
              The evaluator shall present a server certificate that does not contain an identifier in either the Subject Alternative Name (SAN) or Common Name (CN) that matches the reference identifier. The evaluator shall verify that the connection fails.
              The evaluator shall present a server certificate that contains a CN that matches the reference identifier, contains the SAN extension, but does not contain an identifier in the SAN that matches the reference identifier. The evaluator shall verify that the connection fails. The evaluator shall repeat this test for each supported SAN type.
              If the TOE does not mandate the presence of the SAN extension, the evaluator shall present a server certificate that contains a CN that matches the reference identifier and does not contain the SAN extension. The evaluator shall verify that the connection succeeds. If the TOE does mandate the presence of the SAN extension, this Test shall be omitted.
              The evaluator shall present a server certificate that contains a CN that does not match the reference identifier but does contain an identifier in the SAN that matches. The evaluator shall verify that the connection succeeds.
              The evaluator shall perform the following wildcard tests with each supported type of reference identifier:
                <ul>
                  <li>The evaluator shall present a server certificate containing a wildcard that is not in the left-most label of the presented identifier (e.g. foo.*.example.com) and verify that the connection fails.</li>
                  <li>The evaluator shall present a server certificate containing a wildcard in the left-most label but not preceding the public suffix (e.g. *.example.com). The evaluator shall configure the reference identifier with a single left-most label (e.g. foo.example.com) and verify that the connection succeeds. The evaluator shall configure the reference identifier without a left-most label as in the certificate (e.g. example.com) and verify that the connection fails. The evaluator shall configure the reference identifier with two left-most labels (e.g. bar.foo.example.com) and verify that the connection fails.</li>
                  <li>The evaluator shall present a server certificate containing a wildcard in the left-most label immediately preceding the public suffix (e.g. *.com). The evaluator shall configure the reference identifier with a single left-most label (e.g. foo.com) and verify that the connection fails. The evaluator shall configure the reference identifier with two left-most labels (e.g. bar.foo.com) and verify that the connection fails.</li>
                </ul>
              [conditional] If URI or Service name reference identifiers are supported, the evaluator shall configure the DNS name and the service identifier. The evaluator shall present a server certificate containing the correct DNS name and service identifier in the URIName or SRVName fields of the SAN and verify that the connection succeeds. The evaluator shall repeat this test with the wrong service identifier (but correct DNS name) and verify that the connection fails.
              [conditional] If pinned certificates are supported the evaluator shall present a certificate that does not match the pinned certificate and verify that the connection fails.
            
          </div><div id='Mobile_Device_Fundamentals:fcs__tlsc__ext.1.3' class='requirement fcs__tlsc__ext.1.3'><div class='f-el-title'>FCS_TLSC_EXT.1.3</div><div class='words'>The TSF shall not establish a trusted channel if the peer certificate is invalid.
          </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__tlsc__ext.1.3 -->
<div class='aactivity'>
The evaluator shall perform the following test:
            
              The evaluator shall demonstrate that using a certificate without a valid certification path results in the function failing. Using the administrative guidance, the evaluator shall then load a certificate or certificates to the Trust Anchor Database needed to validate the certificate to be used in the function, and demonstrate that the function succeeds. The evaluator then shall delete one of the certificates, and show that the function fails.
            
          </div><div id='Mobile_Device_Fundamentals:fcs__tlsc__ext.1.4' class='requirement fcs__tlsc__ext.1.4'><div class='f-el-title'>FCS_TLSC_EXT.1.4</div><div class='words'>The TSF shall support mutual authentication using X.509v3 certificates.
          </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__tlsc__ext.1.4 -->
<div class='aactivity'>
The evaluator shall ensure that the TSS description required per FIA_X509_EXT.2.1 includes the use of client-side certificates for TLS mutual authentication.<br/><br/>
            The evaluator shall verify that the AGD guidance required per FIA_X509_EXT.2.1 includes instructions for configuring the client-side certificates for TLS mutual authentication.<br/><br/>
            The evaluator shall also perform the following test:
            
              The evaluator shall perform the following modification to the traffic:<br/>
               The evaluator shall establish a connection to a peer server that is not configured for mutual authentication (i.e. does not send Server’s Certificate Request (type 13) message). The evaluator observes negotiation of a TLS channel and confirms that the TOE did not send Client’s Certificate message (type 11) during handshake.
                  
                The evaluator shall establish a connection to a peer server with a shared trusted root that is configured for mutual authentication (i.e. it sends Server’s Certificate Request (type 13) message). The evaluator observes negotiation of a TLS channel and confirms that the TOE responds with a non-empty Client’s Certificate message (type 11) and Certificate Verify (type 15) message.
            
          </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fcs__tlsc__ext.1 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fcs__tlsc__ext.2' class='component fcs__tlsc__ext.2 sel-based disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_TLSC_EXT.2 &#8212; Extended: TLS Protocol</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fcs__tlsc__ext.2.1' class='requirement fcs__tlsc__ext.2.1'><div class='f-el-title'>FCS_TLSC_EXT.2.1</div><div class='words'>The TSF shall present the Supported Elliptic Curves Extension in the Client Hello handshake message with the following NIST curves: 
              <span class='selectables' data-rindex='0'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>secp256r1</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>secp384r1</span>
<input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>secp521r1</span>
</span>.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__tlsc__ext.2.1 -->
<div class='aactivity'>
The evaluator shall verify that TSS describes the Supported Elliptic Curves Extension and whether the required behavior is performed by default or may be configured. If the TSS indicates that the Supported Elliptic Curves Extension must be configured to meet the requirement, the evaluator shall verify that AGD guidance includes configuration of the Supported Elliptic Curves Extension.<br/><br/>
              
                 The evaluator shall configure a server to perform ECDHE key exchange using each of the TOE’s supported curves and shall verify that the TOE successfully connects to the server.
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fcs__tlsc__ext.2 -->
<span class='comp-notes'></span><br/><span class='tooltipped'><input type='checkbox' onchange='handleOCheck(this); return false;'></input></span>
<span id='Mobile_Device_Fundamentals:fcs__tlsc__ext.3' class='component fcs__tlsc__ext.3 disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_TLSC_EXT.3 &#8212; Extended: TLS Protocol</a><span class='tooltiptext'>objective</span>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fcs__tlsc__ext.3.1' class='requirement fcs__tlsc__ext.3.1'><div class='f-el-title'>FCS_TLSC_EXT.3.1</div><div class='words'>The TSF shall present the signature_algorithms extension in the Client Hello with the supported_signature_algorithms value containing the following hash algorithms: 
              <span class='selectables' data-rindex='0'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>SHA256</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>SHA384</span>
<input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>SHA512</span>
</span> and no other hash algorithms.</div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__tlsc__ext.3.1 -->
<div class='aactivity'>
The evaluator shall verify that TSS describes the signature_algorithm extension and whether the required behavior is performed by default or may be configured. If the TSS indicates that the signature_algorithm extension must be configured to meet the requirement, the evaluator shall verify that AGD guidance includes configuration of the signature_algorithm extension.<br/><br/>
              The evaluator shall also perform the following test:
              
                The evaluator shall configure the server to send a certificate in the TLS connection that is not supported according to the Client’s HashAlgorithm enumeration within the signature_algorithms extension (for example, send a certificate with a SHA-1 signature). The evaluator shall verify that the TOE disconnects after receiving the server’s Certificate handshake message.
              
            </div><div id='Mobile_Device_Fundamentals:fcs__tlsc__ext.3.2' class='requirement fcs__tlsc__ext.3.2'><div class='f-el-title'>FCS_TLSC_EXT.3.2</div><div class='words'>The TSF shall support secure renegotiation through use of the "renegotiation_info" TLS extension in accordance with RFC 5746.</div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__tlsc__ext.3.2 -->
<div id='Mobile_Device_Fundamentals:fcs__tlsc__ext.3.3' class='requirement fcs__tlsc__ext.3.3'><div class='f-el-title'>FCS_TLSC_EXT.3.3</div><div class='words'>The TSF shall include (choose only one of)
              <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>renegotiation_info extension</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>TLS_EMPTY_RENEGOTIATION_INFO_SCSV ciphersuite</span>
</li>
</ul>
</span> in the ClientHello message.</div>
</div><!-- End: Mobile_Device_Fundamentals:fcs__tlsc__ext.3.3 -->
<div class='aactivity'>
The evaluator shall perform the following tests:
              
                The evaluator shall use a network packet analyzer/sniffer to capture the traffic between the two TLS endpoints. The evaluator shall verify that either the "renegotiation_info" field or the SCSV ciphersuite is included in the ClientHello packet during the initial handshake.
                The evaluator shall verify the Client’s handling of ServerHello messages received during the initial handshake that include the "renegotiation_info" extension. The evaluator shall modify the length portion of this field in the ServerHello message to be non-zero and verify that the client sends a failure and terminates the connection. The evaluator shall verify that a properly formatted field results in a successful TLS connection.
                The evaluator shall verify that ServerHello messages received during secure renegotiation contain the "renegotiation_info" extension. The evaluator shall modify either the "client_verify_data" or "server_verify_data" value and verify that the client terminates the connection.
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fcs__tlsc__ext.3 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fdp__acf__ext.1' class='component fdp__acf__ext.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FDP_ACF_EXT.1 &#8212; Extended: Security access control</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fdp__acf__ext.1.1' class='requirement fdp__acf__ext.1.1'><div class='f-el-title'>FDP_ACF_EXT.1.1</div><div class='words'>The TSF shall provide a mechanism to restrict the system services that are accessible to an application.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fdp__acf__ext.1.1 -->
<div class='aactivity'>
The evaluator shall ensure the  TSS lists all system services available for use by an application. The evaluator shall also ensure that the  TSS describes how applications interface with these system services, and means by which these system services are protected by the TSF. 
              <br/><br/>
              The  TSS shall describe which of the following categories each system service falls in:<br/>
              <ol>
                <li>No applications are allowed access</li>
                <li>Privileged applications are allowed access</li>
                <li>Applications are allowed access by user authorization</li>
                <li>All applications are allowed access</li>
              </ol>
              Privileged applications include any applications developed by the TSF developer. The  TSS shall describe how privileges are granted to third-party applications. For both types of privileged applications, the  TSS shall describe how and when the privileges are verified and how the TSF prevents unprivileged applications from accessing those services.
              <br/><br/>
              For any services for which the user may grant access, the evaluator shall ensure that the  TSS identifies whether the user is prompted for authorization when the application is installed, or during runtime. The evaluator shall ensure that the operational user guidance contains instructions for restricting application access to system services. 
              <br/><br/>
              Assurance Activity Note: The following tests require the vendor to provide access to a test platform that provides the evaluator with tools that are typically not found on consumer Mobile Device products. 
              <br/><br/>
              The evaluator shall write, or the developer shall provide, applications for the purposes of the following tests.
              <br/><br/>
              
                For each system service to which no applications are allowed access, the evaluator shall attempt to access the system service with a test application and verify that the application is not able to access that system service.
                For each system service to which only privileged applications are allowed access, the evaluator shall attempt to access the system service with an unprivileged application and verify that the application is not able to access that system service. The evaluator shall attempt to access the system service with a privileged application and verify that the application can access the service.
                For each system service to which the user may grant access, the evaluator shall attempt to access the system service with a test application. The evaluator shall ensure that either the system blocks such accesses or prompts for user authorization. The prompt for user authorization may occur at runtime or at installation time, and should be consistent with the behavior described in the  TSS. 
                For each system service listed in the  TSS that is accessible by all applications, the evaluator shall test that an application can access that system service.
              
            </div><div id='Mobile_Device_Fundamentals:fdp__acf__ext.1.2' class='requirement fdp__acf__ext.1.2'><div class='f-el-title'>FDP_ACF_EXT.1.2</div><div class='words'>The TSF shall provide an access control policy that prevents 
              <span class='selectables' data-rindex='0'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>application</span>
<input type='checkbox' id='Mobile_Device_Fundamentals:fdp_group' onchange='update(this); ' data-rindex='1' class='val selbox fdp_group'></input><span>groups of applications</span>
</span> from accessing 
              <span class='selectables' data-rindex='1'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>all</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>private</span>
</span> data stored by other 
              <span class='selectables' data-rindex='2'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>application</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>groups of applications</span>
</span>. Exceptions may only be explicitly authorized for such sharing by 
              <span class='selectables' data-rindex='3'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>the user</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>the administrator</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>a common application developer</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span>no one</span>
</li>
</ul>
</span>.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fdp__acf__ext.1.2 -->
<div class='aactivity'>
The evaluator shall examine the  TSS to verify that it describes which data sharing is permitted between applications, which data sharing is not permitted, and how disallowed sharing is prevented. It is possible to select both "application" and "groups of application", in which case the  TSS is expected to describe the data sharing policies that would be applied in each case.
              
                The evaluator shall write, or the developer shall provide, two applications, one that saves data containing a unique string and the other, which attempts to access that data. If "groups of applications" is selected, the applications shall be placed into different groups. If "application" is selected, the evaluator shall install the two applications. If "private data" is selected, the application shall not write to a designated shared storage area. The evaluator shall verify that the second application is unable to access the stored unique string. 
                  <br/><br/>
                  If "the user" is selected, the evaluator shall grant access as the user and verify that the second application is able to access the stored unique string.
                  <br/><br/>
                  If "the administrator" is selected, the evaluator shall grant access as the administrator and verify that the second application is able to access the stored unique string.
                  <br/><br/>
                  If "a common application developer" is selected, the evaluator shall grant access to an, application with a common application developer to the first, and verify that the application is able to access the stored unique string.
                
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fdp__acf__ext.1 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fdp__acf__ext.2' class='component fdp__acf__ext.2 sel-based disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FDP_ACF_EXT.2 &#8212; Extended: Security access control</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fdp__acf__ext.2.1' class='requirement fdp__acf__ext.2.1'><div class='f-el-title'>FDP_ACF_EXT.2.1</div><div class='words'>The TSF shall provide a separate 
              <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>address book</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>calendar</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>keystore</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span>account credential database, 
              <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='list of additional resources'></textarea></span>
</li>
</ul>
</span> for each application group and only allow applications within that process group to access the resource. Exceptions may only be explicitly authorized for such sharing by 
                <span class='selectables' data-rindex='1'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>the user</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>the administrator</span>
<input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>no one</span>
</span>.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fdp__acf__ext.2.1 -->
<div class='aactivity'>
For each selected resource, the evaluator shall cause data to be placed into the Enterprise group’s instance of that shared resource. The evaluator shall install an application into the Personal group that attempts to access the shared resource information and verify that it cannot access the information.
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fdp__acf__ext.2 -->
<span class='comp-notes'></span><br/><span class='tooltipped'><input type='checkbox' onchange='handleOCheck(this); return false;'></input></span>
<span id='Mobile_Device_Fundamentals:fdp__acf__ext.3' class='component fdp__acf__ext.3 disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FDP_ACF_EXT.3 &#8212; Extended: Security attribute based access control</a><span class='tooltiptext'>objective</span>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fdp__acf__ext.3.1' class='requirement fdp__acf__ext.3.1'><div class='f-el-title'>FDP_ACF_EXT.3.1</div><div class='words'>The TSF shall enforce an access control policy that prohibits an application from granting both write and execute permission to a file on the device except for <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>files stored in the application's private data folder</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>no exceptions</span>
</li>
</ul>
</span>.</div>
</div><!-- End: Mobile_Device_Fundamentals:fdp__acf__ext.3.1 -->
<div class='aactivity'>
Assurance Activity Note: The following tests require the developer to provide access to a test platform that provides the evaluator with tools that are typically not found on consumer Mobile Device products.<br/><br/>
                              
                The evaluator shall write, or the developer shall provide, an application that attempts to store a file with both write and execute permissions. If the selection is "no exceptions", then the evaluator shall verify that this action fails and that the permissions on the file are not simultaneously write and execute.  If the selection is "application's private data folder", then the evaluator shall ensure that the attempt to store the file is outside of the application's private data folder.
                
                The evaluator shall traverse the file system examining the permission on each TSF file to verify that no file has both write and execute permissions set.  If the selection is "application's private data folder", then only files outside of this folder need to be examined by the evaluator for this test.
                
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fdp__acf__ext.3 -->
<span class='comp-notes'></span><br/><span class='tooltipped'><input type='checkbox' onchange='handleOCheck(this); return false;'></input></span>
<span id='Mobile_Device_Fundamentals:fdp__blt__ext.1' class='component fdp__blt__ext.1 disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FDP_BLT_EXT.1 &#8212; Extended: Limitation of Bluetooth Device Access</a><span class='tooltiptext'>objective</span>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fdp__blt__ext.1.1' class='requirement fdp__blt__ext.1.1'><div class='f-el-title'>FDP_BLT_EXT.1.1</div><div class='words'>The TSF shall limit the applications that may communicate with a particular paired Bluetooth device.</div>
</div><!-- End: Mobile_Device_Fundamentals:fdp__blt__ext.1.1 -->
<div class='aactivity'>
The evaluator shall ensure that the  TSS describes the mechanism used to prevent unrestricted access to paired Bluetooth devices (and/or their communication data) by every application with access to the Bluetooth system service on the TOE (as listed in FDP_ACF_EXT.1). The evaluator shall verify that this method either restricts access to a single application or provides explicit control of the applications that may communicate with the paired Bluetooth device.
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fdp__blt__ext.1 -->
<span class='comp-notes'></span><br/><span class='tooltipped'><input type='checkbox' onchange='handleOCheck(this); return false;'></input></span>
<span id='Mobile_Device_Fundamentals:fdp__bck__ext.1' class='component fdp__bck__ext.1 disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FDP_BCK_EXT.1 &#8212; Extended: Application Backup</a><span class='tooltiptext'>objective</span>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fdp__bck__ext.1.1' class='requirement fdp__bck__ext.1.1'><div class='f-el-title'>FDP_BCK_EXT.1.1</div><div class='words'>The TSF shall provide a mechanism for applications to mark 
              <span class='selectables' data-rindex='0'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>all application data</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>selected application data</span>
</span> to be excluded from device backups.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fdp__bck__ext.1.1 -->
<div class='aactivity'>
If "all application data" is selected, the evaluator shall install an application that has marked all of its application data to be excluded from backups. The evaluator shall cause data to be placed into the application’s storage area. The evaluator shall attempt to back up the application data and verify that the backup fails or that the application’s data was not included in the backup.
              <br/><br/>
              If "selected application data" is selected, the evaluator shall install an application that has marked selected application data to be excluded from backups. The evaluator shall cause data covered by "selected application data" to be placed into the application’s storage area. The evaluator shall attempt to backup that selected application data and verify that either the backup fails or that the selected data is excluded from the backup.
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fdp__bck__ext.1 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fdp__pba__ext.1' class='component fdp__pba__ext.1 sel-based disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FDP_PBA_EXT.1 &#8212; Extended: Storage of Critical Biometric Parameters</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fdp__pba__ext.1.1' class='requirement fdp__pba__ext.1.1'><div class='f-el-title'>FDP_PBA_EXT.1.1</div><div class='words'>The TSF shall protect the authentication template 
              <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>using a PIN as an additional factor</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>using a password as an additional factor</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span><textarea onchange='update(this);' class='assignment val' rows='1' placeholder='other circumstances'></textarea></span>
</li>
</ul>
</span>.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fdp__pba__ext.1.1 -->
<div class='aactivity'>
The evaluator shall determine that the  TSS contains a description of the activities that happen during biometric authentication.
              <br/><br/>
              The evaluator shall ensure that the authentication template is protected either using a PIN or by other secure means, as specified by the vendor.
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fdp__pba__ext.1 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fdp__dar' class='component fdp__dar'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FDP_DAR &#8212; Data-At-Rest Protection</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:' class='requirement '><div class='f-el-title'></div><div class='words'></div>
</div><!-- End: Mobile_Device_Fundamentals: -->

</div></span><!-- End: Mobile_Device_Fundamentals:fdp__dar -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fdp__dar__ext.1' class='component fdp__dar__ext.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FDP_DAR_EXT.1 &#8212; Extended: Protected Data Encryption</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fdp__dar__ext.1.1' class='requirement fdp__dar__ext.1.1'><div class='f-el-title'>FDP_DAR_EXT.1.1</div><div class='words'>Encryption shall cover all protected data.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fdp__dar__ext.1.1 -->
<div id='Mobile_Device_Fundamentals:fdp__dar__ext.1.2' class='requirement fdp__dar__ext.1.2'><div class='f-el-title'>FDP_DAR_EXT.1.2</div><div class='words'>Encryption shall be performed using DEKs with AES in the 
              <span class='selectables' data-rindex='0'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>XTS</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>CBC</span>
<input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>GCM</span>
</span> mode with key size 
              <span class='selectables' data-rindex='1'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>128</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>256</span>
</span> bits. 
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fdp__dar__ext.1.2 -->
<div class='aactivity'>
The evaluator shall verify that the  TSS section of the ST indicates which data is protected by the DAR implementation and what data is considered TSF data. The evaluator shall ensure that this data includes all protected data.
              <br/><br/>
              The evaluator shall review the AGD guidance to determine that the description of the configuration and use of the DAR protection does not require the user to perform any actions beyond configuration and providing the authentication credential. The evaluator shall also review the AGD guidance to determine that the configuration does not require the user to identify encryption on a per-file basis. 
              <br/><br/>
              Assurance Activity Note: The following test requires the developer to provide access to a test platform that provides the evaluator with tools that are typically not found on consumer Mobile Device products. 
              <br/><br/>
              
                The evaluator shall enable encryption according to the AGD guidance. The evaluator shall create user data (non-system) either by creating a file or by using an application. The evaluator shall use a tool provided by the developer to verify that this data is encrypted when the product is powered off, in conjunction with Test 1 for FIA_UAU_EXT.1.
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fdp__dar__ext.1 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fdp__dar__ext.2' class='component fdp__dar__ext.2'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FDP_DAR_EXT.2 &#8212; Extended: Sensitive Data Encryption</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fdp__dar__ext.2.1' class='requirement fdp__dar__ext.2.1'><div class='f-el-title'>FDP_DAR_EXT.2.1</div><div class='words'>The TSF shall provide a mechanism for applications to mark data and keys as sensitive.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fdp__dar__ext.2.1 -->
<div class='aactivity'>
The evaluator shall verify that the  TSS includes a description of which data stored by the TSF (such as by native applications) is treated as sensitive. This data may include all or some user or enterprise data and must be specific regarding the level of protection of email, contacts, calendar appointments, messages, and documents. 
              <br/><br/>
              The evaluator shall examine the  TSS to determine that it describes the mechanism that is provided for applications to use to mark data and keys as sensitive. This description shall also contain information reflecting how data and keys marked in this manner are distinguished from data and keys that are not (for instance, tagging, segregation in a "special" area of memory or container, etc.).
              <br/><br/>
              
                The evaluator shall enable encryption of sensitive data and require user authentication according to the AGD guidance. The evaluator shall try to access and create sensitive data (as defined in the ST and either by creating a file or using an application to generate sensitive data) in order to verify that no other user interaction is required.
              
            </div><div id='Mobile_Device_Fundamentals:fdp__dar__ext.2.2' class='requirement fdp__dar__ext.2.2'><div class='f-el-title'>FDP_DAR_EXT.2.2</div><div class='words'>The TSF shall use an asymmetric key scheme to encrypt and store sensitive data received while the product is locked.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fdp__dar__ext.2.2 -->
<div class='aactivity'>
The evaluator shall review the  TSS section of the ST to determine that the  TSS includes a description of the process of receiving sensitive data while the device is in a locked state. The evaluator shall also verify that the description indicates if sensitive data that may be received in the locked state is treated differently than sensitive data that cannot be received in the locked state. The description shall include the key scheme for encrypting and storing the received data, which must involve an asymmetric key and must prevent the sensitive data-at-rest from being decrypted by wiping all key material used to derive or encrypt the data (as described in the application note). The introduction to this section provides two different schemes that meet the requirements, but other solutions may address this requirement.
              <br/><br/>
              The evaluator shall perform the tests in FCS_CKM_EXT.4 for all key material no longer needed while in the locked state and shall ensure that keys for the asymmetric scheme are addressed in the tests performed when transitioning to the locked state.
            </div><div id='Mobile_Device_Fundamentals:fdp__dar__ext.2.3' class='requirement fdp__dar__ext.2.3'><div class='f-el-title'>FDP_DAR_EXT.2.3</div><div class='words'>The TSF shall encrypt any stored symmetric key and any stored private key of the asymmetric key(s) used for the protection of sensitive data according to FCS_STG_EXT.2.1 selection 2. 
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fdp__dar__ext.2.3 -->
<div class='aactivity'>
The evaluator shall verify that the key hierarchy section of the  TSS required for FCS_STG_EXT.2.1 includes the symmetric encryption keys (DEKs) used to encrypt sensitive data. The evaluator shall ensure that these DEKs are encrypted by a key encrypted with (or chain to a KEK encrypted with) the REK and password-derived or biometric-unlocked KEK. 
              <br/><br/>
              The evaluator shall verify that the  TSS section of the ST that describes the asymmetric key scheme includes the protection of any private keys of the asymmetric pairs. The evaluator shall ensure that any private keys that are not wiped and are stored by the TSF are stored encrypted by a key encrypted with (or chain to a KEK encrypted with) the REK and password-derived or biometric-unlocked KEK. 
            </div><div id='Mobile_Device_Fundamentals:fdp__dar__ext.2.4' class='requirement fdp__dar__ext.2.4'><div class='f-el-title'>FDP_DAR_EXT.2.4</div><div class='words'>The TSF shall decrypt the sensitive data that was received while in the locked state upon transitioning to the unlocked state using the asymmetric key scheme and shall re-encrypt that sensitive data using the symmetric key scheme.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fdp__dar__ext.2.4 -->
<div class='aactivity'>
The evaluator shall verify that the  TSS section of the ST that describes the asymmetric key scheme includes a description of the actions taken by the TSF for the purposes of DAR upon transitioning to the unlocked state. These actions shall minimally include decrypting all received data using the asymmetric key scheme and re-encrypting with the symmetric key scheme used to store data while the device is unlocked. 
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fdp__dar__ext.2 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fdp__ifc__ext.1' class='component fdp__ifc__ext.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FDP_IFC_EXT.1 &#8212; Extended: Subset information flow control</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fdp__ifc__ext.1.1' class='requirement fdp__ifc__ext.1.1'><div class='f-el-title'>FDP_IFC_EXT.1.1</div><div class='words'>The TSF shall 
              <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>provide an interface which allows a VPN client to protect all IP traffic using IPsec</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>provide a VPN client which can protect all IP traffic using IPsec</span>
</li>
</ul>
</span> with the exception of IP traffic required to establish the VPN connection.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fdp__ifc__ext.1.1 -->
<div class='aactivity'>

              The evaluator shall verify that the  TSS section of the ST describes the routing of IP traffic through processes on the TSF when a VPN client is enabled. The evaluator shall ensure that the description indicates which traffic does not go through the VPN and which traffic does and that a configuration exists for each baseband protocol in which only the traffic identified by the ST author as necessary for establishing the VPN connection (IKE traffic and perhaps HTTPS or DNS traffic) is not encapsulated by the VPN protocol (IPsec). The evaluator shall verify that the  TSS section describes any differences in the routing of IP traffic when using any supported baseband protocols (e.g. Wi-Fi or, LTE).
              <br/><br/>
              The evaluator shall verify that one (or more) of the following options is addressed by the documentation:
              <br/>
              <ul>
                <li>The description above indicates that if a VPN client is enabled, all configurations route all Data Plane traffic through the tunnel interface established by the VPN client.</li>
                <li>The AGD guidance describes how the user and/or administrator can configure the TSF to meet this requirement.</li>
                <li>The API documentation includes a security function that allows a VPN client to specify this routing.</li>
              </ul>
              <br/>
              
                If the ST author identifies any differences in the routing between Wi-Fi and cellular protocols, the evaluator shall repeat this test with a base station implementing one of the identified cellular protocols.
                  <br/><br/>
                  Step 1: The evaluator shall enable a Wi-Fi configuration as described in the AGD guidance (as required by FTP_ITC_EXT.1). The evaluator shall use a packet sniffing tool between the wireless access point and an Internet-connected network. The evaluator shall turn on the sniffing tool and perform actions with the device such as navigating to websites, using provided applications, and accessing other Internet resources. The evaluator shall verify that the sniffing tool captures the traffic generated by these actions, turn off the sniffing tool, and save the session data. 
                  <br/><br/>
                  Step 2: The evaluator shall configure an IPsec VPN client that supports the routing specified in this requirement, and if necessary, configure the device to perform the routing specified as described in the AGD guidance. The evaluator shall turn on the sniffing tool, establish the VPN connection, and perform the same actions with the device as performed in the first step. The evaluator shall verify that the sniffing tool captures traffic generated by these actions, turn off the sniffing tool, and save the session data.
                  <br/><br/>
                  Step 3: The evaluator shall examine the traffic from both step one and step two to verify that all Data Plane traffic is encapsulated by IPsec. The evaluator shall examine the Security Parameter Index (SPI) value present in the encapsulated packets captured in Step two from the TOE to the Gateway and shall verify this value is the same for all actions used to generate traffic through the VPN. Note that it is expected that the SPI value for packets from the Gateway to the TOE is different than the SPI value for packets from the TOE to the Gateway. The evaluator shall be aware that IP traffic on the cellular baseband outside of the IPsec tunnel may be emanating from the baseband processor and shall verify with the manufacturer that any identified traffic is not emanating from the application processor.
                  <br/><br/>
                  Step 4: The evaluator shall perform an ICMP echo from the TOE to the IP address of another device on the local wireless network and shall verify that no packets are sent using the sniffing tool. The evaluator shall attempt to send packets to the TOE outside the VPN tunnel (i.e. not through the VPN gateway), including from the local wireless network, and shall verify that the TOE discards them. 
                
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fdp__ifc__ext.1 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fdp__stg__ext.1' class='component fdp__stg__ext.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FDP_STG_EXT.1 &#8212; Extended: User Data Storage</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fdp__stg__ext.1.1' class='requirement fdp__stg__ext.1.1'><div class='f-el-title'>FDP_STG_EXT.1.1</div><div class='words'>The TSF shall provide protected storage for the Trust Anchor Database.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fdp__stg__ext.1.1 -->
<div class='aactivity'>
The evaluator shall ensure the  TSS describes the Trust Anchor Database implemented that contain certificates used to meet the requirements of this PP. This description shall contain information pertaining to how certificates are loaded into the store, and how the store is protected from unauthorized access (for example, UNIX permissions) in accordance with the permissions established in FMT_SMF_EXT.1 and FMT_MOF_EXT.1.1.
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fdp__stg__ext.1 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fdp__upc__ext.1' class='component fdp__upc__ext.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FDP_UPC_EXT.1 &#8212; Extended: Inter-TSF user data transfer protection</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fdp__upc__ext.1.1' class='requirement fdp__upc__ext.1.1'><div class='f-el-title'>FDP_UPC_EXT.1.1</div><div class='words'>The TSF shall provide a means for non-TSF applications executing on the TOE to use TLS, HTTPS, Bluetooth BR/EDR, and <span class='selectables' data-rindex='0'><input type='checkbox' id='Mobile_Device_Fundamentals:upc_dtls' onchange='update(this); ' data-rindex='0' class='val selbox upc_dtls'></input><span>DTLS</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>Bluetooth LE</span>
<input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>IPsec</span>
<input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span>no other protocol</span>
</span> to provide a protected communication channel between the non-TSF application and another IT product that is logically distinct from other communication channels, provides assured identification of its end points, protects channel data from disclosure, and detects modification of the channel data.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fdp__upc__ext.1.1 -->
<div id='Mobile_Device_Fundamentals:fdp__upc__ext.1.2' class='requirement fdp__upc__ext.1.2'><div class='f-el-title'>FDP_UPC_EXT.1.2</div><div class='words'>The TSF shall permit the non-TSF applications to initiate communication via the trusted channel.</div>
</div><!-- End: Mobile_Device_Fundamentals:fdp__upc__ext.1.2 -->
<div class='aactivity'>
The evaluator shall verify that the API documentation provided according to  includes the security functions (protection channel) described in these requirements, and verify that the APIs implemented to support this requirement include the appropriate settings/parameters so that the application can both provide and obtain the information needed to assure mutual identification of the endpoints of the communication as required by this component. The evaluator shall write, or the developer shall provide access to, an application that requests protected channel services by the TSF. The evaluator shall verify that the results from the protected channel match the expected results according to the API documentation. This application may be used to assist in verifying the protected channel assurance activities for the protocol requirements. 
                <br/><br/>
                The evaluator shall examine the  TSS to determine that it describes that all protocols listed in the  TSS are specified and included in the requirements in the ST. The evaluator shall confirm that the operational guidance contains instructions necessary for configuring the protocol(s) selected for use by the applications. The evaluator shall also perform the following tests:
              
                The evaluators shall ensure that the application is able to initiate communications with an external IT entity using each protocol specified in the requirement, setting up the connections as described in the operational guidance and ensuring that communication is successful.
                
                The evaluator shall ensure, for each communication channel with an authorized IT entity, the channel data are not sent in plaintext.
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fdp__upc__ext.1 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fia__afl__ext.1' class='component fia__afl__ext.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FIA_AFL_EXT.1 &#8212; Extended: Authentication failure handling</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fia__afl__ext.1.1' class='requirement fia__afl__ext.1.1'><div class='f-el-title'>FIA_AFL_EXT.1.1</div><div class='words'>The TSF shall consider password and 
              <span class='selectables' data-rindex='0'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>fingerprint</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span> iris</span>
<input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span> face</span>
<input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span> voice</span>
<input type='checkbox' onchange='update(this); ' data-rindex='4' class='val selbox'></input><span> vein</span>
<input type='checkbox' onchange='update(this); ' data-rindex='5' class='val selbox'></input><span> hybrid</span>
<input type='checkbox' onchange='update(this); ' data-rindex='6' class='val selbox'></input><span> no other</span>
</span> as critical authentication mechanisms. 
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fia__afl__ext.1.1 -->
<div id='Mobile_Device_Fundamentals:fia__afl__ext.1.2' class='requirement fia__afl__ext.1.2'><div class='f-el-title'>FIA_AFL_EXT.1.2</div><div class='words'>The TSF shall detect when a configurable positive integer within 
              <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='range of acceptable values for each authentication mechanism'></textarea> of 
              <span class='selectables' data-rindex='0'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>unique</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>non-unique</span>
</span> unsuccessful authentication attempts occur related to last successful authentication for each authentication mechanism.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fia__afl__ext.1.2 -->
<div id='Mobile_Device_Fundamentals:fia__afl__ext.1.3' class='requirement fia__afl__ext.1.3'><div class='f-el-title'>FIA_AFL_EXT.1.3</div><div class='words'>The TSF shall maintain the number of unsuccessful authentication attempts that have occurred upon power off.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fia__afl__ext.1.3 -->
<div id='Mobile_Device_Fundamentals:fia__afl__ext.1.4' class='requirement fia__afl__ext.1.4'><div class='f-el-title'>FIA_AFL_EXT.1.4</div><div class='words'>When the defined number of unsuccessful authentication attempts has exceeded the maximum allowed for a given authentication mechanism, all future authentication attempts will be limited to other available authentication mechanisms, unless the given mechanism is designated as a critical authentication mechanism. 
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fia__afl__ext.1.4 -->
<div id='Mobile_Device_Fundamentals:fia__afl__ext.1.5' class='requirement fia__afl__ext.1.5'><div class='f-el-title'>FIA_AFL_EXT.1.5</div><div class='words'>When the defined number of unsuccessful authentication attempts for the last available authentication mechanism or single critical authentication mechanism has been surpassed, the TSF shall perform a wipe of all protected data.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fia__afl__ext.1.5 -->
<div id='Mobile_Device_Fundamentals:fia__afl__ext.1.6' class='requirement fia__afl__ext.1.6'><div class='f-el-title'>FIA_AFL_EXT.1.6</div><div class='words'>The TSF shall increment the number of unsuccessful authentication attempts prior to notifying the user that the authentication was unsuccessful. 
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fia__afl__ext.1.6 -->
<div class='aactivity'>
The evaluator shall ensure that the TSS describes that a value corresponding to the number of unsuccessful authentication attempts since the last successful authentication is kept for each Authentication Factor interface. The evaluator shall ensure that this description also includes if and how this value is maintained when the TOE loses power, either through a graceful powered off or an ungraceful loss of power. The evaluator shall ensure that if the value is not maintained, the interface is after another interface in the boot sequence for which the value is maintained. 
              <br/><br/>
              If the TOE supports multiple authentication mechanisms, the evaluator shall ensure that this description also includes how the unsuccessful authentication attempts for each mechanism selected in FIA_UAU.5.1 is handled. The evaluator shall verify that the TSS describes if each authentication mechanism utilizes its own counter or if multiple authentication mechanisms utilize a shared counter. If multiple authentication mechanisms utilize a shared counter, the evaluator shall verify that the TSS describes this interaction.
              <br/><br/>
              The evaluator shall confirm that the  TSS describes how the process used to determine if the authentication attempt was successful. The evaluator shall ensure that the counter would be updated even if power to the device is cut immediately following notifying the TOE user if the authentication attempt was successful or not.
              <br/><br/>
              The evaluator shall verify that the AGD guidance describes how the administrator configures the maximum number of unique unsuccessful authentication attempts. 
              <br/><br/>
              
                The evaluator shall configure the device with all authentication mechanisms selected in FIA_UAU.5.1. The evaluator shall perform the following tests for each available authentication interface:
                  <br/><br/>
                  Test 1a: The evaluator shall configure the TOE, according to the AGD guidance, with a maximum number of unsuccessful authentication attempts. The evaluator shall enter the locked state and enter incorrect passwords until the wipe occurs. The evaluator shall verify that the number of password entries corresponds to the configured maximum and that the wipe is implemented. 
                  <br/><br/>
                  Test 1b: [conditional] If the TOE supports multiple authentication mechanisms the previous test shall be repeated using a combination of authentication mechanisms confirming that the critical authentication mechanisms will cause the device to wipe and that when the maximum number of unsuccessful authentication attempts for a non-critical authentication mechanism is exceeded, the device limits authentication attempts to other available authentication mechanisms. If multiple authentication mechanisms utilize a shared counter, then the evaluator shall verify that the maximum number of unsuccessful authentication attempts can be reached by using each individual authentication mechanism and a combination of all authentication mechanisms that share the counter.
                <br/>
                The evaluator shall repeat test one, but shall power off (by removing the battery, if possible) the TOE between unsuccessful authentication attempts. The evaluator shall verify that the total number of unsuccessful authentication attempts for each authentication mechanism corresponds to the configured maximum and that the critical authentication mechanisms cause the device to wipe. Alternatively, if the number of authentication failures is not maintained for the interface under test, the evaluator shall verify that upon booting the TOE between unsuccessful authentication attempts another authentication factor interface is presented before the interface under test.<br/>
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fia__afl__ext.1 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fia__blt__ext.1' class='component fia__blt__ext.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FIA_BLT_EXT.1 &#8212; Extended: Bluetooth User Authorization</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fia__blt__ext.1.1_' class='requirement fia__blt__ext.1.1_'><div class='f-el-title'>FIA_BLT_EXT.1.1 </div><div class='words'>The TSF shall require explicit user authorization before pairing with a remote Bluetooth device.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fia__blt__ext.1.1_ -->
<div class='aactivity'>

              The evaluator shall examine the  TSS to ensure that it contains a description of when user permission is required for Bluetooth pairing, and that this description mandates explicit user authorization via manual input for all Bluetooth pairing, including application use of the Bluetooth trusted channel and situations where temporary (non-bonded) connections are formed. The evaluator shall examine the API documentation provided according to  and verify that this API documentation does not include any API for programmatic entering of pairing information (e.g. PINs, numeric codes, or "yes/no" responses) intended to bypass manual user input during pairing.
              <br/><br/>
              The evaluator shall examine the AGD guidance to verify that these user authorization screens are clearly identified and instructions are given for authorizing Bluetooth pairings.
              <br/><br/>
              The evaluator shall perform the following test: 
              <br/><br/>
              
                The evaluator shall perform the following steps:
                  <br/><br/>
                  Step 1: Initiate pairing with the TOE from a remote Bluetooth device that requests no man-in-the-middle protection, no bonding, and claims to have NoInputNoOutput input-output (IO) capability. (Such a device will attempt to evoke behavior from the TOE that represents the minimal level of user interaction that the TOE supports during pairing.) 
                  <br/><br/>
                  Step 2: Verify that the TOE does not permit any Bluetooth pairing without explicit authorization from the user (e.g. the user must have to minimally answer "yes" or "allow" in a prompt). 
                
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fia__blt__ext.1 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fia__blt__ext.2' class='component fia__blt__ext.2'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FIA_BLT_EXT.2 &#8212; Extended: Bluetooth Mutual Authentication </a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fia__blt__ext.2.1' class='requirement fia__blt__ext.2.1'><div class='f-el-title'>FIA_BLT_EXT.2.1</div><div class='words'>The TSF shall require Bluetooth mutual authentication between devices prior to any data transfer over the Bluetooth link. 
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fia__blt__ext.2.1 -->
<div class='aactivity'>
The evaluator shall ensure that the  TSS describes how data transfer of any type is prevented before the Bluetooth pairing is completed. The  TSS shall specifically call out any supported RFCOMM and L2CAP data transfer mechanisms. The evaluator shall ensure that the data transfers are only completed after the Bluetooth devices are paired and mutually authenticated
              The evaluator shall perform the following test:
              
                The evaluator shall use a Bluetooth tool to attempt to access TOE files using the OBEX Object Push service and verify that pairing and mutual authentication are required by the TOE before allowing access. (If the OBEX Object Push service is unsupported on the TOE, a different service that transfers data over Bluetooth L2CAP and/or RFCOMM may be used in this test.) 
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fia__blt__ext.2 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fia__blt__ext.3' class='component fia__blt__ext.3'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FIA_BLT_EXT.3 &#8212; Extended: Rejection of Duplicate Bluetooth Connections</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fia__blt__ext.3.1' class='requirement fia__blt__ext.3.1'><div class='f-el-title'>FIA_BLT_EXT.3.1</div><div class='words'>The TSF shall discard connection attempts from a Bluetooth device address (BD_ADDR) to which a current connection already exists.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fia__blt__ext.3.1 -->
<div class='aactivity'>
The evaluator shall ensure that the  TSS describes how Bluetooth connections are maintained such that two devices with the same Bluetooth device address are not simultaneously connected and such that the initial connection is not superseded by any following connection attempts.
              <br/><br/>
              The evaluator shall perform the following test:
              
                The evaluator shall perform the following steps:
                  <br/><br/>
                  Step 1: Make a Bluetooth connection between the TOE and a remote Bluetooth device with address a known address (BD_ADDR1). 
                  <br/><br/>
                  Step 2: Attempt a connection to the same TOE from a second remote Bluetooth device claiming to have a Bluetooth device address matching BD_ADDR1. 
                  <br/><br/>
                  Step 3: Using a Bluetooth protocol analyzer, verify that the second connection attempt is ignored by the TOE and that the initial connection to the device with BR_ADDR1 is unaffected. 
                
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fia__blt__ext.3 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fia__blt__ext.4' class='component fia__blt__ext.4'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FIA_BLT_EXT.4 &#8212; Extended: Secure Simple Pairing</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fia__blt__ext.4.1' class='requirement fia__blt__ext.4.1'><div class='f-el-title'>FIA_BLT_EXT.4.1</div><div class='words'>The TOE shall support Bluetooth Secure Simple Pairing, both in the host and the controller. Furthermore, Secure Simple Pairing shall be used during the pairing process if the remote device also supports it. 
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fia__blt__ext.4.1 -->
<div class='aactivity'>

              
                The evaluator shall perform the following steps:
                  <br/><br/>
                  Step 1: Initiate pairing with the TOE from a remote Bluetooth device that supports Secure Simple Pairing. 
                  <br/><br/>
                  Step 2: During the pairing process, observe the packets in a Bluetooth protocol analyzer and verify that the TOE claims support for both "Secure Simple Pairing (Host Support)" and "Secure Simple Pairing (Controller Support)" during the LMP Features Exchange.
                  <br/><br/>
                  Step 3: Verify that Secure Simple Pairing is used during the pairing process.
                
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fia__blt__ext.4 -->
<span class='comp-notes'></span><br/><span class='tooltipped'><input type='checkbox' onchange='handleOCheck(this); return false;'></input></span>
<span id='Mobile_Device_Fundamentals:fia__blt__ext.5' class='component fia__blt__ext.5 disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FIA_BLT_EXT.5 &#8212; Extended: Bluetooth Authentication – Secure Connections Only</a><span class='tooltiptext'>objective</span>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fia__blt__ext.5.1' class='requirement fia__blt__ext.5.1'><div class='f-el-title'>FIA_BLT_EXT.5.1</div><div class='words'>The TOE shall support Secure Connections Only mode for Bluetooth BR/EDR. </div>
</div><!-- End: Mobile_Device_Fundamentals:fia__blt__ext.5.1 -->
<div id='Mobile_Device_Fundamentals:fia__blt__ext.5.2' class='requirement fia__blt__ext.5.2'><div class='f-el-title'>FIA_BLT_EXT.5.2</div><div class='words'>The TOE shall support Secure Connections Only mode for Bluetooth LE.</div>
</div><!-- End: Mobile_Device_Fundamentals:fia__blt__ext.5.2 -->
<div class='aactivity'>
The evaluator shall ensure that the TSS describes support for Secure Connections Only mode for BR/EDR and LE.
              <br/><br/>
              The evaluator shall perform the following tests once for BR/EDR and once for LE:
              
                The evaluator shall perform the following steps:<br/><br/>
                  Step 1: Put the TOE into Secure Connections Only mode.
                  <br/><br/>
                  Step 2: Attempt a pairing to a remote device that does not support Secure Connections Only mode.
                  <br/><br/>
                  Step 3: Verify that the pairing attempt fails.
                <br/>
                The evaluator shall perform the following steps:<br/><br/>
                  Step 1: Put the TOE into Secure Connections Only mode.
                  <br/><br/>
                  Step 2: Attempt a pairing to a remote device that contains support Secure Connections Only mode and has Secure Connections Only mode enabled.
                  <br/><br/>
                  Step 3: Verify that the pairing attempt succeeds and use a Bluetooth packet sniffer to verify that the parameters of the pairing and encryption are consistent with Secure Connections.
                
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fia__blt__ext.5 -->
<span class='comp-notes'></span><br/><span class='tooltipped'><input type='checkbox' onchange='handleOCheck(this); return false;'></input></span>
<span id='Mobile_Device_Fundamentals:fia__blt__ext.6' class='component fia__blt__ext.6 disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FIA_BLT_EXT.6 &#8212; Extended: Bluetooth User Authorization</a><span class='tooltiptext'>objective</span>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fia__blt__ext.6.1' class='requirement fia__blt__ext.6.1'><div class='f-el-title'>FIA_BLT_EXT.6.1</div><div class='words'>The TSF shall require explicit user authorization before granting trusted remote devices access to services associated with the following Bluetooth profiles: 
              <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='list of Bluetooth profiles'></textarea>, and shall require explicit user authorization before granting untrusted remote devices access to services associated with the following Bluetooth profiles: 
              <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='list of Bluetooth profiles'></textarea>.</div>
</div><!-- End: Mobile_Device_Fundamentals:fia__blt__ext.6.1 -->
<div class='aactivity'>
The evaluator shall perform the following tests for each service protected according to this requirement:<br/>
              
                While the service is in active use by an application on the TOE, the evaluator shall attempt to gain access to a "protected" Bluetooth service (from the second list in the requirement) from a remote device that does not have the required level of trust to use the service. The evaluator shall verify that the user is explicitly asked for authorization by the TOE to allow access to the service for the particular remote device. The evaluator shall deny the authorization on the TOE and verify that the remote attempt to access the service fails due to lack of authorization. <br/>
                The evaluator shall repeat Test 1, allow the authorization, and verify that the remote device successfully accesses the service. Note that this connection may involve pairing, if the untrusted remote device has not yet paired with the TOE.<br/>
                If the TSF implementation differentiates between trusted and untrusted devices when determining if user authorization is required, repeat Test 1 with a service that appears in the second list in the requirement (but not in the first list) and a device that has the required level of trust to use the service. The evaluator shall verify that the user is not prompted for explicit authorization and the connection to the service succeeds.<br/>
                If the TSF implementation differentiates between trusted and untrusted devices when determining if user authorization is required, repeat Test 1 with a service that appears in the first list in the requirement and a device that has the required level of trust to use the service. The evaluator shall verify that the user is explicitly asked for authorization by the TOE to allow access to the service for the particular remote device. The evaluator shall deny the authorization on the TOE and verify that the remote attempt to access the service fails due to lack of authorization. <br/>
                If the TSF implementation differentiates between trusted and untrusted devices when determining if user authorization is required, repeat Test 2 with a service that appears in the first list in the requirement and a device that has the required level of trust to use the service.  The evaluator shall verify that the remote device successfully accesses the service if the user explicitly provides authorization.
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fia__blt__ext.6 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fia__bmg__ext.1' class='component fia__bmg__ext.1 sel-based disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FIA_BMG_EXT.1 &#8212; Extended: Accuracy of Biometric Authentication</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fia__bmg__ext.1.1' class='requirement fia__bmg__ext.1.1'><div class='f-el-title'>FIA_BMG_EXT.1.1</div><div class='words'>The one-attempt BAF False Accept Rate (FAR) for <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='biometric modality selected in FIA_UAU.5.1'></textarea>shall not exceed <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='claimed FAR no greater than 1:100'></textarea> with a one-attempt BAF False Reject Rate (FRR) not to exceed 1 in <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='claimed FRR no greater than 1:10'></textarea>. 
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fia__bmg__ext.1.1 -->
<div class='aactivity'>

              The evaluator shall verify that the TSS contains evidence supporting the testing and calculations completed to determine the FAR and FRR.  provides guidance to how this testing could be completed and to what error bars are expected when the Rule of 3 is applied. The evaluator shall consult  as a reference, but should not treat it as a mandate. The evaluator shall verify that the TSS contains evidence of whether online or offline testing was used. If offline testing was completed, evidence describing the differences between the biometric system used for testing and the TOE  in the evaluated configuration, if any must be included.
              <br/><br/> 
              The following documentation is not required to be part of the TSS - it may be submitted as a separate proprietary document.  The evaluator shall verify the evidence includes how many imposters were used for testing and that the testing describes how imposters are compared to enrolled users, for example, if multiple devices for online testing or full cross-comparison for offline testing was used. Adequate documentation is required to demonstrate that testing was completed to support the claimed FAR and FRR.                                      
            </div><div id='Mobile_Device_Fundamentals:fia__bmg__ext.1.2' class='requirement fia__bmg__ext.1.2'><div class='f-el-title'>FIA_BMG_EXT.1.2</div><div class='words'>The overall System Authentication False Accept Rate (SAFAR) shall be no greater than 1 in 
                <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='a SAFAR no greater than 1:500'></textarea> within a 1% margin.</div>
</div><!-- End: Mobile_Device_Fundamentals:fia__bmg__ext.1.2 -->
<div class='aactivity'>
The evaluator shall verify that the TSS indicates which SAFAR the TOE is targeting and contains evidence supporting the calculations, per , completed to determine the SAFAR. The evaluator shall verify that the TSS contains evidence of how the authentication factors interact, per FIA_UAU.5.2 and FIA_AFL_EXT.1. The evaluator shall verify that the TSS, contains the combination(s) of authentication factors needed to meet the SAFAR, and the number of attempts for each authentication factor the TOE is configured to allow. Adequate documentation is required to demonstrate the calculations completed to support the claimed SAFAR.
                <br/><br/>                
             </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fia__bmg__ext.1 -->
<span class='comp-notes'></span><br/><span class='tooltipped'><input type='checkbox' onchange='handleOCheck(this); return false;'></input></span>
<span id='Mobile_Device_Fundamentals:fia__bmg__ext.2' class='component fia__bmg__ext.2 disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FIA_BMG_EXT.2 &#8212; Extended: Biometric Enrollment</a><span class='tooltiptext'>objective</span>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fia__bmg__ext.2.1' class='requirement fia__bmg__ext.2.1'><div class='f-el-title'>FIA_BMG_EXT.2.1</div><div class='words'>The TSF shall only use biometric samples of sufficient quality for enrollment. Sample data shall have <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='quality metrics corresponding to each biometric modality'></textarea>.</div>
</div><!-- End: Mobile_Device_Fundamentals:fia__bmg__ext.2.1 -->
<div class='aactivity'>
The evaluator shall verify that the TSS describes how the quality of samples used to create the authentication template at enrollment are verified. As well as the quality standard that the validation method uses to perform the assessment. The evaluator shall verify that the AGD guidance describes how to enroll a user for each biometric modality supported. <br/><br/>
              
              The evaluator shall input biometric samples for enrollment. Upon inputting biometric samples a fixed number of times as specified in the prompts, one or more authentication templates will be generated. The evaluator shall verify that the device only accepts samples of sufficient quality or requests additional samples if the authentication template is not of sufficient quality. For all quality metrics, the evaluator shall ensure that biometric samples achieving a worse quality score than the prescribed threshold are rejected.
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fia__bmg__ext.2 -->
<span class='comp-notes'></span><br/><span class='tooltipped'><input type='checkbox' onchange='handleOCheck(this); return false;'></input></span>
<span id='Mobile_Device_Fundamentals:fia__bmg__ext.3' class='component fia__bmg__ext.3 disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FIA_BMG_EXT.3 &#8212; Extended: Biometric Verification</a><span class='tooltiptext'>objective</span>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fia__bmg__ext.3.1' class='requirement fia__bmg__ext.3.1'><div class='f-el-title'>FIA_BMG_EXT.3.1</div><div class='words'>The TSF shall only use biometric samples of sufficient quality for verification. As such, sample data shall have 
              <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='quality metrics corresponding to each biometric modality'></textarea>.</div>
</div><!-- End: Mobile_Device_Fundamentals:fia__bmg__ext.3.1 -->
<div class='aactivity'>
 The evaluator shall verify that the TSS describes how the quality of samples used to verify authentication are verified. As well as the quality standard that the validation method uses to perform the assessment. The evaluator shall enroll a user for each biometric modality supported. The evaluator will then input biometric samples for verification and ensure that the device only accepts samples of sufficient quality. The evaluator shall ensure that biometric samples achieving a worse quality score than the prescribed threshold are rejected.                   
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fia__bmg__ext.3 -->
<span class='comp-notes'></span><br/><span class='tooltipped'><input type='checkbox' onchange='handleOCheck(this); return false;'></input></span>
<span id='Mobile_Device_Fundamentals:fia__bmg__ext.4' class='component fia__bmg__ext.4 disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FIA_BMG_EXT.4 &#8212; Extended: Biometric Templates</a><span class='tooltiptext'>objective</span>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fia__bmg__ext.4.1' class='requirement fia__bmg__ext.4.1'><div class='f-el-title'>FIA_BMG_EXT.4.1</div><div class='words'>The TSF shall only generate and use enrollment templates and/or authentication templates of sufficient quality for any subsequent authentication functions. </div>
</div><!-- End: Mobile_Device_Fundamentals:fia__bmg__ext.4.1 -->
<div class='aactivity'>
The evaluator shall verify that the  TSS describes how the samples used to create the authentication template at enrollment are mutually consistent and how the mutual consistency is validated, both in terms of the method of validation as well as the quality standard that the validation method uses to perform the assessment.
              <br/><br/>
              The evaluator shall input biometric samples for enrollment. In doing so, the evaluator shall verify the enrollment templates generated are of sufficient quality. Upon inputting biometric samples a fixed number of times as specified in the prompts, the evaluator shall additionally verify that any enrollment and authentication templates generated are of sufficient quality. That is, they shall all be mutually consistent and correspond to the biometric characteristics of a single user and source (e.g. the same finger from the same person).         
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fia__bmg__ext.4 -->
<span class='comp-notes'></span><br/><span class='tooltipped'><input type='checkbox' onchange='handleOCheck(this); return false;'></input></span>
<span id='Mobile_Device_Fundamentals:fia__bmg__ext.5' class='component fia__bmg__ext.5 disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FIA_BMG_EXT.5 &#8212; Extended: Handling Unusual Biometric Templates </a><span class='tooltiptext'>objective</span>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fia__bmg__ext.5.1' class='requirement fia__bmg__ext.5.1'><div class='f-el-title'>FIA_BMG_EXT.5.1</div><div class='words'>The matching algorithm shall handle properly formatted enrollment templates and/or authentication templates, especially those with unusual data properties, appropriately. If such templates contain incorrect syntax, are of low quality, or contain enrollment data considered unrealistic for a given modality, then they shall be rejected by the matching algorithm and an error code shall be reported.</div>
</div><!-- End: Mobile_Device_Fundamentals:fia__bmg__ext.5.1 -->
<div class='aactivity'>
The evaluator shall verify that the TSS how the matching algorithm addresses properly formatted templates with unusual data properties, incorrect syntax, or low quality. The evaluator shall ensure that these claims are sound through appropriate testing based on test programs provided by the vendor.
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fia__bmg__ext.5 -->
<span class='comp-notes'></span><br/><span class='tooltipped'><input type='checkbox' onchange='handleOCheck(this); return false;'></input></span>
<span id='Mobile_Device_Fundamentals:fia__bmg__ext.6' class='component fia__bmg__ext.6 disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FIA_BMG_EXT.6 &#8212; Extended: Spoof Detections for Biometrics</a><span class='tooltiptext'>objective</span>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fia__bmg__ext.6.1' class='requirement fia__bmg__ext.6.1'><div class='f-el-title'>FIA_BMG_EXT.6.1</div><div class='words'>The TSF shall perform Presentation Attack Detection testing up to the attack potential of <span class='selectables' data-rindex='0'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>basic</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>intermediate</span>
<input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>advanced</span>
</span> attacks, for each biometric modalities selected in FIA_UAU.5.1 on each enrollment and authentication attempt, rejecting detected spoofs. When an authentication attempt fails due to PAD testing, the TSF shall not indicate to the user the reason for failure to authenticate.</div>
</div><!-- End: Mobile_Device_Fundamentals:fia__bmg__ext.6.1 -->
<div class='aactivity'>
The testing methodology specified in ISO 19989 Information technology — Security evaluation of presentation attack detection for biometrics   is to be used to determine the efficacy of the PAD for the selected attack potential. 
              <br/><br/>
              Assurance Activity Note: ISO 19989 is in draft status at the time of publication of this PP. Once the ISO standard is published, it shall be used to meet the assurance activity for this requirement. Henniger, Scheuermann, and Kniess ,  provide a description of attack potential calculation with examples. Until such time as ISO 19989 is published, the vendor shall provide to the lab a description of the PAD processing implemented in the TSF, test procedures used to validate successful operation of PAD, and test data with results of the PAD validation testing. The lab may analyze the test procedures and data to validate vendor test results or, optionally, may conduct its own testing.
              <br/><br/>
              If the lab performs its own testing, it is highly recommended that the vendor provides spoof testing tools, as it is not expected for the lab to create a test procedure for modalities outside of established standards and easily implemented procedures. Labs can also expedite the testing process by purchasing the appropriate spoof kits and recipes from specialized biometrics testing labs.
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fia__bmg__ext.6 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fia__pmg__ext.1' class='component fia__pmg__ext.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FIA_PMG_EXT.1 &#8212; Extended: Password Management </a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fia__pmg__ext.1.1' class='requirement fia__pmg__ext.1.1'><div class='f-el-title'>FIA_PMG_EXT.1.1</div><div class='words'>The TSF shall support the following for the Password Authentication Factor: 
              <ol>
                <li>Passwords shall be able to be composed of any combination of 
                  <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>upper and lower case letters</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span><textarea onchange='update(this);' class='assignment val' rows='1' placeholder='a character set of at least 52 characters'></textarea></span>
</li>
</ul>
</span>, numbers, and special characters: 
                <span class='selectables' data-rindex='1'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>"!"</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>"@"</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>"#"</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span>"$"</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='4' class='val selbox'></input><span>"%"</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='5' class='val selbox'></input><span>"^"</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='6' class='val selbox'></input><span>"&amp;"</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='7' class='val selbox'></input><span> "*"</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='8' class='val selbox'></input><span>"("</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='9' class='val selbox'></input><span>")"</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='10' class='val selbox'></input><span><textarea onchange='update(this);' class='assignment val' rows='1' placeholder='other characters'></textarea></span>
</li>
</ul>
</span>
                    ; </li>                   
                <li>Password length up to 
              <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='an integer greater than or equal to 14'></textarea> characters shall be supported. </li>
              </ol>
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fia__pmg__ext.1.1 -->
<div class='aactivity'>
The evaluator shall examine the operational guidance to determine that it provides guidance to security administrators on the composition of strong passwords, and that it provides instructions on setting the minimum password length. The evaluator shall also perform the following tests. Note that one or more of these tests can be performed with a single test case.
              
                The evaluator shall compose passwords that either meet the requirements, or fail to meet the requirements, in some way. For each password, the evaluator shall verify that the TOE supports the password. While the evaluator is not required (nor is it feasible) to test all possible compositions of passwords, the evaluator shall ensure that all characters, rule characteristics, and a minimum length listed in the requirement are supported, and justify the subset of those characters chosen for testing.
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fia__pmg__ext.1 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fia__trt__ext.1' class='component fia__trt__ext.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FIA_TRT_EXT.1 &#8212; Extended: Authentication Throttling</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fia__trt__ext.1.1' class='requirement fia__trt__ext.1.1'><div class='f-el-title'>FIA_TRT_EXT.1.1</div><div class='words'>The TSF shall limit automated user authentication attempts by 
              <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>preventing authentication via an external port</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>enforcing a delay between incorrect authentication attempts</span>
</li>
</ul>
</span> for all authentication mechanisms selected in FIA_UAU.5.1. The minimum delay shall be such that no more than 10 attempts can be attempted per 500 milliseconds.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fia__trt__ext.1.1 -->
<div class='aactivity'>
The evaluator shall verify that the  TSS describes the method by which authentication attempts are not able to be automated. The evaluator shall ensure that the  TSS describes either how the TSF disables authentication via external interfaces (other than the ordinary user interface) or how authentication attempts are delayed in order to slow automated entry and shall ensure that this delay totals at least 500 milliseconds over 10 attempts for all authentication mechanisms selected in FIA_UAU.5.1.
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fia__trt__ext.1 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fia__uau.5' class='component fia__uau.5'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FIA_UAU.5 &#8212; Multiple Authentication Mechanisms</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fia__uau.5.1' class='requirement fia__uau.5.1'><div class='f-el-title'>FIA_UAU.5.1</div><div class='words'>The TSF shall provide <span class='refinement'>password and
              <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' id='Mobile_Device_Fundamentals:uau_fing' onchange='update(this); ' data-rindex='0' class='val selbox uau_fing'></input><span>fingerprint</span>
</li>
<li><input type='checkbox' id='Mobile_Device_Fundamentals:uau_iris' onchange='update(this); ' data-rindex='1' class='val selbox uau_iris'></input><span> iris</span>
</li>
<li><input type='checkbox' id='Mobile_Device_Fundamentals:uau_face' onchange='update(this); ' data-rindex='2' class='val selbox uau_face'></input><span> face</span>
</li>
<li><input type='checkbox' id='Mobile_Device_Fundamentals:uau_vox' onchange='update(this); ' data-rindex='3' class='val selbox uau_vox'></input><span> voice</span>
</li>
<li><input type='checkbox' id='Mobile_Device_Fundamentals:uau_vein' onchange='update(this); ' data-rindex='4' class='val selbox uau_vein'></input><span> vein</span>
</li>
<li><input type='checkbox' id='Mobile_Device_Fundamentals:uau_hybr' onchange='update(this); ' data-rindex='5' class='val selbox uau_hybr'></input><span> hybrid</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='6' class='val selbox'></input><span>no other mechanism</span>
</li>
</ul>
</span>
            </span>to support user authentication.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fia__uau.5.1 -->
<div id='Mobile_Device_Fundamentals:fia__uau.5.2' class='requirement fia__uau.5.2'><div class='f-el-title'>FIA_UAU.5.2</div><div class='words'>The TSF shall authenticate any user's claimed identity according to the <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='rules describing how each authentication mechanism provides authentication'></textarea>.</div>
</div><!-- End: Mobile_Device_Fundamentals:fia__uau.5.2 -->
<div class='aactivity'>
The evaluator shall ensure that the TSS describes each mechanism provided to support user authentication and the rules describing how the authentication mechanism(s) provide authentication. <br/><br/>
            The evaluator shall verify that configuration guidance for each authentication mechanism is addressed in the AGD guidance.
              
                For each authentication mechanism selected, the evaluator shall enable that mechanism and verify that it can be used to authenticate the user at the specified authentication factor interfaces. 
                For each authentication mechanism rule, the evaluator shall ensure that the authentication mechanism(s) behave accordingly.
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fia__uau.5 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fia__uau.6' class='component fia__uau.6'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FIA_UAU.6 &#8212; Re-Authentication</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fia__uau.6.1_l1_r' class='requirement fia__uau.6.1_l1_r'><div class='f-el-title'>FIA_UAU.6.1(1)</div><div class='words'>The TSF shall re-authenticate the user <span class='refinement'>via the Password Authentication Factor</span> under the conditions <span class='refinement'>attempted change to any supported authentication mechanisms</span>.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fia__uau.6.1_l1_r -->
<div class='aactivity'>

              
                The evaluator shall configure the TSF to use the Password Authentication Factor according to the AGD guidance. The evaluator shall change Password Authentication Factor according to the AGD guidance and verify that the TSF requires the entry of the Password Authentication Factor before allowing the factor to be changed.
                [conditional] For each BAF selected in FIA_UAU.5.1, the evaluator shall configure the TSF to use the BAF, which includes configuring the Password Authentication Factor, according to the AGD guidance. The evaluator shall change the BAF according to the AGD guidance and verify that the TSF requires the entry of the Password Authentication Factor before allowing the BAF to be changed. 
                [conditional] If "hybrid" is selected in FIA_UAU.5.1, the evaluator shall configure the TSF to use the BAF and PIN or password, which includes configuring the Password Authentication Factor, according to the AGD guidance. The evaluator shall change the BAF and PIN according to the AGD guidance and verify that the TSF requires the entry of the Password Authentication Factor before allowing the factor to be changed. 
              
            </div><div id='Mobile_Device_Fundamentals:fia__uau.6.1_l2_r_' class='requirement fia__uau.6.1_l2_r_'><div class='f-el-title'>FIA_UAU.6.1(2) </div><div class='words'>
              The TSF shall re-authenticate the user <span class='refinement'>via an authentication factor defined in FIA_UAU.5.1</span> under the conditions <span class='refinement'>TSF-initiated lock, user-initiated lock, 
              <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='other conditions'></textarea></span>.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fia__uau.6.1_l2_r_ -->
<div class='aactivity'>

              
                The evaluator shall configure the TSF to transition to the locked state after a time of inactivity (FMT_SMF_EXT.1) according to the AGD guidance. The evaluator shall wait until the TSF locks and then verify that the TSF requires the entry of the Password Authentication Factor before transitioning to the unlocked state.
                [conditional] For each BAF selected in FIA_UAU.5.1, the evaluator shall repeat Test 1 verifying that the TSF requires the entry of the BAF before transitioning to the unlocked state. 
                [conditional] If "hybrid" is selected in FIA_UAU.5.1, the evaluator shall repeat Test 1 verifying that the TSF requires the entry of the BAF and PIN/password before transitioning to the unlocked state. 
                The evaluator shall configure user-initiated locking according to the AGD guidance. The evaluator shall lock the TSF and then verify that the TSF requires the entry of the Password Authentication Factor before transitioning to the unlocked state.
                [conditional] For each BAF selected in FIA_UAU.5.1, the evaluator shall repeat Test 4 verifying that the TSF requires the entry of the BAF before transitioning to the unlocked state.
                [conditional] If "hybrid" is selected in FIA_UAU.5.1, the evaluator shall repeat Test 4 verifying that the TSF requires the entry of the BAF and PIN/password before transitioning to the unlocked state.
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fia__uau.6 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fia__uau.7' class='component fia__uau.7'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FIA_UAU.7 &#8212; Protected authentication feedback </a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fia__uau.7.1_' class='requirement fia__uau.7.1_'><div class='f-el-title'>FIA_UAU.7.1 </div><div class='words'>The TSF shall provide only <span class='refinement'>obscured feedback to the device’s display</span> to the user while the authentication is in progress.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fia__uau.7.1_ -->
<div class='aactivity'>
The evaluator shall ensure that the  TSS describes the means of obscuring the authentication entry, for all authentication methods specified in FIA_UAU.5.1. The evaluator shall verify that any configuration of this requirement is addressed in the AGD guidance and that the password is obscured by default. 
              
                The evaluator shall enter passwords on the device, including at least the Password Authentication Factor at lockscreen, and verify that the password is not displayed on the device. 
                [conditional] For each BAF selected in FIA_UAU.5.1, the evaluator shall authenticate by producing a biometric sample at lockscreen. As the biometric algorithms are performed, the evaluator shall verify that sensitive images, audio, or other information identifying the user are kept secret and are not revealed to the user. Additionally, the evaluator shall produce a biometric sample that fails to authenticate and verify that the reason(s) for authentication failure (user mismatch, low sample quality, etc.) are not revealed to the user. It is acceptable for the BAF to state that it was unable to physically read the biometric sample, for example, if the sensor is unclean or the biometric sample was removed to quickly. However, specifics regarding why the presented biometric sample failed authentication shall not be revealed to the user.
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fia__uau.7 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fia__uau__ext.1' class='component fia__uau__ext.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FIA_UAU_EXT.1 &#8212; Extended: Authentication for Cryptographic Operation</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fia__uau__ext.1.1' class='requirement fia__uau__ext.1.1'><div class='f-el-title'>FIA_UAU_EXT.1.1</div><div class='words'>The TSF shall require the user to present the Password Authentication Factor prior to decryption of protected data and encrypted DEKs, KEKs and 
              <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>long-term trusted channel key material</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>all software-based key storage</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>no other keys</span>
</li>
</ul>
</span> at startup.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fia__uau__ext.1.1 -->
<div class='aactivity'>
The evaluator shall verify that the  TSS section of the ST describes the process for decrypting protected data and keys. The evaluator shall ensure that this process requires the user to enter a Password Authentication Factor and, in accordance with FCS_CKM_EXT.3, derives a KEK, which is used to protect the software-based secure key storage and (optionally) DEK(s) for sensitive data, in accordance with FCS_STG_EXT.2.
              <br/><br/>
              The following tests may be performed in conjunction with FDP_DAR_EXT.1 and FDP_DAR_EXT.2.
              <br/><br/>
              Assurance Activity Note: The following test require the developer to provide access to a test platform that provides the evaluator with tools that are typically not found on consumer Mobile Device products. 
              <br/><br/>
              
                The evaluator shall enable encryption of protected data and require user authentication according to the AGD guidance. The evaluator shall write, or the developer shall provide access to, an application that includes a unique string treated as protected data.
                  <br/><br/>
                  The evaluator shall reboot the device, use a tool provided by developer to search for the unique string amongst the application data, and verify that the unique string cannot be found. The evaluator shall enter the Password Authentication Factor to access full device functionality, use a tool provided by the developer to access the unique string amongst the application data, and verify that the unique string can be found. 
                <br/>
                [conditional] The evaluator shall require user authentication according to the AGD guidance. The evaluator shall store a key in the software-based secure key storage.
                  <br/><br/>
                  The evaluator shall lock the device, use a tool provided by developer to access the key amongst the stored data, and verify that the key cannot be retrieved or accessed. The evaluator shall enter the Password Authentication Factor to access full device functionality, use a tool provided by developer to access the key, and verify that the key can be retrieved or accessed. 
                <br/>
                [conditional] The evaluator shall enable encryption of sensitive data and require user authentication according to the AGD guidance. The evaluator shall write, or the developer shall provide access to, an application that includes a unique string treated as sensitive data.
                  <br/><br/>
                  The evaluator shall lock the device, use a tool provided by developer to attempt to access the unique string amongst the application data, and verify that the unique string cannot be found. The evaluator shall enter the Password Authentication Factor to access full device functionality, use a tool provided by developer to access the unique string amongst the application data, and verify that the unique string can be retrieved. 
                
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fia__uau__ext.1 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fia__uau__ext.2' class='component fia__uau__ext.2'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FIA_UAU_EXT.2 &#8212; Extended: Timing of Authentication</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fia__uau__ext.2.1' class='requirement fia__uau__ext.2.1'><div class='f-el-title'>FIA_UAU_EXT.2.1</div><div class='words'>The TSF shall allow 
              <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>
                <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='list of actions'></textarea></span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span> no actions</span>
</li>
</ul>
</span> on behalf of the user to be performed before the user is authenticated. 
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fia__uau__ext.2.1 -->
<div id='Mobile_Device_Fundamentals:fia__uau__ext.2.2' class='requirement fia__uau__ext.2.2'><div class='f-el-title'>FIA_UAU_EXT.2.2</div><div class='words'>The TSF shall require each user to be successfully authenticated before allowing any other TSF-mediated actions on behalf of that user.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fia__uau__ext.2.2 -->
<div class='aactivity'>
The evaluator shall verify that the  TSS describes the actions allowed by unauthorized users in the locked state. The evaluator shall attempt to perform some actions not listed in the selection while the device is in the locked state and verify that those actions do not succeed.</div>
</div></span><!-- End: Mobile_Device_Fundamentals:fia__uau__ext.2 -->
<span class='comp-notes'></span><br/><span class='tooltipped'><input type='checkbox' onchange='handleOCheck(this); return false;'></input></span>
<span id='Mobile_Device_Fundamentals:fia__uau__ext.4' class='component fia__uau__ext.4 disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FIA_UAU_EXT.4 &#8212; Extended: Secondary User Authentication</a><span class='tooltiptext'>optional</span>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fia__uau__ext.4.1' class='requirement fia__uau__ext.4.1'><div class='f-el-title'>FIA_UAU_EXT.4.1</div><div class='words'>The TSF shall provide a secondary authentication mechanism for accessing Enterprise applications and resources. The secondary authentication mechanism shall control access to the Enterprise application and shared resources and shall be incorporated into the encryption of protected and sensitive data belonging to Enterprise applications and shared resources.</div>
</div><!-- End: Mobile_Device_Fundamentals:fia__uau__ext.4.1 -->
<div class='aactivity'>
The assurance activities for any selected requirements related to device authentication must be separately performed for the secondary authentication mechanism (in addition to activities performed for the primary authentication mechanism). The requirements are: FIA_UAU.6, FIA_PMG_EXT.1, FIA_TRT_EXT.1, FIA_UAU.7, FIA_UAU_EXT.2, FTA_SSL_EXT.1, FCS_STG_EXT.2, FMT_SMF_EXT.1/FMT_MOF_EXT.1 #1, #2, #8, #21, and #36.
              <br/><br/>
              Additionally, FIA_AFL_EXT.1 must be met, except that in FIA_AFL_EXT.1.2 the separate test is performed with the text "wipe of all protected data" changed to "wipe of all Enterprise application data and all Enterprise shared resource data."
            </div><div id='Mobile_Device_Fundamentals:fia__uau__ext.4.2' class='requirement fia__uau__ext.4.2'><div class='f-el-title'>FIA_UAU_EXT.4.2</div><div class='words'>The TSF shall require the user to present the secondary authentication factor prior to decryption of Enterprise application data and Enterprise shared resource data.</div>
</div><!-- End: Mobile_Device_Fundamentals:fia__uau__ext.4.2 -->
<div class='aactivity'>

              The evaluator shall verify that the  TSS section of the ST describes the process for decrypting Enterprise application data and shared resource data. The evaluator shall ensure that this process requires the user to enter an Authentication Factor and, in accordance with FCS_CKM_EXT.3, derives a KEK which is used to protect the software-based secure key storage and (optionally) DEK(s) for sensitive data, in accordance with FCS_STG_EXT.2.
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fia__uau__ext.4 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fia__x509__ext.1' class='component fia__x509__ext.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FIA_X509_EXT.1 &#8212; Extended: Validation of certificates</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fia__x509__ext.1.1' class='requirement fia__x509__ext.1.1'><div class='f-el-title'>FIA_X509_EXT.1.1</div><div class='words'>The TSF shall validate certificates in accordance with the following rules:
              <ul>
                <li>RFC 5280 certificate validation and certificate path validation</li>
                <li>The certificate path must terminate with a certificate in the Trust Anchor Database</li>
                <li>The TSF shall validate a certificate path by ensuring the presence of the basicConstraints extension and that the CA flag is set to TRUE for all CA certificates</li>
                <li>The TSF shall validate the revocation status of the certificate using 
                <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>the Online Certificate Status Protocol (OCSP) as specified in RFC 2560</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>a Certificate Revocation List (CRL) as specified in RFC 5759</span>
</li>
</ul>
</span></li>
                <li>The TSF shall validate the extendedKeyUsage field according to the following rules:
                  <ul>
                    <li>Certificates used for trusted updates and executable code integrity verification shall have the Code Signing purpose (id-kp 3 with OID 1.3.6.1.5.5.7.3.3) in the extendedKeyUsage field</li>
                      <li>Server certificates presented for TLS shall have the Server Authentication purpose (id-kp 1 with OID 1.3.6.1.5.5.7.3.1) in the extendedKeyUsage field</li>
                        <li>(Conditional) Server certificates presented for EST shall have the CMC Registration Authority (RA) purpose (id-kp-cmcRA with OID 1.3.6.1.5.5.7.3.28) in the extendedKeyUsage field</li>
                  </ul>
                </li>
              </ul>
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fia__x509__ext.1.1 -->
<div id='Mobile_Device_Fundamentals:fia__x509__ext.1.2' class='requirement fia__x509__ext.1.2'><div class='f-el-title'>FIA_X509_EXT.1.2</div><div class='words'>The TSF shall only treat a certificate as a CA certificate if the basicConstraints extension is present and the CA flag is set to TRUE.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fia__x509__ext.1.2 -->
<div class='aactivity'>
The evaluator shall ensure the  TSS describes where the check of validity of the certificates takes place. The evaluator ensures the  TSS also provides a description of the certificate path validation algorithm. 
              <br/><br/>
              The tests described must be performed in conjunction with the other Certificate Services assurance activities, including the use cases in FIA_X509_EXT.2.1 and FIA_X509_EXT.3. The tests for the extendedKeyUsage rules are performed in conjunction with the uses that require those rules. The evaluator shall create a chain of at least four certificates: the node certificate to be tested, two Intermediate CAs, and the self-signed Root CA. 
              <br/><br/>
              
                The evaluator shall then load a certificate or certificates to the Trust Anchor Database needed to validate the certificate to be used in the function (e.g. application validation, trusted channel setup, or trusted software update), and demonstrate that the function succeeds. The evaluator then shall delete one of the certificates, and show that the function fails.<br/>
                The evaluator shall demonstrate that validating an expired certificate results in the function failing. <br/>
                The evaluator shall test that the TOE can properly handle revoked certificates-conditional on whether CRL or OCSP is selected; if both are selected, then a test shall be performed for each method. The evaluator shall test revocation of the node certificate and revocation of the intermediate CA certificate (i.e. the intermediate CA certificate should be revoked by the root CA). For the test of the WLAN use case, only pre-stored CRLs are used. The evaluator shall ensure that a valid certificate is used, and that the validation function succeeds. The evaluator then attempts the test with a certificate that has been revoked (for each method chosen in the selection) to ensure when the certificate is no longer valid that the validation function fails.<br/>
                The evaluator shall construct a certificate path, such that the certificate of the CA issuing the TOE’s certificate does not contain the basicConstraints extension. The validation of the certificate path fails.<br/>
                The evaluator shall construct a certificate path, such that the certificate of the CA issuing the TOE’s certificate has the cA flag in the basicConstraints extension not set. The validation of the certificate path fails.<br/>
                The evaluator shall construct a certificate path, such that the certificate of the CA issuing the TOE’s certificate has the cA flag in the basicConstraints extension set to TRUE. The validation of the certificate path succeeds.<br/>
                The evaluator shall modify any byte in the first eight bytes of the certificate and demonstrate that the certificate fails to validate (the certificate will fail to parse correctly).<br/>
                The evaluator shall modify any bit in the last byte of the signature algorithm of the certificate and demonstrate that the certificate fails to validate (the signature on the certificate will not validate).<br/>
                The evaluator shall modify any byte in the public key of the certificate and demonstrate that the certificate fails to validate (the signature on the certificate will not validate).<br/>
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fia__x509__ext.1 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fia__x509__ext.2' class='component fia__x509__ext.2'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FIA_X509_EXT.2 &#8212; Extended: X509 certificate authentication</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fia__x509__ext.2.1' class='requirement fia__x509__ext.2.1'><div class='f-el-title'>FIA_X509_EXT.2.1</div><div class='words'>The TSF shall use X.509v3 certificates as defined by RFC 5280 to support authentication for 
              <span class='selectables' data-rindex='0'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>IPsec</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>TLS</span>
<input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>HTTPS</span>
<input type='checkbox' id='Mobile_Device_Fundamentals:x509_dtls' onchange='update(this); ' data-rindex='3' class='val selbox x509_dtls'></input><span>DTLS</span>
</span>, and 
              <span class='selectables' data-rindex='1'><ul>
<li><input type='checkbox' id='Mobile_Device_Fundamentals:x509_sys' onchange='update(this); ' data-rindex='0' class='val selbox x509_sys'></input><span>code signing for system software updates</span>
</li>
<li><input type='checkbox' id='Mobile_Device_Fundamentals:x509_apps' onchange='update(this); ' data-rindex='1' class='val selbox x509_apps'></input><span>code signing for mobile applications</span>
</li>
<li><input type='checkbox' id='Mobile_Device_Fundamentals:x509_sign' onchange='update(this); ' data-rindex='2' class='val selbox x509_sign'></input><span>code signing for integrity verification</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span> 
                <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='other uses'></textarea></span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='4' class='val selbox'></input><span>no additional uses</span>
</li>
</ul>
</span>. 
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fia__x509__ext.2.1 -->
<div id='Mobile_Device_Fundamentals:fia__x509__ext.2.2' class='requirement fia__x509__ext.2.2'><div class='f-el-title'>FIA_X509_EXT.2.2</div><div class='words'>When the TSF cannot establish a connection to determine the revocation status of a certificate, the TSF shall 
              <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>allow the administrator to choose whether to accept the certificate in these cases</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>allow the user to choose whether to accept the certificate in these cases</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>accept the certificate</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span>not accept the certificate</span>
</li>
</ul>
</span>.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fia__x509__ext.2.2 -->
<div class='aactivity'>
The evaluator shall check the  TSS to ensure that it describes how the TOE chooses which certificates to use, and any necessary instructions in the administrative guidance for configuring the operating environment so that the TOE can use the certificates.
              <br/><br/>
              The evaluator shall examine the  TSS to confirm that it describes the behavior of the TOE when a connection cannot be established during the validity check of a certificate used in establishing a trusted channel. The evaluator shall verify that any distinctions between trusted channels are described. If the requirement that the administrator is able to specify the default action, then the evaluator shall ensure that the operational guidance contains instructions on how this configuration action is performed.
              <br/><br/>
              The evaluator shall perform the following test for each trusted channel:
              <br/><br/>
              
                The evaluator shall demonstrate that using a valid certificate that requires certificate validation checking to be performed in at least some part by communicating with a non-TOE IT entity. The evaluator shall then manipulate the environment so that the TOE is unable to verify the validity of the certificate, and observe that the action selected in FIA_X509_EXT.2.2 is performed. If the selected action is administrator-configurable, then the evaluator shall follow the operational guidance to determine that all supported administrator-configurable options behave in their documented manner.
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fia__x509__ext.2 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fia__x509__ext.3' class='component fia__x509__ext.3'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FIA_X509_EXT.3 &#8212; Extended: Request Validation of certificates</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fia__x509__ext.3.1' class='requirement fia__x509__ext.3.1'><div class='f-el-title'>FIA_X509_EXT.3.1</div><div class='words'>The TSF shall provide a certificate validation service to applications.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fia__x509__ext.3.1 -->
<div id='Mobile_Device_Fundamentals:fia__x509__ext.3.2' class='requirement fia__x509__ext.3.2'><div class='f-el-title'>FIA_X509_EXT.3.2</div><div class='words'>The TSF shall respond to the requesting application with the success or failure of the validation. 
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fia__x509__ext.3.2 -->
<div class='aactivity'>
The evaluator shall verify that the API documentation provided according to  includes the security function (certificate validation) described in this requirement. This documentation shall be clear as to which results indicate success and failure.
              <br/><br/>
              The evaluator shall write, or the developer shall provide access to, an application that requests certificate validation by the TSF. The evaluator shall verify that the results from the validation match the expected results according to the API documentation. This application may be used to verify that import, removal, modification, and validation are performed correctly according to the tests required by FDP_STG_EXT.1, FTP_ITC_EXT.1, FMT_SMF_EXT.1.1, and FIA_X509_EXT.1.
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fia__x509__ext.3 -->
<span class='comp-notes'></span><br/><span class='tooltipped'><input type='checkbox' onchange='handleOCheck(this); return false;'></input></span>
<span id='Mobile_Device_Fundamentals:fia__x509__ext.4' class='component fia__x509__ext.4 disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FIA_X509_EXT.4 &#8212; Extended: X509 certificate enrollment</a><span class='tooltiptext'>objective</span>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fia__x509__ext.4.1' class='requirement fia__x509__ext.4.1'><div class='f-el-title'>FIA_X509_EXT.4.1</div><div class='words'>The TSF shall use the Enrollment over Secure Transport (EST) protocol as specified in RFC 7030 to request certificate enrollment using the simple enrollment method described in RFC 7030 Section 4.2. </div>
</div><!-- End: Mobile_Device_Fundamentals:fia__x509__ext.4.1 -->
<div id='Mobile_Device_Fundamentals:fia__x509__ext.4.2' class='requirement fia__x509__ext.4.2'><div class='f-el-title'>FIA_X509_EXT.4.2</div><div class='words'>The TSF shall be capable of authenticating EST requests using an existing certificate and corresponding private key as specified by RFC 7030 Section 3.3.2.</div>
</div><!-- End: Mobile_Device_Fundamentals:fia__x509__ext.4.2 -->
<div id='Mobile_Device_Fundamentals:fia__x509__ext.4.3' class='requirement fia__x509__ext.4.3'><div class='f-el-title'>FIA_X509_EXT.4.3</div><div class='words'>The TSF shall be capable of authenticating EST requests using HTTP Basic Authentication with a username and password as specified by RFC 7030 Section 3.2.3.</div>
</div><!-- End: Mobile_Device_Fundamentals:fia__x509__ext.4.3 -->
<div id='Mobile_Device_Fundamentals:fia__x509__ext.4.4' class='requirement fia__x509__ext.4.4'><div class='f-el-title'>FIA_X509_EXT.4.4</div><div class='words'>The TSF shall perform authentication of the EST server using an Explicit Trust Anchor following the rules described in RFC 7030, section 3.6.1. </div>
</div><!-- End: Mobile_Device_Fundamentals:fia__x509__ext.4.4 -->
<div id='Mobile_Device_Fundamentals:fia__x509__ext.4.5' class='requirement fia__x509__ext.4.5'><div class='f-el-title'>FIA_X509_EXT.4.5</div><div class='words'>The TSF shall be capable of requesting server-provided private keys as specified in RFC 7030 Section 4.4.</div>
</div><!-- End: Mobile_Device_Fundamentals:fia__x509__ext.4.5 -->
<div id='Mobile_Device_Fundamentals:fia__x509__ext.4.6' class='requirement fia__x509__ext.4.6'><div class='f-el-title'>FIA_X509_EXT.4.6</div><div class='words'>The TSF shall be capable of updating its EST-specific Trust Anchor Database using the "Root CA Key Update" process described in RFC 7030 Section 4.1.3.</div>
</div><!-- End: Mobile_Device_Fundamentals:fia__x509__ext.4.6 -->
<div id='Mobile_Device_Fundamentals:fia__x509__ext.4.7' class='requirement fia__x509__ext.4.7'><div class='f-el-title'>FIA_X509_EXT.4.7</div><div class='words'>The TSF shall generate a Certificate Request Message for EST as specified in RFC 2986 and be able to provide the following information in the request: public key and 
              <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>device-specific information</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>Common Name</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>Organization</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span>Organizational Unit</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='4' class='val selbox'></input><span>Country</span>
</li>
</ul>
</span>.</div>
</div><!-- End: Mobile_Device_Fundamentals:fia__x509__ext.4.7 -->
<div id='Mobile_Device_Fundamentals:fia__x509__ext.4.8' class='requirement fia__x509__ext.4.8'><div class='f-el-title'>FIA_X509_EXT.4.8</div><div class='words'>The TSF shall validate the chain of certificates from the Root CA certificate in the Trust Anchor Database to the EST Server CA certificate upon receiving a CA Certificates Response. </div>
</div><!-- End: Mobile_Device_Fundamentals:fia__x509__ext.4.8 -->
<div class='aactivity'>
The evaluator shall check to ensure that the operational guidance contains instructions on requesting certificates from an EST server, including generating a Certificate Request Message.<br/><br/>
              The evaluator shall also perform the following tests.Other tests are performed in conjunction with the Assurance Activity listed for FCS_TLSC_EXT.1.<br/>
             
               The evaluator shall use the operational guidance to cause the TOE to request certificate enrollment from an EST server using the simple enrollment method described in RFC 7030 Section 4.2, authenticating the certificate request to the server using an existing certificate and private key as described by RFC 7030 Section 3.3.2. The evaluator shall confirm that the resulting certificate is successfully obtained and installed in the TOE key store.<br/>
               The evaluator shall use the operational guidance to cause the TOE to request certificate enrollment from an EST server using the simple enrollment method described in RFC 7030 Section 4.2, authenticating the certificate request to the server using a username and password as described by RFC 7030 Section 3.2.3. The evaluator shall confirm that the resulting certificate is successfully obtained and installed in the TOE key store.<br/>
               The evaluator shall modify the EST server to return a certificate containing a different public key than the key included in the TOE’s certificate request. The evaluator shall use the operational guidance to cause the TOE to request certificate enrollment from an EST server. The evaluator shall confirm that the TOE does not accept the resulting certificate since the public key in the issued certificate does not match the public key in the certificate request.<br/>
               The evaluator shall configure the EST server or use a man-in-the-middle tool to present a server certificate to the TOE that is present in the TOE general Trust Anchor Database but not its EST-specific Trust Anchor Database. The evaluator shall cause the TOE to request certificate enrollment from the EST server. The evaluator shall verify that the request is not successful.<br/>
               The evaluator shall configure the EST server or use a man-in-the-middle tool to present an invalid certificate. The evaluator shall cause the TOE to request certificate enrollment from the EST server. The evaluator shall verify that the request is not successful The evaluator shall configure the EST server or use a man-in-the-middle tool to present a certificate that does not have the CMC RA purpose and verify that requests to the EST server fail. The tester shall repeat the test using a valid certificate and a certificate that contains the CMC RA purpose and verify that the certificate enrollment requests succeed.<br/>
               The evaluator shall use a packet sniffing tool between the TOE and an EST server. The evaluator shall turn on the sniffing tool and cause the TOE to request certificate enrollment from an EST server. The evaluator shall verify that the EST protocol interaction occurs over a Transport Layer Security (TLS) protected connection. The evaluator is not expected to decrypt the connection but rather observe that the packets conform to the TLS protocol format.<br/>
               The evaluator shall use the operational guidance to cause the TOE to request a server-provided private key and certificate from an EST server. The evaluator shall confirm that the resulting private key and certificate are successfully obtained and installed in the TOE key store.<br/>
               The evaluator shall modify the EST server to, in response to a server-provided private key and certificate request, return a private key that does not correspond with the public key in the returned certificate. The evaluator shall use the operational guidance to cause the TOE to request a server-provided private key and certificate. The evaluator shall confirm that the TOE does not accept the resulting private key and certificate since the private key and public key do not correspond.<br/>
               The evaluator shall configure the EST server to provide a "Root CA Key Update" as described in RFC 7030 Section 4.1.3. The evaluator shall cause the TOE to request CA certificates from the EST server and shall confirm that the EST-specific Trust Anchor Database is updated with the new trust anchor.<br/>
               The evaluator shall configure the EST server to provide a "Root CA Key Update" as described in RFC 7030 Section 4.1.3, but shall modify part of the NewWithOld certificate’s generated signature. The evaluator shall cause the TOE to request CA certificates from the EST server and shall confirm that the EST-specific Trust Anchor Database is not updated with the new trust anchor since the signature did not verify.<br/>
               The evaluator shall use the operational guidance to cause the TOE to generate a certificate request message. The evaluator shall capture the generated message and ensure that it conforms to the format specified by RFC 2986. The evaluator shall confirm that the certificate request provides the public key and other required information, including any necessary user-input information. 
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fia__x509__ext.4 -->
<span class='comp-notes'></span><br/><span class='tooltipped'><input type='checkbox' onchange='handleOCheck(this); return false;'></input></span>
<span id='Mobile_Device_Fundamentals:fia__x509__ext.5' class='component fia__x509__ext.5 disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FIA_X509_EXT.5 &#8212; Extended: X509 certificate enrollment</a><span class='tooltiptext'>objective</span>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fia__x509__ext.5.1' class='requirement fia__x509__ext.5.1'><div class='f-el-title'>FIA_X509_EXT.5.1</div><div class='words'>The TSF shall generate a Certificate Request Message as specified in RFC 2986 and be able to provide the following information in the request: public key and 
            <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>device-specific information</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>Common Name</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>Organization</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span>Organizational Unit</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='4' class='val selbox'></input><span>Country</span>
</li>
</ul>
</span>.</div>
</div><!-- End: Mobile_Device_Fundamentals:fia__x509__ext.5.1 -->
<div id='Mobile_Device_Fundamentals:fia__x509__ext.5.2' class='requirement fia__x509__ext.5.2'><div class='f-el-title'>FIA_X509_EXT.5.2</div><div class='words'>The TSF shall validate the chain of certificates from the Root CA upon receiving the CA Certificate Response.</div>
</div><!-- End: Mobile_Device_Fundamentals:fia__x509__ext.5.2 -->
<div class='aactivity'>
If the ST author selects "device-specific information", the evaluator shall verify that the  TSS contains a description of the device-specific fields used in certificate requests. 
            <br/><br/>
            The evaluator shall check to ensure that the operational guidance contains instructions on generating a Certificate Request Message. If the ST author selects "Common Name", "Organization", "Organizational Unit", or "Country", the evaluator shall ensure that this guidance includes instructions for establishing these fields before creating the certificate request message.
            <br/><br/>
            The evaluator shall also perform the following tests:
            The evaluator shall use the operational guidance to cause the TOE to generate a certificate request message. The evaluator shall capture the generated message and ensure that it conforms to the format specified. The evaluator shall confirm that the certificate request provides the public key and other required information, including any necessary user-input information.<br/>
              The evaluator shall demonstrate that validating a certificate response message without a valid certification path results in the function failing. The evaluator shall then load a certificate or certificates as trusted CAs needed to validate the certificate response message, and demonstrate that the function succeeds. The evaluator shall then delete one of the certificates, and show that the function fails.
            
          </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fia__x509__ext.5 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fmt__mof__ext.1' class='component fmt__mof__ext.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FMT_MOF_EXT.1 &#8212; Extended: Management of security functions behavior</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fmt__mof__ext.1.1' class='requirement fmt__mof__ext.1.1'><div class='f-el-title'>FMT_MOF_EXT.1.1</div><div class='words'>The TSF shall restrict the ability to perform the functions in column 3 of <a onclick='showTarget("cc-Mobile_Device_Fundamentals:fmt_smf")' href="#cc-Mobile_Device_Fundamentals:fmt_smf" class="cc-Mobile_Device_Fundamentals:fmt_smf-ref"><span class="counter">Mobile_Device_Fundamentals:fmt_smf</span></a> to the user.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fmt__mof__ext.1.1 -->
<div class='aactivity'>

              The evaluator shall verify that the  TSS describes those management functions that may only be performed by the user and confirm that the  TSS does not include an Administrator API for any of these management functions. This activity will be performed in conjunction with FMT_SMF_EXT.1.
            </div><div id='Mobile_Device_Fundamentals:fmt__mof__ext.1.2' class='requirement fmt__mof__ext.1.2'><div class='f-el-title'>FMT_MOF_EXT.1.2</div><div class='words'>The TSF shall restrict the ability to perform the functions in column 5 of <a onclick='showTarget("cc-Mobile_Device_Fundamentals:fmt_smf")' href="#cc-Mobile_Device_Fundamentals:fmt_smf" class="cc-Mobile_Device_Fundamentals:fmt_smf-ref"><span class="counter">Mobile_Device_Fundamentals:fmt_smf</span></a> to the administrator when the device is enrolled and according to the administrator-configured policy.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fmt__mof__ext.1.2 -->
<div class='aactivity'>
The evaluator shall verify that the  TSS describes those management functions that may be performed by the Administrator, to include how the user is prevented from accessing, performing, or relaxing the function (if applicable), and how applications/APIs are prevented from modifying the Administrator configuration. The  TSS also describes any functionality that is affected by administrator-configured policy and how. This activity will be performed in conjunction with FMT_SMF_EXT.1.
              <br/>
                The evaluator shall use the test environment to deploy policies to Mobile Devices. <br/>
                The evaluator shall create policies which collectively include all management functions which are controlled by the (enterprise) administrator and cannot be overridden/relaxed by the user as defined in FMT_MOF_EXT.1.2. The evaluator shall apply these policies to devices, attempt to override/relax each setting both as the user (if a setting is available) and as an application (if an API is available), and ensure that the TSF does not permit it. Note that the user may still apply a more restrictive policy than that of the administrator.<br/>
                Additional testing of functions provided to the administrator are performed in conjunction with the testing activities for FMT_SMF_EXT.1.1.
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fmt__mof__ext.1 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fmt__smf__ext.1' class='component fmt__smf__ext.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FMT_SMF_EXT.1 &#8212; Extended: Specification of Management Functions</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fmt__smf__ext.1.1' class='requirement fmt__smf__ext.1.1'><div class='f-el-title'>FMT_SMF_EXT.1.1</div><div class='words'>The TSF shall be capable of performing the following management functions: <br/><br/>             
              <b><span class='ctr' data-counter-type='ct-Table' id='cc-Mobile_Device_Fundamentals:fmt_smf'>
Table <span class='counter'>Mobile_Device_Fundamentals:fmt_smf</span>: Management Functions</span></b><br/>
              <br/>
              Status Markers:<br/>
              M - Mandatory<br/>
              O - Optional/Objective<br/>             

	      <table class='mfun-table'>
<tr><th>Management Function</th><th>Impl.</th><th>User Only</th><th>Admin</th><th>Admin Only</th></tr>
<tr>
<td>
		  <span class='ctr' data-counter-type='ct-function' id='cc-Mobile_Device_Fundamentals:pwd'>
<span class='counter'>Mobile_Device_Fundamentals:pwd</span>.</span> configure password policy:
		  <ol type='a'>
		    <li>minimum password length</li> 
		    <li>minimum password complexity</li> 
		    <li>maximum password lifetime</li>
		  </ol>
		</td><td>X</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td>X</td><td>-</td></tr>
<tr>
<td>
		  2. configure session locking policy:
		  <ol type='a'>
		    <li>screen-lock enabled/disabled</li>
		    <li>screen lock timeout </li>
		    <li>number of authentication failures</li>
		  </ol>
		</td><td>X</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td>X</td><td>-</td></tr>
<tr>
<td>
		  3. enable/disable the VPN protection:
		  <ol type='a'>                     
		  <li>across device</li></ol>
		  <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>b. on a per-app basis</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>c. on a per-group of applications processes basis</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>d. no other method</span>
</li>
</ul>
</span>
		</td><td>X</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
		  4. enable/disable 
		  <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='list of all radios'></textarea>
		</td><td>X</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
		  5. enable/disable 
		  <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='list of audio or visual collection devices'></textarea>:
		  <ol type='a'>
		  <li>across device</li></ol>
		  <span class='selectables' data-rindex='1'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>b. on a per-app basis</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>c. on a per-group of applications processes basis</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>d. no other method</span>
</li>
</ul>
</span>
		</td><td>X</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
		  6. transition to the locked state
		</td><td>X</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td>-</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
		    7. 
		    TSF wipe of protected data
		  </td><td>X</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td>-</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
		  8. configure application installation policy by 
		  <span class='selectables' data-rindex='2'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>a. restricting the sources of applications</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>b. specifying a set of allowed applications based on 
                    <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='application characteristics'></textarea> (an application whitelist)</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>c. denying installation of applications</span>
</li>
</ul>
</span>
		  
		</td><td>X</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td>X</td><td>-</td></tr>
<tr>
<td>
		  9. import keys/secrets into the secure key storage
		</td><td>-</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
		  10. destroy imported keys/secrets and 
		  <span class='selectables' data-rindex='3'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>no other keys/secrets</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span><textarea onchange='update(this);' class='assignment val' rows='1' placeholder='list of other categories of keys/secrets'></textarea></span>
</li>
</ul>
</span> in the secure key storage
		  </td><td>-</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
		  11. import X.509v3 certificates into the Trust Anchor Database
		</td><td>X</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td>-</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
		  12. remove imported X.509v3 certificates and 
		  <span class='selectables' data-rindex='4'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>no other X.509v3 certificates</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span><textarea onchange='update(this);' class='assignment val' rows='1' placeholder='list of other categories of X.509v3 certificates'></textarea></span>
</li>
</ul>
</span> in the Trust Anchor Database
		  </td><td>-</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
		  13. enroll the TOE in management
		</td><td>X</td><td>-</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
		  14. remove applications
		</td><td>X</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td>-</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
		  15. update system software
		</td><td>X</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td>-</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
		  16. install applications
		</td><td>X</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td>-</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
		  17. remove Enterprise applications
		</td><td>X</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td>-</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
		  18. configure the Bluetooth trusted channel:
		  <ol type='a'>              
		    <li>disable/enable the Discoverable mode (for BR/EDR)</li>
		    <li>change the Bluetooth device name</li>                       
		    </ol>
		    <span class='selectables' data-rindex='5'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>c. change the Bluetooth device name (separately for BR/EDR and LE)</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>d. provide separate controls for turning the BR/EDR and LE radios on and off</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>e. allow/disallow additional wireless technologies to be used with Bluetooth</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span>f. disable/enable Advertising (for LE)</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='4' class='val selbox'></input><span>g. disable/enable the Connectable mode (for BR/EDR and LE)</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='5' class='val selbox'></input><span>h. disable/enable the Bluetooth services and/or profiles available on the device (for BR/EDR and LE)</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='6' class='val selbox'></input><span>i. specify minimum level of security for each pairing (for BR/EDR and LE)</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='7' class='val selbox'></input><span>j. configure allowable methods of Out of Band pairing (for BR/EDR and LE)</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='8' class='val selbox'></input><span>k. no other Bluetooth configuration</span>
</li>
</ul>
</span>
		    
		  </td><td>X</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
		  19. enable/disable display notification in the locked state of: 
		  <span class='selectables' data-rindex='6'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>a. email notifications</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>b. calendar appointments</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>c. contact associated with phone call notification</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span>d. text message notification</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='4' class='val selbox'></input><span>e. other application-based notifications</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='5' class='val selbox'></input><span>f. all notifications</span>
</li>
</ul>
</span>
		</td><td>X</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
		  20. enable data-at rest protection
		</td><td>X</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
		  21. enable removable media’s data-at-rest protection
		</td><td>X</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
		  22. enable/disable location services:
		  <ol type='a'>
		  <li>across device</li></ol>
		  <span class='selectables' data-rindex='7'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>b. on a per-app basis</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>c. on a per-group of applications processes basis</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>d. no other method</span>
</li>
</ul>
</span>
		</td><td>X</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
		  23. Enable/disable the use of  
		  <span class='selectables' data-rindex='8'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>Biometric Authentication Factor</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>Hybrid Authentication Factor</span>
</li>
</ul>
</span>
		</td><td>X</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
		  24. enable/disable all data signaling over 
		  <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='list of externally accessible hardware ports'></textarea>
		</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
		  25. enable/disable 
		  <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='list of protocols where the device acts as a server'></textarea>
		</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
		  26. enable/disable developer modes
		</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
		  27. enable/disable bypass of local user authentication
		</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
		  28. wipe Enterprise data
		</td><td>-</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
		  29. approve 
		  <span class='selectables' data-rindex='9'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>import</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>removal</span>
</span> by applications of X.509v3 certificates in the Trust Anchor Database
		  </td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
		  30. configure whether to establish a trusted channel or disallow establishment if the TSF cannot establish a connection to determine the validity of a certificate
		</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
		  31. enable/disable the cellular protocols used to connect to cellular network base stations
		</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
		  32. read audit logs kept by the TSF
		</td><td>-</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
		  33. configure 
		  <span class='selectables' data-rindex='10'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>certificate</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>public-key</span>
</span> used to validate digital signature on applications
		  </td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
		  34. approve exceptions for shared use of keys/secrets by multiple applications
		</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
		  35. approve exceptions for destruction of keys/secrets by applications that did not import the key/secret
		</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
		  36. configure the unlock banner
		</td><td>-</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
		  37. configure the auditable items
		</td><td>-</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
		  38. retrieve TSF-software integrity verification values
		</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
		  39. enable/disable 
		  <span class='selectables' data-rindex='11'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>USB mass storage mode</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>USB data transfer without user authentication</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>USB data transfer without authentication of the connecting system</span>
</li>
</ul>
</span>
		  
		</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
		  40. enable/disable backup of 
		  <span class='selectables' data-rindex='12'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>all applications</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>selected applications</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>selected groups of applications</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span>configuration data</span>
</li>
</ul>
</span>
                  to 
		  <span class='selectables' data-rindex='13'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>locally connected system</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>remote system</span>
</span>
		</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
		  41. enable/disable 
		  <span class='selectables' data-rindex='14'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>Hotspot functionality authenticated by 
                    <span class='selectables' data-rindex='15'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>pre-shared key</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>passcode</span>
<input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>no authentication</span>
</span>
		    </span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>USB tethering authenticated by 
                    <span class='selectables' data-rindex='16'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>pre-shared key</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>passcode</span>
<input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>no authentication</span>
</span>
		    </span>
</li>
</ul>
</span>
		  
		</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
		  42. approve exceptions for sharing data between 
		  <span class='selectables' data-rindex='17'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>application</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>groups of application</span>
</span>
		</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
		  43. place applications into application groups based on 
		  <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='enterprise configuration settings'></textarea>
		</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
		  44. Unenroll the TOE from management
		</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
		  45. Enable/disable the Always On VPN protection
		</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
		  46. Revoke Biometric template
		</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
<tr>
<td>
		  47. <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='list of other management functions to be provided by the TSF'></textarea>		      
		</td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td><td><select onchange='update(this);' class='val'><option value='O'>O</option><option value='X'>X</option></select></td></tr>
</table>

            </div>
</div><!-- End: Mobile_Device_Fundamentals:fmt__smf__ext.1.1 -->
<div class='aactivity'>
The evaluator shall verify that the  TSS describes all management functions, what role(s) can perform each function, and how these functions are (or can be) restricted to the roles identified by FMT_MOF_EXT.1. 
              <br/><br/>
              The following activities are organized according to the function number in the table. These activities include  TSS assurance activities, AGD assurance activities, and test activities.
              <br/><br/>
              Test activities specified below shall take place in the test environment described in the Assurance Activity for FPT_TUD_EXT.1.1, FPT_TUD_EXT.1.2, and FPT_TUD_EXT.1.3. The evaluator shall consult the AGD guidance to perform each of the specified tests, iterating each test as necessary if both the user and administrator may perform the function. The evaluator shall verify that the AGD guidance describes how to perform each management function, including any configuration details. For each specified management function tested, the evaluator shall confirm that the underlying mechanism exhibits the configured setting. 
              <br/><br/>
              
                <b>Function <a onclick='showTarget("cc-Mobile_Device_Fundamentals:pwd")' href="#cc-Mobile_Device_Fundamentals:pwd" class="cc-Mobile_Device_Fundamentals:pwd-ref"><span class="counter">Mobile_Device_Fundamentals:pwd</span></a></b><br/>
                The evaluator shall verify the  TSS defines the allowable policy options: the range of values for both password length and lifetime, and a description of complexity to include character set and complexity policies (e.g., configuration and enforcement of number of uppercase, lowercase, and special characters per password).<br/><br/>
                The evaluator shall exercise the TSF configuration as the administrator and perform positive and negative tests, with at least two values set for each variable setting, for each of the following:
                  <br/>
                  <ul>
                    <li>minimum password length</li>
                    <li>minimum password complexity</li>
                    <li>maximum password lifetime</li>
                  </ul>
                <br/>
                <b>Function 2</b><br/>
                The evaluator shall verify the TSS defines the range of values for both timeout period and number of authentication failures for all supported authentication mechanisms.<br/><br/>
                
                  The evaluator shall exercise the TSF configuration as the administrator. The evaluator shall perform positive and negative tests, with at least two values set for each variable setting, for each of the following:
                  <br/>
                  <ul>
                    <li>screen-lock enabled/disabled</li>
                    <li>screen lock timeout</li>
                    <li>number of authentication failures (may be combined with test for FIA_AFL_EXT.1)</li>
                  </ul>
                <br/>
                
                <b>Function 3</b><br/>
                The evaluator shall perform the following tests:
                  <ol type='a'>
                    <li>The evaluator shall exercise the TSF configuration to enable the VPN protection. These configuration actions must be used for the testing of the FDP_IFC_EXT.1.1 requirement.
                  </li>
                    <li>[conditional] If "per-app basis" is selected, the evaluator shall create two applications and enable one to use the VPN and the other to not use the VPN. The evaluator shall exercise each application (attempting to access network resources; for example, by browsing different websites) individually while capturing packets from the TOE. The evaluator shall verify from the packet capture that the traffic from the VPN-enabled application is encapsulated in IPsec and that the traffic from the VPN-disabled application is not encapsulated in IPsec.
                    </li>
                    <li>[conditional] If "per-groups of application basis" is selected, the evaluator shall create two applications and the applications shall be placed into different groups. Enable one application group to use the VPN and the other to not use the VPN. The evaluator shall exercise each application (attempting to access network resources; for example, by browsing different websites) individually while capturing packets from the TOE. The evaluator shall verify from the packet capture that the traffic from the application in the VPN-enabled group is encapsulated in IPsec and that the traffic from the application in the VPN-disabled group is not encapsulated in IPsec.
                      </li>
                  </ol>
                <br/>
                
                <b>Function 4</b><br/>
                
                The evaluator shall verify that the TSS includes a description of each radio and an indication of if the radio can be enabled/disabled along with what role can do so. In addition the evaluator shall verify that the frequency ranges at which each radio operates is included in the TSS. The evaluator shall confirm that the AGD guidance describes how to perform the enable/disable function for each radio.<br/><br/>
                
                The evaluator shall ensure that minimal signal leakage enters the RF shielded enclosure (i.e. Faraday bag, Faraday box, RF shielded room) by performing the following steps:<br/><br/>
                
                Step 1: Place the antenna of the spectrum analyzer inside the RF shielded enclosure.<br/><br/>
                
                Step 2: Enable "Max Hold" on the spectrum analyzer and perform a spectrum sweep of the frequency range between 300MHz – 6000MHz, in I KHz steps (this range should encompass 802.11, 802.15, GSM, UMTS, LTE and GPS). This range will not address NFC 13.56MHz, another test should be set up with similar constraints to address NFC.<br/><br/>
                
                If power above -90 dBm is observed, the Faraday box has too great of signal leakage and shall not be used to complete the test for Function 4.<br/><br/>
                
                The evaluator shall exercise the TSF configuration as the administrator and, if not restricted to the administrator, the user, to enable and disable the state of each radio (e.g. Wi-Fi, GPS, cellular, NFC, Bluetooth). Additionally, the evaluator shall repeat the steps below, booting into any auxiliary boot mode supported by the device. For each radio, the evaluator shall:<br/><br/>
                
                Step 1: Place the antenna of the spectrum analyzer inside the RF shielded enclosure. Configure the spectrum analyzer to sweep desired frequency range for the radio to be tested (based on range provided in the TSS)). The ambient noise floor shall be set to -110dBm. Place the TOE into the RF shielded enclosure to isolate them from all other RF traffic. <br/><br/>
                
                Step 2: The evaluator shall create a baseline of the expected behavior of RF signals. The evaluator shall power on the device, ensure the radio in question is enabled, power off the device, enable "Max Hold" on the spectrum analyzer and power on the device. The evaluator shall wait 2 minutes at each Authentication Factor interface prior to entering the necessary password to complete the boot process, waiting 5 minutes after the device is fully booted. The evaluator shall observe that RF spikes are present at the expected uplink channel frequency. The evaluator shall clear the "Max Hold" on the spectrum analyzer. <br/><br/>
                
                Step 3: The evaluator shall verify the absence of RF activity for the uplink channel when the radio in question is disabled. The evaluator shall complete the following test five times. The evaluator shall power on the device, ensure the radio in question is disabled, power off the device, enable "Max Hold" on the spectrum analyzer and power on the device. The evaluator shall wait 2 minutes at each Authentication Factor interface prior to entering the necessary password to complete the boot process, waiting 5 minutes after the device is fully booted. The evaluator shall clear the "Max Hold" on the spectrum analyzer. If a spike of RF activity for the uplink channel of the specific radio frequency band is observed at any time (either at an Authentication Factor interface or when the device is fully booted) it is deemed that the radio is enabled.
                <br/>
                
                <b>Function 5</b><br/>
                The evaluator shall verify that the  TSS includes a description of each collection device and an indication of if it can be enabled/disabled along with what role can do so. The evaluator shall confirm that the AGD guidance describes how to perform the enable/disable function. <br/><br/>
                The evaluator shall perform the following test(s):
                  <ol type='a'>
                    <li>The evaluator shall exercise the TSF configuration as the administrator and, if not restricted to the administrator, the user, to enable and disable the state of each audio or visual collection devices (e.g. camera, microphone) listed by the ST author. For each collection device, the evaluator shall disable the device and then attempt to use its functionality. The evaluator shall reboot the TOE and verify that disabled collection devices may not be used during or early in the boot process. Additionally, the evaluator shall boot the device into each available auxiliary boot mode and verify that the collection device cannot be used.
                    </li>
                      <li>[conditional] If "per-app basis" is selected, the evaluator shall create two applications and enable one to use access the A/V device and the other to not access the A/V device. The evaluator shall exercise each application attempting to access the A/V device individually. The evaluator shall verify that the enabled application is able to access the A/V device and the disabled application is not able to access the A/V device.
                      </li>
                        <li>[conditional] If "per-groups of application basis" is selected, the evaluator shall create two applications and the applications shall be placed into different groups. Enable one group to access the A/V device and the other to not access the A/V device. The evaluator shall exercise each application attempting to access the A/V device individually. The evaluator shall verify that the application in the enabled group is able to access the A/V device and the application in the disabled group is not able to access the A/V device.
                    </li>
                  </ol>
                <br/>
                
                <b>Function 6</b><br/>
                The evaluator shall use the test environment to instruct the TSF, both as a user and as the administrator, to command the device to transition to a locked state, and verify that the device transitions to the locked state upon command.<br/>
                
                <b>Function 7</b><br/>
                The evaluator shall use the test environment to instruct the TSF, both as a user and as the administrator, to command the device to perform a wipe of protected data. The evaluator must ensure that this management setup is used when conducting the assurance activities in FCS_CKM_EXT.5.<br/>
                
                <b>Function 8</b><br/>
                The evaluator shall verify the  TSS describes the allowable application installation policy options based on the selection included in the ST. If the application whitelist is selected, the evaluator shall verify that the  TSS includes a description of each application characteristic upon which the whitelist may be based.<br/><br/>
                
                  The evaluator shall exercise the TSF configuration as the administrator to restrict particular applications, sources of applications, or application installation according to the AGD guidance. The evaluator shall attempt to install unauthorized applications and ensure that this is not possible. The evaluator shall, in conjunction, perform the following specific tests:
                  <ol type='a'>
                    <li>[conditional] The evaluator shall attempt to connect to an unauthorized repository in order to install applications.
                    </li>
                    <li>[conditional] The evaluator shall attempt to install two applications (one whitelisted, and one not) from a known allowed repository and verify that the application not on the whitelist is rejected. The evaluator shall also attempt to side-load executables or installation packages via USB connections to determine that the white list is still adhered to 
                    </li></ol>
                <br/>
                
                <b>Function 9 &amp; Function 10</b><br/>
                The evaluator shall verify that the  TSS describes each category of keys/secrets that can be imported into the TSF’s secure key storage.<br/><br/>
                The test of these functions is performed in association with FCS_STG_EXT.1.
                <br/>
                The test of these functions is performed in association with FCS_STG_EXT.1.
                <br/>
                
                <b>Function 11</b><br/>
                The evaluator shall review the AGD guidance to determine that it describes the steps needed to import, modify, or remove certificates in the Trust Anchor database, and that the users that have authority to import those certificates (e.g., only administrator, or both administrators and users) are identified. <br/><br/>
                The evaluator shall import certificates according to the AGD guidance as the user and/or as the administrator, as determined by the administrative guidance. The evaluator shall verify that no errors occur during import. The evaluator should perform an action requiring use of the X.509v3 certificate to provide assurance that installation was completed properly.
                <br/>
                
                <b>Function 12</b><br/>
                The evaluator shall verify that the  TSS describes each additional category of X.509 certificates and their use within the TSF.<br/><br/>
                The evaluator shall remove an administrator-imported certificate and any other categories of certificates included in the assignment of function 14 from the Trust Anchor Database according to the AGD guidance as the user and as the administrator. 
                <br/>
                
                <b>Function 13</b><br/>
                The evaluator shall examine the  TSS to ensure that it contains a description of each management function that will be enforced by the enterprise once the device is enrolled. The evaluator shall examine the AGD guidance to determine that this same information is present.<br/><br/>
                The evaluator shall verify that user approval is required to enroll the device into management.
                <br/>
                
                <b>Function 14</b><br/>
                The evaluator shall verify that the  TSS includes an indication of what applications (e.g., user-installed applications, Administrator-installed applications, or Enterprise applications) can be removed along with what role can do so. The evaluator shall examine the AGD guidance to determine that it details, for each type of application that can be removed, the procedures necessary to remove those applications and their associated data. For the purposes of this assurance activity, "associated data" refers to data that are created by the app during its operation that do not exist independent of the app's existence, for instance, configuration data, or e-mail information that’s part of an e-mail client. It does not, on the other hand, refer to data such as word processing documents (for a word processing app) or photos (for a photo or camera app). <br/><br/>
                The evaluator shall attempt to remove applications according to the AGD guidance and verify that the TOE no longer permits users to access those applications or their associated data.
                <br/>
                
                <b>Function 15</b><br/>
                The evaluator shall attempt to update the TSF system software following the procedures in the AGD guidance and verify that updates correctly install and that the version numbers of the system software increase.
                <br/>
                
                <b>Function 16</b><br/>
                The evaluator shall attempt to install an application following the procedures in the AGD guidance and verify that the application is installed and available on the TOE.
                <br/>
                
                <b>Function 17</b><br/>
                The evaluator shall attempt to remove any Enterprise applications from the device by following the administrator guidance. The evaluator shall verify that the TOE no longer permits users to access those applications or their associated data.
                <br/>
                
                <b>Function 18</b><br/>
                The evaluator shall ensure that the  TSS includes a description of the Bluetooth profiles and services supported and the Bluetooth security modes and levels supported by the TOE. If function e is selected, the evaluator shall verify that the  TSS describes any additional wireless technologies that may be used with Bluetooth, including Wi-Fi with Bluetooth High Speed and NFC as an Out of Band pairing mechanism. If function h is selected, the evaluator shall verify that all supported Bluetooth services are listed in the  TSS as manageable and, if the TOE allows disabling by application rather than by service name, that a list of services for each application is also listed. If function i is selected, the evaluator shall verify that the  TSS describes the method by which the level of security for pairings are managed, including whether the setting is performed for each pairing or is a global setting. If function j is selected, the evaluator shall verify that the  TSS describes when Out of Band pairing methods are allowed and which ones are configurable.<br/><br/>
                The evaluator shall use a Bluetooth-specific protocol analyzer to perform the following tests of each sub-function:
                 <ol type='a'>
                   <li>The evaluator shall disable the Discoverable mode and shall verify that other Bluetooth BR/EDR devices cannot detect the TOE. The evaluator shall use the protocol analyzer to verify that the TOE does not respond to inquiries from other devices searching for Bluetooth devices. The evaluator shall enable Discoverable mode and verify that other devices can detect the TOE and that the TOE sends response packets to inquiries from searching devices.</li>
                   <li>The evaluator shall examine Bluetooth traffic from the TOE to determine the current Bluetooth device name, change the Bluetooth device name, and verify that the Bluetooth traffic from the TOE lists the new name.</li>
                   <li>[conditional] The evaluator shall examine Bluetooth traffic from the TOE to determine the current Bluetooth device name for BR/EDR and LE. The evaluator shall change the Bluetooth device name for LE independently of the device name for BR/EDR. The evaluator shall verify that the Bluetooth traffic from the TOE lists the new name. </li>
                   <li>[conditional] The evaluator shall disable Bluetooth BR/EDR and enable Bluetooth LE. The evaluator shall examine Bluetooth traffic from the TOE to confirm that only Bluetooth LE traffic is present. The evaluator shall repeat the test with Bluetooth BR/EDR enabled and Bluetooth LE disabled, confirming that only Bluetooth BR/EDR is present.</li>
                   <li>[conditional] The evaluator shall disable additional wireless technologies for the TOE and verify that Bluetooth High Speed is not able to send Bluetooth traffic over Wi-Fi, and that NFC cannot be used for pairing. The evaluator shall enable additional wireless technologies and verify that Bluetooth High Speed uses Wi-Fi or that the device can pair using NFC.</li>
                   <li>[conditional] The evaluator shall enable Advertising for Bluetooth LE, verify that the advertisements are captured by the protocol analyzer, disable Advertising, and verify that no advertisements from the device are captured by the protocol analyzer.</li>
                   <li>[conditional] The evaluator shall enable Connectable mode and verify that other Bluetooth devices may pair with the TOE and (if the devices were bonded) re-connect after pairing and disconnection. For BR/EDR devices: The evaluator shall use the protocol analyzer to verify that the TOE responds to pages from the other devices and permits pairing and re-connection. The evaluator shall disable Connectable mode and verify that the TOE does not respond to pages from remote Bluetooth devices, thereby not permitting pairing or re-connection. For LE: The evaluator shall use the protocol analyzer to verify that the TOE sends connectable advertising events and responds to connection requests. The evaluator shall disable Connectable mode and verify that the TOE stops sending connectable advertising events and stops responding to connection requests from remote Bluetooth devices. </li>
                   <li>[conditional] The evaluator shall verify that all supported Bluetooth services and/or profiles are listed in the TSS as manageable and, if the TOE allows disabling by application rather than by service and/or profile name, that a list of services and/or profile for each application is also listed. </li>
                   <li>[conditional] The evaluator shall allow low security modes/levels on the TOE and shall initiate pairing with the TOE from a remote device that allows only something other than Security Mode 4/Level 3 or Security Mode 4/Level 4 (for BR/EDR), or Security Mode 1/Level 3 (for LE). (For example, a remote BR/EDR device may claim Input/Output capability "NoInputNoOutput" and state that man-in-the-middle (MiTM) protection is not required. A remote LE device may not support encryption.) The evaluator shall verify that this pairing attempt succeeds due to the TOE falling back to the low security mode/level. The evaluator shall then remove the pairing of the two devices, prohibit the use of low security modes/levels on the TOE, then attempt the connection again. The evaluator shall verify that the pairing attempt fails. With the low security modes/levels disabled, the evaluator shall initiate pairing from the TOE to a remote device that supports Security Mode 4/Level 3 or Security Mode 4/Level 4 (for BR/EDR) or Security Mode 1/Level 3 (for LE). The evaluator shall verify that this pairing is successful and uses the high security mode/level. </li>
                   <li>[conditional] The evaluator shall attempt to pair using each of the Out of Band pairing methods, verify that the pairing method works, iteratively disable each pairing method, and verify that the pairing method fails.
                    </li>
                 </ol>
                <br/>
                
                <b>Function 19</b><br/>
                The evaluator shall examine the AGD Guidance to determine that it specifies, for at least each category of information selected for Function 19, how to enable and disable display information for that type of information in the locked state.<br/><br/>
                For each category of information listed in the AGD guidance, the evaluator shall verify that when that TSF is configured to limit the information according to the AGD, the information is no longer displayed in the locked state.<br/>                 
                
                <b>Function 20</b><br/>
                The evaluator shall exercise the TSF configuration as the administrator and, if not restricted to the administrator, the user, to enable system-wide data-at-rest protection according to the AGD guidance. The evaluator shall ensure that all assurance activities for DAR (see fdp_dar) are conducted with the device in this configuration.
                <br/>
                
                
                <b>Function 21</b><br/>
                The evaluator shall exercise the TSF configuration as the administrator and, if not restricted to the administrator, the user, to enable removable media’s data-at-rest protection according to the AGD guidance. The evaluator shall ensure that all assurance activities for DAR (see fdp_dar) are conducted with the device in this configuration.
                <br/>
                
                <b>Function 22 </b><br/>
                The evaluator shall perform the following tests.
                  <ol type='a'>
                    <li>The evaluator shall enable location services device-wide and shall verify that an application (such as a mapping application) is able to access the TOE’s location information. The evaluator shall disable location services device-wide and shall verify that an application (such as a mapping application) is unable to access the TOE’s location information.
                    </li>
                      <li>[conditional] If "per-app basis" is selected, the evaluator shall create two applications and enable one to use access the location services and the other to not access the location services. The evaluator shall exercise each application attempting to access location services individually. The evaluator shall verify that the enabled application is able to access the location services and the disabled application is not able to access the location services.
                  </li>
                  </ol>
                <br/>
                
                <b>Function 23</b><br/>
                The evaluator shall verify that the TSS states if the TOE supports a BAF and/or hybrid authentication. If the TOE does not include a BAF and/or hybrid authentication this test is implicitly met.
                   
                  <ol type='a'>
                    <li>[conditional] If a BAF is selected the evaluator shall verify that the TSS describes the procedure to enable/disable the BAF. If the TOE includes multiple BAFs, the evaluator shall verify that the TSS describes how to enable/disable each BAF, specifically if the different modalities can be individually enabled/disabled. The evaluator shall configure the TOE to allow each supported BAF to authenticate and verify that successful authentication can be achieved using the BAF. The evaluator shall configure the TOE to disable the use of each supported BAF for authentication and confirm that the BAF cannot be used to authenticate.
                    </li>
                    <li>[conditional] If "Hybrid" is selected the evaluator shall verify that the TSS describes the procedure to enable/disable the hybrid (biometric credential and PIN/password) authentication. The evaluator shall configure the TOE to allow hybrid authentication to authenticate and confirm that successful authentication can be achieved using the hybrid authentication. The evaluator shall configure the TOE to disable the use of hybrid authentication and confirm that the hybrid authentication cannot be used to authenticate.
                    </li>
                  </ol>
                <br/>
                
                <br/>
                Assurance Activity Note: It should be noted that the following functions are optional capabilities, if the function is implemented, then the following assurance activities shall be performed. The notation of "[conditional] beside the function number indicates that if the function is not included in the ST, then there is no expectation that the assurance activity be performed.
                <br/><br/>
                
                <b>Function 24 [conditional]</b><br/>
                The evaluator shall verify that the  TSS includes a list of each externally accessible hardware port and an indication of if data transfer over that port can be enabled/disabled. AGD guidance will describe how to perform the enable/disable function.<br/><br/>
                The evaluator shall exercise the TSF configuration to enable and disable data transfer capabilities over each externally accessible hardware ports (e.g. USB, SD card, HDMI) listed by the ST author. The evaluator shall use test equipment for the particular interface to ensure that no low-level signaling is occurring on all pins used for data transfer when they are disabled. For each disabled data transfer capability, the evaluator shall repeat this test by rebooting the device into the normal operational mode and verifying that the capability is disabled throughout the boot and early execution stage of the device. 
                <br/>
                
                <b>Function 25 [conditional]</b><br/>
                The evaluator shall verify that the  TSS describes how the TSF acts as a server in each of the protocols listed in the ST, and the reason for acting as a server.<br/><br/>
                The evaluator shall attempt to disable each listed protocol in the assignment. The evaluator shall verify that remote devices can no longer access the TOE or TOE resources using any disabled protocols.
                <br/>
                
                <b>Function 26 [conditional]</b><br/>
                The evaluator shall exercise the TSF configuration as the administrator and, if not restricted to the administrator, the user, to enable and disable any developer mode. The evaluator shall test that developer mode access is not available when its configuration is disabled. The evaluator shall verify the developer mode remains disabled during device reboot.
                <br/>
                
                <b>Function 27 [conditional]</b><br/>
                The evaluator shall examine the AGD guidance to determine that it describes how to enable and disable any "Forgot Password", password hint, or remote authentication (to bypass local authentication mechanisms) capability.<br/>
                For each mechanism listed in the AGD guidance that provides a "Forgot Password" feature or other means where the local authentication process can be bypassed, the evaluator shall disable the feature and ensure that they are not able to bypass the local authentication process.
                <br/>
                
                <b>Function 28 [conditional]</b><br/>
                The evaluator shall attempt to wipe Enterprise data resident on the device according to the administrator guidance. The evaluator shall verify that the data is no longer accessible by the user.
                <br/>
                
                <b>Function 29 [conditional]</b><br/>
                The evaluator shall verify that the  TSS describes how approval for an application to perform the selected action (import, removal) with respect to certificates in the Trust Anchor Database is accomplished (e.g., a pop-up, policy setting, etc.).
                <br/><br/>
                The evaluator shall also verify that the API documentation provided according to  includes any security functions (import, modification, or destruction of the Trust Anchor Database) allowed by applications.<br/><br/>
                The evaluator shall perform one of the following tests:
                  <ol type='a'>
                    <li>[conditional] If applications may import certificates to the Trust Anchor Database, the evaluator shall write, or the developer shall provide access to, an application that imports a certificate into the Trust Anchor Database. The evaluator shall verify that the TOE requires approval before allowing the application to import the certificate: 
                        <ul>
                          <li>The evaluator shall deny the approvals to verify that the application is not able to import the certificate. Failure of import shall be tested by attempting to validate a certificate that chains to the certificate whose import was attempted (as described in the Assurance Activity for FIA_X509_EXT.1).
                          </li>
                          <li>The evaluator shall repeat the test, allowing the approval to verify that the application is able to import the certificate and that validation occurs.
                          </li>
                        </ul>
                    </li>
                    <li>[conditional] If applications may remove certificates in the Trust Anchor Database, the evaluator shall write, or the developer shall provide access to, an application that removes certificates from the Trust Anchor Database. The evaluator shall verify that the TOE requires approval before allowing the application to remove the certificate: 
                        <ul>
                            <li>The evaluator shall deny the approvals to verify that the application is not able to remove the certificate. Failure of removal shall be tested by attempting to validate a certificate that chains to the certificate whose removal was attempted (as described in the Assurance Activity for FIA_X509_EXT.1).
                            </li>
                        </ul>
                    </li>
                  </ol>
                  The evaluator shall repeat the test, allowing the approval to verify that the application is able to remove/modify the certificate and that validation no longer occurs.
                <br/>
                
                <b>Function 30 [conditional]</b><br/>
                The test of this function is performed in conjunction with FIA_X509_EXT.2.2.
                <br/>
                
                <b>Function 31 [conditional]</b><br/>
                The evaluator shall ensure that the  TSS describes which cellular protocols can be disabled. The evaluator shall confirm that the AGD guidance describes the procedure for disabling each cellular protocol identified in the  TSS.<br/><br/>
                The evaluator shall attempt to disable each cellular protocol according to the administrator guidance. The evaluator shall attempt to connect the device to a cellular network and, using network analysis tools, verify that the device does not allow negotiation of the disabled protocols.
                <br/>
                
                <b>Function 32 [conditional]</b><br/>
                The evaluator shall attempt to read any device audit logs according to the administrator guidance and verify that the logs may be read. This test may be performed in conjunction with the assurance activity of FAU_GEN.1.
                <br/>
                
                <b>Function 33 [conditional]</b><br/>
                The test of this function is performed in conjunction with FPT_TUD_EXT.4.1.
                <br/>
                
                <b>Function 34 [conditional]</b><br/>
                The evaluator shall verify that the  TSS describes how the approval for exceptions for shared use of keys/secrets by multiple applications is accomplished (e.g., a pop-up, policy setting, etc.).<br/><br/>
                The test of this function is performed in conjunction with FCS_STG_EXT.1.
                <br/>
                
                <b>Function 35 [conditional]</b><br/>
                The evaluator shall verify that the  TSS describes how the approval for exceptions for destruction of keys/secrets by applications that did not import the key/secret is accomplished (e.g., a pop-up, policy setting, etc.).<br/><br/>
                The test of this function is performed in conjunction with FCS_STG_EXT.1.
                <br/>
                
                <b>Function 36 [conditional] </b><br/>
                The evaluator shall verify that the  TSS describes any restrictions in banner settings (e.g., character limitations).<br/><br/>
                The test of this function is performed in conjunction with FTA_TAB.1.
                <br/>
                
                <b>Function 37 [conditional]</b><br/>
                The test of this function is performed in conjunction with FAU_SEL.1. 
                <br/>
                
                <b>Function 38 [conditional]</b><br/>
                The test of this function is performed in conjunction with FPT_NOT_EXT.2.1. 
                <br/>
                
                <b>Function 39 [conditional]</b><br/>
                The evaluator shall verify that the  TSS includes a description of how data transfers can be managed over USB.<br/><br/>
                The evaluator shall perform the following tests based on the selections made in the table:
                  <ol type='a'>
                    <li>[conditional] The evaluator shall disable USB mass storage mode, attach the device to a computer, and verify that the computer cannot mount the TOE as a drive. The evaluator shall reboot the TOE and repeat this test with other supported auxiliary boot modes.
                      </li>
                    <li>[conditional] The evaluator shall disable USB data transfer without user authentication, attach the device to a computer, and verify that the TOE requires user authentication before the computer can access TOE data. The evaluator shall reboot the TOE and repeat this test with other supported auxiliary boot modes.
                    </li>    
                    <li>[conditional] The evaluator shall disable USB data transfer without connecting system authentication, attach the device to a computer, and verify that the TOE requires connecting system authentication before the computer can access TOE data. The evaluator shall then connect the TOE to another computer and verify that the computer cannot access TOE data. The evaluator shall then connect the TOE to the original computer and verify that the computer can access TOE data.
                    </li>
                  </ol>
                <br/>
                
                <b>Function 40 [conditional]</b><br/>
                The evaluator shall verify that the  TSS includes a description of available backup methods that can be enabled/disabled. If "selected applications or selected groups of applications are selected the  TSS shall include which applications of groups of applications backup can be enabled/disabled.<br/><br/>
                If "all applications" is selected, the evaluator shall disable each selected backup location in turn and verify that the TOE cannot complete a backup. The evaluator shall then enable each selected backup location in turn and verify that the TOE can perform a backup.
                  <br/><br/>
                  If "selected applications" is selected, the evaluator shall disable each selected backup location in turn and verify that for the selected application the TOE prevents backup from occurring. The evaluator shall then enable each selected backup location in turn and verify that for the selected application the TOE can perform a backup.
                  <br/><br/>
                  If "selected groups of applications" is selected, the evaluator shall disable each selected backup location in turn and verify that for a group of applications the TOE prevents the backup from occurring. The evaluator shall then enable each selected backup location in turn and verify for the group of application the TOE can perform a backup.
                  <br/><br/>
                  If "configuration data" is selected, the evaluator shall disable each selected backup location in turn and verify that the TOE prevents the backup of configuration data from occurring. The evaluator shall then enable each selected backup location in turn and verify that the TOE can perform a backup of configuration data.
                <br/>
                
                <b>Function 41 [conditional] </b><br/>
                The evaluator shall verify that the  TSS includes a description of Hotspot functionality and USB tethering to include any authentication for these. <br/><br/>
                The evaluator shall perform the following tests based on the selections in 0.
                  <ol type='a'>
                    <li>[conditional] The evaluator shall enable hotspot functionality with each of the of the support authentication methods. The evaluator shall connect to the hotspot with another device and verify that the hotspot functionality requires the configured authentication method. 
                      </li>
                    <li>[conditional] The evaluator shall enable USB tethering functionality with each of the of the support authentication methods. The evaluator shall connect to the TOE over USB with another device and verify that the tethering functionality requires the configured authentication method.
                    </li>
                  </ol>
                <br/>
                
                <b>Function 42 [conditional]</b><br/>
                The test of this function is performed in conjunction with FDP_ACF_EXT.1.2. 
                <br/>
                
                <b>Function 43 [conditional]</b><br/>
                The evaluator shall set a policy to cause a designated application to be placed into a particular application group. The evaluator shall then install the designated application and verify that it was placed into the correct group. 
                <br/>
                
                <b>Function 44 [conditional]</b><br/>
                The evaluator shall attempt to unenroll the device from management and verify that the steps described in FMT_SMF_EXT.2.1 are performed. This test should be performed in conjunction with the FMT_SMF_EXT.2.1 assurance activity.
                <br/>
                
                <b>Function 45 [conditional]</b><br/>
                The evaluator shall verify that the  TSS contains guidance to configure the VPN as Always-On. The evaluator shall configure the VPN as Always-On and perform the following test.
                  <ol type='a'>
                    <li>The evaluator shall verify that when the VPN is connected all traffic is routed through the VPN. This test is performed in conjunction with FDP_IFC_EXT.1.1.
                    </li>
                    <li>The evaluator shall verify that when the VPN is not established, that no traffic leaves the device. The evaluator shall ensure that the TOE has network connectivity and that the VPN is established. The evaluator shall use a packet sniffing tool to capture the traffic leaving the TOE. The evaluator shall disable the VPN connection on the server side. The evaluator shall perform actions with the device such as navigating to websites, using provided applications, and accessing other Internet resources and verify that no traffic leaves the device.
                      </li>
                    <li>The evaluator shall verify that the TOE has network connectivity and that the VPN is established. The evaluator shall disable network connectivity (i.e. Airplane Mode) and verify that the VPN disconnects. The evaluator shall re-establish network connectivity and verify that the VPN automatically reconnects.
                        </li>
                  </ol>
                <br/>
                
                <b>Function 46 [conditional]</b><br/>
                The evaluator shall verify that the  TSS describes the procedure to revoke a biometric credential stored on the TOE. The evaluator shall configure the TOE to use BAF and confirm that the biometric can be used to authenticate to the device. The evaluator shall revoke the biometric credential’s ability to authenticate to the TOE and confirm that the same BAF cannot be used to authenticate to the device. 
                <br/>
                
                <b>Function 47</b><br/>
                The evaluator shall verify that the  TSS describes all assigned security management functions and their intended behavior. <br/><br/>
                The evaluator shall design and perform tests to demonstrate that the function may be configured and that the intended behavior of the function is enacted by the TOE.
                <br/>
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fmt__smf__ext.1 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fmt__smf__ext.2' class='component fmt__smf__ext.2'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FMT_SMF_EXT.2 &#8212; Extended: Specification of Remediation Actions</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fmt__smf__ext.2.1' class='requirement fmt__smf__ext.2.1'><div class='f-el-title'>FMT_SMF_EXT.2.1</div><div class='words'>The TSF shall offer 
              <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>wipe of protected data</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>wipe of sensitive data</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>alert the administrator</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span>remove Enterprise applications</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='4' class='val selbox'></input><span>remove all device-stored Enterprise resource data</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='5' class='val selbox'></input><span>remove Enterprise secondary authentication data</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='6' class='val selbox'></input><span> 
              <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='list other available remediation actions'></textarea></span>
</li>
</ul>
</span> upon un-enrollment and 
              <span class='selectables' data-rindex='1'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>
                <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='other administrator-configured triggers'></textarea></span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span> no other triggers</span>
</li>
</ul>
</span>.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fmt__smf__ext.2.1 -->
<div class='aactivity'>

              The evaluator shall verify that the  TSS describes all available remediation actions, when they are available for use, and any other administrator-configured triggers. The evaluator shall verify that the  TSS describes how the remediation actions are provided to the administrator. 
              <br/><br/>
              The evaluator shall use the test environment to iteratively configure the device to perform each remediation action in the selection. The evaluator shall configure the remediation action per how the  TSS states it is provided to the administrator. The test environment could be a MDM agent application, but can also be an application with administrator access.
             </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fmt__smf__ext.2 -->
<span class='comp-notes'></span><br/><span class='tooltipped'><input type='checkbox' onchange='handleOCheck(this); return false;'></input></span>
<span id='Mobile_Device_Fundamentals:fmt__smf__ext.3' class='component fmt__smf__ext.3 disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FMT_SMF_EXT.3 &#8212; Extended: Current Administrator</a><span class='tooltiptext'>objective</span>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fmt__smf__ext.3.1' class='requirement fmt__smf__ext.3.1'><div class='f-el-title'>FMT_SMF_EXT.3.1</div><div class='words'>The TSF shall provide a mechanism that allows users to view a list of currently authorized administrators and the management functions that each administrator is authorized to perform.</div>
</div><!-- End: Mobile_Device_Fundamentals:fmt__smf__ext.3.1 -->
<div class='aactivity'>
The evaluator shall cause the TOE to be enrolled into management. The evaluator shall then invoke this mechanism and verify the ability to view that the device has been enrolled, and view the management functions that the administrator is authorized to perform.
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fmt__smf__ext.3 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fpt__aex__ext.1' class='component fpt__aex__ext.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FPT_AEX_EXT.1 &#8212; Extended: Anti-Exploitation Services (ASLR)</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fpt__aex__ext.1.1' class='requirement fpt__aex__ext.1.1'><div class='f-el-title'>FPT_AEX_EXT.1.1</div><div class='words'>The TSF shall provide address space layout randomization ASLR to applications. 
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fpt__aex__ext.1.1 -->
<div id='Mobile_Device_Fundamentals:fpt__aex__ext.1.2' class='requirement fpt__aex__ext.1.2'><div class='f-el-title'>FPT_AEX_EXT.1.2</div><div class='words'>The base address of any user-space memory mapping will consist of at least 8 unpredictable bits. 
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fpt__aex__ext.1.2 -->
<div class='aactivity'>
The evaluator shall ensure that the  TSS section of the ST describes how the 8 bits are generated and provides a justification as to why those bits are unpredictable.
              <br/><br/>
              Assurance Activity Note: The following test require the developer to provide access to a test platform that provides the evaluator with tools that are typically not found on consumer Mobile Device products. <br/>
               
                The evaluator shall select 3 apps included with the TSF. These must include any web browser or mail client included with the TSF. For each of these apps, the evaluator shall launch the same app on two separate Mobile Devices of the same type and compare all memory mapping locations. The evaluator must ensure that no memory mappings are placed in the same location on both devices. 
                  <br/><br/>
                  If the rare (at most 1/256) chance occurs that two mappings are the same for a single app and not the same for the other two apps, the evaluator shall repeat the test with that app to verify that in the second test the mappings are different. 
                
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fpt__aex__ext.1 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fpt__aex__ext.2' class='component fpt__aex__ext.2'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FPT_AEX_EXT.2 &#8212; Extended: Anti-Exploitation Services (Memory Page Permissions)</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fpt__aex__ext.2.1' class='requirement fpt__aex__ext.2.1'><div class='f-el-title'>FPT_AEX_EXT.2.1</div><div class='words'>The TSF shall be able to enforce read, write, and execute permissions on every page of physical memory.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fpt__aex__ext.2.1 -->
<div class='aactivity'>
The evaluator shall ensure that the  TSS describes of the memory management unit (MMU), and ensures that this description documents the ability of the MMU to enforce read, write, and execute permissions on all pages of virtual memory.
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fpt__aex__ext.2 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fpt__aex__ext.3' class='component fpt__aex__ext.3'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FPT_AEX_EXT.3 &#8212; Extended: Anti-Exploitation Services (Overflow Protection)</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fpt__aex__ext.3.1' class='requirement fpt__aex__ext.3.1'><div class='f-el-title'>FPT_AEX_EXT.3.1</div><div class='words'>TSF processes that execute in a non-privileged execution domain on the application processor shall implement stack-based buffer overflow protection.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fpt__aex__ext.3.1 -->
<div class='aactivity'>
The evaluator shall determine that the  TSS contains a description of stack-based buffer overflow protections implemented in the TSF software which runs in the non-privileged execution mode of the application processor. The exact implementation of stack-based buffer overflow protection will vary by platform. Example implementations may be activated through compiler options such as "-fstack-protector-all", "-fstack-protector", and "/GS" flags. 
              The evaluator shall ensure that the  TSS contains an inventory of TSF binaries and libraries, indicating those that implement stack-based buffer overflow protections as well as those that do not. The  TSS must provide a rationale for those binaries and libraries that are not protected in this manner.
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fpt__aex__ext.3 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fpt__aex__ext.4' class='component fpt__aex__ext.4'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FPT_AEX_EXT.4 &#8212; Extended: Domain Isolation</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fpt__aex__ext.4.1' class='requirement fpt__aex__ext.4.1'><div class='f-el-title'>FPT_AEX_EXT.4.1</div><div class='words'>The TSF shall protect itself from modification by untrusted subjects.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fpt__aex__ext.4.1 -->
<div id='Mobile_Device_Fundamentals:fpt__aex__ext.4.2' class='requirement fpt__aex__ext.4.2'><div class='f-el-title'>FPT_AEX_EXT.4.2</div><div class='words'>The TSF shall enforce isolation of address space between applications.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fpt__aex__ext.4.2 -->
<div class='aactivity'>
The evaluator shall ensure that the  TSS describes the mechanisms that are in place that prevents non-TSF software from modifying the TSF software or TSF data that governs the behavior of the TSF. These mechanisms could range from hardware-based means (e.g. "execution rings" and memory management functionality); to software-based means (e.g. boundary checking of inputs to APIs). The evaluator determines that the described mechanisms appear reasonable to protect the TSF from modification.
              <br/><br/>
              The evaluator shall ensure the  TSS describes how the TSF ensures that the address spaces of applications are kept separate from one another.
              <br/><br/>
              The evaluator shall ensure the  TSS details the USSD and MMI codes available from the dialer at the locked state or during auxiliary boot modes that may alter the behavior of the TSF. The evaluator shall ensure that this description includes the code, the action performed by the TSF, and a justification that the actions performed do not modify user or TSF data. If no USSD or MMI codes are available, the evaluator shall ensure that the  TSS provides a description of the method by which actions prescribed by these codes are prevented. 
              <br/><br/>
              The evaluator shall ensure the  TSS documents any TSF data (including software, execution context, configuration information, and audit logs) which may be accessed and modified over a wired interface in auxiliary boot modes. The evaluator shall ensure that the description includes data, which is modified in support of update or restore of the device. The evaluator shall ensure that this documentation includes the auxiliary boot modes in which the data may be modified, the methods for entering the auxiliary boot modes, the location of the data, the manner in which data may be modified, the data format and packaging necessary to support modification, and software and/or hardware tools, if any, which are necessary for modifying the data.
              <br/><br/>
              The evaluator shall ensure that the  TSS provides a description of the means by which unauthorized and undetected modification (that is, excluding cryptographically verified updates per FPT_TUD_EXT.2) of the TSF data over the wired interface in auxiliary boots modes is prevented. The lack of publicly available tools is not sufficient justification. Examples of sufficient justification include auditing of changes, cryptographic verification in the form of a digital signature or hash, disabling the auxiliary boot modes, and access control mechanisms that prevent writing to files or flashing partitions.
              <br/><br/>
              Assurance Activity Note: The following tests require the vendor to provide access to a test platform that provides the evaluator with tools that are typically not found on consumer Mobile Device products. In addition, the vendor provides a list of files (e.g., system files, libraries, configuration files, audit logs) that make up the TSF data. This list could be organized by folders/directories (e.g., /usr/sbin, /etc), as well as individual files that may exist outside of the identified directories. <br/>
              
                The evaluator shall create and load an app onto the Mobile Device. This app shall attempt to traverse over all file systems and report any locations to which data can be written or overwritten. The evaluator must ensure that none of these locations are part of the OS software, device drivers, system and security configuration files, key material, or another untrusted application’s image/data. For example, it is acceptable for a trusted photo editor app to have access to the data created by the camera app, but a calculator application shall not have access to the pictures.<br/>
                For each available auxiliary boot mode, the evaluator shall attempt to modify a TSF file of their choosing using the software and/or hardware tools described in the  TSS. The evaluator shall verify that the modification fails.
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fpt__aex__ext.4 -->
<span class='comp-notes'></span><br/><span class='tooltipped'><input type='checkbox' onchange='handleOCheck(this); return false;'></input></span>
<span id='Mobile_Device_Fundamentals:fpt__aex__ext.5' class='component fpt__aex__ext.5 disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FPT_AEX_EXT.5 &#8212; Extended: Anti-Exploitation Services (ASLR)</a><span class='tooltiptext'>objective</span>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fpt__aex__ext.5.1' class='requirement fpt__aex__ext.5.1'><div class='f-el-title'>FPT_AEX_EXT.5.1</div><div class='words'>The TSF shall provide address space layout randomization (ASLR) to the kernel. </div>
</div><!-- End: Mobile_Device_Fundamentals:fpt__aex__ext.5.1 -->
<div id='Mobile_Device_Fundamentals:fpt__aex__ext.5.2' class='requirement fpt__aex__ext.5.2'><div class='f-el-title'>FPT_AEX_EXT.5.2</div><div class='words'>The base address of any kernel-space memory mapping will consist of at least 4 unpredictable bits.</div>
</div><!-- End: Mobile_Device_Fundamentals:fpt__aex__ext.5.2 -->
<div class='aactivity'>
The evaluator shall ensure that the  TSS section of the ST describes how the 4 bits are generated and provides a justification as to why those bits are unpredictable.
              <br/><br/>
              Assurance Activity Note: The following test require the developer to provide access to a test platform that provides the evaluator with tools that are typically not found on consumer Mobile Device products. 
              
                The evaluator shall reboot the TOE at least five times. For each of these reboots, the evaluator shall examine memory mapping locations of the kernel. The evaluator must ensure that no memory mappings are placed in the same location on both devices.
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fpt__aex__ext.5 -->
<span class='comp-notes'></span><br/><span class='tooltipped'><input type='checkbox' onchange='handleOCheck(this); return false;'></input></span>
<span id='Mobile_Device_Fundamentals:fpt__aex__ext.6' class='component fpt__aex__ext.6 disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FPT_AEX_EXT.6 &#8212; Extended: Anti-Exploitation Services (Memory Page Permissions)</a><span class='tooltiptext'>objective</span>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fpt__aex__ext.6.1' class='requirement fpt__aex__ext.6.1'><div class='f-el-title'>FPT_AEX_EXT.6.1</div><div class='words'>The TSF shall prevent write and execute permissions from being simultaneously granted to any page of physical memory 
              <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>with no exceptions</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span> 
              <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='specific exceptions'></textarea></span>
</li>
</ul>
</span>.</div>
</div><!-- End: Mobile_Device_Fundamentals:fpt__aex__ext.6.1 -->
<div class='aactivity'>
The evaluator shall ensure that the  TSS describes how the operating system of the application processor prevents all processes executing in a non-privileged execution domain from achieving write and execute permissions on any page of memory (with only specified exceptions). The evaluator shall ensure that the  TSS describes how such processes are unable to request pages of memory with such permissions, and how they are unable to change permissions to both write and execute on any pages already allocated to them.
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fpt__aex__ext.6 -->
<span class='comp-notes'></span><br/><span class='tooltipped'><input type='checkbox' onchange='handleOCheck(this); return false;'></input></span>
<span id='Mobile_Device_Fundamentals:fpt__aex__ext.7' class='component fpt__aex__ext.7 disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FPT_AEX_EXT.7 &#8212; Extended: Anti-Exploitation Services (Overflow Protection)</a><span class='tooltiptext'>objective</span>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fpt__aex__ext.7.1' class='requirement fpt__aex__ext.7.1'><div class='f-el-title'>FPT_AEX_EXT.7.1</div><div class='words'>The TSF shall include heap-based buffer overflow protections in the runtime environment it provides to processes that execute on the application processor.</div>
</div><!-- End: Mobile_Device_Fundamentals:fpt__aex__ext.7.1 -->
<div class='aactivity'>
The evaluator shall verify that the  TSS enumerates the heap implementations provided to userspace processes. The evaluator shall ensure that the  TSS lists all types of heap metadata and identifies how the integrity of each type of metadata is ensured. The evaluator shall ensure that the  TSS identifies all fields within each type of metadata and identifies how the integrity of these fields is ensured. The evaluator shall verify that the  TSS identifies the manner in which an error condition is entered when a heap overflow is detected and the resulting actions taken by the TSF.
              <br/><br/>
              For each heap implementation, the evaluator shall write, or the developer shall provide access to, an application, which allocates memory from the heap and then writes arbitrary data significantly beyond the end of the allocated buffer. The evaluator shall attempt to execute this application and verify that the write is not allowed.
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fpt__aex__ext.7 -->
<span class='comp-notes'></span><br/><span class='tooltipped'><input type='checkbox' onchange='handleOCheck(this); return false;'></input></span>
<span id='Mobile_Device_Fundamentals:fpt__bbd__ext.1' class='component fpt__bbd__ext.1 disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FPT_BBD_EXT.1 &#8212; Extended: Application Processor Mediation</a><span class='tooltiptext'>objective</span>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fpt__bbd__ext.1.1' class='requirement fpt__bbd__ext.1.1'><div class='f-el-title'>FPT_BBD_EXT.1.1</div><div class='words'>The TSF shall prevent code executing on any baseband processor (BP) from accessing application processor (AP) resources except when mediated by the AP.</div>
</div><!-- End: Mobile_Device_Fundamentals:fpt__bbd__ext.1.1 -->
<div class='aactivity'>
The evaluator shall ensure that the  TSS section of the ST describes at a high level how the processors on the Mobile Device interact, including which bus protocols they use to communicate, any other devices operating on that bus (peripherals and sensors), and identification of any shared resources. The evaluator shall verify that the design described in the  TSS does not permit any BPs from accessing any of the peripherals and sensors or from accessing main memory (volatile and non-volatile) used by the AP. In particular, the evaluator shall ensure that the design prevents modification of executable memory of the AP by the BP.
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fpt__bbd__ext.1 -->
<span class='comp-notes'></span><br/><span class='tooltipped'><input type='checkbox' onchange='handleOCheck(this); return false;'></input></span>
<span id='Mobile_Device_Fundamentals:fpt__blt__ext.1' class='component fpt__blt__ext.1 disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FPT_BLT_EXT.1 &#8212; Extended: Limitation of Bluetooth Profile Support</a><span class='tooltiptext'>objective</span>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fpt__blt__ext.1.1' class='requirement fpt__blt__ext.1.1'><div class='f-el-title'>FPT_BLT_EXT.1.1</div><div class='words'>The TSF shall disable support for 
              <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='list of Bluetooth profiles'></textarea> Bluetooth profiles when they are not currently being used by an application on the Mobile Device, and shall require explicit user action to enable them.</div>
</div><!-- End: Mobile_Device_Fundamentals:fpt__blt__ext.1.1 -->
<div class='aactivity'>
The evaluator shall perform the following tests:
              
                While the service is not in active use by an application on the TOE, the evaluator shall attempt to discover a service associated with a "protected" Bluetooth profile (as specified by the requirement) on the TOE via a Service Discovery Protocol search. The evaluator shall verify that the service does not appear in the Service Discovery Protocol search results. Next, the evaluator shall attempt to gain remote access to the service from a device that does not currently have a trusted device relationship with the TOE. The evaluator shall verify that this attempt fails due to the unavailability of the service and profile. <br/>
                The evaluator shall repeat Test 1 with a device that currently has a trusted device relationship with the TOE and verify that the same behavior is exhibited. 
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fpt__blt__ext.1 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fpt__jta__ext.1' class='component fpt__jta__ext.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FPT_JTA_EXT.1 &#8212; Extended: JTAG Disablement</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fpt__jta__ext.1.1' class='requirement fpt__jta__ext.1.1'><div class='f-el-title'>FPT_JTA_EXT.1.1</div><div class='words'>The TSF shall 
              <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>disable access through hardware</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>control access by a signing key</span>
</li>
</ul>
</span> to JTAG.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fpt__jta__ext.1.1 -->
<div class='aactivity'>

              
              If "disable access through hardware" is selected the evaluator shall perform the following test:
              <br/><br/>
              Assurance Activity Note: The following test requires the developer to provide access to a test platform that provides the evaluator with chip level access. 
              <br/><br/>
              The evaluator shall examine the TSS to determine the location of the JTAG ports on the TSF, to include the order of the ports (i.e. Data In, Data Out, Clock, etc.). The evaluator shall connect a packet analyzer to the JTAG ports. The evaluator shall query the JTAG port for its device ID and confirm that the device ID cannot be retrieved. <br/><br/>
              
              If "control access by a signing key" is selected the evaluator shall perform the following test:<br/><br/>
              
              The evaluator shall examine the TSS to determine how access to the JTAG is controlled by a signing key. The evaluator shall examine the TSS to determine when the JTAG can be accessed, i.e. what has the access to the signing key.
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fpt__jta__ext.1 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fpt__kst__ext.1' class='component fpt__kst__ext.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FPT_KST_EXT.1 &#8212; Extended: Key Storage</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fpt__kst__ext.1.1' class='requirement fpt__kst__ext.1.1'><div class='f-el-title'>FPT_KST_EXT.1.1</div><div class='words'>The TSF shall not store any plaintext key material in readable non-volatile memory.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fpt__kst__ext.1.1 -->
<div class='aactivity'>
The evaluator shall consult the  TSS section of the ST in performing the assurance activities for this requirement. 
              <br/><br/>
              In performing their review, the evaluator shall determine that the  TSS contains a description of the activities that happen on power-up and password authentication relating to the decryption of DEKs, stored keys, and data.
              <br/><br/>
              The evaluator shall ensure that the description also covers how the cryptographic functions in the FCS requirements are being used to perform the encryption functions, including how the KEKs, DEKs, and stored keys are unwrapped, saved, and used by the TOE so as to prevent plaintext from being written to non-volatile storage. The evaluator shall ensure that the  TSS describes, for each power-down scenario how the TOE ensures that all keys in non-volatile storage are not stored in plaintext.
              <br/><br/>
              The evaluator shall ensure that the  TSS describes how other functions available in the system (e.g., regeneration of the keys) ensure that no unencrypted key material is present in persistent storage.
              <br/><br/>
              The evaluator shall review the  TSS to determine that it makes a case that key material is not written unencrypted to the persistent storage.
              <br/><br/>
              For each BAF selected in FIA_UAU.5.1:
              <br/><br/>
              The evaluator shall determine that the  TSS also contains a description of the activities that happen on biometric authentication, relating to the decryption of DEKs, stored keys, and data. In addition how the system ensures that the biometric keying material is not stored unencrypted in persistent storage.
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fpt__kst__ext.1 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fpt__kst__ext.2' class='component fpt__kst__ext.2'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FPT_KST_EXT.2 &#8212; Extended: No Key Transmission</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fpt__kst__ext.2.1' class='requirement fpt__kst__ext.2.1'><div class='f-el-title'>FPT_KST_EXT.2.1</div><div class='words'>The TSF shall not transmit any plaintext key material outside the security boundary of the TOE. 
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fpt__kst__ext.2.1 -->
<div class='aactivity'>
The evaluator shall consult the  TSS section of the ST in performing the assurance activities for this requirement. The evaluator shall ensure that the  TSS describes the TOE security boundary. The cryptographic module may very well be a particular kernel module, the Operating System, the Application Processor, or up to the entire Mobile Device. 
              <br/><br/>
              In performing their review, the evaluator shall determine that the TSS contains a description of the activities that happen on power-up and password authentication relating to the decryption of DEKs, stored keys, and data.
              <br/><br/>
              The evaluator shall ensure that the  TSS describes how other functions available in the system (e.g., regeneration of the keys) ensure that no unencrypted key material is transmitted outside the security boundary of the TOE.
              <br/><br/>
              The evaluator shall review the  TSS to determine that it makes a case that key material is not transmitted outside the security boundary of the TOE. 
              <br/><br/>
              For each BAF selected in FIA_UAU.5.1:
              <br/><br/>
              In performing their review, the evaluator shall determine that the  TSS contains a description of the activities that happen on biometric authentication, including how any plaintext material, including critical security parameters and results of biometric algorithms, are protected and accessed.
              <br/><br/>
              The evaluator shall ensure that the  TSS describes how functions available in the biometric algorithms ensure that no unencrypted plaintext material, including critical security parameters and intermediate results, is transmitted outside the security boundary of the TOE or to other functions or systems that transmit information outside the security boundary of the TOE.
             </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fpt__kst__ext.2 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fpt__kst__ext.3' class='component fpt__kst__ext.3'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FPT_KST_EXT.3 &#8212; Extended: No Plaintext Key Export</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fpt__kst__ext.3.1' class='requirement fpt__kst__ext.3.1'><div class='f-el-title'>FPT_KST_EXT.3.1</div><div class='words'>The TSF shall ensure it is not possible for the TOE user(s) to export plaintext keys.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fpt__kst__ext.3.1 -->
<div class='aactivity'>
The ST author will provide a statement of their policy for handling and protecting keys. The evaluator shall check to ensure the  TSS describes a policy in line with not exporting either plaintext DEKs, KEKs, or keys stored in the secure key storage. 
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fpt__kst__ext.3 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fpt__not__ext.1' class='component fpt__not__ext.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FPT_NOT_EXT.1 &#8212; Extended: Self-Test Notification</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fpt__not__ext.1.1' class='requirement fpt__not__ext.1.1'><div class='f-el-title'>FPT_NOT_EXT.1.1</div><div class='words'>The TSF shall transition to non-operational mode and 
              <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>log failures in the audit record</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>notify the administrator</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span> 
                <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='other actions'></textarea></span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span>no other actions</span>
</li>
</ul>
</span> when the following types of failures occur: 
              <ul>
                <li>failures of the self-test(s)</li> 
                <li>TSF software integrity verification failures</li>
                  <li><span class='selectables' data-rindex='1'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>no other failures</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span> 
                    <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='other failures'></textarea></span>
</li>
</ul>
</span></li>
              </ul>
              
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fpt__not__ext.1.1 -->
<div class='aactivity'>
The evaluator shall verify that the  TSS describes critical failures that may occur and the actions to be taken upon these critical failures. 
              <br/><br/>
              Assurance Activity Note: The following test require the developer to provide access to a test platform that provides the evaluator with tools that are typically not found on consumer Mobile Device products. 
              
                The evaluator shall use a tool provided by the developer to modify files and processes in the system that correspond to critical failures specified in the second list. The evaluator shall verify that creating these critical failures causes the device to take the remediation actions specified in the first list.
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fpt__not__ext.1 -->
<span class='comp-notes'></span><br/><span class='tooltipped'><input type='checkbox' onchange='handleOCheck(this); return false;'></input></span>
<span id='Mobile_Device_Fundamentals:fpt__not__ext.2' class='component fpt__not__ext.2 disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FPT_NOT_EXT.2 &#8212; Extended: Self-Test Notification</a><span class='tooltiptext'>objective</span>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fpt__not__ext.2.1' class='requirement fpt__not__ext.2.1'><div class='f-el-title'>FPT_NOT_EXT.2.1</div><div class='words'>The TSF shall 
              <span class='selectables' data-rindex='0'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>audit</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>provide the administrator with</span>
</span> TSF-software integrity verification values.</div>
</div><!-- End: Mobile_Device_Fundamentals:fpt__not__ext.2.1 -->
<div class='aactivity'>
The evaluator shall verify that the  TSS describes which critical memory is measured for these integrity values and how the measurement is performed (including which TOE software performs these generates these values, how that software accesses the critical memory, and which algorithms are used).
              <br/><br/>
              If the integrity values are provided to the administrator, the evaluator shall verify that the AGD guidance contains instructions for retrieving these values and information for interpreting them. For example, if multiple measurements are taken, what those measurements are and how changes to those values relate to changes in the device state.
              <br/><br/>
              Assurance Activity Note: The following test may require the developer to provide access to a test platform that provides the evaluator with tools that are typically not found on consumer Mobile Device products. 
              <br/><br/>
              The evaluator shall repeat the following test for each measurement:
              
                The evaluator shall boot the device in an approved state and record the measurement taken (either from the log or by using the administrative guidance to retrieve the value via an MDM Agent). The evaluator shall modify the critical memory or value that is measured. The evaluator shall boot the device and verify that the measurement changed. 
              
            </div><div id='Mobile_Device_Fundamentals:fpt__not__ext.2.2' class='requirement fpt__not__ext.2.2'><div class='f-el-title'>FPT_NOT_EXT.2.2</div><div class='words'>The TSF shall cryptographically sign all integrity verification values.</div>
</div><!-- End: Mobile_Device_Fundamentals:fpt__not__ext.2.2 -->
<div class='aactivity'>

              The evaluator shall verify that the  TSS describes which key the TSF uses to sign the responses to queries and the certificate used to prove ownership of the key, and the method of associating the certificate with a particular device manufacturer and model. The evaluator shall perform the following test.
              
                The evaluator shall write, or the developer shall provide, a management application that queries either the audit logs or the measurements. The evaluator shall verify that the responses to these queries are signed and verify the signatures against the TOE’s certificate.
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fpt__not__ext.2 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fpt__stm.1' class='component fpt__stm.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FPT_STM.1 &#8212; Reliable time stamps</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fpt__stm.1.1' class='requirement fpt__stm.1.1'><div class='f-el-title'>FPT_STM.1.1</div><div class='words'>The TSF shall be able to provide reliable time stamps for its own use.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fpt__stm.1.1 -->
<div class='aactivity'>
The evaluator shall examine the  TSS to ensure that it lists each security function that makes use of time. The  TSS provides a description of how the time is maintained and considered reliable in the context of each of the time related functions. This documentation must identify whether the TSF uses a NTP server or the carrier’s network time as the primary time sources.
              <br/><br/>
              The evaluator examines the operational guidance to ensure it describes how to set the time.
              
                The evaluator uses the operational guide to set the time. The evaluator shall then use an available interface to observe that the time was set correctly.
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fpt__stm.1 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fpt__tst__ext.1' class='component fpt__tst__ext.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FPT_TST_EXT.1 &#8212; Extended: TSF Cryptographic Functionality Testing</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fpt__tst__ext.1.1' class='requirement fpt__tst__ext.1.1'><div class='f-el-title'>FPT_TST_EXT.1.1</div><div class='words'>The TSF shall run a suite of self-tests during initial start-up (on power on) to demonstrate the correct operation of all cryptographic functionality.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fpt__tst__ext.1.1 -->
<div class='aactivity'>
The evaluator shall examine the  TSS to ensure that it specifies the self-tests that are performed at start-up. This description must include an outline of the test procedures conducted by the TSF (e.g., rather than saying "memory is tested", a description similar to "memory is tested by writing a value to each memory location and reading it back to ensure it is identical to what was written" shall be used). The  TSS must include any error states that they TSF may enter when self-tests fail, and the conditions and actions necessary to exit the error states and resume normal operation. The evaluator shall verify that the  TSS indicates these self-tests are run at start-up automatically, and do not involve any inputs from or actions by the user or operator.
              <br/><br/>
              The evaluator shall inspect the list of self-tests in the  TSS and verify that it includes algorithm self-tests. The algorithm self-tests will typically be conducted using known answer tests.
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fpt__tst__ext.1 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fpt__tst__ext.2_l1_r' class='component fpt__tst__ext.2_l1_r'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FPT_TST_EXT.2(1) &#8212; Extended: TSF Integrity Checking</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fpt__tst__ext.2.1_l1_r' class='requirement fpt__tst__ext.2.1_l1_r'><div class='f-el-title'>FPT_TST_EXT.2.1(1)</div><div class='words'>The TSF shall verify the integrity of the bootchain up through the Application Processor OS kernel stored in mutable media prior to its execution through the use of 
                <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>a digital signature using an immutable hardware asymmetric key</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>an immutable hardware hash of an asymmetric key</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>an immutable hardware hash</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span>a digital signature using a hardware-protected asymmetric key</span>
</li>
</ul>
</span>. 
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fpt__tst__ext.2.1_l1_r -->
<div class='aactivity'>
The evaluator shall verify that the  TSS section of the ST includes a description of the boot procedures, including a description of the entire bootchain, of the software for the TSF’s Application Processor. The evaluator shall ensure that before loading the bootloader(s) for the operating system and the kernel, all bootloaders and the kernel software itself is cryptographically verified. For each additional category of executable code verified before execution, the evaluator shall verify that the description in the  TSS describes how that software is cryptographically verified.
              <br/><br/>
              The evaluator shall verify that the  TSS contains a justification for the protection of the cryptographic key or hash, preventing it from being modified by unverified or unauthenticated software. The evaluator shall verify that the  TSS contains a description of the protection afforded to the mechanism performing the cryptographic verification.
              <br/><br/>
              The evaluator shall verify that the  TSS describes each auxiliary boot mode available on the TOE during the boot procedures. The evaluator shall verify that, for each auxiliary boot mode, a description of the cryptographic integrity of the executed code through the kernel is verified before each execution.
              <br/><br/>
              The evaluator shall perform the following tests:
              
                The evaluator shall perform actions to cause TSF software to load and observe that the integrity mechanism does not flag any executables as containing integrity errors and that the TOE properly boots. 
                <br/>
                Assurance Activity Note: The following tests require the vendor to provide access to a test platform that provides the evaluator with tools that are typically not found on consumer Mobile Device products.<br/><br/>
                The evaluator shall modify a TSF executable that is integrity protected and cause that executable to be successfully loaded by the TSF. The evaluator observes that an integrity violation is triggered and the TOE does not boot. (Care must be taken so that the integrity violation is determined to be the cause of the failure to load the module, and not the fact that the module was modified so that it was rendered unable to run because its format was corrupt).<br/>
                [conditional] If the ST author indicates that the integrity verification is performed using a public key, the evaluator shall verify that the update mechanism includes a certificate validation according to FIA_X509_EXT.1. The evaluator shall digitally sign the TSF executable with a certificate that does not have the Code Signing purpose in the extendedKeyUsage field and verify that an integrity violation is triggered. The evaluator shall repeat the test using a certificate that contains the Code Signing purpose and verify that the integrity verification succeeds. Ideally, the two certificates should be identical except for the extendedKeyUsage field.
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fpt__tst__ext.2_l1_r -->
<span class='comp-notes'></span><br/><span class='tooltipped'><input type='checkbox' onchange='handleOCheck(this); return false;'></input></span>
<span id='Mobile_Device_Fundamentals:fpt__tst__ext.2_l2_r' class='component fpt__tst__ext.2_l2_r disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FPT_TST_EXT.2(2) &#8212; Extended: TSF Integrity Checking</a><span class='tooltiptext'>objective</span>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fpt__tst__ext.2.1_l2_r' class='requirement fpt__tst__ext.2.1_l2_r'><div class='f-el-title'>FPT_TST_EXT.2.1(2)</div><div class='words'>The TSF shall verify the integrity of <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>all executable code stored in mutable media</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span><textarea onchange='update(this);' class='assignment val' rows='1' placeholder='list of other executable code'></textarea></span>
</li>
</ul>
</span>, stored in mutable media prior to its execution through the use of <span class='selectables' data-rindex='1'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>a digital signature using an immutable hardware asymmetric key</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>an immutable hardware hash of an asymmetric key</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>an immutable hardware hash</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span>a digital signature using a hardware-protected asymmetric key</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='4' class='val selbox'></input><span>hardware-protected hash</span>
</li>
</ul>
</span>. 
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fpt__tst__ext.2.1_l2_r -->
<div class='aactivity'>

              The assurance activity shall be completed in conjunction with FPT_TST_EXT.2(1) for all executable code specified.
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fpt__tst__ext.2_l2_r -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fpt__tst__ext.3' class='component fpt__tst__ext.3 sel-based disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FPT_TST_EXT.3 &#8212; Extended: TSF Integrity Testing</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fpt__tst__ext.3.1' class='requirement fpt__tst__ext.3.1'><div class='f-el-title'>FPT_TST_EXT.3.1</div><div class='words'>The TSF shall not execute code if the code signing certificate is deemed invalid. 
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fpt__tst__ext.3.1 -->
<div class='aactivity'>
Testing for this element is performed in conjunction with the assurance activities for FPT_TST_EXT.2.1(1). 
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fpt__tst__ext.3 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fpt__tud__ext.1' class='component fpt__tud__ext.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FPT_TUD_EXT.1 &#8212; Extended: Trusted Update: TSF version query</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fpt__tud__ext.1.1' class='requirement fpt__tud__ext.1.1'><div class='f-el-title'>FPT_TUD_EXT.1.1</div><div class='words'>The TSF shall provide authorized users the ability to query the current version of the TOE firmware/software.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fpt__tud__ext.1.1 -->
<div id='Mobile_Device_Fundamentals:fpt__tud__ext.1.2' class='requirement fpt__tud__ext.1.2'><div class='f-el-title'>FPT_TUD_EXT.1.2</div><div class='words'>The TSF shall provide authorized users the ability to query the current version of the hardware model of the device. 
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fpt__tud__ext.1.2 -->
<div id='Mobile_Device_Fundamentals:fpt__tud__ext.1.3' class='requirement fpt__tud__ext.1.3'><div class='f-el-title'>FPT_TUD_EXT.1.3</div><div class='words'>The TSF shall provide authorized users the ability to query the current version of installed mobile applications. 
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fpt__tud__ext.1.3 -->
<div class='aactivity'>
The evaluator shall establish a test environment consisting of the Mobile Device and any supporting software that demonstrates usage of the management functions. This can be test software from the developer, a reference implementation of management software from the developer, or other commercially available software. The evaluator shall set up the Mobile Device and the other software to exercise the management functions according to the provided guidance documentation. 
              
                : Using the AGD guidance provided, the evaluator shall test that the administrator and user can query:
                  <ul>
                    <li>the current version of the TSF operating system and any firmware that can be updated separately</li>
                    <li>the hardware model of the TSF</li>
                    <li>the current version of all installed mobile applications</li>
                  </ul>
                
              
              The evaluator must review manufacturer documentation to ensure that the hardware model identifier is sufficient to identify the hardware which comprises the device. 
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fpt__tud__ext.1 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fpt__tud__ext.2' class='component fpt__tud__ext.2'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FPT_TUD_EXT.2 &#8212; Extended: TSF Update Verification</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fpt__tud__ext.2.1' class='requirement fpt__tud__ext.2.1'><div class='f-el-title'>FPT_TUD_EXT.2.1</div><div class='words'>The TSF shall verify software updates to the Application Processor system software and 
              <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>
                <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='other processor system software'></textarea></span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>no other processor system software</span>
</li>
</ul>
</span> using a digital signature verified by the manufacturer trusted key prior to installing those updates
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fpt__tud__ext.2.1 -->
<div id='Mobile_Device_Fundamentals:fpt__tud__ext.2.2' class='requirement fpt__tud__ext.2.2'><div class='f-el-title'>FPT_TUD_EXT.2.2</div><div class='words'>The TSF shall 
              <span class='selectables' data-rindex='0'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>never update</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>update only by verified software</span>
</span> the TSF boot integrity 
              <span class='selectables' data-rindex='1'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>key</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>hash</span>
</span>.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fpt__tud__ext.2.2 -->
<div id='Mobile_Device_Fundamentals:fpt__tud__ext.2.3' class='requirement fpt__tud__ext.2.3'><div class='f-el-title'>FPT_TUD_EXT.2.3</div><div class='words'>The TSF shall verify that the digital signature verification key used for TSF updates 
              <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>is validated to a public key in the Trust Anchor Database</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>matches an immutable hardware public key</span>
</li>
</ul>
</span>. 
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fpt__tud__ext.2.3 -->
<div class='aactivity'>
The evaluator shall verify that the  TSS section of the ST describes all TSF software update mechanisms for updating the system software. The evaluator shall verify that the description includes a digital signature verification of the software before installation and that installation fails if the verification fails. The evaluator shall verify that all software and firmware involved in updating the TSF is described and, if multiple stages and software are indicated, that the software/firmware responsible for each stage is indicated and that the stage(s) which perform signature verification of the update are identified. 
              <br/><br/>
              The evaluator shall verify that the  TSS describes the method by which the digital signature is verified and that the public key used to verify the signature is either hardware-protected or is validated to chain to a public key in the Trust Anchor Database. If hardware-protection is selected, the evaluator shall verify that the method of hardware-protection is described and that the ST author has justified why the public key may not be modified by unauthorized parties.
              <br/><br/>
              [conditional] If the ST author indicates that software updates to system software running on other processors is verified, the evaluator shall verify that these other processors are listed in the  TSS and that the description includes the software update mechanism for these processors, if different than the update mechanism for the software executing on the Application Processor.
              <br/><br/>
              [conditional] If the ST author indicates that the public key is used for software update digital signature verification, the evaluator shall verify that the update mechanism includes a certificate validation according to FIA_X509_EXT.1 and a check for the Code Signing purpose in the extendedKeyUsage. 
              <br/><br/>
              The evaluator shall verify that the developer has provided evidence that the following tests were performed for each available update mechanism:
              
                The tester shall try to install an update without the digital signature and shall verify that installation fails. The tester shall attempt to install an update with digital signature, and verify that installation succeeds. <br/>
                The tester shall digitally sign the update with a key disallowed by the device and verify that installation fails. The tester shall digitally sign the update with the allowed key and verify that installation succeeds.<br/>
                [conditional] The tester shall digitally sign the update with an invalid certificate and verify that update installation fails. The tester shall repeat the test using a valid certificate and a certificate that contains the purpose and verify that the update installation succeeds.<br/>
                [conditional] The tester shall digitally sign the application with a certificate that does not have the Code Signing purpose and verify that application installation fails. The tester shall repeat the test using a valid certificate and a certificate that contains the Code Signing purpose and verify that the application installation succeeds.<br/>
                [conditional] The tester shall repeat this test for the software executing on each processor listed in the first selection. The tester shall attempt to install an update without the digital signature and shall verify that installation fails. The tester shall attempt to install an update with digital signature, and verify that installation succeeds.
              
            </div><div id='Mobile_Device_Fundamentals:fpt__tud__ext.2.4' class='requirement fpt__tud__ext.2.4'><div class='f-el-title'>FPT_TUD_EXT.2.4</div><div class='words'>The TSF shall verify mobile application software using a digital signature mechanism prior to installation.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fpt__tud__ext.2.4 -->
<div class='aactivity'>
Assurance Activity Note: The following test does not have to be tested using the commercial application store.
              <br/><br/>
              The evaluator shall verify that the  TSS describes how mobile application software is verified at installation. The evaluator shall ensure that this method uses a digital signature. <br/>
              
                The evaluator shall write, or the developer shall provide access to, an application. The evaluator shall try to install this application without a digitally signature and shall verify that installation fails. The evaluator shall attempt to install a digitally signed application, and verify that installation succeeds. 
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fpt__tud__ext.2 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fpt__tud__ext.3' class='component fpt__tud__ext.3 sel-based disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FPT_TUD_EXT.3 &#8212; Extended: Trusted Update Verification</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fpt__tud__ext.3.1' class='requirement fpt__tud__ext.3.1'><div class='f-el-title'>FPT_TUD_EXT.3.1</div><div class='words'>The TSF shall not install code if the code signing certificate is deemed invalid. 
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fpt__tud__ext.3.1 -->
<div class='aactivity'>
Testing for this element is performed in conjunction with the assurance activities for FPT_TUD_EXT.2.3 and FPT_TUD_EXT.4.1. 
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fpt__tud__ext.3 -->
<span class='comp-notes'></span><br/><span class='tooltipped'><input type='checkbox' onchange='handleOCheck(this); return false;'></input></span>
<span id='Mobile_Device_Fundamentals:fpt__tud__ext.4' class='component fpt__tud__ext.4 disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FPT_TUD_EXT.4 &#8212; Extended: Trusted Update Verification</a><span class='tooltiptext'>objective</span>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fpt__tud__ext.4.1' class='requirement fpt__tud__ext.4.1'><div class='f-el-title'>FPT_TUD_EXT.4.1</div><div class='words'>The TSF shall by default only install mobile applications cryptographically verified by 
              <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>a built-in X.509v3 certificate</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>a configured X.509v3 certificate</span>
</li>
</ul>
</span>. </div>
</div><!-- End: Mobile_Device_Fundamentals:fpt__tud__ext.4.1 -->
<div class='aactivity'>
The evaluator shall verify that the  TSS describes how mobile application software is verified at installation. The evaluator shall ensure that this method uses a digital signature by a code signing certificate. 
              
                The evaluator shall write, or the developer shall provide access to, an application. The evaluator shall try to install this application without a digitally signature and shall verify that installation fails. The evaluator shall attempt to install an application digitally signed with an appropriate certificate, and verify that installation succeeds. <br/>
                The evaluator shall digitally sign the application with an invalid certificate and verify that application installation fails. The evaluator shall digitally sign the application with a certificate that does not have the Code Signing purpose and verify that application installation fails. This test may be performed in conjunction with the assurance activities for FIA_X509_EXT.1. <br/>
                If necessary, the evaluator shall configure the device to limit the public keys that can sign application software according to the AGD guidance. The evaluator shall digitally sign the application with a certificate disallowed by the device or configuration and verify that application installation fails. The evaluator shall attempt to install an application digitally signed with an authorized certificate and verify that application installation succeeds.
              
            </div><div id='Mobile_Device_Fundamentals:fpt__tud__ext.4.2' class='requirement fpt__tud__ext.4.2'><div class='f-el-title'>FPT_TUD_EXT.4.2</div><div class='words'>The TSF shall verify that software updates to the TSF are a current or later version than the current version of the TSF. </div>
</div><!-- End: Mobile_Device_Fundamentals:fpt__tud__ext.4.2 -->
<div class='aactivity'>

              The evaluator shall verify that the  TSS describes the mechanism that prevents the TSF from installing software updates that are an older version that the currently installed version. 
              <br/><br/>
              The evaluator shall repeat the following tests to cover all allowed software update mechanisms as described in the  TSS. For example, if the update mechanism replaces an entire partition containing many separate code files, the evaluator does not need to repeat the test for each individual file.
              
                The evaluator shall attempt to install an earlier version of software (as determined by the manufacturer). The evaluator shall verify that this attempt fails by checking the version identifiers or cryptographic hashes of the privileged software against those previously recorded and checking that the values have not changed.<br/>
                The evaluator shall attempt to install a current or later version and shall verify that the update succeeds.
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fpt__tud__ext.4 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:fta__ssl__ext.1' class='component fta__ssl__ext.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FTA_SSL_EXT.1 &#8212; Extended: TSF- and User-initiated Locked State </a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fta__ssl__ext.1.1' class='requirement fta__ssl__ext.1.1'><div class='f-el-title'>FTA_SSL_EXT.1.1</div><div class='words'>The TSF shall transition to a locked state after a time interval of inactivity. 
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fta__ssl__ext.1.1 -->
<div id='Mobile_Device_Fundamentals:fta__ssl__ext.1.2' class='requirement fta__ssl__ext.1.2'><div class='f-el-title'>FTA_SSL_EXT.1.2</div><div class='words'>The TSF shall transition to a locked state after initiation by either the user or the administrator. 
            </div>
</div><!-- End: Mobile_Device_Fundamentals:fta__ssl__ext.1.2 -->
<div id='Mobile_Device_Fundamentals:fta__ssl__ext.1.3' class='requirement fta__ssl__ext.1.3'><div class='f-el-title'>FTA_SSL_EXT.1.3</div><div class='words'>The TSF shall, upon transitioning to the locked state, perform the following operations:
              <ol type='a'>
              <li>clearing or overwriting display devices, obscuring the previous contents; </li>
              <li><textarea onchange='update(this);' class='assignment val' rows='1' placeholder='other actions performed upon transitioning to the locked state'></textarea>.</li>
              </ol>
             </div>
</div><!-- End: Mobile_Device_Fundamentals:fta__ssl__ext.1.3 -->
<div class='aactivity'>
The evaluator shall verify the  TSS describes the actions performed upon transitioning to the locked state. The evaluation shall verify that the AGD guidance describes the method of setting the inactivity interval and of commanding a lock. The evaluator shall verify that the  TSS describes the information allowed to be displayed to unauthorized users.<br/>
              
                The evaluator shall configure the TSF to transition to the locked state after a time of inactivity (FMT_SMF_EXT.1) according to the AGD guidance. The evaluator shall wait until the TSF locks and verify that the display is cleared or overwritten and that the only actions allowed in the locked state are unlocking the session and those actions specified in FIA_UAU_EXT.2.<br/>
                The evaluator shall command the TSF to transition to the locked state according to the AGD guidance as both the user and the administrator. The evaluator shall wait until the TSF locks and verify that the display is cleared or overwritten and that the only actions allowed in the locked state are unlocking the session and those actions specified in FIA_UAU_EXT.2.
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fta__ssl__ext.1 -->
<span class='comp-notes'></span><br/><span class='tooltipped'><input type='checkbox' onchange='handleOCheck(this); return false;'></input></span>
<span id='Mobile_Device_Fundamentals:fta__tab.1' class='component fta__tab.1 disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FTA_TAB.1 &#8212; Default TOE Access Banners</a><span class='tooltiptext'>objective</span>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:fta__tab.1.1' class='requirement fta__tab.1.1'><div class='f-el-title'>FTA_TAB.1.1</div><div class='words'>Before establishing a user session, the TSF shall display an advisory warning message regarding unauthorized use of the TOE.</div>
</div><!-- End: Mobile_Device_Fundamentals:fta__tab.1.1 -->
<div class='aactivity'>
The  TSS shall describe when the banner is displayed. The evaluator shall also perform the following test:
              
                The evaluator follows the operational guidance to configure a notice and consent warning message. The evaluator shall then start up or unlock the TSF. The evaluator shall verify that the notice and consent warning message is displayed in each instance described in the  TSS.
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:fta__tab.1 -->
<span class='comp-notes'></span><br/><span class='tooltipped'><input type='checkbox' onchange='handleOCheck(this); return false;'></input></span>
<span id='Mobile_Device_Fundamentals:ftp__blt__ext.1' class='component ftp__blt__ext.1 disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FTP_BLT_EXT.1 &#8212; Extended: Bluetooth Encryption</a><span class='tooltiptext'>objective</span>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:ftp__blt__ext.1.1' class='requirement ftp__blt__ext.1.1'><div class='f-el-title'>FTP_BLT_EXT.1.1</div><div class='words'>The TSF shall enforce the use of encryption when transmitting data over the Bluetooth trusted channel. The TSF shall set the minimum encryption key size to 
              <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='key size larger than or equal to 128 bits'></textarea> for BR/EDR and 
              <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='key size larger than or equal to 128 bits'></textarea> for LE and shall not negotiate smaller encryption key sizes.</div>
</div><!-- End: Mobile_Device_Fundamentals:ftp__blt__ext.1.1 -->
<div class='aactivity'>
The evaluator shall examine the  TSS to ensure that it specifies the minimum encryption key sizes for both BR/EDR and LE. 
              <br/><br/>
              The evaluator shall perform the following tests: 
              
                The evaluator shall perform the following steps using a Bluetooth protocol analyzer to observe packets pertaining to the encryption key size:
                  <br/><br/>
                  Step 1: Initiate pairing with the TOE from a remote Bluetooth device that has been configured to have a maximum encryption key size of 1 byte. (This can be done using certain commercially-available tools that can send the appropriate command to certain commercially-available Bluetooth controllers.) 
                  <br/><br/>
                  Step 2: Verify that the encryption key size suggested by the remote device is not accepted by the TOE and that the connection is not completed. 
                <br/>
                The evaluator shall perform the following steps using a Bluetooth protocol analyzer to observe packets pertaining to the encryption key size:
                  <br/><br/>
                  Step 1: Initiate pairing with the TOE from a remote Bluetooth device that has been configured to have a minimum encryption key size that is equal to or greater than that of the TOE. (This can be done using certain commercially-available tools that can send the appropriate command to certain commercially-available Bluetooth controllers.) 
                  <br/><br/>
                  Step 2: Use a Bluetooth packet sniffer to verify that the encryption key size negotiated for the connection is at least as large as the minimum encryption key size defined for the TOE.
                
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:ftp__blt__ext.1 -->
<span class='comp-notes'></span><br/><span class='tooltipped'><input type='checkbox' onchange='handleOCheck(this); return false;'></input></span>
<span id='Mobile_Device_Fundamentals:ftp__blt__ext.2' class='component ftp__blt__ext.2 disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FTP_BLT_EXT.2 &#8212; Extended: Bluetooth Encryption</a><span class='tooltiptext'>objective</span>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:ftp__blt__ext.2.1' class='requirement ftp__blt__ext.2.1'><div class='f-el-title'>FTP_BLT_EXT.2.1</div><div class='words'>The TSF shall always require the use of encryption during data transmission and shall either restart encryption or terminate the connection if the remote device stops encryption while connected.</div>
</div><!-- End: Mobile_Device_Fundamentals:ftp__blt__ext.2.1 -->
<div class='aactivity'>

              
                The evaluator shall perform the following steps using a Bluetooth protocol analyzer to observe packets pertaining to the encryption key size:
                  <br/><br/>
                  Step 1: Initiate pairing with the TOE from a remote Bluetooth device that has been configured to have a minimum encryption key size that is equal to or greater than that of the TOE. 
                  <br/><br/>
                  Step 2: After pairing has successfully finished and while a connection exists between the TOE and the remote device, turn off encryption on the remote device. This can be done using commercially-available tools.
                  <br/><br/>
                  Step 3: Verify that the TOE either restarts encryption with the remote device or terminates the connection with the remote device.
                
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:ftp__blt__ext.2 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:ftp__itc__ext.1' class='component ftp__itc__ext.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FTP_ITC_EXT.1 &#8212; Extended: Trusted channel Communication</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:ftp__itc__ext.1.1' class='requirement ftp__itc__ext.1.1'><div class='f-el-title'>FTP_ITC_EXT.1.1</div><div class='words'>The TSF shall use 802.11-2012, 802.1X, and EAP-TLS and 
              <span class='selectables' data-rindex='0'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>IPsec</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>TLS</span>
<input type='checkbox' id='Mobile_Device_Fundamentals:itc_dtls' onchange='update(this); ' data-rindex='2' class='val selbox itc_dtls'></input><span>DTLS</span>
<input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span>HTTPS</span>
</span> protocol to provide a communication channel between itself and another trusted IT product that is logically distinct from other communication channels, provides assured identification of its end points, protects channel data from disclosure, and detects modification of the channel data.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:ftp__itc__ext.1.1 -->
<div id='Mobile_Device_Fundamentals:ftp__itc__ext.1.2' class='requirement ftp__itc__ext.1.2'><div class='f-el-title'>FTP_ITC_EXT.1.2</div><div class='words'>The TSF shall permit the TSF to initiate communication via the trusted channel.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:ftp__itc__ext.1.2 -->
<div id='Mobile_Device_Fundamentals:ftp__itc__ext.1.3' class='requirement ftp__itc__ext.1.3'><div class='f-el-title'>FTP_ITC_EXT.1.3</div><div class='words'>The TSF shall initiate communication via the trusted channel for wireless access point connections, administrative communication, configured enterprise connections, and 
              <span class='selectables' data-rindex='0'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>OTA updates</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>no other connections</span>
</span>.
            </div>
</div><!-- End: Mobile_Device_Fundamentals:ftp__itc__ext.1.3 -->
<div class='aactivity'>
The evaluator shall examine the  TSS to determine that it describes the details of the TOE connecting to access points, VPN Gateways, and other trusted IT products in terms of the cryptographic protocols specified in the requirement, along with TOE-specific options or procedures that might not be reflected in the specifications. The evaluator shall also confirm that all protocols listed in the  TSS are specified and included in the requirements in the ST. The evaluator shall confirm that the operational guidance contains instructions for establishing the connection to access points, VPN Gateways, and other trusted IT products. 
              <br/><br/>
              If OTA updates are selected, the  TSS shall describe which trusted channel protocol is initiated by the TOE and is used for updates.
              <br/><br/>
              The evaluator shall also perform the following tests for each protocol listed:
              
                The evaluator shall ensure, for each communication channel with an authorized IT entity, the channel data are not sent in plaintext and that a protocol analyzer identifies the traffic as the protocol under testing.<br/>
                [conditional] If IPsec is selected (and the TSF includes a native VPN client), the evaluator shall ensure that the TOE is able to initiate communications with a VPN Gateway, setting up the connections as described in the operational guidance and ensuring that communication is successful.<br/>
                [conditional]If OTA updates are selected, the evaluator shall trigger an update request according to the operational guidance and shall ensure that the communication is successful.<br/>
                For any other selected protocol (not tested in Test 1, 2, or 3), the evaluator shall ensure that the TOE is able to initiate communications with a trusted IT product using the protocol, setting up the connection as described in the operational guidance and ensuring that the communication is successful. 
              
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:ftp__itc__ext.1 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:adv__fsp.1' class='component adv__fsp.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>ADV_FSP.1 &#8212; Basic Functional Specification</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:adv__fsp.1.1d' class='requirement adv__fsp.1.1d'><div class='f-el-title'>ADV_FSP.1.1D</div><div class='words'>The developer shall provide a functional specification.</div>
</div><!-- End: Mobile_Device_Fundamentals:adv__fsp.1.1d -->
<div id='Mobile_Device_Fundamentals:adv__fsp.1.2d' class='requirement adv__fsp.1.2d'><div class='f-el-title'>ADV_FSP.1.2D</div><div class='words'>The developer shall provide a tracing from the functional specification to the SFRs.</div>
</div><!-- End: Mobile_Device_Fundamentals:adv__fsp.1.2d -->
<div id='Mobile_Device_Fundamentals:adv__fsp.1.1c' class='requirement adv__fsp.1.1c'><div class='f-el-title'>ADV_FSP.1.1C</div><div class='words'>The functional specification shall describe the purpose and method of use for each SFR-enforcing and SFR-supporting .</div>
</div><!-- End: Mobile_Device_Fundamentals:adv__fsp.1.1c -->
<div id='Mobile_Device_Fundamentals:adv__fsp.1.2c' class='requirement adv__fsp.1.2c'><div class='f-el-title'>ADV_FSP.1.2C</div><div class='words'>The functional specification shall identify all parameters associated with each SFR-enforcing and SFR-supporting .</div>
</div><!-- End: Mobile_Device_Fundamentals:adv__fsp.1.2c -->
<div id='Mobile_Device_Fundamentals:adv__fsp.1.3c' class='requirement adv__fsp.1.3c'><div class='f-el-title'>ADV_FSP.1.3C</div><div class='words'>The functional specification shall provide rationale for the implicit categorization of interfaces as SFR-non-interfering.</div>
</div><!-- End: Mobile_Device_Fundamentals:adv__fsp.1.3c -->
<div id='Mobile_Device_Fundamentals:adv__fsp.1.4c' class='requirement adv__fsp.1.4c'><div class='f-el-title'>ADV_FSP.1.4C</div><div class='words'>The tracing shall demonstrate that the SFRs trace to s in the functional specification.</div>
</div><!-- End: Mobile_Device_Fundamentals:adv__fsp.1.4c -->
<div id='Mobile_Device_Fundamentals:adv__fsp.1.1e' class='requirement adv__fsp.1.1e'><div class='f-el-title'>ADV_FSP.1.1E</div><div class='words'>The evaluator shall confirm that the information provided meets all requirements for content and presentation of evidence.</div>
</div><!-- End: Mobile_Device_Fundamentals:adv__fsp.1.1e -->
<div id='Mobile_Device_Fundamentals:adv__fsp.1.2e' class='requirement adv__fsp.1.2e'><div class='f-el-title'>ADV_FSP.1.2E</div><div class='words'>The evaluator shall determine that the functional specification is an accurate and complete instantiation of the SFRs.</div>
</div><!-- End: Mobile_Device_Fundamentals:adv__fsp.1.2e -->
<div class='aactivity'>
There are no specific assurance activities associated with these SARs, except ensuring the information is provided. The functional specification documentation is provided to support the evaluation activities described in , and other activities described for AGD, ATE, and AVA SARs. The requirements on the content of the functional specification information is implicitly assessed by virtue of the other assurance activities being performed; if the evaluator is unable to perform an activity because there is insufficient interface information, then an adequate functional specification has not been provided.
	      </div>
</div></span><!-- End: Mobile_Device_Fundamentals:adv__fsp.1 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:agd__ope.1' class='component agd__ope.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>AGD_OPE.1 &#8212; Operational User Guidance</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:agd__ope.1.1d' class='requirement agd__ope.1.1d'><div class='f-el-title'>AGD_OPE.1.1D</div><div class='words'>The developer shall provide operational user guidance.</div>
</div><!-- End: Mobile_Device_Fundamentals:agd__ope.1.1d -->
<div id='Mobile_Device_Fundamentals:agd__ope.1.1c' class='requirement agd__ope.1.1c'><div class='f-el-title'>AGD_OPE.1.1C</div><div class='words'>The operational user guidance shall describe, for each user role, the user-accessible functions and privileges that should be controlled in a secure processing environment, including appropriate warnings.</div>
</div><!-- End: Mobile_Device_Fundamentals:agd__ope.1.1c -->
<div id='Mobile_Device_Fundamentals:agd__ope.1.2c' class='requirement agd__ope.1.2c'><div class='f-el-title'>AGD_OPE.1.2C</div><div class='words'>The operational user guidance shall describe, for each user role, how to use the available interfaces provided by the TOE in a secure manner.</div>
</div><!-- End: Mobile_Device_Fundamentals:agd__ope.1.2c -->
<div id='Mobile_Device_Fundamentals:agd__ope.1.3c' class='requirement agd__ope.1.3c'><div class='f-el-title'>AGD_OPE.1.3C</div><div class='words'>The operational user guidance shall describe, for each user role, the available functions and interfaces, in particular all security parameters under the control of the user, indicating secure values as appropriate.</div>
</div><!-- End: Mobile_Device_Fundamentals:agd__ope.1.3c -->
<div id='Mobile_Device_Fundamentals:agd__ope.1.4c' class='requirement agd__ope.1.4c'><div class='f-el-title'>AGD_OPE.1.4C</div><div class='words'>The operational user guidance shall, for each user role, clearly present each type of security-relevant event relative to the user-accessible functions that need to be performed, including changing the security characteristics of entities under the control of the TSF.</div>
</div><!-- End: Mobile_Device_Fundamentals:agd__ope.1.4c -->
<div id='Mobile_Device_Fundamentals:agd__ope.1.5c' class='requirement agd__ope.1.5c'><div class='f-el-title'>AGD_OPE.1.5C</div><div class='words'>The operational user guidance shall identify all possible modes of operation of the OS (including operation following failure or operational error), their consequences, and implications for maintaining secure operation.</div>
</div><!-- End: Mobile_Device_Fundamentals:agd__ope.1.5c -->
<div id='Mobile_Device_Fundamentals:agd__ope.1.6c' class='requirement agd__ope.1.6c'><div class='f-el-title'>AGD_OPE.1.6C</div><div class='words'>The operational user guidance shall, for each user role, describe the security measures to be followed in order to fulfill the security objectives for the operational environment as described in the ST.</div>
</div><!-- End: Mobile_Device_Fundamentals:agd__ope.1.6c -->
<div id='Mobile_Device_Fundamentals:agd__ope.1.7c' class='requirement agd__ope.1.7c'><div class='f-el-title'>AGD_OPE.1.7C</div><div class='words'>The operational user guidance shall be clear and reasonable.</div>
</div><!-- End: Mobile_Device_Fundamentals:agd__ope.1.7c -->
<div id='Mobile_Device_Fundamentals:agd__ope.1.1e' class='requirement agd__ope.1.1e'><div class='f-el-title'>AGD_OPE.1.1E</div><div class='words'>The evaluator shall confirm that the information provided meets all requirements for content and presentation of evidence. </div>
</div><!-- End: Mobile_Device_Fundamentals:agd__ope.1.1e -->
<div class='aactivity'>
Some of the contents of the operational guidance are verified by the assurance activities in  and evaluation of the TOE according to the . The following additional information is also required. <br/><br/>                The operational guidance shall contain a list of natively installed applications and any relevant version numbers. If any third party vendors are permitted to install applications before purchase by the end user or enterprise, these applications shall also be listed.<br/><br/>
                 The operational guidance shall contain instructions for configuring the cryptographic engine associated with the evaluated configuration of the TOE. It shall provide a warning to the administrator that use of other cryptographic engines was not evaluated nor tested during the CC evaluation of the TOE. <br/><br/>
                The documentation must describe the process for verifying updates to the TOE by verifying a digital signature. The evaluator shall verify that this process includes the following steps: 
                <ul>
                  <li>Instructions for obtaining the update itself. This should include instructions for making the update accessible to the TOE (e.g., placement in a specific directory).</li>
                  <li>Instructions for initiating the update process, as well as discerning whether the process was successful or unsuccessful. This includes generation of the hash/digital signature.</li>
                </ul>  
                The TOE will likely contain security functionality that does not fall in the scope of evaluation under this PP. The operational guidance shall make it clear to an administrator which security functionality is covered by the evaluation activities. </div>
</div></span><!-- End: Mobile_Device_Fundamentals:agd__ope.1 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:agd__pre.1' class='component agd__pre.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>AGD_PRE.1 &#8212; Preparative Procedures</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:agd__pre.1.1d' class='requirement agd__pre.1.1d'><div class='f-el-title'>AGD_PRE.1.1D</div><div class='words'>The developer shall provide the TOE, including its preparative procedures.</div>
</div><!-- End: Mobile_Device_Fundamentals:agd__pre.1.1d -->
<div id='Mobile_Device_Fundamentals:agd__pre.1.1c' class='requirement agd__pre.1.1c'><div class='f-el-title'>AGD_PRE.1.1C</div><div class='words'>The preparative procedures shall describe all the steps necessary for secure acceptance of the delivered TOE in accordance with the developer's delivery procedures.</div>
</div><!-- End: Mobile_Device_Fundamentals:agd__pre.1.1c -->
<div id='Mobile_Device_Fundamentals:agd__pre.1.2c' class='requirement agd__pre.1.2c'><div class='f-el-title'>AGD_PRE.1.2C</div><div class='words'>The preparative procedures shall describe all the steps necessary for secure installation of the TOE and for the secure preparation of the operational environment in accordance with the security objectives for the operational environment as described in the ST.</div>
</div><!-- End: Mobile_Device_Fundamentals:agd__pre.1.2c -->
<div id='Mobile_Device_Fundamentals:agd__pre.1.1e' class='requirement agd__pre.1.1e'><div class='f-el-title'>AGD_PRE.1.1E</div><div class='words'>The evaluator shall confirm that the information provided meets all requirements for content and presentation of evidence.</div>
</div><!-- End: Mobile_Device_Fundamentals:agd__pre.1.1e -->
<div id='Mobile_Device_Fundamentals:agd__pre.1.2e' class='requirement agd__pre.1.2e'><div class='f-el-title'>AGD_PRE.1.2E</div><div class='words'>The evaluator shall apply the preparative procedures to confirm that the OS can be prepared securely for operation.</div>
</div><!-- End: Mobile_Device_Fundamentals:agd__pre.1.2e -->
<div class='aactivity'>
As indicated in the introduction above, there are significant expectations with respect to the documentation—especially when configuring the operational environment to support TOE functional requirements. The evaluator shall check to ensure that the guidance provided for the TOE adequately addresses all platforms claimed for the TOE in the ST. </div>
</div></span><!-- End: Mobile_Device_Fundamentals:agd__pre.1 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:alc__cmc.1' class='component alc__cmc.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>ALC_CMC.1 &#8212; Labeling of the TOE</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:alc__cmc.1.1d' class='requirement alc__cmc.1.1d'><div class='f-el-title'>ALC_CMC.1.1D</div><div class='words'>The developer shall provide the TOE and a reference for the TOE.</div>
</div><!-- End: Mobile_Device_Fundamentals:alc__cmc.1.1d -->
<div id='Mobile_Device_Fundamentals:alc__cmc.1.1c' class='requirement alc__cmc.1.1c'><div class='f-el-title'>ALC_CMC.1.1C</div><div class='words'>The TOE shall be labeled with a unique reference.</div>
</div><!-- End: Mobile_Device_Fundamentals:alc__cmc.1.1c -->
<div id='Mobile_Device_Fundamentals:alc__cmc.1.1e' class='requirement alc__cmc.1.1e'><div class='f-el-title'>ALC_CMC.1.1E</div><div class='words'>The evaluator shall confirm that the information provided meets all requirements for content and presentation of evidence.</div>
</div><!-- End: Mobile_Device_Fundamentals:alc__cmc.1.1e -->
<div class='aactivity'>
The evaluator shall check the ST to ensure that it contains an identifier (such as a product name/version number) that specifically identifies the version that meets the requirements of the ST. Further, the evaluator shall check the AGD guidance and TOE samples received for testing to ensure that the version number is consistent with that in the ST. If the vendor maintains a web site advertising the TOE, the evaluator shall examine the information on the web site to ensure that the information in the ST is sufficient to distinguish the product.</div>
</div></span><!-- End: Mobile_Device_Fundamentals:alc__cmc.1 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:alc__cms.1' class='component alc__cms.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>ALC_CMS.1 &#8212; TOE CM Coverage</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:alc__cms.1.1d' class='requirement alc__cms.1.1d'><div class='f-el-title'>ALC_CMS.1.1D</div><div class='words'>
                The developer shall provide a configuration list for the TOE.
	      </div>
</div><!-- End: Mobile_Device_Fundamentals:alc__cms.1.1d -->
<div id='Mobile_Device_Fundamentals:alc__cms.1.1c' class='requirement alc__cms.1.1c'><div class='f-el-title'>ALC_CMS.1.1C</div><div class='words'>The configuration list shall include the following: the TOE itself; and the evaluation evidence required by the SARs.</div>
</div><!-- End: Mobile_Device_Fundamentals:alc__cms.1.1c -->
<div id='Mobile_Device_Fundamentals:alc__cms.1.2c' class='requirement alc__cms.1.2c'><div class='f-el-title'>ALC_CMS.1.2C</div><div class='words'>The configuration list shall uniquely identify the configuration items.</div>
</div><!-- End: Mobile_Device_Fundamentals:alc__cms.1.2c -->
<div id='Mobile_Device_Fundamentals:alc__cms.1.1e' class='requirement alc__cms.1.1e'><div class='f-el-title'>ALC_CMS.1.1E</div><div class='words'>The evaluator shall confirm that the information provided meets all requirements for content and presentation of evidence.</div>
</div><!-- End: Mobile_Device_Fundamentals:alc__cms.1.1e -->
<div class='aactivity'>

                The evaluator shall ensure that the developer has identified (in public-facing development guidance for their platform) one or more development environments appropriate for use in developing applications for the developer’s platform. For each of these development environments, the developer shall provide information on how to configure the environment to ensure that buffer overflow protection mechanisms in the environment(s) are invoked (e.g., compiler and linker flags). The evaluator shall ensure that this documentation also includes an indication of whether such protections are on by default, or have to be specifically enabled. <br/><br/>
              The evaluator shall ensure that the TSF is uniquely identified (with respect to other products from the TSF vendor), and that documentation provided by the developer in association with the requirements in the ST is associated with the TSF using this unique identification.</div>
</div></span><!-- End: Mobile_Device_Fundamentals:alc__cms.1 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:alc__tsu__ext' class='component alc__tsu__ext'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>ALC_TSU_EXT &#8212; Timely Security Updates</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:alc__tsu__ext.1.1d' class='requirement alc__tsu__ext.1.1d'><div class='f-el-title'>ALC_TSU_EXT.1.1D</div><div class='words'>The developer shall provide a description in the TSS of how timely security updates are made to the TOE.</div>
</div><!-- End: Mobile_Device_Fundamentals:alc__tsu__ext.1.1d -->
<div id='Mobile_Device_Fundamentals:alc__tsu__ext.1.1c' class='requirement alc__tsu__ext.1.1c'><div class='f-el-title'>ALC_TSU_EXT.1.1C</div><div class='words'>The description shall include the process for creating and deploying security updates for the TOE software.</div>
</div><!-- End: Mobile_Device_Fundamentals:alc__tsu__ext.1.1c -->
<div id='Mobile_Device_Fundamentals:alc__tsu__ext.1.2c' class='requirement alc__tsu__ext.1.2c'><div class='f-el-title'>ALC_TSU_EXT.1.2C</div><div class='words'>The description shall express the time window as the length of time, in days, between public disclosure of a vulnerability and the public availability of security updates to the TOE.</div>
</div><!-- End: Mobile_Device_Fundamentals:alc__tsu__ext.1.2c -->
<div id='Mobile_Device_Fundamentals:alc__tsu__ext.1.3c' class='requirement alc__tsu__ext.1.3c'><div class='f-el-title'>ALC_TSU_EXT.1.3C</div><div class='words'>The description shall include the mechanisms publicly available for reporting security issues pertaining to the TOE.
	      </div>
</div><!-- End: Mobile_Device_Fundamentals:alc__tsu__ext.1.3c -->
<div id='Mobile_Device_Fundamentals:alc__tsu__ext.1.4c' class='requirement alc__tsu__ext.1.4c'><div class='f-el-title'>ALC_TSU_EXT.1.4C</div><div class='words'>The description shall include where users can seek information about the availability of new updates including details (e.g. CVE identifiers) of the specific public vulnerabilities corrected by each update.
	      </div>
</div><!-- End: Mobile_Device_Fundamentals:alc__tsu__ext.1.4c -->
<div id='Mobile_Device_Fundamentals:alc__tsu__ext.2.1e' class='requirement alc__tsu__ext.2.1e'><div class='f-el-title'>ALC_TSU_EXT.2.1E</div><div class='words'>The evaluator shall confirm that the information provided meets all requirements for content and presentation of evidence.
              </div>
</div><!-- End: Mobile_Device_Fundamentals:alc__tsu__ext.2.1e -->
<div class='aactivity'>

            The evaluator shall verify that the TSS contains a description of the timely security update process used by the developer to create and deploy security updates. The evaluator shall verify that this description addresses the TOE OS, the firmware, and bundled applications, each. The evaluator shall also verify that, in addition to the TOE developer’s process, any carrier or other third-party processes are also addressed in the description. The evaluator shall also verify that each mechanism for deployment of security updates is described.
            <br/><br/>
            The evaluator shall verify that, for each deployment mechanism described for the update process, the TSS lists a time between public disclosure of a vulnerability and public availability of the security update to the TOE patching this vulnerability, to include any third-party or carrier delays in deployment. The evaluator shall verify that this time is expressed in a number or range of days.
              <br/><br/>
              The evaluator shall verify that this description includes the publicly available mechanisms (including either an email address or website) for reporting security issues related to the TOE. The evaluator shall verify that the description of this mechanism includes a method for protecting the report either using a public key for encrypting email or a trusted channel for a website. 
              <br/><br/>
            The evaluator shall verify that the description includes where users can seek information about the availability of new security updates including details of the specific public vulnerabilities corrected by each update. The evaluator shall verify that the description includes the minimum amount of time that the TOE is expected to be supported with security updates, and the process by which users can seek information about when the TOE is no longer expected to receive security updates.
            </div>
</div></span><!-- End: Mobile_Device_Fundamentals:alc__tsu__ext -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:ate__ind.1' class='component ate__ind.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>ATE_IND.1 &#8212; Independent Testing – Conformance</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:ate__ind.1.1d' class='requirement ate__ind.1.1d'><div class='f-el-title'>ATE_IND.1.1D</div><div class='words'>The developer shall provide the TOE for testing.</div>
</div><!-- End: Mobile_Device_Fundamentals:ate__ind.1.1d -->
<div id='Mobile_Device_Fundamentals:ate__ind.1.1c' class='requirement ate__ind.1.1c'><div class='f-el-title'>ATE_IND.1.1C</div><div class='words'>The TOE shall be suitable for testing.</div>
</div><!-- End: Mobile_Device_Fundamentals:ate__ind.1.1c -->
<div id='Mobile_Device_Fundamentals:ate__ind.1.1e' class='requirement ate__ind.1.1e'><div class='f-el-title'>ATE_IND.1.1E</div><div class='words'>The evaluator <i>shall confirm</i> that the information provided meets all requirements for content and presentation of evidence.</div>
</div><!-- End: Mobile_Device_Fundamentals:ate__ind.1.1e -->
<div id='Mobile_Device_Fundamentals:ate__ind.1.2e' class='requirement ate__ind.1.2e'><div class='f-el-title'>ATE_IND.1.2E</div><div class='words'>The evaluator shall test a subset of the TSF to confirm that the TSF operates as specified.</div>
</div><!-- End: Mobile_Device_Fundamentals:ate__ind.1.2e -->
<div class='aactivity'>
The evaluator shall prepare a test plan and report documenting the testing aspects of the system. The test plan covers all of the testing actions contained in the  and the body of this PP’s Assurance Activities. While it is not necessary to have one test case per test listed in an Assurance Activity, the evaluator must document in the test plan that each applicable testing requirement in the ST is covered. <br/><br/>
                The test plan identifies the platforms to be tested, and for those platforms not included in the test plan but included in the ST, the test plan provides a justification for not testing the platforms. This justification must address the differences between the tested platforms and the untested platforms, and make an argument that the differences do not affect the testing to be performed. It is not sufficient to merely assert that the differences have no affect; rationale must be provided. If all platforms claimed in the ST are tested, then no rationale is necessary. <br/><br/>
                The test plan describes the composition of each platform to be tested, and any setup that is necessary beyond what is contained in the AGD documentation. It should be noted that the evaluator is expected to follow the AGD documentation for installation and setup of each platform either as part of a test or as a standard pre-test condition. This may include special test drivers or tools. For each driver or tool, an argument (not just an assertion) should be provided that the driver or tool will not adversely affect the performance of the functionality by the TOE and its platform. This also includes the configuration of the cryptographic engine to be used. The cryptographic algorithms implemented by this engine are those specified by this PP and used by the cryptographic protocols being evaluated (IPsec, TLS/HTTPS, SSH). <br/><br/>
                The test plan identifies high-level test objectives as well as the test procedures to be followed to achieve those objectives. These procedures include expected results. The test report (which could just be an annotated version of the test plan) details the activities that took place when the test procedures were executed, and includes the actual results of the tests. This shall be a cumulative account, so if there was a test run that resulted in a failure; a fix installed; and then a successful re-run of the test, the report would show a "fail" and "pass" result (and the supporting details), and not just the "pass" result.</div>
</div></span><!-- End: Mobile_Device_Fundamentals:ate__ind.1 -->
<span class='comp-notes'></span><br/><span id='Mobile_Device_Fundamentals:ava__van.1' class='component ava__van.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>AVA_VAN.1 &#8212; Vulnerability Survey</a>
<div class='reqgroup'>
<div id='Mobile_Device_Fundamentals:ava__van.1.1d' class='requirement ava__van.1.1d'><div class='f-el-title'>AVA_VAN.1.1D</div><div class='words'>The developer shall provide the TOE for testing.</div>
</div><!-- End: Mobile_Device_Fundamentals:ava__van.1.1d -->
<div id='Mobile_Device_Fundamentals:ava__van.1.1c' class='requirement ava__van.1.1c'><div class='f-el-title'>AVA_VAN.1.1C</div><div class='words'>The TOE shall be suitable for testing.</div>
</div><!-- End: Mobile_Device_Fundamentals:ava__van.1.1c -->
<div id='Mobile_Device_Fundamentals:ava__van.1.1e' class='requirement ava__van.1.1e'><div class='f-el-title'>AVA_VAN.1.1E</div><div class='words'>The evaluator shall confirm that the information provided meets all requirements for content and presentation of evidence.</div>
</div><!-- End: Mobile_Device_Fundamentals:ava__van.1.1e -->
<div id='Mobile_Device_Fundamentals:ava__van.1.2e' class='requirement ava__van.1.2e'><div class='f-el-title'>AVA_VAN.1.2E</div><div class='words'>The evaluator shall perform a search of public domain sources to identify potential vulnerabilities in the TOE.</div>
</div><!-- End: Mobile_Device_Fundamentals:ava__van.1.2e -->
<div id='Mobile_Device_Fundamentals:ava__van.1.3e' class='requirement ava__van.1.3e'><div class='f-el-title'>AVA_VAN.1.3E</div><div class='words'>The evaluator shall conduct penetration testing, based on the identified potential vulnerabilities, to determine that the TOE is resistant to attacks performed by an attacker possessing Basic attack potential.</div>
</div><!-- End: Mobile_Device_Fundamentals:ava__van.1.3e -->
<div class='aactivity'>
The evaluator shall generate a report to document their findings with respect to this requirement. This report could physically be part of the overall test report mentioned in ATE_IND, or a separate document. The evaluator performs a search of public information to find vulnerabilities that have been found in mobile devices and the implemented communication protocols in general, as well as those that pertain to the particular TOE. The evaluator documents the sources consulted and the vulnerabilities found in the report. 
              <br/><br/>
              For each vulnerability found, the evaluator either provides a rationale with respect to its non-applicability, or the evaluator formulates a test (using the guidelines provided in ATE_IND) to confirm the vulnerability, if suitable. Suitability is determined by assessing the attack vector needed to take advantage of the vulnerability. If exploiting the vulnerability requires expert skills and an electron microscope, for instance, then a test would not be suitable and an appropriate justification would be formulated.</div>
</div></span><!-- End: Mobile_Device_Fundamentals:ava__van.1 -->
<span class='comp-notes'></span><br/></div><div class='hidable dep:TLS' id='module:TLS'><h2>TLS</h2><span id='TLS:fcs__tls__ext.1' class='component fcs__tls__ext.1'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_TLS_EXT.1 &#8212; TLS Protocol</a>
<div class='reqgroup'>
<div id='TLS:fcs__tls__ext.1.1' class='requirement fcs__tls__ext.1.1'><div class='f-el-title'>FCS_TLS_EXT.1.1</div><div class='words'>The product shall implement
        <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' id='TLS:tlsc_impl' onchange='update(this); ' data-rindex='0' class='val selbox tlsc_impl'></input><span>TLS as a client</span>
</li>
<li><input type='checkbox' id='TLS:tlss_impl' onchange='update(this); ' data-rindex='1' class='val selbox tlss_impl'></input><span>TLS as a server</span>
</li>
<li><input type='checkbox' id='TLS:dtlsc_impl' onchange='update(this); ' data-rindex='2' class='val selbox dtlsc_impl'></input><span>DTLS as a client</span>
</li>
<li><input type='checkbox' id='TLS:dtlss_impl' onchange='update(this); ' data-rindex='3' class='val selbox dtlss_impl'></input><span>DTLS as a server</span>
</li>
</ul>
</span>.
        </div>
</div><!-- End: TLS:fcs__tls__ext.1.1 -->
<div class='aactivity'>

	      
		The evaluator shall ensure that the selections indicated in the ST are
              consistent with selections in the dependent components.
            </div>
</div></span><!-- End: TLS:fcs__tls__ext.1 -->
<span class='comp-notes'></span><br/><span id='TLS:fcs__tlsc__ext.1' class='component fcs__tlsc__ext.1 sel-based disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_TLSC_EXT.1 &#8212; TLS Client Protocol</a>
<div class='reqgroup'>
<div id='TLS:fcs__tlsc__ext.1.1' class='requirement fcs__tlsc__ext.1.1'><div class='f-el-title'>FCS_TLSC_EXT.1.1</div><div class='words'> The product shall implement TLS 1.2 (RFC 5246) and
              <span class='selectables' data-rindex='0'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>TLS 1.1 (RFC 4346)</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox exclusive'></input><span>no earlier TLS versions</span>
</span> as a client that supports the cipher suites
          <span class='selectables' data-rindex='1'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>TLS_RSA_WITH_AES_128_CBC_SHA as defined in RFC 5246</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>TLS_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>TLS_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span>TLS_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5288</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='4' class='val selbox'></input><span>TLS_DHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='5' class='val selbox'></input><span>TLS_DHE_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='6' class='val selbox'></input><span>TLS_DHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5288</span>
</li>
<li><input type='checkbox' id='TLS:tecdhe1' onchange='update(this); ' data-rindex='7' class='val selbox tecdhe1'></input><span>TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</span>
</li>
<li><input type='checkbox' id='TLS:tecdhe2' onchange='update(this); ' data-rindex='8' class='val selbox tecdhe2'></input><span>TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</span>
</li>
<li><input type='checkbox' id='TLS:tecdhe3' onchange='update(this); ' data-rindex='9' class='val selbox tecdhe3'></input><span>TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384 as defined in RFC 5289</span>
</li>
<li><input type='checkbox' id='TLS:tecdhe4' onchange='update(this); ' data-rindex='10' class='val selbox tecdhe4'></input><span>TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5289</span>
</li>
<li><input type='checkbox' id='TLS:tecdhe5' onchange='update(this); ' data-rindex='11' class='val selbox tecdhe5'></input><span>TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</span>
</li>
<li><input type='checkbox' id='TLS:tecdhe6' onchange='update(this); ' data-rindex='12' class='val selbox tecdhe6'></input><span>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</span>
</li>
<li><input type='checkbox' id='TLS:tecdhe7' onchange='update(this); ' data-rindex='13' class='val selbox tecdhe7'></input><span>TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 as defined in RFC 5289</span>
</li>
<li><input type='checkbox' id='TLS:tecdhe8' onchange='update(this); ' data-rindex='14' class='val selbox tecdhe8'></input><span>TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5289</span>
</li>
</ul>
</span>
          and also supports functionality for 
          <span class='selectables' data-rindex='2'><input type='checkbox' id='TLS:tlsc_mutual_auth' onchange='update(this); ' data-rindex='0' class='val selbox tlsc_mutual_auth'></input><span>mutual authentication</span>
<input type='checkbox' id='TLS:tlsc_reneg' onchange='update(this); ' data-rindex='1' class='val selbox tlsc_reneg'></input><span>session renegotiation</span>
<input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox exclusive'></input><span>none</span>
</span>.
          </div>
</div><!-- End: TLS:fcs__tlsc__ext.1.1 -->
<div class='aactivity'>

              
              The evaluator shall check the description of the implementation of this
              protocol in the TSS to
              ensure that the cipher suites supported are specified. The evaluator shall check the
                TSS to ensure that the
              cipher suites specified include those listed for this component. 
              
              The evaluator shall
              also check the operational guidance to ensure that it contains instructions on
              configuring the product so that
              TLS conforms to the description in the TSS. 
              
              The evaluator shall also perform the following tests:
              
                
                  The evaluator shall establish a  connection
                  using each of the cipher suites specified by the
                  requirement. This connection may be established as part of the establishment of a
                  higher-level protocol, e.g., as part of an EAP session. It is sufficient to
                  observe the successful negotiation of a cipher suite to satisfy the intent of the
                  test; it is not necessary to examine the characteristics of the encrypted traffic
                  in an attempt to discern the cipher suite being used (for example, that the
                  cryptographic algorithm is 128-bit AES and not 256-bit AES).
                
                
                  The goal of the following test is to verify that the TOE accepts only certificates
                  with appropriate values in the extendedKeyUsage extension, and implicitly that the
                  TOE correctly parses the extendedKeyUsage extension as part of X.509v3 server
                  certificate validation.
                  <br/><br/>
                  The evaluator shall attempt to establish the connection using a server with a
                  server certificate that contains the Server Authentication purpose in the
                  extendedKeyUsage extension and verify that a connection is established. The
                  evaluator shall repeat this test using a different, but otherwise valid and
                  trusted, certificate that lacks the Server Authentication purpose in the
                  extendedKeyUsage extension and ensure that a connection is not established.
                  Ideally, the two certificates should be similar in structure, the types of
                  identifiers used, and the chain of trust.
                
                
                  The evaluator shall send a server certificate in the  connection
                  that does not match the server-selected cipher suite (for example, send a ECDSA certificate while using the
                  TLS_RSA_WITH_AES_128_CBC_SHA cipher suite or send a RSA certificate while using one
                  of the ECDSA cipher suites.) The evaluator shall verify that the product disconnects after
                  receiving the server’s Certificate handshake message.
                
                
                  The evaluator shall configure the server to select the
                  TLS_NULL_WITH_NULL_NULL cipher suite and verify that the client denies the
                  connection.
                
                
                  The evaluator shall perform the following modifications to the traffic:
                  
                    
                      Change the  version
                      selected by the server in the Server Hello to an undefined  version (for example 1.5
                      represented by the two bytes 03 06) and verify that the client rejects the
                      connection.
                    
                    
                      Change the  version
                      selected by the server in the Server Hello to the most recent unsupported  version (for example 1.1
                      represented by the two bytes 03 02) and verify that the client rejects the
                      connection.
                    
                    
                      [conditional] If DHE or ECDHE cipher suites are supported, modify at least one byte in the
                      server’s nonce in the Server Hello handshake message, and verify that the client does not complete
                      the handshake and no application data flows.
                    
                    
                      Modify the server’s selected cipher suite in the Server Hello handshake
                      message to be a cipher suite not presented in the Client Hello handshake
                      message. The evaluator shall verify that the client does not complete the handshake
                      and no application data flows.
                    
                    
                      [conditional] If DHE or ECDHE cipher suites are supported, modify the signature block in the
                      server’s Key Exchange handshake message, and verify that the client does not complete the handshake
                      and no application data flows. This test does not apply to cipher suites using RSA key exchange.
                      If a TOE only supports RSA key exchange in conjunction with TLS, then this test shall be omitted.
                    
                    
                      Modify a byte in the Server Finished handshake message, and verify that the
                      client does not complete the handshake and no application data flows.
                    
                    
                      Send a message consisting of random bytes from the server after the server has issued the
                      Change Cipher Spec message and verify that the client does not complete the handshake
                      and no application data flows. The message must still have a valid 5-byte record
                      header in order to ensure the message will be parsed as TLS.
                    
                  
                
              
            </div><div id='TLS:fcs__tlsc__ext.1.2' class='requirement fcs__tlsc__ext.1.2'><div class='f-el-title'>FCS_TLSC_EXT.1.2</div><div class='words'> The product shall verify that the presented identifier matches the reference
              identifier according to RFC 6125. </div>
</div><!-- End: TLS:fcs__tlsc__ext.1.2 -->
<div class='aactivity'>

              
              The evaluator shall ensure that the TSS describes the client’s method of establishing all reference
              identifiers from the application-configured reference identifier, including which
              types of reference identifiers are supported (e.g. Common Name, DNS Name, URI Name,
              Service Name, or other application-specific Subject Alternative Names) and whether IP
              addresses and wildcards are supported. The evaluator shall ensure that this
              description identifies whether and the manner in which certificate pinning is
              supported or used by the product.
              <br/> 
              
              The evaluator shall verify that the AGD guidance includes instructions for
              setting the reference identifier to be used for the purposes of certificate validation
              in . <br/>
              
              The evaluator shall
              configure the reference identifier according to the AGD guidance and perform the
              following tests during a  connection:
              
                 
                  The evaluator shall present a server certificate that contains
                  a CN that does not match the reference identifier and does not
                  contain the SAN extension. The evaluator shall verify that the
                  connection fails. 
                  <p></p>Note that some systems might require the presence of the SAN extension.
                  In this case the connection would still fail but for the
                  reason of the missing SAN extension instead of the mismatch of
                  CN and reference identifier. Both reasons are acceptable to
                  pass Test 1.
                
                
                  The evaluator shall present a server certificate that contains a CN that
                  matches the reference identifier, contains the SAN extension, but does not contain
                  an identifier in the SAN that matches the reference identifier. The evaluator
                  shall verify that the connection fails. The evaluator shall repeat this test for
                  each supported SAN type.
                
                
                  [conditional] If the TOE does not mandate the presence of the SAN extension,
                  the evaluator shall present a server certificate that contains
                  a CN that matches the reference identifier and does not
                  contain the SAN extension. The evaluator shall verify that the
                  connection succeeds. If the TOE does mandate the presence of
                  the SAN extension, this Test shall be omitted.  
                
                
                  The evaluator shall present a server certificate that contains a CN that does
                  not match the reference identifier but does contain an identifier in the SAN that
                  matches. The evaluator shall verify that the connection succeeds.
                
                
                  The evaluator shall perform the following wildcard tests with each supported type of reference
                  identifier. The support for wildcards is intended to be optional. If wildcards are supported, the
                  first, second, and third tests below shall be executed. If wildcards are not supported, then the
                  fourth test below shall be executed.
                  
                    
                      [conditional]: If wildcards are supported, the evaluator shall present a server certificate
                      containing a wildcard that is not in the left-most label of the presented identifier (e.g.
                      foo.*.example.com) and verify that the connection fails.
                    
                    
                      [conditional]: If wildcards are supported, the evaluator shall present a server certificate
                      containing a wildcard in the left-most label but not preceding the public
                      suffix (e.g. *.example.com). The evaluator shall configure
                      the reference identifier with a single left-most label (e.g. foo.example.com) and verify that the
                      connection succeeds. The evaluator shall configure the reference identifier without a left-most
                      label as in the certificate (e.g. example.com) and verify that the connection fails. The evaluator
                      shall configure the reference identifier with two left-most labels (e.g. bar.foo.example.come) and
                      verify that the connection fails.
                    
                    
                      [conditional]: If wildcards are supported, the evaluator shall present a server certificate
                      containing a wildcard in the left-most label immediately preceding the public suffix (e.g. *.com).
                      The evaluator shall configure the reference identifier with a single left-most label (e.g.
                      foo.com) and verify that the connection fails. The evaluator shall configure the reference
                      identifier with two left-most labels (e.g. bar.foo.com) and verify that the connection fails.
                    
                    
                      [conditional]: If wildcards are not supported, the evaluator shall present a server certificate
                      containing a wildcard in the left-most label (e.g. *.example.com). The evaluator shall configure
                      the reference identifier with a single left-most label (e.g. foo.example.com) and verify that the
                      connection fails.
                    
                  
                
                
                  [conditional] If URI or Service name reference identifiers are supported, the
                  evaluator shall configure the  name and
                  the service identifier. The evaluator shall present a server certificate
                  containing the correct  name and
                  service identifier in the URIName or SRVName fields of the SAN and verify that the
                  connection succeeds. The evaluator shall repeat this test with the wrong service
                  identifier (but correct  name) and
                  verify that the connection fails.
                
                
                  [conditional] If pinned certificates are supported the evaluator shall
                  present a certificate that does not match the pinned certificate and verify that
                  the connection fails.
                
              
            </div><div id='TLS:fcs__tlsc__ext.1.3' class='requirement fcs__tlsc__ext.1.3'><div class='f-el-title'>FCS_TLSC_EXT.1.3</div><div class='words'>The product shall not establish a trusted channel if the
              server certificate is invalid
              <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox exclusive'></input><span>with no exceptions</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>except when override is authorized</span>
</li>
</ul>
</span>.
            </div>
</div><!-- End: TLS:fcs__tlsc__ext.1.3 -->
<div class='aactivity'>

              
              The evaluator shall demonstrate that using an invalid certificate
              results in the function failing as follows, unless excepted:
              
                The evaluator shall demonstrate that a server using a certificate without a
                  valid certification path results in an authentication failure. Using the
                  administrative guidance, the evaluator shall then load the trusted CA
                  certificate(s) needed to validate the server's certificate, and demonstrate that the
                  connection succeeds. The evaluator then shall delete one of the CA certificates,
                  and show that the connection fails. 
                 The evaluator shall demonstrate that a server using a certificate which has
                  been revoked results in an authentication failure. 
                 The evaluator shall demonstrate that a server using a certificate which has
                  passed its expiration date results in an authentication failure. 
                 The evaluator shall demonstrate that a server using a certificate which does
                  not have a valid identifier results in an authentication failure. 
              
              
            </div>
</div></span><!-- End: TLS:fcs__tlsc__ext.1 -->
<span class='comp-notes'></span><br/><span id='TLS:fcs__tlsc__ext.2' class='component fcs__tlsc__ext.2 sel-based disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_TLSC_EXT.2 &#8212; TLS Client Support for Mutual Authentication</a>
<div class='reqgroup'>
<div id='TLS:fcs__tlsc__ext.2.1' class='requirement fcs__tlsc__ext.2.1'><div class='f-el-title'>FCS_TLSC_EXT.2.1</div><div class='words'>The product shall support mutual authentication using X.509v3 certificates.</div>
</div><!-- End: TLS:fcs__tlsc__ext.2.1 -->
<div class='aactivity'>

              
                The evaluator shall ensure that the TSS description required per FIA_X509_EXT.2.1 includes the use of client-side certificates for TLS
              mutual authentication. <br/>
              
              The evaluator shall verify that the AGD guidance required
              per FIA_X509_EXT.2.1 includes instructions for configuring the
              client-side certificates for  mutual
              authentication. <br/> 
              
              The evaluator shall also perform the following tests:
              
	      
          The evaluator shall establish a connection to a server that is not
configured for mutual authentication (i.e. does not send Server’s Certificate
Request (type 13) message). The evaluator observes negotiation of a TLS channel
and confirms that the TOE did not send Client’s Certificate message (type 11)
during handshake. 
		
		The evaluator shall establish a connection to a server with a
		shared trusted root that is configured for mutual authentication (i.e. it
		sends Server’s Certificate Request (type 13) message). The evaluator
		observes negotiation of a TLS channel and confirms that the TOE responds
		with a non-empty Client’s Certificate message (type 11) and Certificate
		Verify (type 15) message.
		
	      
            </div>
</div></span><!-- End: TLS:fcs__tlsc__ext.2 -->
<span class='comp-notes'></span><br/><span class='tooltipped'><input type='checkbox' onchange='handleOCheck(this); return false;'></input></span>
<span id='TLS:fcs__tlsc__ext.3' class='component fcs__tlsc__ext.3 disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_TLSC_EXT.3 &#8212; TLS Client Support for Signature Algorithms Extension</a><span class='tooltiptext'>objective</span>
<div class='reqgroup'>
<div id='TLS:fcs__tlsc__ext.3.1' class='requirement fcs__tlsc__ext.3.1'><div class='f-el-title'>FCS_TLSC_EXT.3.1</div><div class='words'> The product shall present the signature_algorithms extension in the Client Hello with
              the supported_signature_algorithms value containing the following hash algorithms: <span class='selectables' data-rindex='0'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>SHA256</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>SHA384</span>
<input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>SHA512</span>
</span> and no other hash algorithms. </div>
</div><!-- End: TLS:fcs__tlsc__ext.3.1 -->
<div class='aactivity'>

              
              The evaluator shall verify that TSS describes the signature_algorithm extension and whether the
              required behavior is performed by default or may be configured. 
              
              If the TSS indicates that the
              signature_algorithm extension must be configured to meet the requirement, the
              evaluator shall verify that AGD guidance includes configuration of the
              signature_algorithm extension. <br/> 
              
              The evaluator shall also perform the following
              tests:
              
                
                  The evaluator shall configure the server to send a
                  certificate in the  connection that is not
                  supported according to the Client's HashAlgorithm
                  enumeration within the signature_algorithms
                  extension (for example, send a certificate with a
                  SHA-1 signature). The evaluator shall verify that
                  the product disconnects after receiving the server's
                  Certificate handshake message.
                
                
                  [conditional] If the client supports a DHE or ECDHE
                  cipher suite, the evaluator shall configure the
                  server to send a Key Exchange handshake message
                  including a signature not supported according to the
                  client's HashAlgorithm enumeration (for example, the
                  server signed the Key Exchange parameters using a
                  SHA-1 signature). The evaluator shall verify that
                  the product disconnects after receiving the server's
                  Key Exchange handshake message.
                
              
            </div>
</div></span><!-- End: TLS:fcs__tlsc__ext.3 -->
<span class='comp-notes'></span><br/><span id='TLS:fcs__tlsc__ext.4' class='component fcs__tlsc__ext.4 sel-based disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_TLSC_EXT.4 &#8212; TLS Client Support for Renegotiation</a>
<div class='reqgroup'>
<div id='TLS:fcs__tlsc__ext.4.1' class='requirement fcs__tlsc__ext.4.1'><div class='f-el-title'>FCS_TLSC_EXT.4.1</div><div class='words'> The product shall support secure renegotiation through use
              of the “renegotiation_info” TLS extension in accordance with RFC 5746. </div>
</div><!-- End: TLS:fcs__tlsc__ext.4.1 -->
<div id='TLS:fcs__tlsc__ext.4.2' class='requirement fcs__tlsc__ext.4.2'><div class='f-el-title'>FCS_TLSC_EXT.4.2</div><div class='words'> The product shall include (choose only one of)
              <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>renegotiation_info extension</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox exclusive'></input><span>TLS_EMPTY_RENEGOTIATION_INFO_SCSV cipher suite</span>
</li>
</ul>
</span> in the ClientHello message. </div>
</div><!-- End: TLS:fcs__tlsc__ext.4.2 -->
<div class='aactivity'>

              
              The evaluator shall perform the following tests:
              
                The evaluator shall use a network packet analyzer/sniffer to capture the traffic between the two
                  TLS endpoints.  The evaluator shall verify that either the “renegotiation_info” field or the SCSV
                  cipher suite is included in the ClientHello message during the initial handshake.
                The evaluator shall verify the Client’s handling of ServerHello messages received during
                  the initial handshake that include the “renegotiation_info” extension.  The evaluator shall modify
                  the length portion of this field in the ServerHello message to be non-zero and verify that the client
                  sends a failure and terminates the connection.  The evaluator shall verify that a properly formatted
                  field results in a successful TLS connection.
                The evaluator shall verify that ServerHello messages received during secure renegotiation contain
                  the “renegotiation_info” extension.  The evaluator shall modify either the “client_verify_data” or
                  “server_verify_data” value and verify that the client terminates the connection.
              
            </div>
</div></span><!-- End: TLS:fcs__tlsc__ext.4 -->
<span class='comp-notes'></span><br/><span id='TLS:fcs__tlsc__ext.5' class='component fcs__tlsc__ext.5 sel-based disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_TLSC_EXT.5 &#8212; TLS Client Support for Supported Groups Extension</a>
<div class='reqgroup'>
<div id='TLS:fcs__tlsc__ext.5.1' class='requirement fcs__tlsc__ext.5.1'><div class='f-el-title'>FCS_TLSC_EXT.5.1</div><div class='words'> The product shall present the Supported Groups Extension in the Client Hello
              with the supported groups <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>secp256r1</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>secp384r1</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>secp521r1</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span>ffdhe2048(256)</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='4' class='val selbox'></input><span>ffdhe3072(257)</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='5' class='val selbox'></input><span>ffdhe4096(258)</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='6' class='val selbox'></input><span>ffdhe6144(259)</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='7' class='val selbox'></input><span>ffdhe8192(260)</span>
</li>
</ul>
</span>.
            </div>
</div><!-- End: TLS:fcs__tlsc__ext.5.1 -->
<div class='aactivity'>

              
              The evaluator shall verify that TSS describes the Supported Groups Extension.
              
              The evaluator shall also perform the following test:
              <br/>
              
              
              The evaluator shall configure a server to perform ECDHE key exchange using each of the TOE’s supported
              curves and/or groups. The evaluator shall verify that the TOE successfully connects to the server.
              
              
            </div>
</div></span><!-- End: TLS:fcs__tlsc__ext.5 -->
<span class='comp-notes'></span><br/><span id='TLS:fcs__tlss__ext.1' class='component fcs__tlss__ext.1 sel-based disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_TLSS_EXT.1 &#8212; TLS Server Protocol</a>
<div class='reqgroup'>
<div id='TLS:fcs__tlss__ext.1.1' class='requirement fcs__tlss__ext.1.1'><div class='f-el-title'>FCS_TLSS_EXT.1.1</div><div class='words'> The product shall implement TLS 1.2 (RFC 5246) and
            <span class='selectables' data-rindex='0'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>TLS 1.1 (RFC 4346)</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox exclusive'></input><span>no earlier TLS versions</span>
</span>
              as a server that supports the cipher suites
              <span class='selectables' data-rindex='1'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>TLS_RSA_WITH_AES_128_CBC_SHA as defined in RFC 5246</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>TLS_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>TLS_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span>TLS_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5288</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='4' class='val selbox'></input><span>TLS_DHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='5' class='val selbox'></input><span>TLS_DHE_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='6' class='val selbox'></input><span>TLS_DHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5288</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='7' class='val selbox'></input><span>TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='8' class='val selbox'></input><span>TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='9' class='val selbox'></input><span>TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384 as defined in RFC 5289</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='10' class='val selbox'></input><span>TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5289</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='11' class='val selbox'></input><span>TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='12' class='val selbox'></input><span>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='13' class='val selbox'></input><span>TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 as defined in RFC 5289</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='14' class='val selbox'></input><span>TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5289</span>
</li>
</ul>
</span> and no other cipher suites,
              and also supports functionality for
              <span class='selectables' data-rindex='2'><input type='checkbox' id='TLS:tlss_mutual_auth' onchange='update(this); ' data-rindex='0' class='val selbox tlss_mutual_auth'></input><span>mutual authentication</span>
<input type='checkbox' id='TLS:tlss_reneg' onchange='update(this); ' data-rindex='1' class='val selbox tlss_reneg'></input><span>session renegotiation</span>
<input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox exclusive'></input><span>none</span>
</span>.
            </div>
</div><!-- End: TLS:fcs__tlss__ext.1.1 -->
<div class='aactivity'>

              
              The evaluator shall check the description of the implementation of this protocol in
              the <abbr linkend='TSS' title='TOE Summary Specification'>TSS</abbr> to ensure that
              the cipher suites supported are specified. The evaluator shall check the
              <abbr linkend='TSS' title='TOE Summary Specification'>TSS</abbr> to ensure that the
              cipher suites specified include those listed for this component. 
              
              The evaluator shall
              also check the operational guidance to ensure that it contains instructions on
              configuring the <abbr linkend='TOE' title='Target of Evaluation'>TOE</abbr> so that
              TLS conforms to the description in the
              <abbr linkend='TSS' title='TOE Summary Specification'>TSS</abbr>.
              
              The evaluator shall
              also perform the following tests:
              
                
                  The evaluator shall establish a
                  <abbr title='Transport Layer Security'>TLS</abbr> connection using each of the
                  cipher suites specified by the requirement. This connection may be established as
                  part of the establishment of a higher-level protocol, e.g., as part of an EAP
                  session. It is sufficient to observe the successful negotiation of a cipher suite
                  to satisfy the intent of the test; it is not necessary to examine the
                  characteristics of the encrypted traffic in an attempt to discern the cipher suite
                  being used (for example, that the cryptographic algorithm is 128-bit AES and not
                  256-bit AES).
                
                
                  The evaluator shall send a Client Hello to the server with a list of
                  cipher suites that does not contain any of the cipher suites in the server’s ST
                  and verify that the server denies the connection. Additionally, the evaluator
                  shall send a Client Hello to the server containing only the
                  TLS_NULL_WITH_NULL_NULL cipher suite and verify that the server
                  denies the connection.
                
                
		  If RSA key exchange is used in one of the selected ciphersuites, the evaluator shall use a client to send a properly
		  constructed Key Exchange message with a modified
		  EncryptedPreMasterSecret field during the TLS
		  handshake. The evaluator shall verify that the
		  handshake is not completed successfully and no
		  application data flows.
                
                
                  The evaluator shall perform the following modifications to the traffic:
                  
                    
                      Change the <abbr title='Transport Layer Security'>TLS</abbr> version proposed
                      by the client in the Client Hello to a non-supported
                      <abbr title='Transport Layer Security'>TLS</abbr> version (for example 1.3
                      represented by the two bytes 03 04) and verify that the server rejects the
                      connection.
                    
                    
                      Modify a byte in the data of the client's Finished handshake message, and verify that the
                      server rejects the connection and does not send any application data.
                    
                    
		      Demonstrate that the TOE will not resume a
		      session for which the client failed to complete
		      the handshake (independent of TOE support for
		      session resumption): Generate a Fatal Alert by
		      sending a Finished message from the client
		      before the client sends a ChangeCipherSpec
		      message, and then send a Client Hello with the
		      session identifier from the previous incomplete
		      session, and verify that the server does not
		      resume the session.
                    
                    
                      Send a message consisting of random bytes from
                      the client after the client has issued the
                      ChangeCipherSpec message and verify that the
                      server denies the connection.
                    
                  
                
              
            </div><div id='TLS:fcs__tlss__ext.1.2' class='requirement fcs__tlss__ext.1.2'><div class='f-el-title'>FCS_TLSS_EXT.1.2</div><div class='words'>The product shall deny connections from clients requesting
            SSL 2.0, SSL 3.0, TLS 1.0 and
              <span class='selectables' data-rindex='0'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>TLS 1.1</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox exclusive'></input><span>none</span>
</span>.
            </div>
</div><!-- End: TLS:fcs__tlss__ext.1.2 -->
<div class='aactivity'>

              
              The evaluator shall verify that the TSS contains a
              description of the denial of old SSL and TLS versions
              consistent relative to selections in FCS_TLS_EXT.1.1.
              
              The evaluator shall verify that the AGD guidance includes any configuration
              necessary to meet this requirement.
              
              
                
                  The evaluator shall send a Client Hello requesting a
                  connection with version SSL 2.0 and verify that the
                  server denies the connection. The evaluator shall
                  repeat this test with SSL 3.0 and TLS 1.0,
                  and TLS 1.1 if it is selected.
                
              
            </div><div id='TLS:fcs__tlss__ext.1.3' class='requirement fcs__tlss__ext.1.3'><div class='f-el-title'>FCS_TLSS_EXT.1.3</div><div class='words'>The product shall perform key establishment for TLS using
              <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>RSA with size
                  <span class='selectables' data-rindex='1'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>2048 bits</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>3072 bits</span>
<input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>4096 bits</span>
<input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox exclusive'></input><span>no other sizes</span>
</span>
                </span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>Diffie-Hellman parameters with size
                  <span class='selectables' data-rindex='2'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>2048 bits</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>3072 bits</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>4096 bits</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span>6144 bits</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='4' class='val selbox'></input><span>8192 bits</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='5' class='val selbox exclusive'></input><span>no other sizes</span>
</li>
</ul>
</span>
                </span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>Diffie-Hellman groups
                  <span class='selectables' data-rindex='3'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>ffdhe2048</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>ffdhe3072</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>ffdhe4096</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span>ffdhe6144</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='4' class='val selbox'></input><span>ffdhe8192</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='5' class='val selbox'></input><span>no other groups</span>
</li>
</ul>
</span>
              </span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span>ECDHE parameters using elliptic curves
                <span class='selectables' data-rindex='4'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>secp256r1</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>secp384r1</span>
<input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>secp521r1</span>
</span> and no other curves
              </span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='4' class='val selbox exclusive'></input><span>no other key establishment methods</span>
</li>
</ul>
</span>
            </div>
</div><!-- End: TLS:fcs__tlss__ext.1.3 -->
<div class='aactivity'>

              
              The evaluator shall verify that the TSS describes the key agreement parameters
              of the server's Key Exchange message.
              
              The evaluator shall verify that any configuration guidance necessary to meet
              the requirement must be contained in the AGD guidance.
              
              
                The evaluator shall conduct the following tests.  The testing can be carried out
                manually with a packet analyzer or with an automated framework
                that similarly captures such empirical evidence.  Note that this testing can be accomplished in
                conjunction with other testing activities.  For each of the following tests, determining that
                the size matches the expected size is sufficient.
                
                  [conditional] If RSA-based key establishment is selected, the evaluator shall attempt a
                  connection using RSA-based key establishment with a supported size.
                  The evaluator shall verify that the size used matches that which is configured. The evaluator
                  shall repeat this test for each supported size of RSA-based key establishment.
                
                
                  [conditional] If finite-field (i.e. non-EC) Diffie-Hellman ciphers are selected, the evaluator shall attempt a
                  connection using a Diffie-Hellman key exchange with a supported
                  parameter size or supported group. The evaluator shall verify that the key agreement parameters in the Key
                  Exchange message are the ones configured. The evaluator shall repeat this test for each supported
                  parameter size or group.
                
                
                  [conditional] If ECDHE ciphers are selected, the evaluator shall attempt a connection
                  using an ECDHE ciphersuite with a
                  supported curve. The evaluator shall verify that the key agreement parameters in the Key
                  Exchange message are the ones configured. The evaluator shall repeat this test for each supported
                  elliptic curve.
                
              
            </div>
</div></span><!-- End: TLS:fcs__tlss__ext.1 -->
<span class='comp-notes'></span><br/><span id='TLS:fcs__tlss__ext.2' class='component fcs__tlss__ext.2 sel-based disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_TLSS_EXT.2 &#8212; TLS Server Support for Mutual Authentication</a>
<div class='reqgroup'>
<div id='TLS:fcs__tlss__ext.2.1' class='requirement fcs__tlss__ext.2.1'><div class='f-el-title'>FCS_TLSS_EXT.2.1</div><div class='words'>The product shall support authentication of
              TLS clients using X.509v3 certificates.
            </div>
</div><!-- End: TLS:fcs__tlss__ext.2.1 -->
<div id='TLS:fcs__tlss__ext.2.2' class='requirement fcs__tlss__ext.2.2'><div class='f-el-title'>FCS_TLSS_EXT.2.2</div><div class='words'>The product shall not establish a trusted channel
              if the client certificate is invalid.
            </div>
</div><!-- End: TLS:fcs__tlss__ext.2.2 -->
<div class='aactivity'>

              
              The evaluator shall ensure that the TSS description required per FIA_X509_EXT.2.1
              includes the use of client-side certificates for TLS mutual authentication.
              
              The evaluator shall verify that the AGD guidance required per FIA_X509_EXT.2.1
              includes instructions for configuring the client-side certificates for TLS mutual
              authentication.  The evaluator shall ensure that the AGD guidance
              includes instructions for configuring the server to require
              mutual authentication of clients using these certificates.
        
	      The evaluator shall use TLS as a function to verify that the validation rules in
	      FIA_X509_EXT.1.1 are adhered to and shall perform the following tests.
        The evaluator shall apply the AGD guidance to configure the server
        to require TLS mutual authentication of clients for the following tests,
        unless overridden by instructions in the test activity:
              
                
                  The evaluator shall configure the server to send a certificate request
                  to the client.  
                  The client shall send a certificate_list structure which has a length of zero. The evaluator
                  shall verify that the handshake is not finished successfully and no application data flows.
                
                
                  The evaluator shall configure the server to send a certificate request
                  to the client.  
                  The client shall send no client certificate message, and instead send a client key exchange
                  message in an attempt to continue the handshake. The evaluator shall verify that the handshake is
                  not finished successfully and no application data flows.
                
                
                  The evaluator shall configure the server to send a certificate request
                  to the client without the supported_signature_algorithm used by the client’s
                  certificate. The evaluator shall attempt a connection using the client
                  certificate and verify that the handshake is not finished successfully
                  and no application data flows.
                
                
                  The evaluator shall demonstrate that using a certificate without a
                  valid certification path results in the function failing. Using the
                  administrative guidance, the evaluator shall then load a certificate or
                  certificates needed to validate the certificate to be used in the function, and
                  demonstrate that the function succeeds. The evaluator then shall delete one
                  of the certificates, and show that the function fails.
                
                
                  The aim of this test is to check the response of the server
                  when it receives a client identity  certificate that is signed
                  by an impostor CA (either Root CA or intermediate CA). To
                  carry out this test the  evaluator shall configure the client
                  to send a client identity certificate with an issuer field
                  that identifies a  CA recognised by the TOE as a trusted CA,
                  but where the key used for the signature on the client
                  certificate  does not in fact correspond to the CA certificate
                  trusted by the TOE (meaning that the client certificate is
                  invalid  because  its  certification  path  does  not  in
                  fact  terminate  in  the  claimed  CA  certificate).  The
                  evaluator shall verify that the attempted connection is
                  denied.
                
                
                  The evaluator shall configure the client to send a certificate with the
                  Client Authentication purpose in the extendedKeyUsage field and verify that
                  the server accepts the attempted connection. The evaluator shall repeat this
                  test without the Client Authentication purpose and shall verify that the server
                  denies the connection. Ideally, the two certificates should be identical except
                  for the Client Authentication purpose.
                
                
                  The evaluator shall perform the following modifications to the traffic:
                  a) Configure the server to require mutual authentication and then
                  modify a byte in the client’s certificate. The evaluator shall verify
                  that the server rejects the connection.
                  b) Configure the server to require mutual authentication and then
                  modify a byte in the signature block of the client’s Certificate Verify handshake message.
                  The evaluator shall verify that the server rejects the connection.
                
              
            </div><div id='TLS:fcs__tlss__ext.2.3' class='requirement fcs__tlss__ext.2.3'><div class='f-el-title'>FCS_TLSS_EXT.2.3</div><div class='words'>The product shall not establish a trusted channel if
              the Distinguished Name (DN) or Subject Alternative Name (SAN)
              contained in a certificate does not match one of the expected identifiers
              for the client.
            </div>
</div><!-- End: TLS:fcs__tlss__ext.2.3 -->
<div class='aactivity'>

              
              If the product implements mutual authentication, the evaluator shall
              verify that the TSS describes how the DN and SAN in the certificate
              is compared to the expected identifier.
              
              If the DN is not compared automatically to the domain name,
              IP address, username, or email address, the evaluator shall
              ensure that the AGD guidance includes configuration of the
              expected identifier or the directory server for the connection.
              
              
                
                  The evaluator shall send a client certificate with an identifier that does not match any of the
                  expected identifiers and verify that the server denies the connection. The matching itself
                  might be performed outside the TOE (e.g. when passing the certificate on to a directory server
                  for comparison).
                
              
            </div>
</div></span><!-- End: TLS:fcs__tlss__ext.2 -->
<span class='comp-notes'></span><br/><span class='tooltipped'><input type='checkbox' onchange='handleOCheck(this); return false;'></input></span>
<span id='TLS:fcs__tlss__ext.3' class='component fcs__tlss__ext.3 disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_TLSS_EXT.3 &#8212; TLS Server Support for Signature Algorithms Extension</a><span class='tooltiptext'>objective</span>
<div class='reqgroup'>
<div id='TLS:fcs__tlss__ext.3.1' class='requirement fcs__tlss__ext.3.1'><div class='f-el-title'>FCS_TLSS_EXT.3.1</div><div class='words'>The product shall present the HashAlgorithm
            enumeration in supported_signature_algorithms in the
            Certificate Request with the following hash algorithms:
	    <span class='selectables' data-rindex='0'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>SHA256</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>SHA384</span>
<input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>SHA512</span>
</span> and no other hash algorithms.
            </div>
</div><!-- End: TLS:fcs__tlss__ext.3.1 -->
<div class='aactivity'>

        
	      The evaluator shall verify that TSS describes the
	      supported_signature_algorithms field of the Certificate
	      Request and whether the required behavior is performed
	      by default or may be configured.
        
        If the TSS indicates
	      that the supported_signature_algorithms field must be
	      configured to meet the requirement, the evaluator shall
	      verify that AGD guidance includes configuration of the
	      supported_signature_algorithms field.
	      
	      The evaluator shall also perform the following test:
	      <br/>
	      The evaluator shall configure the server to send the
	      signature_algorithms extension in the Certificate
	      Request message indicating that the hash algorithm used
	      by the client’s certificate is not supported.  The
	      evaluator shall attempt a connection using that client
	      certificate and verify that the server denies the
	      client’s connection.
	    </div>
</div></span><!-- End: TLS:fcs__tlss__ext.3 -->
<span class='comp-notes'></span><br/><span id='TLS:FCS__TLSS__EXT.4' class='component FCS__TLSS__EXT.4 sel-based disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_TLSS_EXT.4 &#8212; TLS Server Support for Renegotiation</a>
<div class='reqgroup'>
<div id='TLS:fcs__tlss__ext.4.1' class='requirement fcs__tlss__ext.4.1'><div class='f-el-title'>FCS_TLSS_EXT.4.1</div><div class='words'>The product shall support the "renegotiation_info" TLS extension
              in accordance with RFC 5746.
            </div>
</div><!-- End: TLS:fcs__tlss__ext.4.1 -->
<div id='TLS:fcs__tlss__ext.4.2' class='requirement fcs__tlss__ext.4.2'><div class='f-el-title'>FCS_TLSS_EXT.4.2</div><div class='words'>The product shall include the renegotiation_info extension in
              ServerHello messages.
            </div>
</div><!-- End: TLS:fcs__tlss__ext.4.2 -->
<div class='aactivity'>

        
	      The following tests require connection with a client that supports secure
        renegotiation and the "renegotiation_info" extension.
	      
		The evaluator shall use a network packet analyzer/sniffer to capture
      the traffic between the two TLS endpoints.  The evaluator shall verify that
      the “renegotiation_info” field is included in the ServerHello message. 
		
		The evaluator shall modify the length portion of the field in the
      ClientHello message in the initial handshake to be non-zero and verify that
      the server sends a failure and terminates the connection.  The evaluator
      shall verify that a properly formatted field results in a successful TLS connection.
		
		The evaluator shall modify the "client_verify_data" or "server_verify_data"
      value in the ClientHello message received during secure renegotiation and
      verify that the server terminates the connection.
		
	      
	    </div>
</div></span><!-- End: TLS:FCS__TLSS__EXT.4 -->
<span class='comp-notes'></span><br/><span id='TLS:fcs__dtlsc__ext.1' class='component fcs__dtlsc__ext.1 sel-based disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_DTLSC_EXT.1 &#8212; DTLS Client Protocol</a>
<div class='reqgroup'>
<div id='TLS:fcs__dtlsc__ext.1.1' class='requirement fcs__dtlsc__ext.1.1'><div class='f-el-title'>FCS_DTLSC_EXT.1.1</div><div class='words'>The product shall implement DTLS 1.2 (RFC 6347) and
      <span class='selectables' data-rindex='0'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>DTLS 1.0 (RFC 4347)</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox exclusive'></input><span>no earlier DTLS versions</span>
</span> as a client that supports the cipher suites
    <span class='selectables' data-rindex='1'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>TLS_RSA_WITH_AES_128_CBC_SHA as defined in RFC 5246</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>TLS_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>TLS_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span>TLS_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5288</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='4' class='val selbox'></input><span>TLS_DHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='5' class='val selbox'></input><span>TLS_DHE_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='6' class='val selbox'></input><span>TLS_DHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5288</span>
</li>
<li><input type='checkbox' id='TLS:decdhe1' onchange='update(this); ' data-rindex='7' class='val selbox decdhe1'></input><span>TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</span>
</li>
<li><input type='checkbox' id='TLS:decdhe2' onchange='update(this); ' data-rindex='8' class='val selbox decdhe2'></input><span>TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</span>
</li>
<li><input type='checkbox' id='TLS:decdhe3' onchange='update(this); ' data-rindex='9' class='val selbox decdhe3'></input><span>TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384 as defined in RFC 5289</span>
</li>
<li><input type='checkbox' id='TLS:decdhe4' onchange='update(this); ' data-rindex='10' class='val selbox decdhe4'></input><span>TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5289</span>
</li>
<li><input type='checkbox' id='TLS:decdhe5' onchange='update(this); ' data-rindex='11' class='val selbox decdhe5'></input><span>TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</span>
</li>
<li><input type='checkbox' id='TLS:decdhe6' onchange='update(this); ' data-rindex='12' class='val selbox decdhe6'></input><span>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</span>
</li>
<li><input type='checkbox' id='TLS:decdhe7' onchange='update(this); ' data-rindex='13' class='val selbox decdhe7'></input><span>TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 as defined in RFC 5289</span>
</li>
<li><input type='checkbox' id='TLS:decdhe8' onchange='update(this); ' data-rindex='14' class='val selbox decdhe8'></input><span>TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5289</span>
</li>
</ul>
</span>
      and also supports functionality for 
      <span class='selectables' data-rindex='2'><input type='checkbox' id='TLS:dtlsc_mutual_auth' onchange='update(this); ' data-rindex='0' class='val selbox dtlsc_mutual_auth'></input><span>mutual authentication</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox exclusive'></input><span>none</span>
</span>.
      </div>
</div><!-- End: TLS:fcs__dtlsc__ext.1.1 -->
<div class='aactivity'>

	
        The evaluator shall perform the evaluation activities listed for FCS_TLSC_EXT.1.1,
        but ensuring that DTLS (and not TLS) is used in each evaluation activity.
        <br/><br/>
        For tests which involve version numbers, note that in DTLS the on-the-wire representation
        is the 1's complement of the corresponding textual DTLS version numbers. This is described in
        Section 4.1 of RFC 6347 and RFC 4347.  For example, DTLS 1.0 is represented by the bytes 0xfe 0xff,
        while the undefined DTLS 1.4 would be represented by the bytes 0xfe 0xfb.
      </div><div id='TLS:fcs__dtlsc__ext.1.2' class='requirement fcs__dtlsc__ext.1.2'><div class='f-el-title'>FCS_DTLSC_EXT.1.2</div><div class='words'> The product shall verify that the presented identifier matches the reference
        identifier according to RFC 6125. </div>
</div><!-- End: TLS:fcs__dtlsc__ext.1.2 -->
<div class='aactivity'>

      
      The evaluator shall perform the evaluation activities listed for FCS_TLSC_EXT.1.2.
      </div><div id='TLS:fcs__dtlsc__ext.1.3' class='requirement fcs__dtlsc__ext.1.3'><div class='f-el-title'>FCS_DTLSC_EXT.1.3</div><div class='words'>The product shall not establish a trusted channel if the
        server certificate is invalid
        <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox exclusive'></input><span>with no exceptions</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>except when override is authorized</span>
</li>
</ul>
</span>.
      </div>
</div><!-- End: TLS:fcs__dtlsc__ext.1.3 -->
<div class='aactivity'>

        
        The evaluator shall perform the evaluation activities listed for FCS_TLSC_EXT.1.3.
      </div><div id='TLS:fcs__dtlsc__ext.1.4' class='requirement fcs__dtlsc__ext.1.4'><div class='f-el-title'>FCS_DTLSC_EXT.1.4</div><div class='words'>The product shall
    <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>terminate the DTLS session</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>silently discard the record</span>
</li>
</ul>
</span>
    if a message received contains an invalid MAC or if decryption fails in the case of GCM and other
    AEAD ciphersuites.
    </div>
</div><!-- End: TLS:fcs__dtlsc__ext.1.4 -->
<div class='aactivity'>

      
      The evaluator shall verify that the TSS describes the actions that take place if a message
      received from the DTLS Server fails the MAC integrity check.
      
      The evaluator shall establish a connection using a server. The evaluator will then modify
      at least one byte in a record message, and verify that the client discards the record or
      terminates the DTLS session.
    </div>
</div></span><!-- End: TLS:fcs__dtlsc__ext.1 -->
<span class='comp-notes'></span><br/><span id='TLS:fcs__dtlsc__ext.2' class='component fcs__dtlsc__ext.2 sel-based disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_DTLSC_EXT.2 &#8212; DTLS Client Support for Mutual Authentication</a>
<div class='reqgroup'>
<div id='TLS:fcs__dtlsc__ext.2.1' class='requirement fcs__dtlsc__ext.2.1'><div class='f-el-title'>FCS_DTLSC_EXT.2.1</div><div class='words'>
              The product shall support mutual authentication using X.509v3 certificates.
            </div>
</div><!-- End: TLS:fcs__dtlsc__ext.2.1 -->
<div class='aactivity'>

	
        The evaluator shall perform the evaluation activities listed for FCS_TLSC_EXT.2.1.
      </div>
</div></span><!-- End: TLS:fcs__dtlsc__ext.2 -->
<span class='comp-notes'></span><br/><span id='TLS:fcs__dtlss__ext.1' class='component fcs__dtlss__ext.1 sel-based disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_DTLSS_EXT.1 &#8212; DTLS Server Protocol</a>
<div class='reqgroup'>
<div id='TLS:fcs__dtlss__ext.1.1' class='requirement fcs__dtlss__ext.1.1'><div class='f-el-title'>FCS_DTLSS_EXT.1.1</div><div class='words'>The product shall implement DTLS 1.2 (RFC 6347) and
      <span class='selectables' data-rindex='0'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>DTLS 1.0 (RFC 4347)</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox exclusive'></input><span>no earlier DTLS versions</span>
</span>
        as a server that supports the ciphersuites
        <span class='selectables' data-rindex='1'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>TLS_RSA_WITH_AES_128_CBC_SHA as defined in RFC 5246</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>TLS_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>TLS_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span>TLS_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5288</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='4' class='val selbox'></input><span>TLS_DHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='5' class='val selbox'></input><span>TLS_DHE_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='6' class='val selbox'></input><span>TLS_DHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5288</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='7' class='val selbox'></input><span>TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='8' class='val selbox'></input><span>TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='9' class='val selbox'></input><span>TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384 as defined in RFC 5289</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='10' class='val selbox'></input><span>TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5289</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='11' class='val selbox'></input><span>TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='12' class='val selbox'></input><span>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='13' class='val selbox'></input><span>TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 as defined in RFC 5289</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='14' class='val selbox'></input><span>TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5289</span>
</li>
</ul>
</span> and no other cipher suites,
        and also supports functionality for
        <span class='selectables' data-rindex='2'><input type='checkbox' id='TLS:dtlss_mutual_auth' onchange='update(this); ' data-rindex='0' class='val selbox dtlss_mutual_auth'></input><span>mutual authentication</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox exclusive'></input><span>none</span>
</span>.
      </div>
</div><!-- End: TLS:fcs__dtlss__ext.1.1 -->
<div class='aactivity'>

	
        The evaluator shall perform the evaluation activities listed for FCS_TLSS_EXT.1.1,
        but ensuring that DTLS (and not TLS) is used in each stage of the evaluation activities.
        <br/><br/>
        For tests which involve version numbers, note that in DTLS the on-the-wire representation
        is the 1's complement of the corresponding textual DTLS version numbers. This is described in
        Section 4.1 of RFC 6347 and RFC 4347.  For example, DTLS 1.0 is represented by the bytes 0xfe 0xff,
        while the undefined DTLS 1.4 would be represented by the bytes 0xfe 0xfb.
      </div><div id='TLS:fcs__dtlss__ext.1.2' class='requirement fcs__dtlss__ext.1.2'><div class='f-el-title'>FCS_DTLSS_EXT.1.2</div><div class='words'>The product shall deny connections from clients requesting
        <textarea onchange='update(this);' class='assignment val' rows='1' placeholder='list of protocol versions'></textarea>.
      </div>
</div><!-- End: TLS:fcs__dtlss__ext.1.2 -->
<div class='aactivity'>

	
        If any DTLS versions are assigned, then the evaluator shall perform the evaluation
        activities listed for FCS_TLSS_EXT.1.2.
      </div><div id='TLS:fcs__dtlss__ext.1.3' class='requirement fcs__dtlss__ext.1.3'><div class='f-el-title'>FCS_DTLSS_EXT.1.3</div><div class='words'>
        The product shall not proceed with a connection handshake attempt if the DTLS Client fails validation.
      </div>
</div><!-- End: TLS:fcs__dtlss__ext.1.3 -->
<div class='aactivity'>

        
        The evaluator shall verify that the TSS describes how the DTLS Client IP address is validated prior to
        issuing a ServerHello message.
        
        Modify at least one byte in the cookie from the Server's HelloVerifyRequest message, and verify that the
        Server rejects the Client's handshake message.
      </div><div id='TLS:fcs__dtlss__ext.1.4' class='requirement fcs__dtlss__ext.1.4'><div class='f-el-title'>FCS_DTLSS_EXT.1.4</div><div class='words'>The product shall perform key establishment for DTLS using
        <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>RSA with size 2048 bits and
            <span class='selectables' data-rindex='1'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>3072 bits</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>4096 bits</span>
<input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox exclusive'></input><span>no other sizes</span>
</span>
          </span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>ECDHE parameters over NIST curves
            <span class='selectables' data-rindex='2'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>secp256r1</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>secp384r1</span>
<input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>secp521r1</span>
</span> and no other curves</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>Diffie-Hellman parameters of size 2048 and
            <span class='selectables' data-rindex='3'><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>3072 bits</span>
<input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>4096 bits</span>
<input type='checkbox' onchange='update(this); ' data-rindex='2' class='val selbox'></input><span>6144 bits</span>
<input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox'></input><span>8192 bits</span>
<input type='checkbox' onchange='update(this); ' data-rindex='4' class='val selbox exclusive'></input><span>no other size</span>
</span>
          </span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='3' class='val selbox exclusive'></input><span>no other key establishment methods</span>
</li>
</ul>
</span>
      </div>
</div><!-- End: TLS:fcs__dtlss__ext.1.4 -->
<div class='aactivity'>

      
        The evaluator shall perform the evaluation activities listed for FCS_TLSS_EXT.1.3.
      </div><div id='TLS:fcs__dtlss__ext.1.5' class='requirement fcs__dtlss__ext.1.5'><div class='f-el-title'>FCS_DTLSS_EXT.1.5</div><div class='words'>The product shall
      <span class='selectables' data-rindex='0'><ul>
<li><input type='checkbox' onchange='update(this); ' data-rindex='0' class='val selbox'></input><span>terminate the DTLS session</span>
</li>
<li><input type='checkbox' onchange='update(this); ' data-rindex='1' class='val selbox'></input><span>silently discard the record</span>
</li>
</ul>
</span>
      if a message received contains an invalid MAC or if decryption fails in the case of GCM and other
      AEAD ciphersuites.
      </div>
</div><!-- End: TLS:fcs__dtlss__ext.1.5 -->
<div class='aactivity'>

        
        The evaluator shall verify that the TSS describes the actions that take place if a message
        received from the DTLS client fails the MAC integrity check.
        
        The evaluator shall establish a connection using a client. The evaluator will then modify
        at least one byte in a record message, and verify that the server discards the record or
        terminates the DTLS session.
      </div>
</div></span><!-- End: TLS:fcs__dtlss__ext.1 -->
<span class='comp-notes'></span><br/><span id='TLS:fcs__dtlss__ext.2' class='component fcs__dtlss__ext.2 sel-based disabled'><span class='f-comp-status'></span>
                <a onclick='toggle(this); return false;' href='#"+id+"' class='f-comp-title'>FCS_DTLSS_EXT.2 &#8212; DTLS Server Support for Mutual Authentication</a>
<div class='reqgroup'>
<div id='TLS:fcs__dtlss__ext.2.1' class='requirement fcs__dtlss__ext.2.1'><div class='f-el-title'>FCS_DTLSS_EXT.2.1</div><div class='words'>
              The product shall support mutual authentication of DTLS clients using X.509v3 certificates.
            </div>
</div><!-- End: TLS:fcs__dtlss__ext.2.1 -->
<div class='aactivity'>

	
          The evaluator shall perform the evaluation activities listed for FCS_TLSS_EXT.2.1.
      </div><div id='TLS:fcs__dtlss__ext.2.2' class='requirement fcs__dtlss__ext.2.2'><div class='f-el-title'>FCS_DTLSS_EXT.2.2</div><div class='words'>The product shall not establish a trusted channel
        if the client certificate is invalid.
      </div>
</div><!-- End: TLS:fcs__dtlss__ext.2.2 -->
<div class='aactivity'>

	
        The evaluator shall perform the evaluation activities listed for FCS_TLSS_EXT.2.2. 
      </div><div id='TLS:fcs__dtlss__ext.2.3' class='requirement fcs__dtlss__ext.2.3'><div class='f-el-title'>FCS_DTLSS_EXT.2.3</div><div class='words'>The product shall not establish a trusted channel if
        the Distinguished Name (DN) or Subject Alternative Name (SAN)
        contained in a certificate does not match one of the expected identifiers
        for the client.
      </div>
</div><!-- End: TLS:fcs__dtlss__ext.2.3 -->
<div class='aactivity'>

        
        The evaluator shall perform the evaluation activities listed for FCS_TLSS_EXT.2.3.
      </div>
</div></span><!-- End: TLS:fcs__dtlss__ext.2 -->
<span class='comp-notes'></span><br/></div><div class='dep:General_Purpose_Operating_System dep:Mobile_Device_Fundamentals '>

        <h2>Download Security Target</h2>
        <button type="button" onclick='handleXmlReport()'>Minimal XML Representation</button>
        <button type="button" onclick='handleHtmlReport()'>Readable HTML Report</button>

       </div>
       </div>
       <div id='report-node' style="display: none;"/>
    </body>
</html>
