<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html><head><title>Supporting Document - 
    PP-Module for MDM Agents</title><style type="text/css">
    #toc a{
        display: block;
    }

    svg{
      width: 100%;
    }

    a[id^="ajq_"]{
        color:black;
    }

    
    body{
       max-width: 900px;
       margin: auto;
    }
    #toc span{
       margin-left: 20px;
    }
    .assignable-content{
      font-style: italic;
    }
    .selection-content{
      font-style: italic;
    }
    .refinement{
      font-weight: bold;
    }
    div.eacategory{
      font-style: italic;
      font-weight: bold;
    }
    .activity_pane .toggler::after, .activity_pane .toggler{
       display: inline-block;
       height: auto;
       content: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8A\
       AAAPCAYAAAA71pVKAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAQOFAAEDhQGl\
       VDz+AAAAB3RJTUUH4gIXFDM7fhmr1wAAAfRJREFUKM+dkk9I02EYxz/P+25uurWR\
       tTkzI4NGl4jQgkq71K1DhnTQIDolRAQFQYSHTtGhU4e6eujQofBSFLOg0C4RUSjh\
       FnmqTTdKpj/mfv/eX4cUpmRYn9vz8v3w8D7PA/AWGADCbI4QcAb4AnAF8IBJEdX+\
       N0tEda40C4AHADviW1LFvpOX6+FwtAacVzqkGiWtwxo4F21OuPu7+yvxRNoDEhpY\
       cpzavkQyc7D76FCk+vN7j7VU6RdR4xAsikjGGP9FKrN3sPfEpajv2i2zhckR4JUG\
       UCr0erFavLkn2ytd2WPxcFOsZb74+SIQA0YPHBqIdB8Z6tChJv1m/N4P33OGAUsD\
       BIFxPNcOkq07jyeSbbo1tTu2q6vHEqU7D/ddSKcz2ZQJjBSmx925b9NjwEMAafha\
       eyQa/3Dq7O0243sCIEoRGAOA59nm5dM7OHVruzH+AkDjYEp23RrLT+U8Ub+fV0UR\
       oVyaMfVa9fqquF5GKX3ja2FCuc6yWbMipYNP755UgEdr8o2FMf5ivVYdKRfzRkRW\
       RfJTOc+2rWdAcUN5hdGP7x8viGgAXLvGbGFCKxW6tj74J3nOqVvP89M5V6kQ86UZ\
       f7lWvWWMt7Sp41VKb21uSfqnB++6kWi8BLTzL4ioq7H4tgC4z3/QAZSBxEaBXygN\
       v+jeFnAPAAAAAElFTkSuQmCC');
       max-width: 15px;
    }


    a {
      text-decoration: none;
      word-wrap: break-word;
    }
    a.abbr:link{
      color:black;
      text-decoration:none;
    }
    a.abbr:visited{
      color:black;
      text-decoration:none;
    }
    a.abbr:hover{
      color:blue;
      text-decoration:none;
    }
    a.abbr:hover:visited{
      color:purple;
      text-decoration:none;
    }
    a.abbr:active{
      color:red;
      text-decoration:none;
    }
    .note-header{
      font-weight: bold;
    }
    .note p:first-child{
      display: inline;
    }

    .indent{ margin-left:2em; }

    /* Tooltip container */
    .tooltipped {
       position: relative;
       display: inline-block;
       border-bottom: 1px dotted black; /* If you want dots under the hoverable text */
    }

    /* Tooltip text */
    .tooltiptext {
       visibility: hidden;
       width: 120px;
       background-color: black;
       color: #fff;
       text-align: center;
       padding: 5px 0;
       border-radius: 6px;

       /* Position the tooltip text - see examples below! */
       position: absolute;
       z-index: 1;
   }

   /* Show the tooltip text when you mouse over the tooltip container */
   .tooltipped:hover .tooltiptext {
       visibility: visible;
   }
   tr.major-row{
       border-top-style: double;
   }
   tr.major-row td:first-child{
       border-right-style: ridge;
       background-color: white;
   } 
   table.mfs td{
       text-align: center;
   }
   table.mfs td:first-child{
       text-align: left;
   }
  .table-caption, caption{
       text-align: center;
       font-weight: bold;
   }
   table{
       margin:auto;
       margin-top:1em;
       border-collapse:collapse; /*border: 1px solid black;*/
   }
   td{
       text-align:left;
       padding:8px 8px;
   }
   th{
       padding:8px 8px;
   }
   thead tr td{
       text-align: center;
       font-style: oblique;
       font-weight: bold;
   }
   tr.header{
       border-bottom:3px solid gray;
       padding:8px 8px;
       text-align:left;
       font-weight:bold; /*font-size: 90%; font-family: verdana, arial, helvetica, sans-serif; */
   }
   table tr:nth-child(2n+2){
       background-color:#F4F4F4;
   }

   .dependent{
       border: 1px solid gray;
       border-radius: 1px
   }
   .dependent-content{
       margin-left: 25px;
       font-style: italic;
   }

   .uc_table_or td, .uc_table_or tr {
       vertical-align: middle;
       border: 1px solid black;
       background-color: white;
   }

   .uc_not, .uc_mf, .uc_sel, .uc_guide{
       text-indent: 10px;
   }
   .uc_sel &gt; a{ 
       font-style: italic;
   }

   .uc_not_sel, .uc_sel.uc_mf, uc_assign.uc_mf{
       text-indent: 20px;
   }


   .uc_table_or tr td.or_cell{
      white-space: nowrap;
      border-radius: 0.6em 0 0 0.6em;
      background-color: black;
      color: white;
   }

   .uc_table_and, .uc_table_or {
       width: 100%;
       background-color: white;
   }
   .uc_guidance{
       display: table;
       background-color: gray;
   }  
   div.uc_inc_fcomp{
       display: list-item;
       list-style-type: disc;
       list-style-position: inside;
       }

   div.validationguidelines_label{
        padding-top: 10px;
   }
	
   .evidence, .test-obj { font-style: normal; font-size: 90%;}
   
   
	table.classic {
    	width: 100%;
    	background-color: white;
    	border-collapse: collapse;
    	border-width: 2px;
  		border-color: gray;
  		border-style: solid;
  		color: black;
		font-size: small;
	}
    table.classic th {
  		background-color: lightgray;   
	}
    table.classic th:empty{
	    background-color: white;
		border-top: none;
		border-left: none;
	}
	table.classic td, table.classic th {
  		border-width: 2px;
  		border-color: gray;
  		border-style: solid;
  		padding: 5px;
	}

   
   
   </style></head><body><div style="text-align: center; margin-left: auto; margin-right: auto;"><h1 class="title" style="page-break-before:auto;">Supporting Document<br/>
        Mandatory Technical Document</h1><img src="images/niaplogo.png" alt="NIAP"></img><hr width="50%"></hr><noscript><h1 style="text-align:center; border-style: dashed; border-width: medium; border-color: red;">This page is best viewed with JavaScript enabled!</h1></noscript><br/>
    PP-Module for MDM Agents<br/>
      Version: 1.0<br/>2019-04-25<br/><b>National Information Assurance Partnership</b></div><div class="foreword"><h1 style="text-align: center">Foreword</h1><p>This is a Supporting Document (SD), intended to complement the Common Criteria version 3
      and the associated Common Evaluation Methodology for
      Information Technology Security Evaluation.</p><p>SDs may be “Guidance Documents”, that highlight specific approaches 
      and application of the standard to areas where no mutual recognition of
      its application is required, and as such, are not of normative nature, 
      or “Mandatory Technical Documents”, whose application is mandatory for evaluations 
      whose scope is covered by that of the SD.
      The usage of the latter class is not only mandatory, but certificates
      issued as a result of their application are recognized under the CCRA.</p><p><b>Technical Editor:</b><br/>
      National Information Assurance Partnership (NIAP)
      </p><p><b style="page-break-before:always;">Document history:</b><table><tr class="header"><th>Version</th><th>Date</th><th style="align:left;">Comment</th></tr><tr><td>1.0</td><td>2013-10-21</td><td>Initial Release</td></tr><tr><td>1.1</td><td>2014-02-07</td><td>Typographical changes and clarifications to front-matter</td></tr><tr><td>2.0</td><td>2014-12-31</td><td>Separation of MDM Agent SFRs. Updated cryptography, protocol, X.509 requirements.
        Added objective requirement for Agent audit storage. New requirement for unenrollment
        prevention. Initial Release of MDM Agent EP.</td></tr><tr><td>3.0</td><td>2016-11-21</td><td> Updates to align with Technical Decisions. Added requirements to support BYOD use
        case. </td></tr><tr><td>4.0</td><td>2019-03-01</td><td> Convert to
        PP-Module. </td></tr></table></p><p><b>General Purpose:</b><br/>
      The purpose of this SD is to define evaluation methods for the functional behavior of 
      MDM Agents  products.
      </p><p><b>Acknowledgments:</b><br/>
      This SD was developed with support from NIAP 
      MDM Agents Technical Community members, with representatives from industry, government 
      agencies, Common Criteria Test Laboratories, and members of academia.
      </p></div><h1>Table of Contents</h1><div id="toc"><a href="#introduction" style="text-indent:0px">1<span>Introduction</span></a><a href="#scope" style="text-indent:10px">1.1<span>Technology Area and Scope of Supporting Document</span></a><a href="#structure" style="text-indent:10px">1.2<span>Structure of the Document</span></a><a href="#glossary" style="text-indent:10px">1.3<span>Terms</span></a><a href="#cc-terms" style="text-indent:20px">1.3.1<span>Common Criteria Terms</span></a><a href="#tech-terms" style="text-indent:20px">1.3.2<span>Technical Terms</span></a><a href="#sfr" style="text-indent:0px">2<span>Evaluation Activities for SFRs</span></a><a href="#aa-" style="text-indent:10px">2.1<span>
    Protection Profile for Mobile Device Fundamentals</span></a><a href="#qq-sfrs--Modified" style="text-indent:20px">2.1.1<span>Modified SFRs
        </span></a><a href="#qq-sfrs--Additional" style="text-indent:20px">2.1.2<span>Additional SFRs
        </span></a><a href="#aa-" style="text-indent:10px">2.2<span>
    Protection Profile for Mobile Device Management</span></a><a href="#qq-sfrs--Modified" style="text-indent:20px">2.2.1<span>Modified SFRs
        </span></a><a href="#qq-sfrs--Additional" style="text-indent:20px">2.2.2<span>Additional SFRs
        </span></a><a href="#man-sfrs" style="text-indent:10px">2.3<span>TOE SFR Evaluation Activities</span></a><a href="#opt-sfrs" style="text-indent:10px">2.4<span>Evaluation Activities for Optional SFRs</span></a><a href="#sel-sfrs" style="text-indent:10px">2.5<span>Evaluation Activities for Selection-Based SFRs</span></a><a href="#obj-sfrs" style="text-indent:10px">2.6<span>Evaluation Activities for Objective SFRs</span></a><a href="#sar_aas" style="text-indent:0px">3<span>Evaluation Activities for SARs</span></a><a href="#sup-info" style="text-indent:0px">4<span>Required Supplementary Information</span></a><a href="#biblio" style="text-indent:0px">Appendix A - <span>References</span></a></div><h1 id="introduction" class="indexable" data-level="0">1 Introduction</h1><h2 id="scope" class="indexable" data-level="1">1.1 Technology Area and Scope of Supporting Document</h2><p>The scope of the 
    PP-Module for MDM Agents is
    to describe the security functionality of 
      MDM Agents products in terms of 
    [CC] and to define functional and assurance requirements for them.

    
    The PP-Module is intended for use with the following Base-PPs:
        <ul><li><a href="https://www.niap-ccevs.org/Profile/Info.cfm?PPID=417&amp;id=417">
    Protection Profile for Mobile Device Fundamentals, Version 3.1</a></li><li><a href="https://www.niap-ccevs.org/Profile/Info.cfm?PPID=392&amp;id=392">
    Protection Profile for Mobile Device Management, Version 4.0</a></li></ul><br/>
    This SD is mandatory for evaluations of TOEs that claim conformance to a PP-Configuration that includes the PP-Module for :
    <ul><li>MDM Agents, Version 1.0</li></ul>
    As such it defines Evaluation Activities for the functionality described in the PP-Module as well as any impacts to the Evaluation Activities to the Base-PP(s) it modifies.
    </p><p> 
Although Evaluation Activities are defined mainly for the evaluators to follow, in general they also help developers to prepare for evaluation by identifying specific requirements for their TOE.
    The specific requirements in Evaluation Activities may in some cases clarify the meaning of Security
    Functional Requirements (SFR), and may identify particular requirements for the content of Security
    Targets (ST) (especially the TOE Summary Specification), user guidance documentation, and possibly
    supplementary information (e.g. for entropy analysis or cryptographic key management architecture).</p><h2 id="structure" class="indexable" data-level="1">1.2 Structure of the Document</h2><p>Evaluation Activities can be defined for both SFRs and Security Assurance Requirements (SAR),
    which are themselves defined in separate sections of the SD.</p><p>If any Evaluation Activity cannot be successfully completed in an evaluation, then
    the overall verdict for the evaluation is a 'fail'.
    In rare cases there may be acceptable reasons why an Evaluation Activity
    may be modified or deemed not applicable for a particular TOE, 
    but this must be approved by the Certification Body for the evaluation.</p><p>In general, if all Evaluation Activities (for both SFRs and SARs) are successfully
    completed in an evaluation then it would be expected that the overall verdict for 
    the evaluation is a ‘pass’.
    To reach a ‘fail’ verdict when the Evaluation Activities have been successfully 
    completed would require a specific justification from the evaluator as to why the 
    Evaluation Activities were not sufficient for that TOE.
    </p><p>Similarly, at the more granular level of assurance components, if the Evaluation 
    Activities for an assurance component and all of its related SFR Evaluation 
    Activities are successfully completed in an evaluation then it would be expected 
    that the verdict for the assurance component is a ‘pass’.
    To reach a ‘fail’ verdict for the assurance component when these Evaluation 
    Activities have been successfully completed would require a specific justification 
    from the evaluator as to why the Evaluation Activities were not sufficient for that TOE. 
    </p><h2 id="glossary" class="indexable" data-level="1">1.3 Terms</h2>
The following sections list Common Criteria and technology terms used in this document.
    <h3 id="cc-terms" class="indexable" data-level="2">1.3.1 Common Criteria Terms</h3><table><tr><td><div id="Assurance">Assurance</div></td><td>Grounds for confidence that a TOE meets the SFRs <a href="#bibCC">[CC]</a>.</td></tr>
<tr><td><div id="Base_Protection_Profile">Base Protection Profile (Base-PP)</div></td><td>Protection Profile used as a basis to build a PP-Configuration.</td></tr>
<tr><td><div id="Collaborative_Protection_Profile">Collaborative Protection Profile (cPP)</div></td><td>A Protection Profile developed by
    international technical communities and approved by multiple schemes</td></tr>
<tr><td><div id="Common_Criteria">Common Criteria (CC)</div></td><td>Common Criteria for Information Technology Security Evaluation (International Standard ISO/IEC 15408).</td></tr>
<tr><td><div id="Common_Criteria_Testing_Laboratory">Common Criteria Testing Laboratory</div></td><td>
      Within the context of the Common Criteria Evaluation and Validation Scheme (CCEVS), an IT security evaluation facility, accredited by the National Voluntary Laboratory Accreditation Program (NVLAP) and approved by the NIAP Validation Body to conduct Common Criteria-based evaluations.
    </td></tr>
<tr><td><div id="Common_Evaluation_Methodology">Common Evaluation Methodology (CEM)</div></td><td>Common Evaluation Methodology for Information Technology Security Evaluation.</td></tr>
<tr><td><div id="Distributed_TOE">Distributed TOE</div></td><td>A TOE composed of multiple components operating as a logical whole.</td></tr>
<tr><td><div id="Extended_Package">Extended Package (EP)</div></td><td>A deprecated document form for collecting SFRs that implement a particular protocol, technology,
	    or functionality. See Functional Packages.</td></tr>
<tr><td><div id="Functional_Package">Functional Package (FP)</div></td><td>A document that collects SFRs for a particular protocol, technology,
	    or functionality.</td></tr>
<tr><td><div id="Operational_Environment">Operational Environment (OE)</div></td><td>Hardware and software that are outside the TOE boundary that support the TOE functionality and security policy.</td></tr>
<tr><td><div id="Protection_Profile">Protection Profile (PP)</div></td><td>An implementation-independent set of security requirements for a category of products.</td></tr>
<tr><td><div id="Protection_Profile_Configuration">Protection Profile Configuration (PP-Configuration)</div></td><td>A comprehensive set of security requirements for a product type that consists of at least one Base-PP and at least one PP-Module.</td></tr>
<tr><td><div id="Protection_Profile_Module">Protection Profile Module (PP-Module)</div></td><td>An implementation-independent statement of security needs for a TOE type complementary to one or more Base Protection Profiles.</td></tr>
<tr><td><div id="Security_Assurance_Requirement">Security Assurance Requirement (SAR)</div></td><td>A requirement to assure the security of the TOE.</td></tr>
<tr><td><div id="Security_Functional_Requirement">Security Functional Requirement (SFR)</div></td><td>A requirement for security enforcement by the TOE.</td></tr>
<tr><td><div id="Security_Target">Security Target (ST)</div></td><td>A set of implementation-dependent security requirements for a specific product.</td></tr>
<tr><td><div id="Target_of_Evaluation">Target of Evaluation (TOE)</div></td><td>The product under evaluation. </td></tr>
<tr><td><div id="TOE_Security_Functionality">TOE Security Functionality (TSF)</div></td><td>The security functionality of the product under evaluation.</td></tr>
<tr><td><div id="TOE_Summary_Specification">TOE Summary Specification (TSS)</div></td><td>A description of how a TOE satisfies the SFRs in an ST.</td></tr>
</table><h3 id="tech-terms" class="indexable" data-level="2">1.3.2 Technical Terms</h3><table style="width: 100%"><tr><td><div id="Administrator">Administrator</div></td><td>The person who is responsible for management activities, including setting
            the policy that is applied by the enterprise on the mobile device.</td></tr>
<tr><td><div id="Enrolled_State">Enrolled State</div></td><td>The state in which a mobile device is managed by a policy from an MDM.</td></tr>
<tr><td><div id="Mobile_Application_Store">Mobile Application Store (MAS)</div></td><td>Mobile Application Store</td></tr>
<tr><td><div id="Mobile_Device_Management">Mobile Device Management (MDM)</div></td><td>Mobile Device Management</td></tr>
<tr><td><div id="Mobile_Device_User">Mobile Device User</div></td><td>The person who uses and is held responsible for a mobile device.</td></tr>
<tr><td><div id="Operating_System">Operating System</div></td><td>
	      Software which runs at the highest privilege level and can directly control
              hardware resources. Modern mobile devices typically have at least two primary
              operating systems: one which runs on the cellular baseband processor and one which
              runs on the application processor. The platform of the application processor handles
              most user interaction and provides the execution environment for apps. The platform of
              the cellular baseband processor handles communications with the cellular network and
              may control other peripherals. The term OS, without context, may be assumed to refer
              to the platform of the application</td></tr>
<tr><td><div id="Unenrolled_State">Unenrolled State</div></td><td>
		The state in which a mobile device is not managed by an MDM system.
	      </td></tr>
<tr><td><div id="User">User</div></td><td>See Mobile Device User.</td></tr>
</table><h1 id="sfr" class="indexable" data-level="0">2 Evaluation Activities for SFRs</h1><p>The EAs presented in this section capture the actions the evaluator performs 
    to address technology specific aspects covering specific SARs (e.g. ASE_TSS.1, 
    ADV_FSP.1, AGD_OPE.1, and ATE_IND.1) – this is in addition to the CEM workunits 
    that are performed in Section <a href="#sar_aas" class="dynref">3 Evaluation Activities for SARs</a>.</p><p>Regarding design descriptions (designated by the subsections labeled TSS, as 
    well as any required supplementary material that may be treated as proprietary), 
    the evaluator must ensure there is specific information that satisfies the EA. 
    For findings regarding the TSS section, the evaluator’s verdicts will be 
    associated with the CEM workunit ASE_TSS.1-1.
    Evaluator verdicts associated with the supplementary evidence will also be 
    associated with ASE_TSS.1-1, 
    since the requirement to provide such evidence is specified in ASE in the PP.</p><p>For ensuring the guidance documentation provides sufficient information for 
    the administrators/users as it pertains to SFRs, the evaluator’s verdicts will 
    be associated with CEM workunits ADV_FSP.1-7, AGD_OPE.1-4, and AGD_OPE.1-5.</p><p>Finally, the subsection labeled Tests is where the authors have determined 
    that testing of the product in the context of the associated SFR is necessary.
    While the evaluator is expected to develop tests, there may be instances where 
    it is more practical for the developer to construct tests, or where the 
    developer may have existing tests. 
    Therefore, it is acceptable for the evaluator to witness developer-generated 
    tests in lieu of executing the tests. 
    In this case, the evaluator must ensure the developer’s tests are executing both 
    in the manner declared by the developer and as mandated by the EA. 
    The CEM workunits that are associated with the EAs specified in this section 
    are: ATE_IND.1-3, ATE_IND.1-4, ATE_IND.1-5, ATE_IND.1-6, and ATE_IND.1-7.</p><h2 class="indexable" data-level="1" id="aa-">2.1 
    Protection Profile for Mobile Device Fundamentals</h2>
      The EAs defined in this section are only applicable in cases where the TOE claims conformance
      to a PP-Configuration that includes the MDF PP.
     <h3 class="indexable" data-level="2" id="qq-sfrs--Modified">2.1.1 Modified SFRs
        </h3>
	  The PP-Module does not modify any requirements when the 
	  MDF PP is the base.
	<h3 class="indexable" data-level="2" id="qq-sfrs--Additional">2.1.2 Additional SFRs
        </h3>
        
          
             This family is defined in both the MDF and the MDM s. This  augments the extended family by adding one additional component, FCS_STG_EXT.4. This new component and its impact on the extended family’s component leveling are shown below; reference the MDF or MDM PP for all other definitions for this family. 
          
          
             This SFR requires the  Agent to use
              functionality defined by the  in FCS_CKM_EXT.1. 
             requires the TSF to define a specific location for its key
              storage.
            There are no management functions foreseen.
            There are no auditable events foreseen.
            FCS_CKM.1 Cryptographic Key Generation
            
              The  Agent shall use the platform provided key storage for
                all persistent secret and private keys.
              This requirement ensures that persistent secrets
                (credentials, secret keys) and private keys are stored securely when not in use by
                the mobile platform. 
              
                 The evaluator will verify that the  lists each persistent
                  secret (credential, secret key) and private key needed to meet the requirements in
                  the . For each of these items, the evaluator will confirm that
                  the  lists for what purpose it is used, and, for each
                  platform listed as supported in the , how it is stored. The
                  evaluator shall verify that the Agent calls a platform-provided API to store
                  persistent secrets and private keys. 
              
            
          
        
        
          
             The  defines FTP_ITC_EXT.1 to define the secure protocols used for trusted channel communications. This  iterates the SFR to specify a subset of these protocols that may be used for  Agent communications in particular. 
            
              Refinement: The TSF shall use 
                  mutually authenticated TLS client as defined in the Package for
                    Transport Layer Security
                  mutually authenticated DTLS client as defined in the Package for
                    Transport Layer Security
                  HTTPS
                 to provide a communication channel between itself and another trusted
                IT product that is logically distinct from other communication channels, provides
                assured identification of its end points, protects channel data from disclosure, and
                detects modification of the channel data.
               The intent of this requirement is to protect the
                communications channel between  Server and Agent, post
                enrollment.  is to protect the communications
                channel between  Server and Agent during enrollment.
                 This requirement is to ensure that the transmission of any audit
                logs, mobile device information data (software version, hardware model, and
                application versions), and configuration data collected by the 
                Agent and sent from the  Agent to the 
                Server, when commanded, or at configurable intervals, is properly protected. This
                trusted channel also protects any commands and policies sent by the  Server to the  Agent. Either the  Agent or the  Server is able to initiate the
                connection. This requirement is iterated from the MDF  to indicate the protocols that the MDM Agent can use for a trusted
                channel. The mobile device is required to perform the mandated cryptographic
                protocols as in the  for communication channels mandated in
                the MDF . The  author must select one of
                TLS, DTLS, or HTTPS in order to establish and maintain a trusted channel between the
                   Agent and the  Server. Only TLS, DTLS,
                or HTTPS are acceptable for this trusted channel. Since this
                requirement is only for the case when the  builds on MDF
                PP and in this case it is expected that the  Agent will be a
                native part of the mobile operating system, it is expected that the  Agent will utilize the mobile device's implementation of the
                selected protocols. HTTPS (FCS_HTTPS_EXT.1) and TLS (FCS_TLSC_EXT.1) are already
                mandatory for a MDF ST. If "TLS" or "DTLS" is selected the following selections from
                the TLS Functional Package must be made: 
                  FCS_TLS_EXT.1: 
                      either TLS or DTLS is selected depending on the selection made in
                        FTP_ITC_EXT.1.1
                      client must be selected
                    
                  
                  FCS_TLSC_EXT.1.1: 
                      The cipher suites selected must correspond with the algorithms and
                        hash functions allowed in FCS_COP.1 from the MDF PP.
                      mutual authentication must be selected
                    
                  
                 Protocol, RBG, Certificate validation, algorithm, and similar services may
                be met with platform provided services. 
              
            
            
              Refinement: The  shall permit the TSF and the 
                Server and 
                  MAS Server
                  no other IT entities
                 to initiate communication via the trusted channel.
               For all other use cases, the mobile device initiates the
                communication; however, for  Agents, the 
                Server may also initiate communication.
            
            
              Refinement: The TSF shall initiate communication via the trusted channel for all
                communication between the MDM Agent and the MDM Server and 
                  all communication between the MAS Server and the MDM
                    Agent
                  no other communication
                
              
               This element is iterated from the MDF ;
                it is expected that the mobile device will initiate the trusted channel between the MDM
                Agent and the MDM Server for administrative communication and may initiate other
                trusted channels to other trusted IT entities for other uses.
              
                The evaluator shall examine the  to determine that the
                  methods of Agent-Server communication are indicated, along with how those
                  communications are protected. The evaluator shall also confirm that all protocols
                  listed in the  in support of remote 
                  administration are consistent with those specified in the requirement, and are
                  included in the requirements in the .
                
                 The evaluator shall confirm that the operational guidance contains
                  instructions for configuring the communication channel between the MDM Agent and
                  the MDM Server and conditionally, the MAS Server for each supported
                  method.
                
                For each supported identifier type (excluding DNs), the evaluator shall
                  repeat the following tests:
                  
                    The evaluators shall ensure that communications using each specified (in
                      the operational guidance) Agent-Server communication method is tested during
                      the course of the evaluation, setting up the connections as described in the
                      operational guidance and ensuring that communication is
                      successful.
                    
                    The evaluator shall ensure, for each method of Agent-Server communication,
                      the channel data is not sent in plaintext.
                    
                    The evaluator shall ensure, for each communication channel with the MDM
                      Server, that a protocol analyzer identifies the traffic as the protocol under
                      testing.
                    
                   
                    
                    Further evaluation activities are associated with the specific protocols.
                
              
            
          
          
            This SFR uses the trusted channel protocols defined by the  in FTP_ITC_EXT.1 to facilitate a trusted path that the  Agent can use to enroll the mobile device it runs on into
              management. Even though the  does not define FTP_TRP.1, the
              requirement was given an iteration label for consistency with the  Server requirement of the same name. 
            
              Refinement: The TSF shall use 
                  TLS client as defined in the Package for Transport Layer Security
                  HTTPS
                 to provide a trusted communication path between itself and another
                trusted IT product that is logically distinct from other communication paths and
                provides assured identification of its endpoints and protection of the communicated
                data from disclosure and detection of modification of the communicated data from
                [modification, disclosure]. 
            
            
              Refinement: The TSF shall permit MD users to initiate communication via the trusted path.
              
            
            
              Refinement: The TSF shall require the use of the trusted path for [[all MD user actions]]. 
              
               This requirement ensures that authorized MD users initiate
                all communication with the  via a trusted path, and that all
                communications with the  by MD users is performed over this
                path. The purpose of this connection is for enrollment by the MD user.
                 The  author chooses the mechanism or
                mechanisms supported by the . The data passed in this trusted
                communication channel are encrypted as defined by the protocol selected.
                 Since this requirement is only for the case when the  builds on MDF PP and in this case it is expected that the
                   Agent will be a native part of the mobile operating system,
                it is expected that the  Agent will utilize the mobile device's
                implementation of the selected protocols. HTTPS (FCS_HTTPS_EXT.1) and TLS
                (FCS_TLSC_EXT.1) are already mandatory for a MDF ST. If "TLS" or "DTLS" is selected
                the following selections from the TLS Functional Package must be made: 
                
                
                  FCS_TLS_EXT.1: 
                      TLS must be selected
                      client must be selected
                    
                  
                  FCS_TLSC_EXT.1.1: 
                      The cipher suites selected must correspond with the algorithms and
                        hash functions allowed in FCS_COP.1 from the MDF PP.
                    
                  
                
              
              
                The evaluator shall examine the  to determine that the
                  methods of remote enrollment are indicated, along with how those communications
                  are protected. The evaluator shall also confirm that all protocols listed in the
                     in support of enrollment are consistent with those
                  specified in the requirement, and are included in the requirements in the .
                
                The evaluator shall confirm that the operational guidance contains
                  instructions for establishing the enrollment sessions for each supported
                  method.
                
                For each  Agent/platform listed as supported in the
                    : 
                  
                    The evaluators shall ensure that communications using each specified (in
                      the operational guidance) enrollment method is tested during the course of the
                      evaluation, setting up the connections as described in the operational
                      guidance and ensuring that communication is successful.
                    
                    For each method of enrollment supported, the evaluator shall follow the
                      operational guidance to ensure that there is no available interface that can
                      be used by a remote user to establish enrollment sessions without invoking the
                      trusted path.
                    
                    The evaluator shall ensure, for each method enrollment, the channel data
                      is not sent in plaintext.
                    
                   
                    
                    Further evaluation activities are associated with the specific protocols.
                
              
            
          
        
      <h2 class="indexable" data-level="1" id="aa-">2.2 
    Protection Profile for Mobile Device Management</h2>
      The EAs defined in this section are only applicable in cases where the TOE claims conformance
      to a PP-Configuration that includes the MDM PP.
     <h3 class="indexable" data-level="2" id="qq-sfrs--Modified">2.2.1 Modified SFRs
        </h3>
	  The PP-Module does not modify any requirements when the 
	  MDM PP is the base.
	<h3 class="indexable" data-level="2" id="qq-sfrs--Additional">2.2.2 Additional SFRs
        </h3>
        
          
            
             The  requires the TOE to define a
              method of key storage. This  iterates it to specify the use
              of platform key storage for  Agents. 
            
              Refinement: The MDM Agent shall use the [platform-provided key storage] for all persistent
                secret and private keys.
               This requirement ensures that persistent secrets
                (credentials, secret keys) and private keys are stored securely when not in use by
                the mobile platform.
              
              
                 The evaluator will verify that the  lists each persistent
                  secret (credential, secret key) and private key needed to meet the requirements in
                  the . For each of these items, the evaluator will confirm that
                  the  lists for what purpose it is used, and, for each
                  platform listed as supported in the , how it is stored. The
                  evaluator shall verify that the Agent calls a platform-provided API to store
                  persistent secrets and private keys.
                
              
            
          
        

      <h2 class="indexable" data-level="1" id="man-sfrs">2.3 TOE SFR Evaluation Activities</h2>
        
           This family is defined in the 
            . This  augments the extended family
            by adding one additional component, FAU_ALT_EXT.2. This new component and its impact on
            the extended family’s component leveling are shown below; reference the  PP for all other definitions for this family. 
        
        
          
          requires the TSF to define when and how an  Agent generates
            alerts and transmits them to an  Server based on its
            activity.
          The following actions could be considered for the management functions in FMT: 
              Ability to configure the specific events that result in generation of
                alerts.
            
          
           The following actions should be auditable if FAU_GEN Security audit data
            generation is included in the PP/ST:
              Minimal: Success/failure of sending alert. 
            
          
           FAU_ALT_EXT.1 Server Alerts [FPT_ITT.1(2) Basic Internal TSF Data
            Transfer Protection; or FTP_ITC.1 Inter-TSF Trusted Channel] 
          
            The  Agent shall provide an alert via the trusted channel to
              the  Server in the event of any of the following audit events: 
                successful application of policies to a mobile device,
                
                  
                    receiving
                    generating
                   periodic reachability events, 
                
                  change in enrollment state
                  failure to install an application from the MAS Server
                  failure to update an application from the MAS Server
                  other events
                  no other events
                .
              
            
             The trusted channel is defined in FPT_ITT.1(2) of the  if Agent extends  Server and FTP_ITC_EXT.1 if Agent extends MDF . “Alert” in this requirement could be as simple as an audit record or
              a notification. If any prior alerts exist in the queue, per FAU_ALT_EXT.2.2, those
              alerts must be sent when the trusted channel is available. This
              requirement is to ensure that the  Agent must notify the  Server whenever one of the events listed above occurs. Lack of
              receipt of a successful policy installation indicates the failure of the policy
              installation. The periodic reachability events ensure that either
              the  Agent responds to  Server polls to
              determine device network reachability, or the  Agent can be
              configured to regularly notify the Server that it is reachable. The  author must select “receiving” in the first case and “generating” in the second.
              The corresponding requirement for the  Server is FAU_NET_EXT.1 in
              the 
              . The  author must either
              assign further events or select the “no other events” option. Note that alerts may
              take time to reach the  Server, or not arrive, due to poor
              connectivity. 
                        
          
          
            The MDM Agent shall queue alerts if the trusted channel is not available.
            If the trusted channel is not available, alerts must be queued. When the trusted channel becomes available, the queued alerts must be sent.
            
            
                                
                  The evaluator shall examine the  and verify that it describes how the alerts are implemented. 
                  The evaluator shall examine the  and verify that it describes how the candidate policy updates are obtained and the actions that take place for successful (policy update installed) and unsuccessful (policy update not installed) cases. The software components that are performing the processing must also be identified in the  and verified by the evaluator. 
                  The evaluator also ensures that the  describes how reachability events are implemented, and if configurable are selected in FMT_SMF_EXT.4.2. The evaluator verifies that this description clearly indicates who ( Agent or  Server) initiates reachability events. 
                  The evaluator shall ensure that the  describes under what circumstances, if any, the alert may not be generated (e.g., the device is powered off or disconnected from the trusted channel), how alerts are queued, and the maximum amount of storage for queued messages.
              
              
                  
                      The evaluator shall perform a policy update from the test environment  server. The evaluator shall verify the  Agent accepts the update, makes the configured changes, and reports the success of the policy update back to the  Server.
                      The evaluator shall perform each of the actions listed in FAU_ALT_EXT.2.1 and verify that the alert does in fact reach the  Server.
                      The evaluator shall configure the  Agent to perform a network reachability test, both with and without such connectivity and ensure that results reflect each.
                      The evaluator shall remove network connectivity from the MDM Agent and generate an alert/event as defined in FAU_ALT_EXT.2.1. The evaluator shall restore network connectivity to the MDM Agent and verify that the alert generated while the  was disconnected is sent by the MDM Agent upon re-establishment of the connectivity.
                  
              
            
          
        
        
          
          
            Refinement: The  Agent shall 
                invoke platform-provided functionality
                implement functionality
               to generate an  Agent audit record of the
              following auditable events: 
                Startup and shutdown of the  Agent;
                All auditable events for [not specified] level of audit; and
                [ policy updated, any modification commanded by the 
                   Server, specifically defined auditable events listed in 
                  , and 
                  other events
                  no other events
                ].
              
            
             This requirement outlines the information to be included in
              the  Agent’s audit records. The  author can
              include other auditable events directly in the Auditable Events table in
              FAU_GEN.1.1(2); they are not limited to the list presented.
               policy update must minimally indicate that an update to policy
              occurred. The event record need not contain the differences between the prior policy
              and the new policy; optionally, the specific change(s) to policy that were included in
              that update may be detailed. All updates to policy should trigger this alert.
              Modifications commanded by the  Server are those commands listed
              in FMT_SMF.1.1. The selection for the FMT_UNR_EXT.1 auditable event
              in the Auditable Events table corresponds to the selection in FMT_UNR_EXT.1. If “apply
              remediation actions” is selected in FMT_UNR_EXT.1, then the 
              author selects “attempt to unenroll” in FAU_GEN.1.1(2) Auditable Events table for
              FMT_UNR_EXT.1; otherwise, "none" is selected.
               Auditable Events
              
                
                  Requirement
                  Auditable Events
                  Additional Audit Record Contents
                
                
                  FAU_ALT_EXT.2
                  Success/failure of sending alert.
                  No additional information.
                
                
                  FAU_GEN.1
                  None.
                  N/A
                
                
                  FAU_SEL.1
                  All modifications to the audit configuration that occur while the audit
                    collection functions are operating.
                  No additional information.
                
                
                  FCS_STG_EXT.4/ FCS_STG_EXT.1(2)
                  None.
                  
                
                
                  FCS_TLSC_EXT.1
                  Failure to establish a TLS session.Reason for failure.
                Failure to verify presented identifier.Presented identifier and reference identifier.
                Establishment/termination of a TLS session.Non-TOE endpoint of connection.
                
                
                  FIA_ENR_EXT.2
                  Enrollment in management.
                  Reference identifier of  Server.
                
                
                  FMT_POL_EXT.2
                  Failure of policy validation.
                  Reason for failure of validation.
                
                
                  FMT_SMF_EXT.4
                  Outcome (Success/failure) of function.
                  No additional information.
                
                
                  FMT_UNR_EXT.1.1
                  
                    
                      Attempt to unenroll
                      none
                    
                  
                  No additional information.
                
                
                  FTP_ITC_EXT.1(2)
                  Initiation and termination of trusted channel.
                  Trusted channel protocol. Non-TOE endpoint of connection.
                
              
              
                        
          
          
            Refinement: The 
                TSF
                TOE platform
               shall record within each  Agent audit record at
              least the following information: 
                Date and time of the event, type of event, subject identity, (if relevant) the outcome 
                  (success or failure) of the event, and additional information in ; and         
                For each audit event type, based on the auditable event definitions of the functional components 
                  included in the PP-Module/ST, other audit relevant information.
              
            
            All audits must contain at least the information mentioned in
              FAU_GEN.1.2(2), but may contain more information which can be assigned. The  author must identify in the  which information
              of the audit record that is performed by the  Agent and that
              which is performed by the  Agent’s platform.
            
            
              
                  The evaluator shall check the  and ensure that it provides a format for audit records. Each audit record format type must be covered, along with a brief description of each field.  
                  If "invoke platform-provided functionality" is selected, the evaluator shall examine the  to verify that it describes (for each supported platform) how this functionality is invoked (it should be noted that this may be through a mechanism that is not implemented by the  Agent; nonetheless, that mechanism will be identified in the  as part of this evaluation activity). 
              
              
                  The evaluator shall use the  to perform the auditable
                  events defined in the Auditable Events table in FAU_GEN.1.1(2) and observe that
                  accurate audit records are generated with contents and formatting consistent with
                  those described in the . Note that this testing can be
                  accomplished in conjunction with the testing of the security mechanisms
                  directly.                                 
              
            
          
        
        
          
          
            Refinement: The  shall 
                invoke platform-provided functionality
                implement functionality
               to select the set of events to be audited from the set of all auditable
              events based on the following attributes: 
                [event type]
                [success of auditable security events, failure of auditable security events, 
                  other attributes].
              
            The intent of this requirement is to identify all criteria that
              can be selected to trigger an audit event. For the  author, the
              assignment is used to list any additional criteria or “no other attributes”. This selection may be
              configured by the MDM Server.
            
            
              If "invoke platform-provided functionality" is selected, the evaluator shall
                examine the  of the  to verify that it
                describes (for each supported platform) how this functionality is invoked (it should
                be noted that this may be through a mechanism that is not implemented by the MDM
                Agent; nonetheless, that mechanism will be identified in the 
                as part of this evaluation activity).
              
              The evaluator shall examine the operational guidance to determine that it
                contains instructions on how to define the set of auditable events as well as
                explains the syntax for multi-value selection (if applicable). The evaluator shall
                also verify that the operational guidance shall identify those audit records that
                are always recorded, regardless of the selection criteria currently being
                enforced.
              
              
                
                  For each attribute listed in the requirement, the evaluator shall devise a
                    test to show that selecting the attribute causes only audit events with that
                    attribute (or those that are always recorded, as identified in the
                    administrative guidance) to be recorded.
                  
                  [conditional]: If the TSF supports specification of more complex audit
                    pre-selection criteria (e.g., multiple attributes, logical expressions using
                    attributes) then the evaluator shall devise tests showing that this capability
                    is correctly implemented. The evaluator shall also, in the test plan, provide a
                    short narrative justifying the set of tests as representative and sufficient to
                    exercise the capability.
                  
                
              
            
          
        
      <div class="comp" id=""><h4>FAU_ALT_EXT.2 Agent Alerts</h4><div class="component-activity-header">FAU_ALT_EXT.2</div>
              
              
            <div class="eacategory">TSS</div>                  
                  The evaluator shall examine the  and verify that it describes how the alerts are implemented.<br/><br/> 
                  The evaluator shall examine the  and verify that it describes how the candidate policy updates are obtained and the actions that take place for successful (policy update installed) and unsuccessful (policy update not installed) cases. The software components that are performing the processing must also be identified in the  and verified by the evaluator.<br/><br/> 
                  The evaluator also ensures that the  describes how reachability events are implemented, and if configurable are selected in FMT_SMF_EXT.4.2. The evaluator verifies that this description clearly indicates who ( Agent or  Server) initiates reachability events.<br/><br/> 
                  The evaluator shall ensure that the  describes under what circumstances, if any, the alert may not be generated (e.g., the device is powered off or disconnected from the trusted channel), how alerts are queued, and the maximum amount of storage for queued messages.<br/><br/>
              <div class="eacategory">Tests</div>
                  <ul>
                      <li><b>Test 1: </b>The evaluator shall perform a policy update from the test environment  server. The evaluator shall verify the  Agent accepts the update, makes the configured changes, and reports the success of the policy update back to the  Server.</li>
                      <li><b>Test 2: </b>The evaluator shall perform each of the actions listed in FAU_ALT_EXT.2.1 and verify that the alert does in fact reach the  Server.</li>
                      <li><b>Test 3: </b>The evaluator shall configure the  Agent to perform a network reachability test, both with and without such connectivity and ensure that results reflect each.</li>
                      <li><b>Test 4: </b>The evaluator shall remove network connectivity from the MDM Agent and generate an alert/event as defined in FAU_ALT_EXT.2.1. The evaluator shall restore network connectivity to the MDM Agent and verify that the alert generated while the  was disconnected is sent by the MDM Agent upon re-establishment of the connectivity.</li>
                  </ul>
              </div><div class="comp" id=""><h4>FAU_GEN.1/AUDITGEN Audit Data Generation</h4><div class="component-activity-header">FAU_GEN.1/AUDITGEN</div>
              
              
            <div class="eacategory">TSS</div>
                  The evaluator shall check the  and ensure that it provides a format for audit records. Each audit record format type must be covered, along with a brief description of each field. <br/><br/> 
                  If "invoke platform-provided functionality" is selected, the evaluator shall examine the  to verify that it describes (for each supported platform) how this functionality is invoked (it should be noted that this may be through a mechanism that is not implemented by the  Agent; nonetheless, that mechanism will be identified in the  as part of this evaluation activity).<br/><br/> 
              <div class="eacategory">Tests</div>
                  The evaluator shall use the  to perform the auditable
                  events defined in the Auditable Events table in FAU_GEN.1.1(2) and observe that
                  accurate audit records are generated with contents and formatting consistent with
                  those described in the . Note that this testing can be
                  accomplished in conjunction with the testing of the security mechanisms
                  directly.<br/><br/>                                 
              </div><div class="comp" id=""><h4>FAU_SEL.1/EVENTSEL Security Audit Event Selection</h4><div class="component-activity-header">FAU_SEL.1/EVENTSEL</div>
              
              
              
            <div class="eacategory">TSS</div>If "invoke platform-provided functionality" is selected, the evaluator shall
                examine the  of the  to verify that it
                describes (for each supported platform) how this functionality is invoked (it should
                be noted that this may be through a mechanism that is not implemented by the MDM
                Agent; nonetheless, that mechanism will be identified in the 
                as part of this evaluation activity).<br/><br/>
              <div class="eacategory">Guidance</div>The evaluator shall examine the operational guidance to determine that it
                contains instructions on how to define the set of auditable events as well as
                explains the syntax for multi-value selection (if applicable). The evaluator shall
                also verify that the operational guidance shall identify those audit records that
                are always recorded, regardless of the selection criteria currently being
                enforced.<br/><br/>
              <div class="eacategory">Tests</div>
                <ul>
                  <li><b>Test 1: </b>For each attribute listed in the requirement, the evaluator shall devise a
                    test to show that selecting the attribute causes only audit events with that
                    attribute (or those that are always recorded, as identified in the
                    administrative guidance) to be recorded.
                  </li>
                  <li><b>Test 2: </b>[conditional]: If the TSF supports specification of more complex audit
                    pre-selection criteria (e.g., multiple attributes, logical expressions using
                    attributes) then the evaluator shall devise tests showing that this capability
                    is correctly implemented. The evaluator shall also, in the test plan, provide a
                    short narrative justifying the set of tests as representative and sufficient to
                    exercise the capability.
                  </li>
                </ul>
              </div>
        
           This family is defined in the 
            . This  augments the extended family
            by adding one additional component, FIA_ENR_EXT.2. This new component and its impact on
            the extended family’s component leveling are shown below; reference the  PP for all other definitions for this family. 
        
        
          
           requires the TSF to record specific information about the 
            Server (i.e. the entity that is enrolling it) during the enrollment process.
          There are no management functions foreseen.
          The following actions should be auditable if FAU_GEN Security audit data generation
            is included in the PP/ST:
              Minimal: Completion of enrollment process.
            
          
          FIA_ENR_EXT.1 Enrollment of Mobile Device into Management
          
            The  Agent shall record the reference identifier of the
                 Server during the enrollment process. 
            The reference identifier of the  Server
              may be the Distinguished Name, Domain Name, and/or the IP address of the  Server. This requirement allows the specification of the information
              to be to be used to establish a network connection and the reference identifier for
              authenticating the trusted channel between the  Server and  Agent.
            
            
              The evaluator shall examine the  to verify that it describes
                which types of reference identifiers are acceptable and how the identifier is
                specified (e.g. preconfigured in the  Agent, by the user, by
                the  server, in a policy).
              
              The evaluator shall examine the operational guidance to verify that it
                describes how to configure reference identifier of the 
                Server’s certificate and, if different than the reference identifier, the Domain
                Name or IP address (for connectivity) of the 
                Server.
              
              The evaluator shall follow the operational guidance to establish the reference
                identifier of the  server on the  Agent
                and in conjunction with other evaluation activities verify that the  Agent can connect to the  Server and validate
                the  Server’s certificate.
              
            
          
        
      <div class="comp" id=""><h4>FIA_ENR_EXT.2 Agent Enrollment of Mobile Device into Management</h4><div class="component-activity-header">FIA_ENR_EXT.2</div>
              
              
              
            <div class="eacategory">TSS</div>The evaluator shall examine the  to verify that it describes
                which types of reference identifiers are acceptable and how the identifier is
                specified (e.g. preconfigured in the  Agent, by the user, by
                the  server, in a policy).<br/><br/>
              <div class="eacategory">Guidance</div>The evaluator shall examine the operational guidance to verify that it
                describes how to configure reference identifier of the 
                Server’s certificate and, if different than the reference identifier, the Domain
                Name or IP address (for connectivity) of the 
                Server.<br/><br/>
              <div class="eacategory">Tests</div>The evaluator shall follow the operational guidance to establish the reference
                identifier of the  server on the  Agent
                and in conjunction with other evaluation activities verify that the  Agent can connect to the  Server and validate
                the  Server’s certificate.<br/><br/>
              </div>
        
           This family is defined in the 
            . This  augments the extended family
            by adding one additional component, FMT_POL_EXT.2. This new component and its impact on
            the extended family’s component leveling are shown below; reference the  PP for all other definitions for this family.
        
        
          
           requires the TSF to verify the validity of the source of a policy before
            applying it.
          There are no management functions foreseen.
          The following actions should be auditable if FAU_GEN Security audit data generation
            is included in the PP/ST:
              Minimal: Failure to validate policy.
            
          
          FCS_COP.1 Cryptographic Operation FMT_POL_EXT.1 Trusted Policy
            Update 
          
            The  Agent shall only accept policies and policy updates
              that are digitally signed by a certificate that has been authorized for policy updates
              by the  Server. 
            The intent of this requirement is to cryptographically tie the
              policies to the enterprise that mandated the policy, not to protect the policies in
              transit (as they are already protected by FPT_ITT.1(2) of the ). This is especially critical for
              users who connect to multiple enterprises. Policies must be
              digitally signed by the enterprise using the algorithms in
              FCS_COP.1(3).
                       
          
          
            The MDM Agent shall not install policies if the policy-signing certificate is
              deemed invalid. 
            
                
                The evaluator ensures that the  describes how the candidate policies are obtained by the  Agent, the processing associated with verifying the digital signature of the policy updates, and the actions that take place for successful (signature was verified) and unsuccessful (signature could not be verified) cases. The software components that are performing the processing must also be identified in the  and verified by the evaluators.
                
               
                  This evaluation activity is performed in conjunction with the evaluation activity for FIA_X509_EXT.1 and FIA_X509_EXT.2 as defined in the s.
                  
                      The evaluator shall perform a policy update from an available configuration interface (such as through a test  Server). The evaluator shall verify the update is signed and is provided to the  Agent. The evaluator shall verify the  Agent accepts the digitally signed policy.
                      The evaluator shall perform a policy update from an available configuration interface (such as through a test  Server). The evaluator shall provide an unsigned and an incorrectly signed policy to the  Agent. The evaluator shall verify the  Agent does not accept the digitally signed policy.
                              
              
            
          
        
        
           This family is defined in the MDF . This  augments the extended family by adding one additional component,
            FMT_SMF_EXT.4. This new component and its impact on the extended family’s component
            leveling are shown below; reference the MDF PP for all other definitions for this
            family. 
        
        
          
           
           requires the TSF to support the execution of certain management functions that
            require interfacing with other TOE components.
          The following actions could be considered for the management functions in FMT:
              Execution of management functions.
              Configuration of management functions behavior.
            
          
          The following actions should be auditable if FAU_GEN Security audit data generation
            is included in the PP/ST:
              Minimal: Successful and failed execution of management functions.
            
          
          FCS_CKM.1 Cryptographic Key Generation
          
            The  Agent shall be capable of interacting with the platform
              to perform the following functions: 
                Import the certificates to be used for authentication of  Agent communications,
                
                    administrator-provided management functions in MDF 
                    administrator-provided device management functions in 
                      
                  
                
                    additional functions
                     no additional functions
                  .
              
            
             This requirement captures all the configuration functionality
              in the  Agent to configure the underlying mobile device with the
              configuration policies sent from the  Server to the Agent. The
                 author selects the  (MDF  or 
              ) as the source of the management functions. The
              administrator-provided management functions in MDF  are specified
              in Column 4 of Table 5 in MDF  and in FPT_TUD_EXT.1 (for version
              queries). The administrator-provided device management functions in 
               are specified in FMT_SMF.1.1(1); the functions in the selection
              of FMT_SMF.1.1(1) in the 
               are required to correspond to the functions available on the
              platforms supported by the  Agent. The  author can add more commands and configuration policies by completing
              the assignment statement; the mobile device must support these additional commands or
              configuration policies. The agent must configure the platform based
              on the commands and configuration policies received from the 
              Server. The  author must not claim any functionality not provided
              by the supported mobile device(s). All selections and assignments performed by the
                 author in this requirement should match the selections and
              assignments of the validated mobile device .
                       
          
          
            The  Agent shall be capable of performing the following
              functions: 
                Enroll in management
                Configure whether users can unenroll from management
                
                  
                    configure periodicity of reachability events
                    other management functions
                    no other functions
                  .
              
             This requirement captures all of the configuration in the
                 Agent for configuration of itself. If the
                 Agent is a part of the mobile device, enrollment is a single
              function both of the Agent and of the mobile device
              (FMT_SMF_EXT.4.1). If the  Agent is an
              application developed separately from the mobile device, the 
              Agent performs the function “enroll the mobile device in management” (per
              FMT_SMF_EXT.4.1) by registering itself to the mobile device as a device administrator.
              The Agent itself is enrolled in management by configuring the 
              Server to which the Agent answers. If the 
              Agent does not support unenrollment prevention, remediation actions should be applied
              upon unenrollment (per FMT_UNR_EXT.1). If the Agent generates
              periodic reachability events in FAU_ALT_EXT.2.1 and the periodicity of these events is
              configurable, “configure periodicity of reachability events” must be
              selected.
             
            
                
                This assurance activity may be performed in conjunction with other assurance
                activities in the .
                
               
                  The evaluator shall verify that the any assigned functions are described in the  and that these functions are documented as supported by the platform. The evaluator shall examine the  to verify that any differences between management functions and policies for each supported mobile device are listed.
                  The evaluator shall verify that the  describes the methods in which the MDM Agent can be enrolled. 
                  The  description shall make clear if the MDM Agent supports multiple interfaces for enrollment and configuration (for example, both remote configuration and local configuration).                  
              
               
                  The evaluator shall verify the AGD guidance includes detailed instructions for configuring each function in this requirement. 
                  If the  Agent is a component of the  system (i.e.  Server is the ), the evaluator shall verify, by consulting documentation for the claimed mobile device platforms, that the configurable functions listed for this Agent are supported by the platforms. 
                  If the  Agent supports multiple interfaces for configuration (for example, both remote configuration and local configuration), the AGD guidance makes clear whether some functions are restricted to certain interfaces.                
              
              
                
                    In conjunction with the evaluation activities in the , the evaluator shall attempt to configure each administrator-provided management function and shall verify that the mobile device executes the commands and enforces the policies.
                  The evaluator shall configure the MDM Agent authentication certificate in accordance with the configuration guidance. The evaluator shall verify that the MDM Agent uses this certificate in performing the tests for FPT_ITT.1(2) (from the MDM PP).
                    In conjunction with other evaluation activities, the evaluator shall attempt to enroll the MDM Agent in management with each interface identified in the , and verify that the MDM Agent can manage the device and communicate with the MDM Server.
                    [conditional] In conjunction with the evaluation activity for FAU_ALT_EXT.2.1, the evaluator shall configure the periodicity for reachability events for several configured time periods and shall verify that the MDM Server receives alerts on that schedule.
                  [conditional] The evaluator shall design and perform tests to demonstrate that the assigned function may be configured and that the intended behavior of the function is enacted by the mobile device.
                
              
            
          
        
        
           Components in this family define requirements for TSF behavior when a user
            attempts to unenroll the TOE from mobile device management.
        
        
          
           requires the TSF either to prevent unenrollment entirely or to take some
            corrective action in the event that an unenrollment is initiated.
          There are no management functions foreseen.
          The following actions should be auditable if FAU_GEN Security audit data generation
            is included in the PP/ST:
              Minimal: Unenrollment from .
            
          
           [FIA_ENR_EXT.1 Enrollment of Mobile Device into Management; or
            FMT_MOF_EXT.1 Management of Functions Behavior] 
          
            The  Agent shall provide a mechanism to enforce the
              following behavior upon an attempt to unenroll the mobile device from management: 
                prevent the unenrollment from occurring
                apply remediation actions
              .
            
            Unenrolling is the action of transitioning from the enrolled
              state to the unenrolled state. If preventing the user from unenrolling is
              configurable, administrators configure whether users are allowed to unenroll through
              the  Server. For those configurations where
              unenrollment is allowed, for example a BYOD usage, the MDF PP describes remediation
              actions performed upon unenrollment, such as wiping enterprise data, in
              FMT_SMF_EXT.2.1; however, the  Agent is limited to those actions
              supported by the mobile device on which the Agent is operating.
            
            
               The evaluator shall ensure that the  describes the
                mechanism used to prevent users from unenrolling or the remediation actions applied
                when unenrolled.
              
               The evaluator shall ensure that the administrative guidance instructs
                administrators in configuring the unenrollment prevention in each available
                configuration interface. If any configuration allows users to unenroll, the guidance
                also describes the actions that unenroll the Agent.
              
              
                
                  If ‘prevent the unenrollment from occurring’ is selected: The evaluator shall configure the Agent according to the administrative guidance for each available configuration interface, shall attempt to unenroll the device, and shall verify that the attempt fails.
                  
                  If ‘apply remediation actions’ is selected: If any configuration allows the user to unenroll, the evaluator shall configure the Agent to allow user unenrollment, attempt to unenroll, and verify that the remediation actions are applied.
                  
                
              
            
          
        
      <div class="comp" id=""><h4>FMT_POL_EXT.2 Agent Trusted Policy Update</h4><div class="component-activity-header">FMT_POL_EXT.2</div>
                
              
            <div class="eacategory">TSS</div>
                The evaluator ensures that the  describes how the candidate policies are obtained by the  Agent, the processing associated with verifying the digital signature of the policy updates, and the actions that take place for successful (signature was verified) and unsuccessful (signature could not be verified) cases. The software components that are performing the processing must also be identified in the  and verified by the evaluators.<br/><br/>
                <div class="eacategory">Tests</div> 
                  This evaluation activity is performed in conjunction with the evaluation activity for FIA_X509_EXT.1 and FIA_X509_EXT.2 as defined in the s.<br/><br/>
                  <ul>
                      <li><b>Test 1: </b>The evaluator shall perform a policy update from an available configuration interface (such as through a test  Server). The evaluator shall verify the update is signed and is provided to the  Agent. The evaluator shall verify the  Agent accepts the digitally signed policy.</li>
                      <li><b>Test 2: </b>The evaluator shall perform a policy update from an available configuration interface (such as through a test  Server). The evaluator shall provide an unsigned and an incorrectly signed policy to the  Agent. The evaluator shall verify the  Agent does not accept the digitally signed policy.</li>
                  </ul>            
              </div><div class="comp" id=""><h4>FMT_SMF_EXT.4 Specification of Management Functions</h4><div class="component-activity-header">FMT_SMF_EXT.4</div>
                
                This assurance activity may be performed in conjunction with other assurance
                activities in the .<br/><br/>
                
              
              
              
            <div class="eacategory">TSS</div> 
                  The evaluator shall verify that the any assigned functions are described in the  and that these functions are documented as supported by the platform. The evaluator shall examine the  to verify that any differences between management functions and policies for each supported mobile device are listed.<br/><br/>
                  The evaluator shall verify that the  describes the methods in which the MDM Agent can be enrolled.<br/><br/> 
                  The  description shall make clear if the MDM Agent supports multiple interfaces for enrollment and configuration (for example, both remote configuration and local configuration).<br/><br/>                  
              <div class="eacategory">Guidance</div> 
                  The evaluator shall verify the AGD guidance includes detailed instructions for configuring each function in this requirement.<br/><br/> 
                  If the  Agent is a component of the  system (i.e.  Server is the ), the evaluator shall verify, by consulting documentation for the claimed mobile device platforms, that the configurable functions listed for this Agent are supported by the platforms.<br/><br/> 
                  If the  Agent supports multiple interfaces for configuration (for example, both remote configuration and local configuration), the AGD guidance makes clear whether some functions are restricted to certain interfaces.<br/><br/>                
              <div class="eacategory">Tests</div>
                <ul>
                    <li><b>Test 1: </b>In conjunction with the evaluation activities in the , the evaluator shall attempt to configure each administrator-provided management function and shall verify that the mobile device executes the commands and enforces the policies.</li>
                  <li><b>Test 2: </b>The evaluator shall configure the MDM Agent authentication certificate in accordance with the configuration guidance. The evaluator shall verify that the MDM Agent uses this certificate in performing the tests for FPT_ITT.1(2) (from the MDM PP).</li>
                    <li><b>Test 3: </b>In conjunction with other evaluation activities, the evaluator shall attempt to enroll the MDM Agent in management with each interface identified in the , and verify that the MDM Agent can manage the device and communicate with the MDM Server.</li>
                    <li><b>Test 4: </b>[conditional] In conjunction with the evaluation activity for FAU_ALT_EXT.2.1, the evaluator shall configure the periodicity for reachability events for several configured time periods and shall verify that the MDM Server receives alerts on that schedule.</li>
                  <li><b>Test 5: </b>[conditional] The evaluator shall design and perform tests to demonstrate that the assigned function may be configured and that the intended behavior of the function is enacted by the mobile device.</li>
                </ul>
              </div><div class="comp" id=""><h4>FMT_UNR_EXT.1 User Unenrollment Prevention</h4><div class="component-activity-header">FMT_UNR_EXT.1</div>
              
              
              
            <div class="eacategory">TSS</div> The evaluator shall ensure that the  describes the
                mechanism used to prevent users from unenrolling or the remediation actions applied
                when unenrolled.<br/><br/>
              <div class="eacategory">Guidance</div> The evaluator shall ensure that the administrative guidance instructs
                administrators in configuring the unenrollment prevention in each available
                configuration interface. If any configuration allows users to unenroll, the guidance
                also describes the actions that unenroll the Agent.<br/><br/>
              <div class="eacategory">Tests</div>
                <ul>
                  <li><b>Test 1: </b>If ‘prevent the unenrollment from occurring’ is selected: The evaluator shall configure the Agent according to the administrative guidance for each available configuration interface, shall attempt to unenroll the device, and shall verify that the attempt fails.
                  </li>
                  <li><b>Test 2: </b>If ‘apply remediation actions’ is selected: If any configuration allows the user to unenroll, the evaluator shall configure the Agent to allow user unenrollment, attempt to unenroll, and verify that the remediation actions are applied.
                  </li>
                </ul>
              </div><h2 class="indexable" data-level="1" id="opt-sfrs">2.4 Evaluation Activities for Optional SFRs</h2>The PP-Module does not define any optional requirements.<h2 class="indexable" data-level="1" id="sel-sfrs">2.5 Evaluation Activities for Selection-Based SFRs</h2>The PP-Module does not define any selection-based requirements.<h2 class="indexable" data-level="1" id="obj-sfrs">2.6 Evaluation Activities for Objective SFRs</h2>
        
          This family is defined in the 
            . This  augments the extended family
            by adding one additional component, FAU_STG_EXT.3. This new component and its impact on
            the extended family’s component leveling are shown below; reference the  PP for all other definitions for this family.
        
        
          
          
           requires the TSF to identify a location for audit record storage and the events
            that are stored at this location.
          There are no management functions foreseen.
          There are no auditable events foreseen.
          FAU_GEN.1 Audit Data Generation
          
            The MDM Agent shall store MDM audit records in the platform-provided audit storage. 
            FAU_STG_EXT.3 should only be included in the  for MDM Agent platforms (i.e., mobile devices) that conform to MDF PP version 3 or later.
            
            
              The evaluator shall verify that the  description of the
                audit records indicates how the records are stored. The evaluator shall verify that
                the Agent calls a platform-provided API to store audit records.
              
            
          
        
      <div class="comp" id=""><h4>FAU_STG_EXT.3 Security Audit Event Storage</h4><div class="component-activity-header">FAU_STG_EXT.3</div>
              
            <div class="eacategory">TSS</div>The evaluator shall verify that the  description of the
                audit records indicates how the records are stored. The evaluator shall verify that
                the Agent calls a platform-provided API to store audit records.<br/><br/>
              </div>
        
           Components in this family define requirements for tracking the availability
            of network components. 
        
        
          
           requires the TSF to keep track of failed attempts to communicate with a remote
            entity.
          The following actions could be considered for the management functions in FMT:
            
              Configuration of unreachability threshold.
          
          The following actions should be auditable if FAU_GEN Security audit data generation
            is included in the PP/ST:
              Minimal: Reaching/exceeding unreachability threshold.
          
          FPT_STM.1 Reliable Time Stamps
          
            The TSF shall detect when a configurable 
                positive integer of missed reachability events occur
                time limit is exceeded
               related to the last successful connection with the server has been
              reached. 
             This requirement is to enable the Agent to determine if it has
              been out of connectivity with the Server for too long. The configuration of the number
              of allowed missed reachability events or time limit since last successful connection
              with the server is handled in Server configuration policy of the Agent (the first selection of
              function 56 in FMT_SMF.1.1(1) within the MDM PP). If the first selection of FMT_SMF.1.1(1) function 56 is included in the ,
              then FPT_NET_EXT.1.1 must be included in the . If the Agent has been out of connectivity with the server for
              too long than the remediation actions specified in the second selection of function 56 must occur. For
              example if the Agent has not synced with the server in the allowed amount of time that
              the Agent must wipe the device without requiring a command from the
              Server.
            
            
               The evaluator shall verify that the  contains a description
                of how the Agent determines how long it has been since the last successful
                connection with the Server (i.e., total number of missed reachability events or
                time). If total number of missed reachability events is selected, the evaluator
                shall verify that the  contains a description of how often the
                reachability events are sent.
              
               The evaluator shall verify that the AGD guidance instructs the
                administrator, if needed, how to configure the  to detect when
                the time since last successful connection with the server has been
                reached.
              
               The evaluator shall configure the Server configuration policy of the Agent per
                FMT_SMF.1.1(1) function 56 within the Mobile Device Managment PP. The device shall be placed in airplane mode to prevent
                connectivity with the Server. The evaluator shall verify that after the configured
                time, the remediation actions selected in function 56 occur.
              
            
          
        
      <div class="comp" id=""><h4>FPT_NET_EXT.1 Network Reachability</h4><div class="component-activity-header">FPT_NET_EXT.1</div>
              
              
              
            <div class="eacategory">TSS</div> The evaluator shall verify that the  contains a description
                of how the Agent determines how long it has been since the last successful
                connection with the Server (i.e., total number of missed reachability events or
                time). If total number of missed reachability events is selected, the evaluator
                shall verify that the  contains a description of how often the
                reachability events are sent.<br/><br/>
              <div class="eacategory">Guidance</div> The evaluator shall verify that the AGD guidance instructs the
                administrator, if needed, how to configure the  to detect when
                the time since last successful connection with the server has been
                reached.<br/><br/>
              <div class="eacategory">Tests</div> The evaluator shall configure the Server configuration policy of the Agent per
                FMT_SMF.1.1(1) function 56 within the Mobile Device Managment PP. The device shall be placed in airplane mode to prevent
                connectivity with the Server. The evaluator shall verify that after the configured
                time, the remediation actions selected in function 56 occur.<br/><br/>
              </div><h1 id="sar_aas" class="indexable" data-level="0">3 Evaluation Activities for SARs</h1><p>The PP-Module does not define any SARs beyond those defined within the
    
	base-PP to which it must claim conformance.
	It is important to note that a TOE that is evaluated against the PP-Module is
	inherently evaluated against the Base-PP as well.

	The Base-PP includes a number of Evaluation Activities associated with both SFRs and SARs.
	Additionally, the PP-Module includes a number of SFR-based Evaluation Activities 
	that similarly refine the SARs of the Base-PPs.
	The evaluation laboratory will evaluate the TOE against the chosen Base-PP
      
    and supplement that evaluation with the necessary SFRs that are taken from the PP-Module.
    </p><h1 id="sup-info" class="indexable" data-level="0">4 Required Supplementary Information</h1><p>This Supporting Document has no required supplementary information beyond the ST, operational
guidance, and testing.</p><h1 id="biblio" class="indexable" data-level="A">Appendix A -  References</h1><table><tr class="header"><th>Identifier</th><th>Title</th></tr>
    <tr><td><span id="bibCC"> [CC] </span></td><td>Common Criteria for Information Technology Security Evaluation - <ul><li><a href="http://www.commoncriteriaportal.org/files/ccfiles/CCPART1V3.1R5.pdf">Part
                1: Introduction and General Model</a>, CCMB-2017-04-001, Version 3.1 Revision 5,
              April 2017.</li><li><a href="http://www.commoncriteriaportal.org/files/ccfiles/CCPART2V3.1R5.pdf">Part
                2: Security Functional Components</a>, CCMB-2017-04-002, Version 3.1 Revision 5,
              April 2017.</li><li><a href="http://www.commoncriteriaportal.org/files/ccfiles/CCPART3V3.1R5.pdf">Part
                3: Security Assurance Components</a>, CCMB-2017-04-003, Version 3.1 Revision 5,
              April 2017.</li></ul></td></tr>
  </table></body></html>